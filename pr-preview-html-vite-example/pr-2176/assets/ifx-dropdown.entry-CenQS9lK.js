import{r,c as s,g as o,h as i}from"./index-RccJVRSK.js";import{i as a}from"./dom-utils-CtINY9El-CZY0_Num.js";import{d as l,t as h}from"./tracking-DNHOWgWh-BE-DLK5Z.js";import{c}from"./popper-BfP9ezJQ-CAMpDiU4.js";const d=()=>":host{display:inline-block}",p=class{constructor(e){r(this,e),this.ifxOpen=s(this,"ifxOpen",7),this.ifxClose=s(this,"ifxClose",7),this.ifxDropdown=s(this,"ifxDropdown",7)}placement="bottom-start";defaultOpen=!1;internalIsOpen=!1;noAppendToBody=!1;ifxOpen;ifxClose;ifxDropdown;disabled;noCloseOnOutsideClick=!1;noCloseOnMenuClick=!1;get el(){return o(this)}trigger;menu;popperInstance;handleOutsideClick(e){const t=e.target;!this.noCloseOnOutsideClick&&!this.el.contains(t)&&!this.menu.contains(t)&&this.closeDropdown()}handleFocusOutside(e){const t=e.target;this.internalIsOpen&&!this.el.contains(t)&&!this.menu.contains(t)&&this.closeDropdown()}handleTriggerClick=()=>{this.internalIsOpen?this.closeDropdown():this.openDropdown()};handleTriggerKeyDown=e=>{e.key==="Tab"&&this.internalIsOpen&&!e.shiftKey&&(e.preventDefault(),this.focusFirstItem())};handleMenuClick=()=>{this.noCloseOnMenuClick||this.closeDropdown()};getItemFocusables(){return this.menu?Array.from(this.menu.querySelectorAll("ifx-dropdown-item")).filter(t=>!(t.getAttribute("hide")==="true"||t.classList.contains("hide"))).map(t=>t.shadowRoot?.querySelector("a")).filter(t=>!!t):[]}handleMenuKeyDown=e=>{const t=this.getItemFocusables();if(!t.length)return;const n=t.indexOf(document.activeElement);switch(e.key){case"ArrowDown":e.preventDefault(),t[(n+1)%t.length].focus();break;case"ArrowUp":e.preventDefault(),t[(n-1+t.length)%t.length].focus();break;case"Home":e.preventDefault(),t[0].focus();break;case"End":e.preventDefault(),t[t.length-1].focus();break;case"Enter":case" ":case"Spacebar":e.preventDefault(),document.activeElement?.click();break;case"Escape":e.preventDefault(),this.closeDropdown(),this.trigger?.focus();break;case"Tab":e.shiftKey&&n===0&&(e.preventDefault(),this.closeDropdown(),this.trigger?.focus());break}};componentWillLoad(){this.updateSlotContent(),this.watchHandlerIsOpen(this.defaultOpen,this.internalIsOpen)}async componentDidLoad(){if(!a(this.el)){const e=l();h("ifx-dropdown",await e)}}watchHandlerIsOpen(e,t){e!==t&&e!==this.internalIsOpen&&(e?this.openDropdown():this.closeDropdown())}watchHandlerDisabled(e){this.trigger&&(this.trigger.disabled=e)}watchHandlerSlot(){this.updateSlotContent()}focusFirstItem(){const[e]=this.getItemFocusables();e?.focus()}updateSlotContent(){const e=this.el.querySelector("ifx-dropdown-trigger-button, ifx-dropdown-trigger");e!==this.trigger&&(this.trigger&&(this.trigger.removeEventListener("click",this.handleTriggerClick),this.trigger.removeEventListener("keydown",this.handleTriggerKeyDown)),this.trigger=e,this.trigger&&(this.trigger.disabled=this.disabled,this.trigger.addEventListener("click",this.handleTriggerClick),this.trigger.addEventListener("keydown",this.handleTriggerKeyDown)));const t=this.el.querySelector("ifx-dropdown-menu");this.noAppendToBody?this.menu=t:(this.menu&&this.menu!==t&&(this.menu.removeEventListener("click",this.handleMenuClick),this.menu.removeEventListener("keydown",this.handleMenuKeyDown),this.menu.remove()),this.menu=t,this.menu&&!document.body.contains(this.menu)&&document.body.append(this.menu)),this.menu&&(this.menu.removeEventListener("click",this.handleMenuClick),this.menu.removeEventListener("keydown",this.handleMenuKeyDown),this.menu.addEventListener("click",this.handleMenuClick),this.menu.addEventListener("keydown",this.handleMenuKeyDown))}disconnectedCallback(){this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=null),this.menu&&this.menu.remove()}async isOpen(){return this.internalIsOpen}async closeDropdown(){this.internalIsOpen&&(this.internalIsOpen=!1,this.trigger.isOpen=!1,this.menu.isOpen=!1,this.ifxClose.emit()),this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=null)}async openDropdown(){!this.internalIsOpen&&!this.disabled&&(this.internalIsOpen=!0,this.trigger.isOpen=!0,this.menu.isOpen=!0,this.popperInstance=c(this.el,this.menu,{placement:this.placement}),this.ifxOpen.emit())}render(){return i("div",{key:"7ce42124c9ceabab20d3d7bd4b09035c10c143c5","aria-label":"dropdown menu",class:"dropdown"},i("slot",{key:"da24a57538a33fd2164de34e3a71e95db1123875"}))}static get watchers(){return{defaultOpen:[{watchHandlerIsOpen:0}],disabled:[{watchHandlerDisabled:0}]}}};p.style=d();export{p as ifx_dropdown};
//# sourceMappingURL=ifx-dropdown.entry-CenQS9lK.js.map

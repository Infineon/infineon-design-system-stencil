import{r as u,c as f,h as o,g as m,H as g}from"./index-N_Cl5ghV.js";import{t as b}from"./tracking-a7efdbcd-C3wgNWo1.js";import{i as w}from"./dom-utils-1988cdf1-CZY0_Num.js";const S=':root{--ifx-font-family:"Source Sans 3", "Arial, sans-serif"}.ifx-multiselect-container{position:relative;box-sizing:border-box;font-family:var(--ifx-font-family)}.ifx-multiselect-container:hover{cursor:pointer}.ifx-multiselect-container .ifx-label-wrapper{font-size:1rem;line-height:1.5rem;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;max-width:100%}.ifx-multiselect-container .ifx-error-message-wrapper{color:#CD002F;font-size:0.75rem;line-height:1rem;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;max-width:100%}.ifx-multiselect-container .ifx-multiselect-wrapper{background-color:#FFFFFF;box-sizing:border-box;display:flex;align-items:center;border:1px solid #8D8786;border-radius:1px;width:100%;font-weight:400;font-style:normal;height:40px;line-height:24px;padding:8px 16px;font-size:1rem;line-height:1.5rem}.ifx-multiselect-container .ifx-multiselect-wrapper:focus-visible{outline:none}.ifx-multiselect-container .ifx-multiselect-wrapper:focus-visible:not(.active):not(:active){outline:none}.ifx-multiselect-container .ifx-multiselect-wrapper:focus-visible:not(.active):not(:active)::before{content:"";position:absolute;width:calc(100% + 4px);height:calc(100% + 4px);top:50%;left:50%;transform:translate(-50%, -50%);border:2px solid #0A8276;border-radius:2px}.ifx-multiselect-container .ifx-multiselect-wrapper.disabled{background:#EEEDED;color:#575352;border-color:#575352;cursor:default;-webkit-user-select:none;-ms-user-select:none;user-select:none}.ifx-multiselect-container .ifx-multiselect-wrapper.error{border-color:#CD002F}.ifx-multiselect-container .ifx-multiselect-wrapper:hover:not(.focus,:focus){border-color:#575352}.ifx-multiselect-container .ifx-multiselect-wrapper.active{border-color:#0A8276 !important}.ifx-multiselect-container .ifx-multiselect-wrapper.active .icon-wrapper-up{display:flex;align-items:center;justify-content:center;padding-left:8px}.ifx-multiselect-container .ifx-multiselect-wrapper.active .icon-wrapper-down{display:none}.ifx-multiselect-container .ifx-multiselect-wrapper .icon-wrapper-up{display:none}.ifx-multiselect-container .ifx-multiselect-wrapper .icon-wrapper-down{display:flex;align-items:center;justify-content:center;padding-left:8px}.ifx-multiselect-container .ifx-multiselect-wrapper.is-flipped .ifx-multiselect-dropdown-menu{top:auto;bottom:100%}.ifx-multiselect-container .ifx-multiselect-input{flex-grow:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ifx-multiselect-container .ifx-multiselect-input.placeholder{opacity:0.5}.ifx-multiselect-container .ifx-multiselect-icon-container{margin-left:auto;display:flex;align-items:center;gap:8px}.ifx-multiselect-container .ifx-multiselect-icon-container .ifx-multiselect-icon-container{display:flex}.ifx-multiselect-container .ifx-multiselect-icon-container .icon-wrapper{display:flex;align-items:center;transition:transform 0.2s ease-in-out}.ifx-multiselect-container .ifx-multiselect-icon-container .icon-wrapper--open{transform:rotate(180deg)}.ifx-multiselect-container .ifx-clear-button{display:flex;align-items:center}.ifx-multiselect-container .ifx-clear-button.hide{display:none}.ifx-multiselect-container .ifx-multiselect-dropdown-menu{box-sizing:border-box;position:absolute;top:100%;left:0;width:100%;margin-top:4px;border:1px solid #EEEDED;background-color:#fff;box-shadow:0px 6px 9px 0px rgba(29, 29, 29, 0.1);max-height:300px;z-index:1000;display:flex;flex-direction:column}.ifx-multiselect-dropdown-functions{padding:12px 16px;border-bottom:1px solid #EEEDED;flex-shrink:0}.ifx-multiselect-dropdown-search{margin-bottom:12px}.ifx-multiselect-dropdown-controls{display:flex;flex-wrap:wrap;justify-content:space-between;gap:8px}.ifx-multiselect-dropdown-controls .select-all-wrapper{display:flex}.ifx-multiselect-dropdown-controls .expand-collapse-controls{display:flex;gap:12px}.ifx-multiselect-dropdown-controls .control-item{font-size:0.875rem;line-height:1.25rem}.ifx-multiselect-dropdown-controls .control-item:hover{color:#0A8276}.ifx-multiselect-dropdown-controls .control-item:active{color:#08665C}.ifx-multiselect-dropdown-controls .control-item:focus{outline:none}.ifx-multiselect-dropdown-controls .control-item:focus-visible{outline:2px solid #0A8276;outline-offset:2px;border-radius:1px}.ifx-multiselect-options{flex:1;overflow-y:auto;padding-top:12px;padding-bottom:12px}.ifx-multiselect-options.show-no-results .ifx-multiselect-no-results{display:block}.ifx-multiselect-no-results{padding-left:16px;padding-right:16px;display:none}',v=S;function E(i,t){let e;return function(...s){const n=()=>{clearTimeout(e),i(...s)};clearTimeout(e),e=setTimeout(n,t)}}const y=class{constructor(i){u(this,i),this.ifxSelect=f(this,"ifxSelect",7),this.ifxOpen=f(this,"ifxOpen",7),i.$hostElement$["s-ei"]?this.internals=i.$hostElement$["s-ei"]:(this.internals=i.$hostElement$.attachInternals(),i.$hostElement$["s-ei"]=this.internals),this.disabled=!1,this.error=!1,this.errorMessage="Error",this.label="",this.placeholder="",this.showSearch=!0,this.showSelectAll=!0,this.showClearButton=!0,this.showExpandCollapse=!0,this.noResultsMessage="No results found.",this.showNoResultsMessage=!0,this.searchPlaceholder="Search",this.selectAllLabel="Select all",this.expandLabel="Expand",this.collapseLabel="Collapse",this.ariaMultiSelectLabel="Multi-select dropdown",this.ariaMultiSelectLabelledBy="",this.ariaMultiSelectDescribedBy="",this.ariaSearchLabel="Search options",this.ariaClearLabel="Clear all selections",this.ariaToggleLabel="Toggle dropdown",this.ariaSelectAllLabel="Select all options",this.ariaExpandAllLabel="Expand all categories",this.ariaCollapseAllLabel="Collapse all categories",this.internalError=!1,this.persistentSelectedOptions=[],this.dropdownOpen=!1,this.searchTerm="",this.handleSearch=E(t=>{const e=t.value.toLowerCase(),l=e!=="";this.searchTerm=e;const s=this.el.shadowRoot.querySelector(".ifx-multiselect-wrapper");if(s)if(l)s.classList.remove("active");else{const a=this.el.shadowRoot.querySelector("ifx-search-field");a&&a.matches(":focus-within")||s.classList.add("active")}const n=this.el.shadowRoot.querySelector(".ifx-multiselect-options");n&&(l?n.classList.add("has-search-filter"):n.classList.remove("has-search-filter")),requestAnimationFrame(()=>{if(this.el.querySelectorAll("ifx-multiselect-option").forEach(r=>{const c=new CustomEvent("ifx-search-filter",{detail:{searchTerm:e,isActive:l}});r.dispatchEvent(c)}),l)setTimeout(()=>{const r=this.el.querySelectorAll("ifx-multiselect-option");let c=0;r.forEach(d=>{const p=window.getComputedStyle(d),x=d.getBoundingClientRect();p.display!=="none"&&p.visibility!=="hidden"&&p.opacity!=="0"&&x.height>0&&c++});const h=this.el.shadowRoot.querySelector(".ifx-multiselect-options");h&&(c===0?h.classList.add("show-no-results"):h.classList.remove("show-no-results"))},200);else{const r=this.el.shadowRoot.querySelector(".ifx-multiselect-options");r&&r.classList.remove("show-no-results")}})},150),this.pendingSelectionUpdate=!1,this.handleDocumentClick=t=>{t.composedPath().includes(this.dropdownElement)||(this.dropdownOpen=!1,document.removeEventListener("click",this.handleDocumentClick),this.resetSearch(),this.ifxOpen.emit(this.dropdownOpen))}}parseChildOptions(){const i=[];return Array.from(this.el.children).forEach((e,l)=>{if(e.tagName==="IFX-MULTISELECT-OPTION"){const s=this.parseOptionElement(e,l);s&&i.push(s)}}),i}parseOptionElement(i,t){const e=i.getAttribute("value")||`option-${t}`,l=i.hasAttribute("selected"),s=i.hasAttribute("disabled"),n=i.hasAttribute("indeterminate"),a={value:e,selected:l,disabled:s,indeterminate:n},r=Array.from(i.children).filter(c=>c.tagName==="IFX-MULTISELECT-OPTION").map((c,h)=>this.parseOptionElement(c,h)).filter(c=>c!==null);return r.length>0&&(a.children=r),a}loadInitialOptions(){this.internalError=this.error,this.internalErrorMessage=this.errorMessage;const i=this.parseChildOptions(),e=this.collectSelectedOptions(i).filter(l=>!this.persistentSelectedOptions.some(s=>s.value==l.value));this.persistentSelectedOptions=[...this.persistentSelectedOptions,...e]}collectSelectedOptions(i){let t=[];for(const e of i)e.selected?e.children&&e.children.length>0?t=t.concat(this.collectLeafOptions(e.children)):t.some(l=>l.value===e.value)||t.push(e):e.children&&e.children.length>0&&(t=t.concat(this.collectSelectedOptions(e.children)));return t}collectLeafOptions(i){let t=[];for(const e of i)e.children&&e.children.length>0?t=t.concat(this.collectLeafOptions(e.children)):t.push(e);return t}handleSearchFocus(i){const t=this.el.shadowRoot.querySelector(".ifx-multiselect-wrapper");t&&(i||this.searchTerm!==""?t.classList.remove("active"):t.classList.add("active"))}positionDropdown(){var i;const t=(i=this.el.shadowRoot.querySelector(".ifx-multiselect-wrapper"))===null||i===void 0?void 0:i.getBoundingClientRect(),e=window.innerHeight-t.bottom;t.top>e&&t.height>e||t.bottom>window.innerHeight?this.dropdownFlipped=!0:this.dropdownFlipped=!1}updateSlotBasedSelections(i=!1){const t=this.el.querySelectorAll("ifx-multiselect-option"),e=[];t.forEach(l=>{const s=l.__stencil_instance;s&&s.selected&&!s.hasChildren&&e.push({value:s.value,selected:!0,disabled:s.disabled})}),this.persistentSelectedOptions=e,i&&this.ifxSelect.emit(this.persistentSelectedOptions)}updateInitialParentStates(){const i=this.el.querySelectorAll("ifx-multiselect-option");Array.from(i).map(e=>({element:e,instance:e.__stencil_instance,depth:parseInt(e.getAttribute("data-level")||"0")})).filter(e=>e.instance).sort((e,l)=>l.depth-e.depth).forEach(({instance:e})=>{e.hasChildren&&this.updateParentState(e)})}updateParentState(i){const t=Array.from(i.el.children).filter(n=>n.tagName==="IFX-MULTISELECT-OPTION").map(n=>n.__stencil_instance).filter(n=>n!==null),e=t.filter(n=>n.selected).length,l=t.filter(n=>n.indeterminate).length,s=t.length;e===s&&l===0?(i.selected=!0,i.indeterminate=!1):e===0&&l===0?(i.selected=!1,i.indeterminate=!1):(i.selected=!1,i.indeterminate=!0)}componentDidLoad(){setTimeout(()=>{this.positionDropdown()},500),this.el.addEventListener("ifx-option-changed",()=>{this.pendingSelectionUpdate||(this.pendingSelectionUpdate=!0,requestAnimationFrame(()=>{this.updateSlotBasedSelections(!0),setTimeout(()=>{this.pendingSelectionUpdate=!1},0)}))}),setTimeout(()=>{this.updateSlotBasedSelections(!1),this.updateInitialParentStates()},100)}componentWillLoad(){w(this.el)||b("ifx-multiselect"),this.loadInitialOptions()}updateInternalError(){this.internalError=this.error}updateInternalErrorMessage(){this.internalErrorMessage=this.errorMessage}onSelectionChange(i,t){const e=new FormData;i.forEach(l=>e.append(this.name,l.value)),this.internals.setFormValue(e)}collapseAll(){this.el.querySelectorAll("ifx-multiselect-option").forEach(t=>{const e=t.__stencil_instance;e&&e.hasChildren&&(e.isExpanded=!1)})}expandAll(){this.el.querySelectorAll("ifx-multiselect-option").forEach(t=>{const e=t.__stencil_instance;e&&e.hasChildren&&(e.isExpanded=!0)})}selectAll(){this.resetSearch(),this.el.querySelectorAll("ifx-multiselect-option").forEach(t=>{const e=t.__stencil_instance;e&&(e.hasChildren?e.isExpanded=!0:e.selected=!0)}),setTimeout(()=>{this.updateInitialParentStates(),this.updateSlotBasedSelections(!1),this.ifxSelect.emit(this.persistentSelectedOptions)},0)}async clearSelection(){this.el.querySelectorAll("ifx-multiselect-option").forEach(t=>{const e=t.__stencil_instance;e&&(e.selected=!1,e.indeterminate=!1,e.hasChildren&&(e.isExpanded=!1))}),this.persistentSelectedOptions=[],setTimeout(()=>{this.updateSlotBasedSelections(!1),this.ifxSelect.emit(this.persistentSelectedOptions)},0)}toggleDropdown(){this.dropdownOpen=!this.dropdownOpen,setTimeout(()=>{this.dropdownOpen?document.addEventListener("click",this.handleDocumentClick):this.resetSearch(),this.ifxOpen.emit(this.dropdownOpen)},0)}resetSearch(){this.searchTerm="";const i=this.el.shadowRoot.querySelector("ifx-search-field");i&&(i.value="");const t=this.el.shadowRoot.querySelector(".ifx-multiselect-options");t&&t.classList.remove("has-search-filter"),this.el.querySelectorAll("ifx-multiselect-option").forEach(l=>{const s=new CustomEvent("ifx-search-filter",{detail:{searchTerm:"",isActive:!1}});l.dispatchEvent(s)})}handleWrapperClick(i){this.positionDropdown(),i.currentTarget===i.target&&this.toggleDropdown()}handleKeyDown(i){if(!this.disabled){if(!this.dropdownOpen){switch(i.code){case"Enter":case"Space":case"ArrowDown":i.preventDefault(),this.toggleDropdown();break}return}switch(i.code){case"Escape":i.preventDefault(),this.toggleDropdown();break;case"Enter":case"Space":i.target.closest(".ifx-multiselect-dropdown-functions")||(i.preventDefault(),this.toggleDropdown());break;case"ArrowDown":case"ArrowUp":i.preventDefault(),this.focusFirstOption();break}}}focusFirstOption(){var i;const t=this.el.querySelector("ifx-multiselect-option:not(.search-hidden)");if(t){const e=(i=t.shadowRoot)===null||i===void 0?void 0:i.querySelector(".option-label");e==null||e.focus()}}renderSelectAll(){const i=this.el.querySelectorAll("ifx-multiselect-option"),t=Array.from(i).filter(n=>!n.hasChildren),e=Array.from(i).filter(n=>!n.hasChildren&&n.selected),l=t.length>0&&e.length===t.length,s=n=>{n&&(n.preventDefault(),n.stopPropagation()),l?this.clearSelection():this.selectAll()};return o("div",{class:"select-all-wrapper"},o("ifx-checkbox",{id:"selectAll",checked:l,size:"s","aria-label":this.ariaSelectAllLabel,onClick:s,onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),n.stopPropagation(),s(n))}},this.selectAllLabel))}renderNoResultsMessage(){return o("div",{class:"ifx-multiselect-no-results"},o("div",{class:"no-results-content"},o("span",{class:"no-results-text"},this.noResultsMessage)))}render(){const i=this.persistentSelectedOptions.map(s=>{var n;const a=this.el.querySelector(`ifx-multiselect-option[value="${s.value}"]`);return((n=a==null?void 0:a.textContent)===null||n===void 0?void 0:n.trim())||s.value}).join(", "),t=this.persistentSelectedOptions.length>0;let e=!1;const l=this.el.querySelectorAll("ifx-multiselect-option");return l.length>0&&(e=Array.from(l).every(s=>s.children.length===0)),o("div",{class:"ifx-multiselect-container",ref:s=>this.dropdownElement=s},this.label?o("div",{class:"ifx-label-wrapper"},o("span",null,this.label)):null,o("div",{class:`ifx-multiselect-wrapper
        ${this.dropdownOpen?"active":""}
        ${this.dropdownFlipped?"is-flipped":""}
        ${this.internalError?"error":""}
        ${this.disabled?"disabled":""}`,role:"combobox","aria-label":this.ariaMultiSelectLabel,"aria-labelledby":this.ariaMultiSelectLabelledBy||void 0,"aria-describedby":this.ariaMultiSelectDescribedBy||void 0,"aria-expanded":this.dropdownOpen,"aria-haspopup":"listbox","aria-disabled":this.disabled,tabindex:"0",onClick:this.disabled?void 0:s=>this.handleWrapperClick(s),onKeyDown:this.disabled?void 0:s=>this.handleKeyDown(s)},o("div",{class:`ifx-multiselect-input
          ${t?"":"placeholder"}
          `,onClick:this.disabled?void 0:()=>this.toggleDropdown()},t?i:this.placeholder),this.dropdownOpen&&o("div",{class:"ifx-multiselect-dropdown-menu"},(this.showSearch||this.showSelectAll||this.showExpandCollapse&&!e)&&o("div",{class:"ifx-multiselect-dropdown-functions",onClick:s=>s.stopPropagation()},this.showSearch&&o("div",{class:"ifx-multiselect-dropdown-search"},o("ifx-search-field",{class:"search-input",placeholder:this.searchPlaceholder,size:"s","show-delete-icon":"true","aria-label":this.ariaSearchLabel,onKeyDown:s=>{s.stopPropagation()},onIfxInput:s=>this.handleSearch(s.target),onFocus:()=>this.handleSearchFocus(!0),onBlur:()=>this.handleSearchFocus(!1)})),o("div",{class:"ifx-multiselect-dropdown-controls"},this.showSelectAll&&this.renderSelectAll(),this.showExpandCollapse&&!e&&o("div",{class:"expand-collapse-controls"},o("span",{class:"control-item",role:"button",tabIndex:0,"aria-label":this.ariaExpandAllLabel,onClick:s=>{s.stopPropagation(),this.expandAll()},onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),s.stopPropagation(),this.expandAll())}},this.expandLabel),o("span",{class:"control-item",role:"button",tabIndex:0,"aria-label":this.ariaCollapseAllLabel,onClick:s=>{s.stopPropagation(),this.collapseAll()},onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),s.stopPropagation(),this.collapseAll())}},this.collapseLabel)))),o("div",{class:"ifx-multiselect-options",role:"listbox","aria-multiselectable":"true"},o("slot",null),this.searchTerm&&this.showNoResultsMessage&&this.renderNoResultsMessage())),o("div",{class:"ifx-multiselect-icon-container"},this.persistentSelectedOptions.length>0&&o("div",{class:`ifx-clear-button ${this.showClearButton?"":"hide"}`,onClick:this.disabled?void 0:()=>this.clearSelection()},o("ifx-icon",{icon:"cRemove16"})),o("div",{class:"icon-wrapper-up",onClick:this.disabled?void 0:()=>this.toggleDropdown()},o("ifx-icon",{key:"icon-up",icon:"chevron-up-16"})),o("div",{class:"icon-wrapper-down",onClick:this.disabled?void 0:()=>this.toggleDropdown()},o("ifx-icon",{key:"icon-down",icon:"chevron-down-16"})))),this.internalError?o("div",{class:"ifx-error-message-wrapper"},o("span",null,this.internalErrorMessage)):null)}static get formAssociated(){return!0}get el(){return m(this)}static get watchers(){return{error:["updateInternalError"],errorMessage:["updateInternalErrorMessage"],persistentSelectedOptions:["onSelectionChange"]}}};y.style=v;const C=":host{display:block;width:100%}.option{display:flex;flex-direction:column;position:relative;cursor:pointer;list-style:none}.option.option--expanded{position:relative}.option.option--has-children{position:relative}.option.option--has-children .option-item>.chevron-wrapper{display:flex}.option--disabled{cursor:not-allowed;pointer-events:none;color:#BFBBBB}.option.search-hidden{display:none !important}.option.search-match .option-item .option-label .search-highlight{font-weight:bold}.option-item{display:flex;flex-direction:row;align-items:center;white-space:nowrap;min-height:20px;padding:4px 16px;background-color:#FFFFFF;transition:background-color 0.2s ease-in-out}.option-item:hover{background-color:#F7F7F7}.option--disabled .option-item:hover{background-color:transparent}.option-children{display:block}.chevron-wrapper{display:none;align-items:center;justify-content:center;margin-right:8px;width:20px;height:20px;flex-shrink:0}.chevron-wrapper:focus{outline:none}.chevron-wrapper:focus-visible{outline:2px solid #0A8276;outline-offset:2px;border-radius:1px}.option--has-children .chevron-wrapper{display:flex}.chevron-wrapper .chevron{transition:transform 0.2s ease-in-out;color:#3C3A39}.chevron-wrapper .chevron.chevron--expanded{transform:rotate(90deg)}.chevron-wrapper .chevron.chevron--collapsed{transform:rotate(0deg)}.checkbox-wrapper{display:flex;align-items:center;margin-right:8px;flex-shrink:0}.option-label{flex-grow:1;display:flex;align-items:center;cursor:pointer;padding:2px 0;font-size:0.875rem}.option-label:focus{outline:none}.option-label:focus-visible{outline:2px solid #0A8276;outline-offset:2px;border-radius:1px}.option--disabled .option-label{cursor:not-allowed;color:#BFBBBB}",A=C,O=class{constructor(i){u(this,i),this.selected=!1,this.disabled=!1,this.indeterminate=!1,this.isExpanded=!1,this.hasChildren=!1,this.depth=0,this.searchTerm="",this.isSearchActive=!1,this.isSearchDisabled=!1,this.handleSearchFilter=t=>{const{searchTerm:e,isActive:l}=t.detail;this.searchTerm=e.toLowerCase(),this.isSearchActive=l,requestAnimationFrame(()=>{this.updateSearchClasses()})},this.handleCheckboxClick=t=>{if(this.disabled||this.isSearchActive&&this.isSearchDisabled)return;t.stopPropagation();let e;this.indeterminate?e=!0:e=!this.selected,this.selected=e,this.indeterminate=!1,this.hasChildren&&(this.isExpanded=e,requestAnimationFrame(()=>{this.selectAllChildren(e),this.expandAllChildren(e)})),this.updateParentStates(),this.notifyMultiselect()},this.handleHeaderClick=t=>{t.stopPropagation(),!this.disabled&&!(this.isSearchActive&&this.isSearchDisabled)&&this.handleClick(t)}}componentWillLoad(){this.hasChildren=this.el.children.length>0,this.depth=this.calculateDepth(),this.el.setAttribute("data-level",this.depth.toString()),this.hasChildren&&this.hasAnySelectedChildren()&&(this.isExpanded=!0)}componentDidLoad(){this.el.__stencil_instance=this,this.notifyMultiselect(),this.el.addEventListener("ifx-search-filter",this.handleSearchFilter)}disconnectedCallback(){this.el.removeEventListener("ifx-search-filter",this.handleSearchFilter)}updateSearchClasses(){var i;const t=(i=this.el.shadowRoot)===null||i===void 0?void 0:i.querySelector(".option");if(!t)return;if(!this.isSearchActive){t.classList.remove("search-hidden","search-parent","search-match"),this.removeHighlighting(),this.isSearchDisabled=!1;return}const l=this.getTextContent().toLowerCase().includes(this.searchTerm),s=this.hasMatchingParent();requestAnimationFrame(()=>{const n=this.hasMatchingChildren();t.classList.remove("search-hidden","search-parent","search-match"),this.isSearchDisabled=!1,l&&!this.hasChildren?(t.classList.add("search-match"),this.highlightSearchTerm()):l&&this.hasChildren?(t.classList.add("search-match"),this.highlightSearchTerm(),this.isExpanded=!0):!l&&this.hasChildren&&n?(t.classList.add("search-parent"),this.removeHighlighting(),this.isExpanded=!0,this.isSearchDisabled=!0):s?(t.classList.add("search-match"),this.removeHighlighting()):(t.classList.add("search-hidden"),this.removeHighlighting())})}highlightSearchTerm(){var i;if(!this.searchTerm)return;const t=(i=this.el.shadowRoot)===null||i===void 0?void 0:i.querySelector(".option-label");if(!t)return;const e=t.querySelector("slot");if(!e)return;this.removeHighlighting();const l=this.getTextContent(),s=this.searchTerm.toLowerCase(),n=l.toLowerCase();if(!n.includes(s))return;const a=n.indexOf(s);if(a===-1)return;const r=l.substring(0,a),c=l.substring(a,a+s.length),h=l.substring(a+s.length),d=document.createElement("span");d.className="highlighted-text",r&&d.appendChild(document.createTextNode(r));const p=document.createElement("strong");p.className="search-highlight",p.textContent=c,d.appendChild(p),h&&d.appendChild(document.createTextNode(h)),t.setAttribute("data-original-content","true"),e.style.display="none",t.appendChild(d)}removeHighlighting(){var i;const t=(i=this.el.shadowRoot)===null||i===void 0?void 0:i.querySelector(".option-label");if(!t)return;const e=t.querySelector("slot"),l=t.querySelector(".highlighted-text");l&&t.removeChild(l),e&&(e.style.display=""),t.removeAttribute("data-original-content")}getTextContent(){let i="";return Array.from(this.el.childNodes).forEach(t=>{var e;t.nodeType===Node.TEXT_NODE&&(i+=((e=t.textContent)===null||e===void 0?void 0:e.trim())||"")}),i||this.value||""}hasMatchingChildren(){return this.hasChildren?Array.from(this.el.children).filter(t=>t.tagName==="IFX-MULTISELECT-OPTION").some(t=>{const e=t.__stencil_instance;if(!e)return!1;const s=e.getTextContent().toLowerCase().includes(this.searchTerm),n=e.hasMatchingChildren();return s||n}):!1}hasMatchingParent(){let i=this.el.parentElement;for(;i&&i.tagName==="IFX-MULTISELECT-OPTION";){const t=i.__stencil_instance;if(t&&t.getTextContent().toLowerCase().includes(this.searchTerm))return!0;i=i.parentElement}return!1}calculateDepth(){let i=0,t=this.el.parentElement;for(;t&&t.tagName!=="IFX-MULTISELECT";)t.tagName==="IFX-MULTISELECT-OPTION"&&i++,t=t.parentElement;return i}handleClick(i){if(this.disabled||this.isSearchActive&&this.isSearchDisabled)return;if(i.stopPropagation(),i.type==="click"&&i.target.closest(".chevron-wrapper")){this.toggleExpansion();return}let t;this.indeterminate?t=!0:t=!this.selected,this.selected=t,this.indeterminate=!1,this.hasChildren&&(this.isExpanded=t,requestAnimationFrame(()=>{this.selectAllChildren(t),this.expandAllChildren(t)})),this.updateParentStates(),this.notifyMultiselect()}handleKeyDown(i){if(this.disabled||this.isSearchActive&&this.isSearchDisabled)return;const t=i.target;t.closest(".chevron-wrapper")||t.closest(".checkbox-wrapper")||(i.key!=="ArrowUp"&&i.key!=="ArrowDown"&&i.stopPropagation(),i.key==="ArrowRight"&&this.hasChildren&&(this.isExpanded=!0),i.key==="ArrowLeft"&&this.hasChildren&&(this.isExpanded=!1))}notifyMultiselect(){const i=new CustomEvent("ifx-option-changed",{bubbles:!0,detail:{value:this.value,selected:this.selected,indeterminate:this.indeterminate}});this.el.dispatchEvent(i)}selectAllChildren(i){Array.from(this.el.children).filter(e=>e.tagName==="IFX-MULTISELECT-OPTION").forEach(e=>{var l;const s=e.__stencil_instance;s&&(s.selected=i,s.indeterminate=!1,s.hasChildren&&(s.isExpanded=i,s.selectAllChildren(i)),(l=s.notifyMultiselect)===null||l===void 0||l.call(s))})}expandAllChildren(i){Array.from(this.el.children).filter(e=>e.tagName==="IFX-MULTISELECT-OPTION").forEach(e=>{const l=e.__stencil_instance;l&&l.hasChildren&&(l.isExpanded=i,l.expandAllChildren(i))})}updateParentStates(){var i;let t=this.el.parentElement;for(;t&&t.tagName==="IFX-MULTISELECT-OPTION";){const e=t.__stencil_instance;if(!e){t=t.parentElement;continue}const l=Array.from(t.children).filter(r=>r.tagName==="IFX-MULTISELECT-OPTION").map(r=>r.__stencil_instance).filter(r=>r!==null),s=l.filter(r=>r.selected).length,n=l.filter(r=>r.indeterminate).length,a=l.length;s===a&&n===0?(e.selected=!0,e.indeterminate=!1):s===0&&n===0?(e.selected=!1,e.indeterminate=!1):(e.selected=!1,e.indeterminate=!0),(i=e.notifyMultiselect)===null||i===void 0||i.call(e),t=t.parentElement}}toggleExpansion(){this.isExpanded=!this.isExpanded}hasAnySelectedChildren(){return Array.from(this.el.children).filter(t=>t.tagName==="IFX-MULTISELECT-OPTION").some(t=>{const e=t.hasAttribute("selected"),l=this.checkForSelectedDescendants(t);return e||l})}checkForSelectedDescendants(i){return Array.from(i.children).filter(e=>e.tagName==="IFX-MULTISELECT-OPTION").some(e=>{const l=e.hasAttribute("selected"),s=this.checkForSelectedDescendants(e);return l||s})}render(){let i=!1;const t=this.el.closest("ifx-multiselect");t&&(i=Array.from(t.querySelectorAll("ifx-multiselect-option")).every(r=>r.children.length===0));const e=this.depth*28+16,l=this.hasChildren?0:28;let s=e+l;const n=i?void 0:{paddingLeft:`${s}px`};return o(g,{key:"f836f58884e2e57c4c5fb4953f10d5ff4a34c8da"},o("div",{key:"9eca6e87bb3c21512a051596b1e92931b707e88f",class:{option:!0,"option--has-children":this.hasChildren,"option--expanded":this.isExpanded,"option--disabled":this.disabled,"option--selected":this.selected},role:"option","aria-expanded":this.hasChildren?this.isExpanded?"true":"false":void 0,"aria-selected":this.selected?"true":"false","aria-disabled":this.disabled?"true":"false","data-level":this.depth,"data-value":this.value},o("div",{key:"41d24ef38470f5f7f8aa36daa33b339b7d8079f3",class:"option-item",style:n},o("div",{key:"27d33336e7d15ccce1703429b70494fe86808214",class:"chevron-wrapper",tabIndex:this.hasChildren?0:-1,role:this.hasChildren?"button":void 0,"aria-label":this.hasChildren?this.isExpanded?"Collapse":"Expand":void 0,onClick:a=>{a.stopPropagation(),this.toggleExpansion()},onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),a.stopPropagation(),this.toggleExpansion())}},this.hasChildren&&o("ifx-icon",{key:"68e975b49b4aa9edf564b80644c5a55809185629",class:`chevron ${this.isExpanded?"chevron--expanded":"chevron--collapsed"}`,icon:"chevron-right-16"})),o("div",{key:"f651aefe4cc30db6056331ffaafd8e6ea17039fc",class:"checkbox-wrapper",onClick:a=>a.stopPropagation()},o("ifx-checkbox",{key:"e8cb2c7a75921a81e0321ff22718d9373cb6f437",size:"s",checked:this.isSearchActive&&this.isSearchDisabled||this.indeterminate?!1:this.selected,indeterminate:this.isSearchActive&&this.isSearchDisabled?!1:this.indeterminate,onClick:this.handleCheckboxClick,disabled:this.disabled||this.isSearchActive&&this.isSearchDisabled,onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),a.stopPropagation(),this.handleCheckboxClick(a))}})),o("div",{key:"4f626380753927d4bedca0f78643e6647eff6356",class:"option-label",onClick:this.handleHeaderClick,tabIndex:-1},o("slot",{key:"8207d9f952bff231fda0bf0be43e1c567aa6a6da"}))),this.isExpanded&&o("div",{key:"930d611f27451ff393d1403386bb6cd6b4a54980",class:"option-children"},o("slot",{key:"269eb6381257f82b74b888188646559e6881a9d9",name:"children"}))))}get el(){return m(this)}};O.style=A;export{y as ifx_multiselect,O as ifx_multiselect_option};

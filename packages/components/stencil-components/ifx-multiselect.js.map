{"file":"ifx-multiselect.js","mappings":"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","names":[],"sources":["src/components/select/multi-select/multiselect.scss?tag=ifx-multiselect&encapsulation=shadow","src/components/select/multi-select/multiselect.tsx"],"sourcesContent":["// @import '~choices.js/public/assets/styles/choices.css';\r\n@use \"~@infineon/design-system-tokens/dist/tokens\";\r\n@use \"../../../global/font.scss\";\r\n\r\n.ifx-multiselect-container {\r\n  position: relative;\r\n  box-sizing: border-box;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n\r\n  &.small-select {\r\n    height: 36px;\r\n  }\r\n\r\n  &.medium-select {\r\n    height: 40px;\r\n  }\r\n\r\n  &:hover {\r\n    cursor: pointer;\r\n  }\r\n\r\n\r\n  .ifx-label-wrapper {\r\n    font-size: 16px;\r\n    line-height: 24px;\r\n    white-space: pre-wrap;\r\n    word-wrap: break-word;\r\n    overflow-wrap: anywhere;\r\n    max-width: 100%;\r\n  }\r\n\r\n  .ifx-error-message-wrapper {\r\n    color: #CD002F;\r\n    font-size: 12px;\r\n    line-height: 16px;\r\n    white-space: pre-wrap;\r\n    word-wrap: break-word;\r\n    overflow-wrap: anywhere;\r\n    max-width: 100%;\r\n  }\r\n\r\n  .ifx-multiselect-wrapper {\r\n    box-sizing: border-box;\r\n    position: relative;\r\n    display: flex;\r\n    align-items: center;\r\n    border: 1px solid #8D8786;\r\n    width: 100%;\r\n\r\n    &.small-select {\r\n      line-height: 20px;\r\n      padding: 8px 12px;\r\n      font-size: 14px;\r\n    }\r\n\r\n    &.medium-select {\r\n      line-height: 24px;\r\n      padding: 8px 16px;\r\n      font-size: 16px;\r\n    }\r\n\r\n    &:focus-visible {\r\n      outline: none;\r\n    }\r\n\r\n    &:focus-visible:not(.active):not(:active) {\r\n      &::before {\r\n        content: '';\r\n        position: absolute;\r\n        width: calc(100% + 4px);\r\n        height: calc(100% + 4px);\r\n        top: 50%;\r\n        left: 50%;\r\n        transform: translate(-50%, -50%);\r\n        border: 2px solid tokens.$ifxColorOcean500\r\n      }\r\n    }\r\n\r\n    &.disabled {\r\n      background: #EEEDED;\r\n      color: #575352;\r\n      border-color: #575352;\r\n      cursor: not-allowed;\r\n      -webkit-user-select: none;\r\n      -ms-user-select: none;\r\n      user-select: none;\r\n    }\r\n\r\n    &.error {\r\n      border-color: #CD002F;\r\n    }\r\n\r\n    &:hover:not(.focus, :focus) {\r\n      border-color: #8D8786;\r\n    }\r\n\r\n    &.active {\r\n      border: 2px solid #0A8276 !important; // Active border color\r\n\r\n      & .icon-wrapper-up {\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n      }\r\n\r\n      & .icon-wrapper-down {\r\n        display: none\r\n      }\r\n    }\r\n\r\n\r\n    & .icon-wrapper-up {\r\n      display: none;\r\n    }\r\n\r\n    & .icon-wrapper-down {\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n\r\n    &.is-flipped {\r\n      .ifx-multiselect-dropdown-menu {\r\n        top: auto;\r\n        bottom: 100%;\r\n      }\r\n    }\r\n  }\r\n\r\n  .ifx-multiselect-input {\r\n    flex-grow: 1;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n\r\n    &.placeholder {\r\n      opacity: 0.5;\r\n    }\r\n\r\n  }\r\n\r\n\r\n  .ifx-multiselect-icon-container {\r\n    margin-left: auto;\r\n    align-items: center;\r\n    display: flex;\r\n  }\r\n\r\n\r\n  .ifx-clear-button {\r\n    margin-right: tokens.$ifxSpace100; // Space between clear button and icons\r\n    display: flex;\r\n  }\r\n\r\n  .ifx-multiselect-dropdown-menu {\r\n    position: absolute;\r\n    top: 100%;\r\n    left: 0;\r\n    width: 100%;\r\n    border: 1px solid #ddd;\r\n    margin-top: 2px;\r\n    background-color: #fff;\r\n    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\r\n    max-height: 300px;\r\n    /* Adjust based on your design */\r\n    overflow-y: auto;\r\n    z-index: var(--dynamic-z-index, 1); // Fallback to 1\r\n\r\n    .search-input {\r\n      // position: sticky;\r\n      // top: 0;\r\n      // z-index: 2;\r\n      width: 100%;\r\n      padding: 8px 16px;\r\n      font-size: 16px;\r\n      font-style: normal;\r\n      font-weight: 400;\r\n      box-sizing: border-box;\r\n      background-color: tokens.$ifxColorBaseWhite;\r\n      border: none;\r\n      border-bottom: 2px solid #ccc;\r\n\r\n      &:focus {\r\n        outline: none;\r\n        border: 1px solid tokens.$ifxColorOcean500;\r\n      }\r\n\r\n      // Optional: Placeholder style\r\n      &::placeholder {\r\n        color: #999;\r\n      }\r\n    }\r\n  }\r\n\r\n  .option {\r\n    position: relative;\r\n    padding: 8px 16px;\r\n    gap: 8px;\r\n    align-items: center;\r\n    display: flex;\r\n    font-style: normal;\r\n    font-weight: 400;\r\n\r\n    &.small-select {\r\n      line-height: 20px;\r\n      font-size: 14px;\r\n    }\r\n\r\n    &.medium-select {\r\n      line-height: 24px;\r\n      font-size: 16px;\r\n    }\r\n\r\n    &:hover {\r\n      background-color: #EEEDED;\r\n    }\r\n\r\n    &:focus {\r\n      background-color: #BFBBBB;\r\n      outline: none;\r\n      box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);\r\n    }\r\n\r\n    &.is-highlighted {\r\n      background-color: #EEEDED;\r\n      ;\r\n    }\r\n\r\n    &.selected {\r\n      // color: #0A8276;\r\n    }\r\n\r\n    &.sub-option {\r\n      padding-left: 30px;\r\n      /* or however much indentation you want */\r\n    }\r\n  }\r\n\r\n\r\n\r\n}","import { Component, Prop, State, Event, EventEmitter, Element, h, Watch } from '@stencil/core';\r\nimport { Option } from './interfaces';\r\n\r\n@Component({\r\n  tag: 'ifx-multiselect',\r\n  styleUrl: 'multiselect.scss',\r\n  shadow: true\r\n})\r\n\r\n\r\nexport class Multiselect {\r\n\r\n  @Prop() options: any[] | string;\r\n  @Prop() batchSize: number = 50;\r\n  @Prop() size: string = 'medium (40px)';\r\n  @Prop() disabled: boolean = false;\r\n  @Prop() error: boolean = false;\r\n  @State() internalError: boolean = false;\r\n  @Prop() errorMessage: string = \"Error\";\r\n  @Prop() label: string = \"\";\r\n  @State() persistentSelectedOptions: Option[] = [];\r\n  @Prop() placeholder: string = \"\";\r\n  @State() listOfOptions: Option[] = [];\r\n  @State() dropdownOpen = false;\r\n  @State() dropdownFlipped: boolean;\r\n  @Prop() maxItemCount: number;\r\n  @State() zIndex: number = 1; // default z-index value\r\n  static globalZIndex = 1; // This will be shared among all instances of the component.\r\n  private currentIndex: number = 0; //needed for option selection using keyboard\r\n  @State() isLoading: boolean = false;\r\n  @State() loadedOptions: Option[] = [];\r\n  @State() filteredOptions: Option[] = [];\r\n\r\n\r\n\r\n  @Event() ifxSelect: EventEmitter;\r\n  @Event() ifxMultiselectIsOpen: EventEmitter;\r\n\r\n  @Element() el: HTMLElement;\r\n  dropdownElement!: HTMLElement;\r\n\r\n\r\n  async loadInitialOptions() {\r\n    this.isLoading = true;\r\n    this.internalError = this.error;\r\n    // Load the first batch of options (e.g., first 20)\r\n    this.loadedOptions = await this.fetchOptions(0, this.batchSize);\r\n    this.isLoading = false;\r\n  }\r\n\r\n  async fetchMoreOptions() {\r\n    this.isLoading = true;\r\n    const moreOptions = await this.fetchOptions(this.loadedOptions.length, this.batchSize);\r\n    this.loadedOptions = [...this.loadedOptions, ...moreOptions];\r\n    this.isLoading = false;\r\n  }\r\n\r\n\r\n  handleScroll(event: UIEvent) {\r\n    const element = event.target as HTMLElement;\r\n    const halfwayPoint = Math.floor((element.scrollHeight - element.clientHeight) / 2); //loading more options when the user has scrolled halfway through the current list\r\n\r\n    if (element.scrollTop >= halfwayPoint) {\r\n      this.fetchMoreOptions();\r\n    }\r\n  }\r\n\r\n\r\n\r\n\r\n  async fetchOptions(startIndex: number, count: number): Promise<Option[]> {\r\n    let allOptions: Option[] = [];\r\n\r\n    // Parse options if it's a string, or use directly if it's an array\r\n    if (typeof this.options === 'string') {\r\n      try {\r\n        allOptions = JSON.parse(this.options);\r\n      } catch (err) {\r\n        console.error('Failed to parse options:', err);\r\n      }\r\n    } else if (Array.isArray(this.options)) {\r\n      allOptions = this.options;\r\n    } else {\r\n      console.error('Unexpected value for options:', this.options);\r\n    }\r\n\r\n    // Slice the options array based on startIndex and count\r\n    const slicedOptions = allOptions.slice(startIndex, startIndex + count);\r\n\r\n    // Update the state for initially selected options, if needed\r\n    if (startIndex === 0) { // Assuming you want to do this only for the first batch\r\n      const initiallySelected = slicedOptions.filter(option => option.selected);\r\n      this.persistentSelectedOptions = [...this.persistentSelectedOptions, ...initiallySelected];\r\n    }\r\n\r\n    return slicedOptions;\r\n  }\r\n\r\n  handleSearch(event: Event) {\r\n    const searchTerm = (event.target as HTMLInputElement).value.toLowerCase();\r\n    if (searchTerm === '') {\r\n      this.filteredOptions = this.loadedOptions;\r\n    } else {\r\n      this.filteredOptions = this.loadedOptions.filter(option => option.label.toLowerCase().includes(searchTerm))\r\n    }\r\n  }\r\n\r\n  componentDidLoad() {\r\n    setTimeout(() => {\r\n      this.positionDropdown();\r\n    }, 500);\r\n\r\n    // setInterval(this.handleScroll, 5000); // Runs every 5 seconds (5000 milliseconds)\r\n\r\n\r\n  }\r\n\r\n\r\n  componentWillLoad() {\r\n    this.loadInitialOptions();\r\n    this.filteredOptions = [...this.loadedOptions];\r\n  }\r\n\r\n  @Watch('error')\r\n  updateInternalError() { \r\n    this.internalError = this.error;\r\n  }\r\n\r\n  @Watch('loadedOptions')\r\n  loadedOptionsChanged() {\r\n    this.filteredOptions = [...this.loadedOptions];\r\n  }\r\n\r\n\r\n  handleOptionClick(option: Option) {\r\n    this.internalError = false; //reset potential previous errors\r\n    // 1. Prevent action if disabled\r\n    //check if newly selected option has children => if not, count it as 1, otherwise count the # of children\r\n    let newOptionsLength = option.children ? option.children.length : 1;\r\n    if (this.maxItemCount && this.persistentSelectedOptions.length + newOptionsLength > this.maxItemCount && !this.persistentSelectedOptions.some(selectedOption => selectedOption.value === option.value)) {\r\n      console.error('Max item count reached');\r\n      this.internalError = true;\r\n      this.errorMessage = \"Please consider the maximum number of items to choose from\";\r\n      return;\r\n    }\r\n\r\n    // 2. Determine if the current option was previously selected\r\n    const wasSelected = this.persistentSelectedOptions.some(selectedOption => selectedOption.value === option.value);\r\n\r\n    // 3. Handle parent-child relationships\r\n    if (option.children && option.children.length > 0) {\r\n      if (wasSelected) {\r\n        this.persistentSelectedOptions = this.persistentSelectedOptions.filter(selectedOption => selectedOption.value !== option.value && !option.children.some(child => child.value === selectedOption.value));\r\n      } else {\r\n        this.persistentSelectedOptions = [...this.persistentSelectedOptions, option, ...option.children];\r\n      }\r\n    } else {\r\n      if (wasSelected) {\r\n        this.persistentSelectedOptions = this.persistentSelectedOptions.filter(selectedOption => selectedOption.value !== option.value);\r\n      } else {\r\n        this.persistentSelectedOptions.push(option);\r\n      }\r\n\r\n      const parentOption = this.listOfOptions.find(opt => opt.children && opt.children.some(child => child.value === option.value));\r\n\r\n      if (parentOption) {\r\n        const allChildrenSelected = parentOption.children.every(child => this.persistentSelectedOptions.some(selectedOption => selectedOption.value === child.value));\r\n        const someChildrenSelected = parentOption.children.some(child => this.persistentSelectedOptions.some(selectedOption => selectedOption.value === child.value));\r\n\r\n        if (allChildrenSelected) {\r\n          if (!this.persistentSelectedOptions.some(selectedOption => selectedOption.value === parentOption.value)) {\r\n            this.persistentSelectedOptions.push(parentOption);\r\n          }\r\n        } else if (someChildrenSelected) {\r\n          this.persistentSelectedOptions = this.persistentSelectedOptions.filter(selectedOption => selectedOption.value !== parentOption.value);\r\n        } else {\r\n          this.persistentSelectedOptions = this.persistentSelectedOptions.filter(selectedOption => selectedOption.value !== parentOption.value);\r\n        }\r\n      }\r\n    }\r\n\r\n    // 4. Reflect changes in the listOfOptions state\r\n    this.listOfOptions = this.listOfOptions.map(opt => {\r\n      if (opt.value === option.value) {\r\n        return { ...opt, selected: !wasSelected };\r\n      } else if (opt.children) {\r\n        const isParentSelected = this.persistentSelectedOptions.includes(opt);\r\n        opt.children = opt.children.map(child => {\r\n          if (child.value === option.value || isParentSelected) {\r\n            return { ...child, selected: true };\r\n          }\r\n          return child;\r\n        });\r\n        return { ...opt, children: opt.children };\r\n      }\r\n      return opt;\r\n    });\r\n\r\n    // 5. Update the selected status in persistentSelectedOptions\r\n    this.persistentSelectedOptions = this.persistentSelectedOptions.map(pOpt => {\r\n      const matchingOption = this.listOfOptions.find(loOpt => loOpt.value === pOpt.value) || this.listOfOptions.flatMap(loOpt => loOpt.children || []).find(child => child.value === pOpt.value);\r\n      if (matchingOption) {\r\n        return { ...pOpt, selected: matchingOption.selected };\r\n      }\r\n      return pOpt;\r\n    });\r\n\r\n    // 6. Emit persistentSelectedOptions without duplicated children\r\n    const emittedOptions = this.persistentSelectedOptions.map(pOpt => {\r\n      // If this option is a child, check if its parent is in persistentSelectedOptions\r\n      const parent = this.listOfOptions.find(loOpt => loOpt.children && loOpt.children.some(child => child.value === pOpt.value));\r\n      if (parent && this.persistentSelectedOptions.some(selectedOption => selectedOption.value === parent.value)) {\r\n        // If it's a child and its parent is also selected, ensure it's set to selected: true\r\n        return { ...pOpt, selected: true };\r\n      }\r\n      return pOpt;\r\n    }).filter(pOpt => {\r\n      // After ensuring the children are selected, now filter out the children whose parents are also in the persistentSelectedOptions\r\n      const parent = this.listOfOptions.find(loOpt => loOpt.children && loOpt.children.some(child => child.value === pOpt.value));\r\n      if (parent && this.persistentSelectedOptions.some(selectedOption => selectedOption.value === parent.value)) {\r\n        return false;  // Exclude this child since its parent is already selected\r\n      }\r\n      return true;\r\n    });\r\n    this.ifxSelect.emit(emittedOptions);\r\n  }\r\n\r\n  handleDocumentClick = (event: Event) => {\r\n    const path = event.composedPath();\r\n    if (!path.includes(this.dropdownElement)) {\r\n      this.dropdownOpen = false;\r\n      document.removeEventListener('click', this.handleDocumentClick);\r\n\r\n      // Dispatch the ifxMultiselectIsOpen event\r\n      this.ifxMultiselectIsOpen.emit(this.dropdownOpen);\r\n    }\r\n  }\r\n\r\n  getSizeClass() {\r\n    return `${this.size}` === \"s\"\r\n      ? \"small-select\"\r\n      : \"medium-select\";\r\n  }\r\n\r\n  toggleDropdown() {\r\n    this.dropdownOpen = !this.dropdownOpen;\r\n    setTimeout(() => {\r\n      if (this.dropdownOpen) {\r\n        document.addEventListener('click', this.handleDocumentClick);\r\n      }\r\n      // Dispatch the ifxMultiselectIsOpen event\r\n      this.ifxMultiselectIsOpen.emit(this.dropdownOpen);\r\n    }, 0);\r\n    this.zIndex = Multiselect.globalZIndex++;\r\n  }\r\n\r\n\r\n  waitForElement(querySelectorFunc: Function, callback: Function, maxTries = 50) {\r\n    let tries = 0;\r\n    function request() {\r\n      requestAnimationFrame(() => {\r\n        const elements = querySelectorFunc();\r\n        if (elements.length > 0 || tries > maxTries) {\r\n          callback(elements);\r\n        } else {\r\n          tries++;\r\n          request();\r\n        }\r\n      });\r\n    }\r\n    request();\r\n  }\r\n\r\n\r\n  handleKeyDown(event: KeyboardEvent) {\r\n    if (this.disabled) return; // If it's disabled, don't do anything.\r\n\r\n    const options = this.dropdownElement.querySelectorAll('.option');\r\n\r\n    switch (event.code) {\r\n      case 'Enter' || 'Space':\r\n        if (this.dropdownOpen) {\r\n          this.selectItem(options);\r\n        } else {\r\n          this.toggleDropdown();\r\n          // Wait a bit for the dropdown to finish rendering\r\n          this.waitForElement(() => {\r\n            return this.dropdownElement.querySelectorAll('.option');\r\n          }, (options) => {\r\n            this.updateHighlightedOption(options);\r\n          });\r\n        }\r\n        break;\r\n      case 'ArrowDown':\r\n        this.handleArrowDown(options);\r\n        if (this.dropdownOpen) {\r\n          this.updateHighlightedOption(options);\r\n        }\r\n        break;\r\n      case 'ArrowUp':\r\n        this.handleArrowUp(options);\r\n        if (this.dropdownOpen) {\r\n          this.updateHighlightedOption(options);\r\n        }\r\n        break;\r\n    }\r\n  }\r\n\r\n  handleWrapperClick(event: MouseEvent) {\r\n    // This is your existing logic for positioning the dropdown\r\n    this.positionDropdown();\r\n\r\n    // Check if the event target is the wrapper itself and not a child element.\r\n    if (event.currentTarget === event.target) {\r\n      this.toggleDropdown();\r\n    }\r\n  }\r\n\r\n  clearSelection() {\r\n    this.persistentSelectedOptions = [];\r\n    this.listOfOptions = this.listOfOptions.map(option => ({ ...option, selected: false }));\r\n    this.ifxSelect.emit(this.persistentSelectedOptions); // if you want to emit empty selection after clearing\r\n  }\r\n\r\n  positionDropdown() {\r\n    const wrapperRect = this.el.shadowRoot.querySelector('.ifx-multiselect-wrapper')?.getBoundingClientRect();\r\n    const spaceBelow = window.innerHeight - wrapperRect.bottom;\r\n    const spaceAbove = wrapperRect.top;\r\n\r\n    // If there's more space above than below the trigger and the dropdown doesn't fit below\r\n    if ((spaceAbove > spaceBelow && wrapperRect.height > spaceBelow) || (wrapperRect.bottom > window.innerHeight)) {\r\n      this.dropdownFlipped = true;\r\n    } else {\r\n      this.dropdownFlipped = false;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  // Helper function to update highlighted option based on currentIndex\r\n  private updateHighlightedOption(options: NodeList) {\r\n    // Clear all highlights\r\n    options.forEach((option: Element) => option.classList.remove('is-highlighted'));\r\n\r\n    // Apply highlight to the current option\r\n    if (this.currentIndex >= 0 && this.currentIndex < options.length) {\r\n      (options[this.currentIndex] as Element).classList.add('is-highlighted');\r\n    }\r\n  }\r\n\r\n  // Helper function to handle arrow down navigation\r\n  private handleArrowDown(options: NodeList) {\r\n    if (this.currentIndex < options.length - 1) {\r\n      this.currentIndex++;\r\n    } else {\r\n      this.currentIndex = 0; // Wrap to the beginning.\r\n    }\r\n  }\r\n\r\n  // Helper function to handle arrow up navigation\r\n  private handleArrowUp(options: NodeList) {\r\n    if (this.currentIndex > 0) {\r\n      this.currentIndex--;\r\n    } else {\r\n      this.currentIndex = options.length - 1; // Wrap to the end.\r\n    }\r\n  }\r\n\r\n  private selectItem(options: NodeList) {\r\n    // If there's a previous selection, remove its \"selected\" class\r\n    const previouslySelected = this.dropdownElement.querySelector('.option.selected');\r\n    if (previouslySelected) {\r\n      previouslySelected.classList.remove('selected');\r\n    }\r\n\r\n    // Mark the current item as selected\r\n    const currentOptionElement = options[this.currentIndex] as Element;\r\n    currentOptionElement.classList.add('selected');\r\n\r\n    const currentOptionValue = currentOptionElement.getAttribute('data-value');\r\n    const currentListOfOptions = typeof this.options === 'string' //passed in string form via storybook\r\n      ? JSON.parse(this.options).map((option) => ({ value: option.value, label: option.label, children: option.children, selected: option.selected })) // added selected\r\n      : this.options.map(option => ({ ...option }));\r\n\r\n    const currentOption = this.findInOptions(currentListOfOptions, currentOptionValue); // get the option object based on the currently selected value and the options array\r\n    this.handleOptionClick(currentOption);\r\n  }\r\n\r\n\r\n  renderOption(option: Option, index: number) {\r\n    const isSelected = this.persistentSelectedOptions.some(selectedOption => selectedOption.value === option.value);\r\n    const disableCheckbox = !isSelected && this.maxItemCount && this.persistentSelectedOptions.length >= this.maxItemCount;\r\n    const uniqueId = `checkbox-${option.value}-${index}`; // Generate a unique ID using the index\r\n    const isIndeterminate = this.isOptionIndeterminate(option);\r\n\r\n    return (\r\n      <div>\r\n        <div class={`option ${isSelected ? 'selected' : ''} \r\n        ${this.getSizeClass()}`}\r\n          data-value={option.value}\r\n          onClick={() => !disableCheckbox && this.handleOptionClick(option)}\r\n          tabindex=\"0\"\r\n          role={`${option.children?.length > 0 ? \"treeitem\" : \"option\"}`}\r\n        >\r\n          <ifx-checkbox id={uniqueId} value={isSelected} indeterminate={isIndeterminate} disabled={disableCheckbox}></ifx-checkbox>\r\n          <label htmlFor={uniqueId}>{option.label}</label>\r\n        </div>\r\n        {option.children && option.children.map((child, childIndex) => this.renderSubOption(child, `${index}-${childIndex}`))}\r\n      </div>\r\n    );\r\n  }\r\n\r\n\r\n  isOptionIndeterminate(option: Option): boolean {\r\n    if (!option.children) return false;\r\n\r\n    const selectedChildren = option.children.filter(child =>\r\n      this.persistentSelectedOptions.some(persistentOption => persistentOption.value === child.value)\r\n    ).length;\r\n\r\n    return selectedChildren > 0 && selectedChildren < option.children.length;\r\n  }\r\n\r\n\r\n  findInOptions(options: Option[], searchTerm: string): Option | null {\r\n    for (const option of options) {\r\n      if (option.value === searchTerm) {\r\n        return option;\r\n      }\r\n      if (option.children) {\r\n        const foundInChildren = this.findInOptions(option.children, searchTerm);\r\n        if (foundInChildren) {\r\n          return foundInChildren;\r\n        }\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n\r\n  renderSubOption(option: Option, index: string) {\r\n    const isSelected = this.persistentSelectedOptions.some(selectedOption => selectedOption.value === option.value);\r\n    const disableCheckbox = !isSelected && this.maxItemCount && this.persistentSelectedOptions.length >= this.maxItemCount;\r\n    const uniqueId = `checkbox-${option.value}-${index}`;\r\n\r\n    return (\r\n      <div class={`option sub-option ${isSelected ? 'selected' : ''} ${this.getSizeClass()}`}\r\n        data-value={option.value}\r\n        role={`${option.children?.length > 0 ? \"option\" : \"treeitem\"}`}\r\n        onClick={() => !disableCheckbox && this.handleOptionClick(option)}\r\n        tabindex=\"0\">\r\n        <ifx-checkbox id={uniqueId} value={isSelected} disabled={disableCheckbox}></ifx-checkbox>\r\n        <label htmlFor={uniqueId}>{option.label}</label>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  render() {\r\n    // Create a label for the selected options\r\n    const selectedOptionsLabels = this.persistentSelectedOptions.map(option => option.label).join(', ');\r\n\r\n    return (\r\n      <div class={`ifx-multiselect-container ${this.getSizeClass()}`} ref={el => this.dropdownElement = el as HTMLElement}>\r\n        {\r\n          this.label ?\r\n            <div class=\"ifx-label-wrapper\">\r\n              <span>{this.label}</span>\r\n            </div> : null\r\n        }\r\n        <div class={`ifx-multiselect-wrapper \r\n        ${this.getSizeClass()} \r\n        ${this.dropdownOpen ? 'active' : ''} \r\n        ${this.dropdownFlipped ? 'is-flipped' : ''}\r\n        ${this.internalError ? 'error' : \"\"}\r\n        ${this.disabled ? 'disabled' : \"\"}`}\r\n          tabindex=\"0\"\r\n          onClick={(event) => this.handleWrapperClick(event)}\r\n          onKeyDown={(event) => this.handleKeyDown(event)} >\r\n          <div class={`ifx-multiselect-input \r\n          ${this.persistentSelectedOptions.length === 0 ? 'placeholder' : \"\"}\r\n          `}\r\n            onClick={this.disabled ? undefined : () => this.toggleDropdown()}\r\n          >\r\n            {this.persistentSelectedOptions.length > 0 ? selectedOptionsLabels : this.placeholder}\r\n          </div>\r\n          {this.dropdownOpen && (\r\n            <div class=\"ifx-multiselect-dropdown-menu\"\r\n              onScroll={(event) => this.handleScroll(event)}\r\n              style={{ '--dynamic-z-index': this.zIndex.toString() }}>\r\n              <input type=\"text\" role=\"textbox\" class=\"search-input\" onInput={(event) => this.handleSearch(event)} placeholder=\"Search...\"></input>\r\n              {this.filteredOptions.map((option, index) => this.renderOption(option, index))}\r\n              {this.isLoading && <div>Loading more options...</div>}\r\n            </div>\r\n          )}\r\n          <div class=\"ifx-multiselect-icon-container\">\r\n\r\n            {/* Clear Button - will show only if there's a selection */}\r\n            {this.persistentSelectedOptions.length > 0 && (\r\n              <div class=\"ifx-clear-button\" onClick={() => this.clearSelection()}>\r\n                <ifx-icon icon=\"cremove24\"></ifx-icon>\r\n              </div>\r\n            )}\r\n            <div class=\"icon-wrapper-up\" onClick={this.disabled ? undefined : () => this.toggleDropdown()}>\r\n              <ifx-icon\r\n                key='icon-up'\r\n                icon='chevronup-16'></ifx-icon>\r\n            </div>\r\n            <div class=\"icon-wrapper-down\" onClick={this.disabled ? undefined : () => this.toggleDropdown()}>\r\n              <ifx-icon\r\n                key='icon-down'\r\n                icon='chevron-down-16'></ifx-icon>\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n        {\r\n          this.internalError ?\r\n            <div class=\"ifx-error-message-wrapper\">\r\n              <span>{this.errorMessage}</span>\r\n            </div> : null\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n\r\n}\r\n"],"version":3}
"use strict";(self.webpackChunk_infineon_infineon_design_system_stencil=self.webpackChunk_infineon_infineon_design_system_stencil||[]).push([[4651],{"./dist/esm/ifx-file-upload.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ifx_file_upload:()=>IfxFileUpload});var _index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./dist/esm/index-c77e25a0.js");const IfxFileUpload=class{constructor(hostRef){(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,hostRef),this.ifxFileUploadAdd=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadAdd",7),this.ifxFileUploadRemove=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadRemove",7),this.ifxFileUploadChange=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadChange",7),this.ifxFileUploadError=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadError",7),this.ifxFileUploadInvalid=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadInvalid",7),this.ifxFileUploadStart=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadStart",7),this.ifxFileUploadComplete=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadComplete",7),this.ifxFileUploadAbort=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadAbort",7),this.ifxFileUploadDrop=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadDrop",7),this.ifxFileUploadClick=(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"ifxFileUploadClick",7),this.dragAndDrop=!1,this.maxFileSizeMB=7,this.allowedFileTypes=["jpg","jpeg","png","pdf","mov","mp3","mp4"],this.labelBrowseFiles="Browse files",this.labelDragAndDrop="Drag & Drop or browse files to upload",this.labelFileTooLarge="Upload failed. Max file size: {{size}}MB.",this.labelUnsupportedFileType="Unsupported file type.",this.labelUploaded="Successfully uploaded",this.labelSupportedFormatsTemplate="Supported file formats: {{types}}. Max file size: {{size}}MB.",this.isDragOver=!1,this.files=[],this.uploadTasks=[],this.rejectedSizeFiles=[],this.rejectedTypeFiles=[],this.fileInputEl=null,this.extensionToMimeMap={jpg:"image/jpeg",jpeg:"image/jpeg",png:"image/png",pdf:"application/pdf",mov:"video/quicktime",mp3:"audio/mpeg",mp4:"video/mp4"}}getNormalizedFileTypes(){if(Array.isArray(this.allowedFileTypes))return this.allowedFileTypes;try{return JSON.parse(this.allowedFileTypes)}catch(_a){return this.allowedFileTypes.split(",").map((t=>t.trim()))}}handleFileChange(event){const input=event.target;input.files&&this.processFiles(input.files)}handleDrop(event){var _a;if(event.preventDefault(),event.stopPropagation(),this.isDragOver=!1,null===(_a=event.dataTransfer)||void 0===_a?void 0:_a.files){const droppedFiles=Array.from(event.dataTransfer.files),allowedMimes=this.getNormalizedFileTypes().map((ext=>this.extensionToMimeMap[ext.toLowerCase()])).filter(Boolean),acceptedFiles=[],rejectedFiles=[];droppedFiles.forEach((file=>{const isValidType=allowedMimes.includes(file.type),isValidSize=file.size<=1024*this.maxFileSizeMB*1024;isValidType&&isValidSize?acceptedFiles.push(file):rejectedFiles.push(file)})),this.ifxFileUploadDrop.emit({droppedFiles,acceptedFiles,rejectedFiles}),this.processFiles(event.dataTransfer.files)}}handleDragOver(event){event.preventDefault(),this.isDragOver=!0}handleDragLeave(event){event.preventDefault(),this.isDragOver=!1}processFiles(fileList){const selectedFiles=Array.from(fileList),allowedMimes=this.getNormalizedFileTypes().map((ext=>this.extensionToMimeMap[ext.toLowerCase()])).filter(Boolean),validFiles=[],rejectedSize=[],rejectedType=[];selectedFiles.forEach((file=>{const isValidType=allowedMimes.includes(file.type),isValidSize=file.size<=1024*this.maxFileSizeMB*1024;isValidType&&isValidSize?validFiles.push(file):(isValidType||(rejectedType.push(file.name),this.ifxFileUploadInvalid.emit({file,reason:"invalid-type"})),isValidSize||(rejectedSize.push(file.name),this.ifxFileUploadInvalid.emit({file,reason:"invalid-size"})),this.ifxFileUploadError.emit({file,errorType:isValidType?"file-too-large":"invalid-type",message:"Invalid file rejected"}))})),this.rejectedSizeFiles=[...this.rejectedSizeFiles,...rejectedSize],this.rejectedTypeFiles=[...this.rejectedTypeFiles,...rejectedType],validFiles.forEach((file=>this.startUpload(file))),this.files=[...this.files,...validFiles],validFiles.length>0&&(this.ifxFileUploadAdd.emit({addedFiles:validFiles,files:this.files}),this.ifxFileUploadChange.emit({files:this.files}))}startUpload(file){this.ifxFileUploadStart.emit({file});const task={file,progress:0,intervalId:null,completed:!1};if(this.uploadHandler)this.uploadHandler(file).then((()=>{task.progress=100,task.completed=!0,this.uploadTasks=[...this.uploadTasks],this.ifxFileUploadComplete.emit({file}),this.ifxFileUploadChange.emit({files:this.files})})).catch((()=>{console.error("Upload failed"),this.ifxFileUploadError.emit({file,errorType:"upload-failed",message:"Upload handler rejected file"})}));else{const totalSize=file.size,fakeUploadSpeed=5e5;let uploaded=0;task.intervalId=window.setInterval((()=>{uploaded+=fakeUploadSpeed/5;const progress=Math.min(100,Math.round(uploaded/totalSize*100));task.progress=progress,this.uploadTasks=[...this.uploadTasks],progress>=100&&(clearInterval(task.intervalId),task.completed=!0,task.intervalId=null,this.uploadTasks=[...this.uploadTasks],this.ifxFileUploadComplete.emit({file}),this.ifxFileUploadChange.emit({files:this.files}))}),200)}this.uploadTasks=[...this.uploadTasks,task]}cancelUpload(file){const taskIndex=this.uploadTasks.findIndex((t=>t.file.name===file.name));if(-1!==taskIndex){const task=this.uploadTasks[taskIndex];null!==(null==task?void 0:task.intervalId)&&clearInterval(task.intervalId),this.uploadTasks=this.uploadTasks.filter(((_,i)=>i!==taskIndex))}this.files=this.files.filter((f=>f.name!==file.name)),this.ifxFileUploadAbort.emit({file}),this.ifxFileUploadChange.emit({files:this.files}),this.fileInputEl&&(this.fileInputEl.value="")}removeFile(file){this.uploadTasks=this.uploadTasks.filter((task=>task.file.name!==file.name)),this.files=this.files.filter((f=>f.name!==file.name)),this.ifxFileUploadRemove.emit({removedFile:file,files:this.files}),this.ifxFileUploadChange.emit({files:this.files}),this.fileInputEl&&(this.fileInputEl.value="")}clearRejectedFile(fileName,type){"size"===type?this.rejectedSizeFiles=this.rejectedSizeFiles.filter((f=>f!==fileName)):this.rejectedTypeFiles=this.rejectedTypeFiles.filter((f=>f!==fileName)),this.fileInputEl&&(this.fileInputEl.value="")}splitFileNameParts(file){const name=file.name,dotIndex=name.lastIndexOf(".");return-1===dotIndex?{base:name,ext:""}:{base:name.substring(0,dotIndex),ext:name.substring(dotIndex)}}getFileIcon(file){var _a;switch(null===(_a=file.name.split(".").pop())||void 0===_a?void 0:_a.toLowerCase()){case"pdf":return"file-pdf-16";case"jpg":case"jpeg":return"file-jpg-16";case"png":return"file-png-16";case"mov":return"file-mov-16";case"mp3":return"file-mp3-16";case"mp4":return"file-mp4-16";default:return"file"}}getFormattedSize(file){const sizeInKB=file.size/1024;return sizeInKB>1024?`${(sizeInKB/1024).toFixed(1)} MB`:`${sizeInKB.toFixed(0)} KB`}getAcceptAttribute(){return this.getNormalizedFileTypes().map((ext=>"."+ext.toLowerCase())).join(",")}getSupportedFileText(){return this.labelSupportedFormatsTemplate.replace("{{types}}",this.getNormalizedFileTypes().map((ext=>ext.toUpperCase())).join(", ")).replace("{{size}}",this.maxFileSizeMB.toString())}getFormattedFileTooLargeText(){return this.labelFileTooLarge.replace("{{size}}",this.maxFileSizeMB.toString())}componentDidLoad(){this.hostElement.hasAttribute("show-demo-states")&&(this.showDemoStates=!0),this.showDemoStates&&this.injectDemoState()}async injectDemoState(){const uploading=new File(["demo"],"Image.jpg",{type:"image/jpeg"}),uploaded=new File(["demo"],"File.pdf",{type:"application/pdf"}),tooLarge=new File(["demo"],"Video.mp4",{type:"video/mp4"}),unsupported=new File(["demo"],"Script.exe",{type:"application/x-msdownload"});this.files=[uploaded,uploading],this.uploadTasks=[{file:uploaded,progress:100,intervalId:null,completed:!0},{file:uploading,progress:35,intervalId:null,completed:!1}],this.rejectedSizeFiles=[tooLarge.name],this.rejectedTypeFiles=[unsupported.name]}render(){return(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"9ebbf4de0d20c25b5c0167dd48b6ab4d538ca736",class:"file-upload-wrapper"},this.dragAndDrop?this.renderDragAndDropArea():this.renderUploadArea(),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ul",{key:"ad545c35ebfaf6016b4cebe0d11d0f4798816718",class:"file-list"},this.rejectedSizeFiles.map((fileName=>(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("li",{class:"file-item upload-failed"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-icon"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon",{icon:"file-16"})),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-info"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-top-row"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-wrapper"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-base"},this.splitFileNameParts({name:fileName}).base),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-ext"},this.splitFileNameParts({name:fileName}).ext)),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-actions"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon-button",{shape:"square",variant:"tertiary",icon:"delete-forever-16",size:"s","aria-label":"Remove file",onClick:()=>this.clearRejectedFile(fileName,"size")}))),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-middle-row"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-status"},this.getFormattedFileTooLargeText())))))),this.rejectedTypeFiles.map((fileName=>(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("li",{class:"file-item upload-failed"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-icon"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon",{icon:"file-16"})),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-info"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-top-row"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-wrapper"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-base"},this.splitFileNameParts({name:fileName}).base),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-ext"},this.splitFileNameParts({name:fileName}).ext)),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-actions"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon-button",{shape:"square",variant:"tertiary",icon:"delete-forever-16",size:"s","aria-label":"Remove file",onClick:()=>this.clearRejectedFile(fileName,"type")}))),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-middle-row"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-status"},this.labelUnsupportedFileType)))))),this.files.map((file=>{var _a;const task=this.uploadTasks.find((t=>t.file.name===file.name)),progress=null!==(_a=null==task?void 0:task.progress)&&void 0!==_a?_a:100,isUploading=task&&!task.completed,itemClass=isUploading?"file-item uploading":"file-item upload-success",{base,ext}=this.splitFileNameParts(file);return(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("li",{class:itemClass},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-icon"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon",{icon:this.getFileIcon(file)})),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-info"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-top-row"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-wrapper"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-base"},base),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-name-ext"},ext)),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-actions"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon-button",{shape:"square",variant:"tertiary",icon:"cross-16",size:"s","aria-label":"Cancel upload",onClick:()=>this.cancelUpload(file),style:{display:isUploading?"inline-flex":"none"}}),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon-button",{shape:"square",variant:"tertiary",icon:"delete-forever-16",size:"s","aria-label":"Remove file",onClick:()=>this.removeFile(file),style:{display:isUploading?"none":"inline-flex"}}))),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-middle-row"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-size"},this.getFormattedSize(file)),isUploading&&(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-uploading"}," – Uploading …"),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{class:"file-status"},!isUploading&&(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",null,(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon",{icon:"check-12"})," ",this.labelUploaded))),isUploading&&(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:"file-progress-row"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-progress-bar",{size:"s",value:progress,"show-label":"true"}))))}))))}renderUploadArea(){return(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:{"upload-button":!0}},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("label",null,(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-button",{variant:"secondary"},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon",{icon:"upload-16"}),this.labelBrowseFiles),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("input",{ref:el=>{this.fileInputEl=el},type:"file",accept:this.getAcceptAttribute(),multiple:!0,onChange:e=>this.handleFileChange(e),style:{display:"none"}})),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{class:"file-upload-info"},this.getSupportedFileText()))}renderDragAndDropArea(){return(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{class:{"upload-dropzone":!0,"drag-over":this.isDragOver},onClick:()=>{this.fileInputEl&&this.fileInputEl.click()},onDragOver:e=>this.handleDragOver(e),onDragLeave:e=>this.handleDragLeave(e),onDrop:e=>this.handleDrop(e)},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("ifx-icon",{icon:"upload-24",class:"custom-icon"}),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",null,this.labelDragAndDrop),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{class:"file-upload-info"},this.getSupportedFileText()),(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{style:{height:"0px",overflow:"hidden"}},(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.h)("input",{ref:el=>{this.fileInputEl=el},type:"file",accept:this.getAcceptAttribute(),multiple:!0,onChange:e=>this.handleFileChange(e)})))}get hostElement(){return(0,_index_c77e25a0_js__WEBPACK_IMPORTED_MODULE_0__.g)(this)}};IfxFileUpload.style=':root{--ifx-font-family:"Source Sans 3";font-family:var(--ifx-font-family, sans-serif)}:host{font-family:var(--ifx-font-family, sans-serif)}.file-upload-wrapper{display:flex;flex-direction:column}.upload-dropzone{border:1px dashed #BFBBBB;padding:40px;text-align:center;cursor:pointer;color:#1D1D1D;transition:border-color 0.3s ease;border-radius:1px;background:#FFFFFF}.upload-dropzone ifx-icon{color:#0A8276}.upload-dropzone:hover{border:1px dashed #8D8786}.upload-dropzone.drag-over{border:1px solid #0A8276;background:#F7F7F7}.upload-dropzone input{display:none}.file-upload-info{font-style:normal;font-weight:400;font-size:0.75rem;line-height:1rem;letter-spacing:0em;color:#1D1D1D;margin:0;margin-top:4px}.file-list{list-style:none;padding:0;margin:0;margin-top:16px;display:flex;flex-direction:column;gap:16px}.file-item{border:1px solid #BFBBBB;padding:16px;display:flex;gap:16px}.file-info{width:100%;min-width:0}.file-top-row{display:flex;align-items:center;justify-content:space-between;gap:16px;margin-top:-8px}.file-top-row ifx-icon{flex-shrink:0}.file-name-wrapper{display:flex;min-width:0;max-width:100%;white-space:nowrap;overflow:hidden;font-weight:400;font-size:0.875rem}.file-name-base{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex-shrink:1;min-width:0}.file-name-ext{flex-shrink:0;margin-left:0}.file-middle-row{display:flex;align-items:center;font-size:0.75rem;line-height:1rem;flex-wrap:wrap;color:#575352}.file-middle-row .file-status{margin-left:16px}.file-progress-row{margin-top:16px}.file-progress-row ifx-progress-bar{width:100%}.upload-success{border-color:#0A8276}.upload-success .file-status ifx-icon{position:relative;top:2px;color:#4CA460}.upload-failed{border-color:#CD002F}.upload-failed .file-status{color:#CD002F;margin-left:0}'}}]);
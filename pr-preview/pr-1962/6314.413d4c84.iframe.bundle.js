/*! For license information please see 6314.413d4c84.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunk_infineon_infineon_design_system_stencil=self.webpackChunk_infineon_infineon_design_system_stencil||[]).push([[6314],{"./dist/esm/dom-utils-1988cdf1.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{i:()=>isNestedInIfxComponent});const isNestedInIfxComponent=el=>{let parent=el.parentNode;for(;parent;)if(parent instanceof ShadowRoot)parent=parent.host;else{if(parent instanceof HTMLElement&&parent.tagName.toLowerCase().startsWith("ifx"))return!0;parent=parent.parentNode}return!1}},"./dist/esm/framework-detection-7b788e19.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>detectFramework,t:()=>trackComponent});var process=__webpack_require__("../../node_modules/process/browser.js");const isTestEnvironment=void 0!==process&&process.env&&!1;function trackComponent(componentName,environment){["jest","non-browser","localhost","error"].includes(environment)||(window.btnt||function initializeTracking(){var t,r,n,pp;isTestEnvironment?window.btnt||(window.btnt=()=>{}):(t=document,r="script","object"!=typeof window.btntConfig&&(window.btntConfig={domain:"https://ssgtm.infineon.com",withCookies:!0,maxBatchSize:10}),window.btnt||(window.btnt=function(z){"object"!=typeof z&&(z={}),"object"!=typeof window.btntQueue&&(window.btntQueue=[]),window.btntQueue.push(z)},n=t.createElement(r),(pp=t.getElementsByTagName(r)[0])&&pp.parentNode&&(n.async=1,n.src=window.btntConfig.domain+"/btnt.js",pp.parentNode.insertBefore(n,pp))))}(),window.btnt({event_name:"component_initialized",component_name:componentName,environment}))}let frameworkCache=null;const detectFramework=()=>{if(frameworkCache)return frameworkCache;if("undefined"==typeof window||"undefined"==typeof document)return frameworkCache="non-browser",frameworkCache;const win=window,doc=document;if(void 0!==process&&process.env&&!1)return frameworkCache="jest",frameworkCache;if(win.location.search.includes("viewMode")||win.location.href.includes("viewMode")||win.__STORYBOOK_ENV__)return frameworkCache="storybook",frameworkCache;if(["localhost","127.0.0.1"].includes(win.location.hostname))return frameworkCache="localhost",frameworkCache;try{if(win.React)return frameworkCache="React",frameworkCache;if(doc.querySelector("[data-reactroot], [data-reactid]"))return frameworkCache="React",frameworkCache;const rootContainers=Array.from(doc.querySelectorAll("body > div"));return rootContainers.some(container=>Object.keys(container).some(key=>key.startsWith("__reactContainer")))?(frameworkCache="React",frameworkCache):win.ng||win.getAllAngularRootElements||doc.querySelector("[ng-version], [ng-app]")?(frameworkCache="Angular",frameworkCache):win.Vue||win.__VUE__||doc.querySelector("[data-v-app]")?(frameworkCache="Vue",frameworkCache):(frameworkCache="Vanilla",frameworkCache)}catch(e){return frameworkCache="error",frameworkCache}}},"./dist/esm/index-72ac5051.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>classNames});var module,classnames={exports:{}};module=classnames,function(){var hasOwn={}.hasOwnProperty;function classNames(){for(var classes="",i=0;i<arguments.length;i++){var arg=arguments[i];arg&&(classes=appendClass(classes,parseValue(arg)))}return classes}function parseValue(arg){if("string"==typeof arg||"number"==typeof arg)return arg;if("object"!=typeof arg)return"";if(Array.isArray(arg))return classNames.apply(null,arg);if(arg.toString!==Object.prototype.toString&&!arg.toString.toString().includes("[native code]"))return arg.toString();var classes="";for(var key in arg)hasOwn.call(arg,key)&&arg[key]&&(classes=appendClass(classes,key));return classes}function appendClass(value,newClass){return newClass?value?value+" "+newClass:value+newClass:value}module.exports?(classNames.default=classNames,module.exports=classNames):window.classNames=classNames}();const classNames=classnames.exports},"./dist/esm/main.esm-b8709563.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>createGrid});var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(obj,key,value)=>key in obj?__defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value}):obj[key]=value,__spreadValues=(a,b)=>{for(var prop in b||(b={}))__hasOwnProp.call(b,prop)&&__defNormalProp(a,prop,b[prop]);if(__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(b))__propIsEnum.call(b,prop)&&__defNormalProp(a,prop,b[prop]);return a},__spreadProps=(a,b)=>__defProps(a,__getOwnPropDescs(b)),__export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})},__decorateClass=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp(target,key,result),result},__decorateParam=(index,decorator)=>(target,key)=>decorator(target,key,index),generic_exports={};function makeNull(value){return null==value||""===value?null:value}function exists(value,allowEmptyString=!1){return null!=value&&(""!==value||allowEmptyString)}function missing(value){return!exists(value)}function missingOrEmpty(value){return null==value||0===value.length}function toStringOrNull(value){return null!=value&&"function"==typeof value.toString?value.toString():null}function attrToNumber(value){if(void 0===value)return;if(null===value||""===value)return null;if("number"==typeof value)return isNaN(value)?void 0:value;const valueParsed=parseInt(value,10);return isNaN(valueParsed)?void 0:valueParsed}function attrToBoolean(value){if(void 0!==value)return null!==value&&""!==value&&("boolean"==typeof value?value:/true/i.test(value))}function attrToString(value){if(null!=value&&""!==value)return value}function jsonEquals(val1,val2){return(val1?JSON.stringify(val1):null)===(val2?JSON.stringify(val2):null)}function defaultComparator(valueA,valueB,accentedCompare=!1){const valueAMissing=null==valueA,valueBMissing=null==valueB;if(valueA&&valueA.toNumber&&(valueA=valueA.toNumber()),valueB&&valueB.toNumber&&(valueB=valueB.toNumber()),valueAMissing&&valueBMissing)return 0;if(valueAMissing)return-1;if(valueBMissing)return 1;function doQuickCompare(a,b){return a>b?1:a<b?-1:0}if("string"!=typeof valueA)return doQuickCompare(valueA,valueB);if(!accentedCompare)return doQuickCompare(valueA,valueB);try{return valueA.localeCompare(valueB)}catch(e){return doQuickCompare(valueA,valueB)}}function values(object){if(object instanceof Set||object instanceof Map){const arr=[];return object.forEach(value=>arr.push(value)),arr}return Object.values(object)}__export(generic_exports,{attrToBoolean:()=>attrToBoolean,attrToNumber:()=>attrToNumber,attrToString:()=>attrToString,defaultComparator:()=>defaultComparator,exists:()=>exists,jsonEquals:()=>jsonEquals,makeNull:()=>makeNull,missing:()=>missing,missingOrEmpty:()=>missingOrEmpty,toStringOrNull:()=>toStringOrNull,values:()=>values});var ColumnKeyCreator=class{constructor(){this.existingKeys={}}addExistingKeys(keys2){for(let i=0;i<keys2.length;i++)this.existingKeys[keys2[i]]=!0}getUniqueKey(colId,colField){colId=toStringOrNull(colId);let count=0;for(;;){let idToTry;if(colId?(idToTry=colId,0!==count&&(idToTry+="_"+count)):colField?(idToTry=colField,0!==count&&(idToTry+="_"+count)):idToTry=count,!this.existingKeys[idToTry])return this.existingKeys[idToTry]=!0,String(idToTry);count++}}},object_exports={};__export(object_exports,{SKIP_JS_BUILTINS:()=>SKIP_JS_BUILTINS,cloneObject:()=>cloneObject,deepCloneDefinition:()=>deepCloneDefinition,getAllValuesInObject:()=>getAllValuesInObject,getValueUsingField:()=>getValueUsingField,isNonNullObject:()=>isNonNullObject,iterateObject:()=>iterateObject,mergeDeep:()=>mergeDeep,removeAllReferences:()=>removeAllReferences});var SKIP_JS_BUILTINS=new Set(["__proto__","constructor","prototype"]);function iterateObject(object,callback){if(null!=object)if(Array.isArray(object))for(let i=0;i<object.length;i++)callback(i.toString(),object[i]);else for(const[key,value]of Object.entries(object))callback(key,value)}function cloneObject(object){const copy={},keys2=Object.keys(object);for(let i=0;i<keys2.length;i++){if(SKIP_JS_BUILTINS.has(keys2[i]))continue;const key=keys2[i],value=object[key];copy[key]=value}return copy}function deepCloneDefinition(object,keysToSkip){if(!object)return;const obj=object,res={};return Object.keys(obj).forEach(key=>{if(keysToSkip&&keysToSkip.indexOf(key)>=0||SKIP_JS_BUILTINS.has(key))return;const value=obj[key],sourceIsSimpleObject=isNonNullObject(value)&&value.constructor===Object;res[key]=sourceIsSimpleObject?deepCloneDefinition(value):value}),res}function getAllValuesInObject(obj){if(!obj)return[];const anyObject=Object;if("function"==typeof anyObject.values)return anyObject.values(obj);const ret=[];for(const key in obj)obj.hasOwnProperty(key)&&obj.propertyIsEnumerable(key)&&ret.push(obj[key]);return ret}function mergeDeep(dest,source,copyUndefined=!0,makeCopyOfSimpleObjects=!1){exists(source)&&iterateObject(source,(key,sourceValue)=>{if(SKIP_JS_BUILTINS.has(key))return;let destValue=dest[key];if(destValue!==sourceValue){if(makeCopyOfSimpleObjects){if(null==destValue&&null!=sourceValue){"object"==typeof sourceValue&&sourceValue.constructor===Object&&(destValue={},dest[key]=destValue)}}isNonNullObject(sourceValue)&&isNonNullObject(destValue)&&!Array.isArray(destValue)?mergeDeep(destValue,sourceValue,copyUndefined,makeCopyOfSimpleObjects):(copyUndefined||void 0!==sourceValue)&&(dest[key]=sourceValue)}})}function getValueUsingField(data,field,fieldContainsDots){if(!field||!data)return;if(!fieldContainsDots)return data[field];const fields=field.split(".");let currentObject=data;for(let i=0;i<fields.length;i++){if(null==currentObject)return;currentObject=currentObject[fields[i]]}return currentObject}function removeAllReferences(obj,preserveKeys=[],preDestroyLink){Object.keys(obj).forEach(key=>{"object"!=typeof obj[key]||preserveKeys.includes(key)||(obj[key]=void 0)});const proto=Object.getPrototypeOf(obj),properties={};Object.getOwnPropertyNames(proto).forEach(key=>{if("function"==typeof proto[key]&&!preserveKeys.includes(key)){const func=()=>{console.warn((key=>`AG Grid: Grid API function ${key}() cannot be called as the grid has been destroyed.\n    It is recommended to remove local references to the grid api. Alternatively, check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.\n    To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${preDestroyLink}`)(key))};properties[key]={value:func,writable:!0}}}),Object.defineProperties(obj,properties)}function isNonNullObject(value){return"object"==typeof value&&null!==value}var function_exports={};__export(function_exports,{compose:()=>compose,debounce:()=>debounce,doOnce:()=>doOnce,errorOnce:()=>errorOnce,executeAfter:()=>executeAfter,executeInAWhile:()=>executeInAWhile,executeNextVMTurn:()=>executeNextVMTurn,getFunctionName:()=>getFunctionName,isFunction:()=>isFunction,noop:()=>noop,throttle:()=>throttle,waitUntil:()=>waitUntil,warnOnce:()=>warnOnce});var doOnceFlags={};function doOnce(func,key){doOnceFlags[key]||(func(),doOnceFlags[key]=!0)}function warnOnce(msg){doOnce(()=>console.warn("AG Grid: "+msg),msg)}function errorOnce(msg){doOnce(()=>console.error("AG Grid: "+msg),msg)}function getFunctionName(funcConstructor){if(funcConstructor.name)return funcConstructor.name;const matches=/function\s+([^\(]+)/.exec(funcConstructor.toString());return matches&&2===matches.length?matches[1].trim():null}function isFunction(val){return!!(val&&val.constructor&&val.call&&val.apply)}function executeInAWhile(funcs){executeAfter(funcs,400)}var executeNextVMTurnFuncs=[],executeNextVMTurnPending=!1;function executeNextVMTurn(func){executeNextVMTurnFuncs.push(func),executeNextVMTurnPending||(executeNextVMTurnPending=!0,window.setTimeout(()=>{const funcsCopy=executeNextVMTurnFuncs.slice();executeNextVMTurnFuncs.length=0,executeNextVMTurnPending=!1,funcsCopy.forEach(func2=>func2())},0))}function executeAfter(funcs,milliseconds=0){funcs.length>0&&window.setTimeout(()=>funcs.forEach(func=>func()),milliseconds)}function debounce(func,delay){let timeout;return function(...args){const context=this;window.clearTimeout(timeout),timeout=window.setTimeout(function(){func.apply(context,args)},delay)}}function throttle(func,wait){let previousCall=0;return function(...args){const currentCall=(new Date).getTime();currentCall-previousCall<wait||(previousCall=currentCall,func.apply(this,args))}}function waitUntil(condition,callback,timeout=100,timeoutMessage){const timeStamp=(new Date).getTime();let interval=null,executed=!1;const internalCallback=()=>{const reachedTimeout=(new Date).getTime()-timeStamp>timeout;(condition()||reachedTimeout)&&(callback(),executed=!0,null!=interval&&(window.clearInterval(interval),interval=null),reachedTimeout&&timeoutMessage&&console.warn(timeoutMessage))};internalCallback(),executed||(interval=window.setInterval(internalCallback,10))}function compose(...fns){return arg=>fns.reduce((composed,f)=>f(composed),arg)}var noop=()=>{},ModuleNames=(ModuleNames2=>(ModuleNames2.CommunityCoreModule="@ag-grid-community/core",ModuleNames2.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",ModuleNames2.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",ModuleNames2.CsvExportModule="@ag-grid-community/csv-export",ModuleNames2.EnterpriseCoreModule="@ag-grid-enterprise/core",ModuleNames2.RowGroupingModule="@ag-grid-enterprise/row-grouping",ModuleNames2.ColumnsToolPanelModule="@ag-grid-enterprise/column-tool-panel",ModuleNames2.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",ModuleNames2.MenuModule="@ag-grid-enterprise/menu",ModuleNames2.SetFilterModule="@ag-grid-enterprise/set-filter",ModuleNames2.MultiFilterModule="@ag-grid-enterprise/multi-filter",ModuleNames2.StatusBarModule="@ag-grid-enterprise/status-bar",ModuleNames2.SideBarModule="@ag-grid-enterprise/side-bar",ModuleNames2.RangeSelectionModule="@ag-grid-enterprise/range-selection",ModuleNames2.MasterDetailModule="@ag-grid-enterprise/master-detail",ModuleNames2.RichSelectModule="@ag-grid-enterprise/rich-select",ModuleNames2.GridChartsModule="@ag-grid-enterprise/charts",ModuleNames2.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",ModuleNames2.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",ModuleNames2.ExcelExportModule="@ag-grid-enterprise/excel-export",ModuleNames2.ClipboardModule="@ag-grid-enterprise/clipboard",ModuleNames2.SparklinesModule="@ag-grid-enterprise/sparklines",ModuleNames2.AdvancedFilterModule="@ag-grid-enterprise/advanced-filter",ModuleNames2.AngularModule="@ag-grid-community/angular",ModuleNames2.ReactModule="@ag-grid-community/react",ModuleNames2.VueModule="@ag-grid-community/vue",ModuleNames2))(ModuleNames||{}),_ModuleRegistry=class _ModuleRegistry{static register(module){_ModuleRegistry.__register(module,!0,void 0)}static registerModules(modules){_ModuleRegistry.__registerModules(modules,!0,void 0)}static __register(module,moduleBased,gridId){_ModuleRegistry.runVersionChecks(module),void 0!==gridId?(_ModuleRegistry.areGridScopedModules=!0,void 0===_ModuleRegistry.gridModulesMap[gridId]&&(_ModuleRegistry.gridModulesMap[gridId]={}),_ModuleRegistry.gridModulesMap[gridId][module.moduleName]=module):_ModuleRegistry.globalModulesMap[module.moduleName]=module,_ModuleRegistry.setModuleBased(moduleBased)}static __unRegisterGridModules(gridId){delete _ModuleRegistry.gridModulesMap[gridId]}static __registerModules(modules,moduleBased,gridId){_ModuleRegistry.setModuleBased(moduleBased),modules&&modules.forEach(module=>_ModuleRegistry.__register(module,moduleBased,gridId))}static isValidModuleVersion(module){const[moduleMajor,moduleMinor]=module.version.split(".")||[],[currentModuleMajor,currentModuleMinor]=_ModuleRegistry.currentModuleVersion.split(".")||[];return moduleMajor===currentModuleMajor&&moduleMinor===currentModuleMinor}static runVersionChecks(module){if(_ModuleRegistry.currentModuleVersion||(_ModuleRegistry.currentModuleVersion=module.version),module.version?_ModuleRegistry.isValidModuleVersion(module)||console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${module.moduleName}' is version ${module.version} but the other modules are version ${this.currentModuleVersion}. Please update all modules to the same version.`):console.error(`AG Grid: You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. '${module.moduleName}' is incompatible. Please update all modules to the same version.`),module.validate){const result=module.validate();if(!result.isValid){const errorResult=result;console.error(`AG Grid: ${errorResult.message}`)}}}static setModuleBased(moduleBased){void 0===_ModuleRegistry.moduleBased?_ModuleRegistry.moduleBased=moduleBased:_ModuleRegistry.moduleBased!==moduleBased&&doOnce(()=>{console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/modules/ for more information.")},"ModulePackageCheck")}static __setIsBundled(){_ModuleRegistry.isBundled=!0}static __assertRegistered(moduleName,reason,gridId){var _a;if(this.__isRegistered(moduleName,gridId))return!0;const warningKey=reason+moduleName;let warningMessage;if(_ModuleRegistry.isBundled)warningMessage=`AG Grid: unable to use ${reason} as 'ag-grid-enterprise' has not been loaded. Check you are using the Enterprise bundle:\n        \n        <script src="https://cdn.jsdelivr.net/npm/ag-grid-enterprise@AG_GRID_VERSION/dist/ag-grid-enterprise.min.js"><\/script>\n        \nFor more info see: https://ag-grid.com/javascript-data-grid/getting-started/#getting-started-with-ag-grid-enterprise`;else if(_ModuleRegistry.moduleBased||void 0===_ModuleRegistry.moduleBased){let modName=null==(_a=Object.entries(ModuleNames).find(([k,v])=>v===moduleName))?void 0:_a[0];warningMessage=`AG Grid: unable to use ${reason} as the ${modName} is not registered${_ModuleRegistry.areGridScopedModules?` for gridId: ${gridId}`:""}. Check if you have registered the module:\n           \n    import { ModuleRegistry } from '@ag-grid-community/core';\n    import { ${modName} } from '${moduleName}';\n    \n    ModuleRegistry.registerModules([ ${modName} ]);\n\nFor more info see: https://www.ag-grid.com/javascript-grid/modules/`}else warningMessage=`AG Grid: unable to use ${reason} as package 'ag-grid-enterprise' has not been imported. Check that you have imported the package:\n            \n    import 'ag-grid-enterprise';`;return doOnce(()=>{console.warn(warningMessage)},warningKey),!1}static __isRegistered(moduleName,gridId){var _a;return!!_ModuleRegistry.globalModulesMap[moduleName]||!!(null==(_a=_ModuleRegistry.gridModulesMap[gridId])?void 0:_a[moduleName])}static __getRegisteredModules(gridId){return[...values(_ModuleRegistry.globalModulesMap),...values(_ModuleRegistry.gridModulesMap[gridId]||{})]}static __getGridRegisteredModules(gridId){var _a;return values(null!=(_a=_ModuleRegistry.gridModulesMap[gridId])?_a:{})||[]}static __isPackageBased(){return!_ModuleRegistry.moduleBased}};_ModuleRegistry.globalModulesMap={},_ModuleRegistry.gridModulesMap={},_ModuleRegistry.areGridScopedModules=!1;var ModuleRegistry=_ModuleRegistry,Context=class{constructor(params,logger){if(this.beanWrappers={},this.destroyed=!1,!params||!params.beanClasses)return;this.contextParams=params,this.logger=logger,this.logger.log(">> creating ag-Application Context"),this.createBeans();const beanInstances=this.getBeanInstances();this.wireBeans(beanInstances),this.logger.log(">> ag-Application Context ready - component is alive")}getBeanInstances(){return values(this.beanWrappers).map(beanEntry=>beanEntry.beanInstance)}createBean(bean,afterPreCreateCallback){if(!bean)throw Error("Can't wire to bean since it is null");return this.wireBeans([bean],afterPreCreateCallback),bean}wireBeans(beanInstances,afterPreCreateCallback){this.autoWireBeans(beanInstances),this.methodWireBeans(beanInstances),this.callLifeCycleMethods(beanInstances,"preConstructMethods"),exists(afterPreCreateCallback)&&beanInstances.forEach(afterPreCreateCallback),this.callLifeCycleMethods(beanInstances,"postConstructMethods")}createBeans(){this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),iterateObject(this.beanWrappers,(key,beanEntry)=>{let constructorParamsMeta;beanEntry.bean.__agBeanMetaData&&beanEntry.bean.__agBeanMetaData.autowireMethods&&beanEntry.bean.__agBeanMetaData.autowireMethods.agConstructor&&(constructorParamsMeta=beanEntry.bean.__agBeanMetaData.autowireMethods.agConstructor);const constructorParams=this.getBeansForParameters(constructorParamsMeta,beanEntry.bean.name),newInstance=new(beanEntry.bean.bind.apply(beanEntry.bean,[null,...constructorParams]));beanEntry.beanInstance=newInstance});const createdBeanNames=Object.keys(this.beanWrappers).join(", ");this.logger.log(`created beans: ${createdBeanNames}`)}createBeanWrapper(BeanClass){const metaData=BeanClass.__agBeanMetaData;if(!metaData){let beanName;return beanName=BeanClass.prototype.constructor?getFunctionName(BeanClass.prototype.constructor):""+BeanClass,void console.error(`Context item ${beanName} is not a bean`)}const beanEntry={bean:BeanClass,beanInstance:null,beanName:metaData.beanName};this.beanWrappers[metaData.beanName]=beanEntry}autoWireBeans(beanInstances){beanInstances.forEach(beanInstance=>{this.forEachMetaDataInHierarchy(beanInstance,(metaData,beanName)=>{const attributes=metaData.agClassAttributes;attributes&&attributes.forEach(attribute=>{const otherBean=this.lookupBeanInstance(beanName,attribute.beanName,attribute.optional);beanInstance[attribute.attributeName]=otherBean})})})}methodWireBeans(beanInstances){beanInstances.forEach(beanInstance=>{this.forEachMetaDataInHierarchy(beanInstance,(metaData,beanName)=>{iterateObject(metaData.autowireMethods,(methodName,wireParams)=>{if("agConstructor"===methodName)return;const initParams=this.getBeansForParameters(wireParams,beanName);beanInstance[methodName].apply(beanInstance,initParams)})})})}forEachMetaDataInHierarchy(beanInstance,callback){let prototype=Object.getPrototypeOf(beanInstance);for(;null!=prototype;){const constructor=prototype.constructor;if(constructor.hasOwnProperty("__agBeanMetaData")){callback(constructor.__agBeanMetaData,this.getBeanName(constructor))}prototype=Object.getPrototypeOf(prototype)}}getBeanName(constructor){if(constructor.__agBeanMetaData&&constructor.__agBeanMetaData.beanName)return constructor.__agBeanMetaData.beanName;const constructorString=constructor.toString();return constructorString.substring(9,constructorString.indexOf("("))}getBeansForParameters(parameters,beanName){const beansList=[];return parameters&&iterateObject(parameters,(paramIndex,otherBeanName)=>{const otherBean=this.lookupBeanInstance(beanName,otherBeanName);beansList[Number(paramIndex)]=otherBean}),beansList}lookupBeanInstance(wiringBean,beanName,optional=!1){if(this.destroyed)return this.logger.log(`AG Grid: bean reference ${beanName} is used after the grid is destroyed!`),null;if("context"===beanName)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(beanName))return this.contextParams.providedBeanInstances[beanName];const beanEntry=this.beanWrappers[beanName];return beanEntry?beanEntry.beanInstance:(optional||console.error(`AG Grid: unable to find bean reference ${beanName} while initialising ${wiringBean}`),null)}callLifeCycleMethods(beanInstances,lifeCycleMethod){beanInstances.forEach(beanInstance=>this.callLifeCycleMethodsOnBean(beanInstance,lifeCycleMethod))}callLifeCycleMethodsOnBean(beanInstance,lifeCycleMethod,methodToIgnore){const allMethods={};this.forEachMetaDataInHierarchy(beanInstance,metaData=>{const methods=metaData[lifeCycleMethod];methods&&methods.forEach(methodName=>{methodName!=methodToIgnore&&(allMethods[methodName]=!0)})});Object.keys(allMethods).forEach(methodName=>beanInstance[methodName]())}getBean(name){return this.lookupBeanInstance("getBean",name,!0)}destroy(){if(this.destroyed)return;this.destroyed=!0,this.logger.log(">> Shutting down ag-Application Context");const beanInstances=this.getBeanInstances();this.destroyBeans(beanInstances),this.contextParams.providedBeanInstances=null,ModuleRegistry.__unRegisterGridModules(this.contextParams.gridId),this.logger.log(">> ag-Application Context shut down - component is dead")}destroyBean(bean){bean&&this.destroyBeans([bean])}destroyBeans(beans){return beans?(beans.forEach(bean=>{this.callLifeCycleMethodsOnBean(bean,"preDestroyMethods","destroy");const beanAny=bean;"function"==typeof beanAny.destroy&&beanAny.destroy()}),[]):[]}isDestroyed(){return this.destroyed}getGridId(){return this.contextParams.gridId}};function PreConstruct(target,methodName,descriptor){const props=getOrCreateProps(target.constructor);props.preConstructMethods||(props.preConstructMethods=[]),props.preConstructMethods.push(methodName)}function PostConstruct(target,methodName,descriptor){const props=getOrCreateProps(target.constructor);props.postConstructMethods||(props.postConstructMethods=[]),props.postConstructMethods.push(methodName)}function PreDestroy(target,methodName,descriptor){const props=getOrCreateProps(target.constructor);props.preDestroyMethods||(props.preDestroyMethods=[]),props.preDestroyMethods.push(methodName)}function Bean(beanName){return classConstructor=>{getOrCreateProps(classConstructor).beanName=beanName}}function Autowired(name){return(target,propertyKey,descriptor)=>{autowiredFunc(target,name,!1,target,propertyKey,null)}}function Optional(name){return(target,propertyKey,descriptor)=>{autowiredFunc(target,name,!0,target,propertyKey,null)}}function autowiredFunc(target,name,optional,classPrototype,methodOrAttributeName,index){if(null===name)return void console.error("AG Grid: Autowired name should not be null");if("number"==typeof index)return void console.error("AG Grid: Autowired should be on an attribute");const props=getOrCreateProps(target.constructor);props.agClassAttributes||(props.agClassAttributes=[]),props.agClassAttributes.push({attributeName:methodOrAttributeName,beanName:name,optional})}function Qualifier(name){return(classPrototype,methodOrAttributeName,index)=>{const constructor="function"==typeof classPrototype?classPrototype:classPrototype.constructor;let props;if("number"==typeof index){let methodName;methodOrAttributeName?(props=getOrCreateProps(constructor),methodName=methodOrAttributeName):(props=getOrCreateProps(constructor),methodName="agConstructor"),props.autowireMethods||(props.autowireMethods={}),props.autowireMethods[methodName]||(props.autowireMethods[methodName]={}),props.autowireMethods[methodName][index]=name}}}function getOrCreateProps(target){return target.hasOwnProperty("__agBeanMetaData")||(target.__agBeanMetaData={}),target.__agBeanMetaData}var EventService=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setBeans(gos,frameworkOverrides,globalEventListener=null,globalSyncEventListener=null){if(this.frameworkOverrides=frameworkOverrides,this.gos=gos,globalEventListener){const async=gos.useAsyncEvents();this.addGlobalListener(globalEventListener,async)}globalSyncEventListener&&this.addGlobalListener(globalSyncEventListener,!1)}setFrameworkOverrides(frameworkOverrides){this.frameworkOverrides=frameworkOverrides}getListeners(eventType,async,autoCreateListenerCollection){const listenerMap=async?this.allAsyncListeners:this.allSyncListeners;let listeners=listenerMap.get(eventType);return!listeners&&autoCreateListenerCollection&&(listeners=new Set,listenerMap.set(eventType,listeners)),listeners}noRegisteredListenersExist(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size}addEventListener(eventType,listener,async=!1){this.getListeners(eventType,async,!0).add(listener)}removeEventListener(eventType,listener,async=!1){const listeners=this.getListeners(eventType,async,!1);if(listeners&&(listeners.delete(listener),0===listeners.size)){(async?this.allAsyncListeners:this.allSyncListeners).delete(eventType)}}addGlobalListener(listener,async=!1){(async?this.globalAsyncListeners:this.globalSyncListeners).add(listener)}removeGlobalListener(listener,async=!1){(async?this.globalAsyncListeners:this.globalSyncListeners).delete(listener)}dispatchEvent(event){let agEvent=event;this.gos&&this.gos.addGridCommonParams(agEvent),this.dispatchToListeners(agEvent,!0),this.dispatchToListeners(agEvent,!1),this.firedEvents[agEvent.type]=!0}dispatchEventOnce(event){this.firedEvents[event.type]||this.dispatchEvent(event)}dispatchToListeners(event,async){var _a;const eventType=event.type;if(async&&"event"in event){const browserEvent=event.event;browserEvent instanceof Event&&(event.eventPath=browserEvent.composedPath())}const processEventListeners=(listeners2,originalListeners2)=>listeners2.forEach(listener=>{if(!originalListeners2.has(listener))return;const callback=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>listener(event)):()=>listener(event);async?this.dispatchAsync(callback):callback()}),originalListeners=null!=(_a=this.getListeners(eventType,async,!1))?_a:new Set,listeners=new Set(originalListeners);listeners.size>0&&processEventListeners(listeners,originalListeners);new Set(async?this.globalAsyncListeners:this.globalSyncListeners).forEach(listener=>{const callback=this.frameworkOverrides?()=>this.frameworkOverrides.wrapIncoming(()=>listener(eventType,event)):()=>listener(eventType,event);async?this.dispatchAsync(callback):callback()})}dispatchAsync(func){this.asyncFunctionsQueue.push(func),this.scheduled||(this.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)}),this.scheduled=!0)}flushAsyncQueue(){this.scheduled=!1;const queueCopy=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],queueCopy.forEach(func=>func())}};__decorateClass([__decorateParam(0,Qualifier("gridOptionsService")),__decorateParam(1,Qualifier("frameworkOverrides")),__decorateParam(2,Qualifier("globalEventListener")),__decorateParam(3,Qualifier("globalSyncEventListener"))],EventService.prototype,"setBeans",1),EventService=__decorateClass([Bean("eventService")],EventService);var FrameworkEventListenerService=class{constructor(frameworkOverrides){this.frameworkOverrides=frameworkOverrides,this.wrappedListeners=new Map,this.wrappedGlobalListeners=new Map}wrap(userListener){let listener=userListener;return this.frameworkOverrides.shouldWrapOutgoing&&(listener=event=>{this.frameworkOverrides.wrapOutgoing(()=>userListener(event))},this.wrappedListeners.set(userListener,listener)),listener}wrapGlobal(userListener){let listener=userListener;return this.frameworkOverrides.shouldWrapOutgoing&&(listener=(eventType,event)=>{this.frameworkOverrides.wrapOutgoing(()=>userListener(eventType,event))},this.wrappedGlobalListeners.set(userListener,listener)),listener}unwrap(userListener){var _a;return null!=(_a=this.wrappedListeners.get(userListener))?_a:userListener}unwrapGlobal(userListener){var _a;return null!=(_a=this.wrappedGlobalListeners.get(userListener))?_a:userListener}},COL_DEF_DEFAULTS={resizable:!0,sortable:!0},instanceIdSequence=0;function getNextColInstanceId(){return instanceIdSequence++}var _Column=class _Column{constructor(colDef,userProvidedColDef,colId,primary){this.instanceId=getNextColInstanceId(),this.autoHeaderHeight=null,this.moving=!1,this.menuVisible=!1,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.eventService=new EventService,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=colDef,this.userProvidedColDef=userProvidedColDef,this.colId=colId,this.primary=primary,this.setState(colDef)}getInstanceId(){return this.instanceId}setState(colDef){void 0!==colDef.sort?"asc"!==colDef.sort&&"desc"!==colDef.sort||(this.sort=colDef.sort):"asc"!==colDef.initialSort&&"desc"!==colDef.initialSort||(this.sort=colDef.initialSort);const sortIndex=colDef.sortIndex,initialSortIndex=colDef.initialSortIndex;void 0!==sortIndex?null!==sortIndex&&(this.sortIndex=sortIndex):null!==initialSortIndex&&(this.sortIndex=initialSortIndex);const hide=colDef.hide,initialHide=colDef.initialHide;this.visible=void 0!==hide?!hide:!initialHide,void 0!==colDef.pinned?this.setPinned(colDef.pinned):this.setPinned(colDef.initialPinned);const flex=colDef.flex,initialFlex=colDef.initialFlex;void 0!==flex?this.flex=flex:void 0!==initialFlex&&(this.flex=initialFlex)}setColDef(colDef,userProvidedColDef,source){this.colDef=colDef,this.userProvidedColDef=userProvidedColDef,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),this.eventService.dispatchEvent(this.createColumnEvent("colDefChanged",source))}getUserProvidedColDef(){return this.userProvidedColDef}setParent(parent){this.parent=parent}getParent(){return this.parent}setOriginalParent(originalParent){this.originalParent=originalParent}getOriginalParent(){return this.originalParent}initialise(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip()}initDotNotation(){const suppressDotNotation=this.gos.get("suppressFieldDotNotation");this.fieldContainsDots=exists(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!suppressDotNotation,this.tooltipFieldContainsDots=exists(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!suppressDotNotation}initMinAndMaxWidths(){var _a,_b;const colDef=this.colDef;this.minWidth=null!=(_a=colDef.minWidth)?_a:this.environment.getMinColWidth(),this.maxWidth=null!=(_b=colDef.maxWidth)?_b:Number.MAX_SAFE_INTEGER}initTooltip(){this.tooltipEnabled=exists(this.colDef.tooltipField)||exists(this.colDef.tooltipValueGetter)||exists(this.colDef.tooltipComponent)}resetActualWidth(source){const initialWidth=this.calculateColInitialWidth(this.colDef);this.setActualWidth(initialWidth,source,!0)}calculateColInitialWidth(colDef){var _a,_b;const minColWidth=null!=(_a=colDef.minWidth)?_a:this.environment.getMinColWidth(),maxColWidth=null!=(_b=colDef.maxWidth)?_b:Number.MAX_SAFE_INTEGER;let width;const colDefWidth=attrToNumber(colDef.width),colDefInitialWidth=attrToNumber(colDef.initialWidth);return width=null!=colDefWidth?colDefWidth:null!=colDefInitialWidth?colDefInitialWidth:200,Math.max(Math.min(width,maxColWidth),minColWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(colId){if(missing(this.colDef)||missing(this.colDef.showRowGroup))return!1;const showingAllGroups=!0===this.colDef.showRowGroup,showingThisGroup=this.colDef.showRowGroup===colId;return showingAllGroups||showingThisGroup}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}addEventListener(eventType,userListener){var _a,_b;this.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.frameworkOverrides),this.frameworkEventListenerService=new FrameworkEventListenerService(this.frameworkOverrides));const listener=null!=(_b=null==(_a=this.frameworkEventListenerService)?void 0:_a.wrap(userListener))?_b:userListener;this.eventService.addEventListener(eventType,listener)}removeEventListener(eventType,userListener){var _a,_b;const listener=null!=(_b=null==(_a=this.frameworkEventListenerService)?void 0:_a.unwrap(userListener))?_b:userListener;this.eventService.removeEventListener(eventType,listener)}createColumnFunctionCallbackParams(rowNode){return this.gos.addGridCommonParams({node:rowNode,data:rowNode.data,column:this,colDef:this.colDef})}isSuppressNavigable(rowNode){if("boolean"==typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"==typeof this.colDef.suppressNavigable){const params=this.createColumnFunctionCallbackParams(rowNode);return(0,this.colDef.suppressNavigable)(params)}return!1}isCellEditable(rowNode){return!(rowNode.group&&!this.gos.get("enableGroupEdit"))&&this.isColumnFunc(rowNode,this.colDef.editable)}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(rowNode){return this.isColumnFunc(rowNode,this.colDef.rowDrag)}isDndSource(rowNode){return this.isColumnFunc(rowNode,this.colDef.dndSource)}isCellCheckboxSelection(rowNode){return this.isColumnFunc(rowNode,this.colDef.checkboxSelection)}isSuppressPaste(rowNode){return this.isColumnFunc(rowNode,this.colDef?this.colDef.suppressPaste:null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(key){var _a;return null!=(_a=this.colDef[key])?_a:COL_DEF_DEFAULTS[key]}isColumnFunc(rowNode,value){if("boolean"==typeof value)return value;if("function"==typeof value){return value(this.createColumnFunctionCallbackParams(rowNode))}return!1}setMoving(moving,source){this.moving=moving,this.eventService.dispatchEvent(this.createColumnEvent("movingChanged",source))}createColumnEvent(type,source){return this.gos.addGridCommonParams({type,column:this,columns:[this],source})}isMoving(){return this.moving}getSort(){return this.sort}setSort(sort,source){this.sort!==sort&&(this.sort=sort,this.eventService.dispatchEvent(this.createColumnEvent("sortChanged",source))),this.dispatchStateUpdatedEvent("sort")}setMenuVisible(visible,source){this.menuVisible!==visible&&(this.menuVisible=visible,this.eventService.dispatchEvent(this.createColumnEvent("menuVisibleChanged",source)))}isMenuVisible(){return this.menuVisible}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return"asc"===this.sort}isSortDescending(){return"desc"===this.sort}isSortNone(){return missing(this.sort)}isSorting(){return exists(this.sort)}getSortIndex(){return this.sortIndex}setSortIndex(sortOrder){this.sortIndex=sortOrder,this.dispatchStateUpdatedEvent("sortIndex")}setAggFunc(aggFunc){this.aggFunc=aggFunc,this.dispatchStateUpdatedEvent("aggFunc")}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(left,source){this.oldLeft=this.left,this.left!==left&&(this.left=left,this.eventService.dispatchEvent(this.createColumnEvent("leftChanged",source)))}isFilterActive(){return this.filterActive}setFilterActive(active,source,additionalEventAttributes){this.filterActive!==active&&(this.filterActive=active,this.eventService.dispatchEvent(this.createColumnEvent("filterActiveChanged",source)));const filterChangedEvent=this.createColumnEvent("filterChanged",source);additionalEventAttributes&&mergeDeep(filterChangedEvent,additionalEventAttributes),this.eventService.dispatchEvent(filterChangedEvent)}isHovered(){return this.columnHoverService.isHovered(this)}setPinned(pinned){this.pinned=!0===pinned||"left"===pinned?"left":"right"===pinned?"right":null,this.dispatchStateUpdatedEvent("pinned")}setFirstRightPinned(firstRightPinned,source){this.firstRightPinned!==firstRightPinned&&(this.firstRightPinned=firstRightPinned,this.eventService.dispatchEvent(this.createColumnEvent("firstRightPinnedChanged",source)))}setLastLeftPinned(lastLeftPinned,source){this.lastLeftPinned!==lastLeftPinned&&(this.lastLeftPinned=lastLeftPinned,this.eventService.dispatchEvent(this.createColumnEvent("lastLeftPinnedChanged",source)))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return"left"===this.pinned||"right"===this.pinned}isPinnedLeft(){return"left"===this.pinned}isPinnedRight(){return"right"===this.pinned}getPinned(){return this.pinned}setVisible(visible,source){const newValue=!0===visible;this.visible!==newValue&&(this.visible=newValue,this.eventService.dispatchEvent(this.createColumnEvent("visibleChanged",source))),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){const colDef=this.getColDef();return!colDef.suppressSpanHeaderHeight&&!colDef.autoHeaderHeight}getColumnGroupPaddingInfo(){let parent=this.getParent();if(!parent||!parent.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const numberOfParents=parent.getPaddingLevel()+1;let isSpanningTotal=!0;for(;parent;){if(!parent.isPadding()){isSpanningTotal=!1;break}parent=parent.getParent()}return{numberOfParents,isSpanningTotal}}getColDef(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getDefinition(){return this.colDef}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(height){const changed=height!==this.autoHeaderHeight;return this.autoHeaderHeight=height,changed}createBaseColDefParams(rowNode){return this.gos.addGridCommonParams({node:rowNode,data:rowNode.data,colDef:this.colDef,column:this})}getColSpan(rowNode){if(missing(this.colDef.colSpan))return 1;const params=this.createBaseColDefParams(rowNode),colSpan=this.colDef.colSpan(params);return Math.max(colSpan,1)}getRowSpan(rowNode){if(missing(this.colDef.rowSpan))return 1;const params=this.createBaseColDefParams(rowNode),rowSpan=this.colDef.rowSpan(params);return Math.max(rowSpan,1)}setActualWidth(actualWidth,source,silent=!1){null!=this.minWidth&&(actualWidth=Math.max(actualWidth,this.minWidth)),null!=this.maxWidth&&(actualWidth=Math.min(actualWidth,this.maxWidth)),this.actualWidth!==actualWidth&&(this.actualWidth=actualWidth,this.flex&&"flex"!==source&&"gridInitializing"!==source&&(this.flex=null),silent||this.fireColumnWidthChangedEvent(source)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(source){this.eventService.dispatchEvent(this.createColumnEvent("widthChanged",source))}isGreaterThanMax(width){return null!=this.maxWidth&&width>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex||0}setFlex(flex){this.flex!==flex&&(this.flex=flex),this.dispatchStateUpdatedEvent("flex")}setMinimum(source){exists(this.minWidth)&&this.setActualWidth(this.minWidth,source)}setRowGroupActive(rowGroup,source){this.rowGroupActive!==rowGroup&&(this.rowGroupActive=rowGroup,this.eventService.dispatchEvent(this.createColumnEvent("columnRowGroupChanged",source))),this.dispatchStateUpdatedEvent("rowGroup")}isRowGroupActive(){return this.rowGroupActive}setPivotActive(pivot,source){this.pivotActive!==pivot&&(this.pivotActive=pivot,this.eventService.dispatchEvent(this.createColumnEvent("columnPivotChanged",source))),this.dispatchStateUpdatedEvent("pivot")}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}setValueActive(value,source){this.aggregationActive!==value&&(this.aggregationActive=value,this.eventService.dispatchEvent(this.createColumnEvent("columnValueChanged",source)))}isValueActive(){return this.aggregationActive}isAllowPivot(){return!0===this.colDef.enablePivot}isAllowValue(){return!0===this.colDef.enableValue}isAllowRowGroup(){return!0===this.colDef.enableRowGroup}getMenuTabs(defaultValues){warnOnce("As of v31.1, 'getMenuTabs' is deprecated. Use 'getColDef().menuTabs ?? defaultValues' instead.");let menuTabs=this.getColDef().menuTabs;return null==menuTabs&&(menuTabs=defaultValues),menuTabs}dispatchStateUpdatedEvent(key){this.eventService.dispatchEvent({type:_Column.EVENT_STATE_UPDATED,key})}};_Column.EVENT_MOVING_CHANGED="movingChanged",_Column.EVENT_LEFT_CHANGED="leftChanged",_Column.EVENT_WIDTH_CHANGED="widthChanged",_Column.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",_Column.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",_Column.EVENT_VISIBLE_CHANGED="visibleChanged",_Column.EVENT_FILTER_CHANGED="filterChanged",_Column.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",_Column.EVENT_SORT_CHANGED="sortChanged",_Column.EVENT_COL_DEF_CHANGED="colDefChanged",_Column.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",_Column.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",_Column.EVENT_PIVOT_CHANGED="columnPivotChanged",_Column.EVENT_VALUE_CHANGED="columnValueChanged",_Column.EVENT_STATE_UPDATED="columnStateUpdated",__decorateClass([Autowired("gridOptionsService")],_Column.prototype,"gos",2),__decorateClass([Autowired("environment")],_Column.prototype,"environment",2),__decorateClass([Autowired("columnHoverService")],_Column.prototype,"columnHoverService",2),__decorateClass([Autowired("frameworkOverrides")],_Column.prototype,"frameworkOverrides",2),__decorateClass([PostConstruct],_Column.prototype,"initialise",1);var Column=_Column,_ProvidedColumnGroup=class _ProvidedColumnGroup{constructor(colGroupDef,groupId,padding,level){this.localEventService=new EventService,this.expandable=!1,this.instanceId=getNextColInstanceId(),this.expandableListenerRemoveCallback=null,this.colGroupDef=colGroupDef,this.groupId=groupId,this.expanded=!!colGroupDef&&!!colGroupDef.openByDefault,this.padding=padding,this.level=level}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0)}reset(colGroupDef,level){this.colGroupDef=colGroupDef,this.level=level,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}setOriginalParent(originalParent){this.originalParent=originalParent}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return!!this.children&&this.children.some(child=>child.isVisible())}isPadding(){return this.padding}setExpanded(expanded){this.expanded=void 0!==expanded&&expanded;const event={type:_ProvidedColumnGroup.EVENT_EXPANDED_CHANGED};this.localEventService.dispatchEvent(event)}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(children){this.children=children}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const result=[];return this.addLeafColumns(result),result}addLeafColumns(leafColumns){this.children&&this.children.forEach(child=>{child instanceof Column?leafColumns.push(child):child instanceof _ProvidedColumnGroup&&child.addLeafColumns(leafColumns)})}getColumnGroupShow(){const colGroupDef=this.colGroupDef;if(colGroupDef)return colGroupDef.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const listener=this.onColumnVisibilityChanged.bind(this);this.getLeafColumns().forEach(col=>col.addEventListener("visibleChanged",listener)),this.expandableListenerRemoveCallback=()=>{this.getLeafColumns().forEach(col=>col.removeEventListener("visibleChanged",listener)),this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let atLeastOneShowingWhenOpen=!1,atLeastOneShowingWhenClosed=!1,atLeastOneChangeable=!1;const children=this.findChildrenRemovingPadding();for(let i=0,j=children.length;i<j;i++){const abstractColumn=children[i];if(!abstractColumn.isVisible())continue;const headerGroupShow=abstractColumn.getColumnGroupShow();"open"===headerGroupShow?(atLeastOneShowingWhenOpen=!0,atLeastOneChangeable=!0):"closed"===headerGroupShow?(atLeastOneShowingWhenClosed=!0,atLeastOneChangeable=!0):(atLeastOneShowingWhenOpen=!0,atLeastOneShowingWhenClosed=!0)}const expandable=atLeastOneShowingWhenOpen&&atLeastOneShowingWhenClosed&&atLeastOneChangeable;if(this.expandable!==expandable){this.expandable=expandable;const event={type:_ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED};this.localEventService.dispatchEvent(event)}}findChildrenRemovingPadding(){const res=[],process=items=>{items.forEach(item=>{item instanceof _ProvidedColumnGroup&&item.isPadding()?process(item.children):res.push(item)})};return process(this.children),res}onColumnVisibilityChanged(){this.setExpandable()}addEventListener(eventType,listener){this.localEventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.localEventService.removeEventListener(eventType,listener)}};_ProvidedColumnGroup.EVENT_EXPANDED_CHANGED="expandedChanged",_ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED="expandableChanged",__decorateClass([PreDestroy],_ProvidedColumnGroup.prototype,"destroy",1);var ProvidedColumnGroup=_ProvidedColumnGroup,DefaultColumnTypes={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},event_exports={};__export(event_exports,{addSafePassiveEventListener:()=>addSafePassiveEventListener,createEventPath:()=>createEventPath,getCtrlForEventTarget:()=>getCtrlForEventTarget,getEventPath:()=>getEventPath,isElementInEventPath:()=>isElementInEventPath,isEventSupported:()=>isEventSupported,isStopPropagationForAgGrid:()=>isStopPropagationForAgGrid,stopPropagationForAgGrid:()=>stopPropagationForAgGrid});var array_exports={};function existsAndNotEmpty(value){return null!=value&&value.length>0}function last(arr){if(arr&&arr.length)return arr[arr.length-1]}function areEqual(a,b,comparator){return null==a&&null==b||null!=a&&null!=b&&a.length===b.length&&a.every((value,index)=>comparator?comparator(value,b[index]):b[index]===value)}function shallowCompare(arr1,arr2){return areEqual(arr1,arr2)}function sortNumerically(array){return array.sort((a,b)=>a-b)}function removeRepeatsFromArray(array,object){if(array)for(let index=array.length-2;index>=0;index--){const thisOneMatches=array[index]===object,nextOneMatches=array[index+1]===object;thisOneMatches&&nextOneMatches&&array.splice(index+1,1)}}function removeFromUnorderedArray(array,object){const index=array.indexOf(object);index>=0&&(array[index]=array[array.length-1],array.pop())}function removeFromArray(array,object){const index=array.indexOf(object);index>=0&&array.splice(index,1)}function removeAllFromUnorderedArray(array,toRemove){for(let i=0;i<toRemove.length;i++)removeFromUnorderedArray(array,toRemove[i])}function removeAllFromArray(array,toRemove){for(let i=0;i<toRemove.length;i++)removeFromArray(array,toRemove[i])}function insertIntoArray(array,object,toIndex){array.splice(toIndex,0,object)}function insertArrayIntoArray(dest,src,toIndex){if(null!=dest&&null!=src)for(let i=src.length-1;i>=0;i--){insertIntoArray(dest,src[i],toIndex)}}function moveInArray(array,objectsToMove,toIndex){removeAllFromArray(array,objectsToMove),objectsToMove.slice().reverse().forEach(obj=>insertIntoArray(array,obj,toIndex))}function includes(array,value){return array.indexOf(value)>-1}function flatten(arrayOfArrays){return[].concat.apply([],arrayOfArrays)}function pushAll(target,source){null!=source&&null!=target&&source.forEach(value=>target.push(value))}function toStrings(array){return array.map(toStringOrNull)}function forEachReverse(list,action){if(null!=list)for(let i=list.length-1;i>=0;i--)action(list[i],i)}__export(array_exports,{areEqual:()=>areEqual,existsAndNotEmpty:()=>existsAndNotEmpty,flatten:()=>flatten,forEachReverse:()=>forEachReverse,includes:()=>includes,insertArrayIntoArray:()=>insertArrayIntoArray,insertIntoArray:()=>insertIntoArray,last:()=>last,moveInArray:()=>moveInArray,pushAll:()=>pushAll,removeAllFromArray:()=>removeAllFromArray,removeAllFromUnorderedArray:()=>removeAllFromUnorderedArray,removeFromArray:()=>removeFromArray,removeFromUnorderedArray:()=>removeFromUnorderedArray,removeRepeatsFromArray:()=>removeRepeatsFromArray,shallowCompare:()=>shallowCompare,sortNumerically:()=>sortNumerically,toStrings:()=>toStrings});var AG_GRID_STOP_PROPAGATION="__ag_Grid_Stop_Propagation",PASSIVE_EVENTS=["touchstart","touchend","touchmove","touchcancel","scroll"],supports={};function stopPropagationForAgGrid(event){event[AG_GRID_STOP_PROPAGATION]=!0}function isStopPropagationForAgGrid(event){return!0===event[AG_GRID_STOP_PROPAGATION]}var isEventSupported=(()=>{const tags={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return eventName=>{if("boolean"==typeof supports[eventName])return supports[eventName];const el=document.createElement(tags[eventName]||"div");return supports[eventName="on"+eventName]=eventName in el}})();function getCtrlForEventTarget(gos,eventTarget,type){let sourceElement=eventTarget;for(;sourceElement;){const renderedComp=gos.getDomData(sourceElement,type);if(renderedComp)return renderedComp;sourceElement=sourceElement.parentElement}return null}function isElementInEventPath(element,event){return!(!event||!element)&&getEventPath(event).indexOf(element)>=0}function createEventPath(event){const res=[];let pointer=event.target;for(;pointer;)res.push(pointer),pointer=pointer.parentElement;return res}function getEventPath(event){const eventNoType=event;return eventNoType.path?eventNoType.path:eventNoType.composedPath?eventNoType.composedPath():createEventPath(eventNoType)}function addSafePassiveEventListener(frameworkOverrides,eElement,event,listener){const options=includes(PASSIVE_EVENTS,event)?{passive:!0}:void 0;frameworkOverrides&&frameworkOverrides.addEventListener&&frameworkOverrides.addEventListener(eElement,event,listener,options)}var _BeanStub=class _BeanStub{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.lastChangeSetIdLookup={},this.propertyListenerId=0,this.isAlive=()=>!this.destroyed}getFrameworkOverrides(){return this.frameworkOverrides}getContext(){return this.context}destroy(){for(let i=0;i<this.destroyFunctions.length;i++)this.destroyFunctions[i]();this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:_BeanStub.EVENT_DESTROYED})}addEventListener(eventType,listener){this.localEventService||(this.localEventService=new EventService),this.localEventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.localEventService&&this.localEventService.removeEventListener(eventType,listener)}dispatchEvent(event){this.localEventService&&this.localEventService.dispatchEvent(event)}addManagedListener(object,event,listener){if(this.destroyed)return;object instanceof HTMLElement?addSafePassiveEventListener(this.getFrameworkOverrides(),object,event,listener):object.addEventListener(event,listener);const destroyFunc=()=>(object.removeEventListener(event,listener),null);return this.destroyFunctions.push(destroyFunc),()=>(destroyFunc(),this.destroyFunctions=this.destroyFunctions.filter(fn=>fn!==destroyFunc),null)}setupGridOptionListener(event,listener){this.gos.addEventListener(event,listener);const destroyFunc=()=>(this.gos.removeEventListener(event,listener),null);return this.destroyFunctions.push(destroyFunc),()=>(destroyFunc(),this.destroyFunctions=this.destroyFunctions.filter(fn=>fn!==destroyFunc),null)}addManagedPropertyListener(event,listener){return this.destroyed?()=>null:this.setupGridOptionListener(event,listener)}addManagedPropertyListeners(events,listener){if(this.destroyed)return;const eventsKey=events.join("-")+this.propertyListenerId++,wrappedListener=event=>{if(event.changeSet){if(event.changeSet&&event.changeSet.id===this.lastChangeSetIdLookup[eventsKey])return;this.lastChangeSetIdLookup[eventsKey]=event.changeSet.id}const propertiesChangeEvent={type:"gridPropertyChanged",changeSet:event.changeSet,source:event.source};listener(propertiesChangeEvent)};events.forEach(event=>this.setupGridOptionListener(event,wrappedListener))}addDestroyFunc(func){this.isAlive()?this.destroyFunctions.push(func):func()}createManagedBean(bean,context){const res=this.createBean(bean,context);return this.addDestroyFunc(this.destroyBean.bind(this,bean,context)),res}createBean(bean,context,afterPreCreateCallback){return(context||this.getContext()).createBean(bean,afterPreCreateCallback)}destroyBean(bean,context){return(context||this.getContext()).destroyBean(bean)}destroyBeans(beans,context){if(beans)for(let i=0;i<beans.length;i++)this.destroyBean(beans[i],context);return[]}};_BeanStub.EVENT_DESTROYED="destroyed",__decorateClass([Autowired("frameworkOverrides")],_BeanStub.prototype,"frameworkOverrides",2),__decorateClass([Autowired("context")],_BeanStub.prototype,"context",2),__decorateClass([Autowired("eventService")],_BeanStub.prototype,"eventService",2),__decorateClass([Autowired("gridOptionsService")],_BeanStub.prototype,"gos",2),__decorateClass([Autowired("localeService")],_BeanStub.prototype,"localeService",2),__decorateClass([Autowired("environment")],_BeanStub.prototype,"environment",2),__decorateClass([PreDestroy],_BeanStub.prototype,"destroy",1);var BeanStub=_BeanStub,ColumnFactory=class extends BeanStub{setBeans(loggerFactory){this.logger=loggerFactory.create("ColumnFactory")}createColumnTree(defs,primaryColumns,existingTree,source){const columnKeyCreator=new ColumnKeyCreator,{existingCols,existingGroups,existingColKeys}=this.extractExistingTreeData(existingTree);columnKeyCreator.addExistingKeys(existingColKeys);const unbalancedTree=this.recursivelyCreateColumns(defs,0,primaryColumns,existingCols,columnKeyCreator,existingGroups,source),treeDept=this.findMaxDept(unbalancedTree,0);this.logger.log("Number of levels for grouped columns is "+treeDept);const columnTree=this.balanceColumnTree(unbalancedTree,0,treeDept,columnKeyCreator);return depthFirstOriginalTreeSearch(null,columnTree,(child,parent)=>{child instanceof ProvidedColumnGroup&&child.setupExpandable(),child.setOriginalParent(parent)}),{columnTree,treeDept}}extractExistingTreeData(existingTree){const existingCols=[],existingGroups=[],existingColKeys=[];return existingTree&&depthFirstOriginalTreeSearch(null,existingTree,item=>{if(item instanceof ProvidedColumnGroup){const group=item;existingGroups.push(group)}else{const col=item;existingColKeys.push(col.getId()),existingCols.push(col)}}),{existingCols,existingGroups,existingColKeys}}createForAutoGroups(autoGroupCols,gridBalancedTree){return autoGroupCols.map(col=>this.createAutoGroupTreeItem(gridBalancedTree,col))}createAutoGroupTreeItem(balancedColumnTree,column){const dept=this.findDepth(balancedColumnTree);let nextChild=column;for(let i=dept-1;i>=0;i--){const autoGroup=new ProvidedColumnGroup(null,`FAKE_PATH_${column.getId()}}_${i}`,!0,i);this.createBean(autoGroup),autoGroup.setChildren([nextChild]),nextChild.setOriginalParent(autoGroup),nextChild=autoGroup}return 0===dept&&column.setOriginalParent(null),nextChild}findDepth(balancedColumnTree){let dept=0,pointer=balancedColumnTree;for(;pointer&&pointer[0]&&pointer[0]instanceof ProvidedColumnGroup;)dept++,pointer=pointer[0].getChildren();return dept}balanceColumnTree(unbalancedTree,currentDept,columnDept,columnKeyCreator){const result=[];for(let i=0;i<unbalancedTree.length;i++){const child=unbalancedTree[i];if(child instanceof ProvidedColumnGroup){const originalGroup=child,newChildren=this.balanceColumnTree(originalGroup.getChildren(),currentDept+1,columnDept,columnKeyCreator);originalGroup.setChildren(newChildren),result.push(originalGroup)}else{let firstPaddedGroup,currentPaddedGroup;for(let j=columnDept-1;j>=currentDept;j--){const newColId=columnKeyCreator.getUniqueKey(null,null),colGroupDefMerged=this.createMergedColGroupDef(null),paddedGroup=new ProvidedColumnGroup(colGroupDefMerged,newColId,!0,currentDept);this.createBean(paddedGroup),currentPaddedGroup&&currentPaddedGroup.setChildren([paddedGroup]),currentPaddedGroup=paddedGroup,firstPaddedGroup||(firstPaddedGroup=currentPaddedGroup)}if(firstPaddedGroup&&currentPaddedGroup){result.push(firstPaddedGroup);if(unbalancedTree.some(leaf=>leaf instanceof ProvidedColumnGroup)){currentPaddedGroup.setChildren([child]);continue}currentPaddedGroup.setChildren(unbalancedTree);break}result.push(child)}}return result}findMaxDept(treeChildren,dept){let maxDeptThisLevel=dept;for(let i=0;i<treeChildren.length;i++){const abstractColumn=treeChildren[i];if(abstractColumn instanceof ProvidedColumnGroup){const originalGroup=abstractColumn,newDept=this.findMaxDept(originalGroup.getChildren(),dept+1);maxDeptThisLevel<newDept&&(maxDeptThisLevel=newDept)}}return maxDeptThisLevel}recursivelyCreateColumns(defs,level,primaryColumns,existingColsCopy,columnKeyCreator,existingGroups,source){if(!defs)return[];const result=new Array(defs.length);for(let i=0;i<result.length;i++){const def=defs[i];this.isColumnGroup(def)?result[i]=this.createColumnGroup(primaryColumns,def,level,existingColsCopy,columnKeyCreator,existingGroups,source):result[i]=this.createColumn(primaryColumns,def,existingColsCopy,columnKeyCreator,source)}return result}createColumnGroup(primaryColumns,colGroupDef,level,existingColumns,columnKeyCreator,existingGroups,source){const colGroupDefMerged=this.createMergedColGroupDef(colGroupDef),groupId=columnKeyCreator.getUniqueKey(colGroupDefMerged.groupId||null,null),providedGroup=new ProvidedColumnGroup(colGroupDefMerged,groupId,!1,level);this.createBean(providedGroup);const existingGroupAndIndex=this.findExistingGroup(colGroupDef,existingGroups);existingGroupAndIndex&&existingGroups.splice(existingGroupAndIndex.idx,1);let existingGroup=null==existingGroupAndIndex?void 0:existingGroupAndIndex.group;existingGroup&&providedGroup.setExpanded(existingGroup.isExpanded());const children=this.recursivelyCreateColumns(colGroupDefMerged.children,level+1,primaryColumns,existingColumns,columnKeyCreator,existingGroups,source);return providedGroup.setChildren(children),providedGroup}createMergedColGroupDef(colGroupDef){const colGroupDefMerged={};return Object.assign(colGroupDefMerged,this.gos.get("defaultColGroupDef")),Object.assign(colGroupDefMerged,colGroupDef),colGroupDefMerged}createColumn(primaryColumns,colDef,existingColsCopy,columnKeyCreator,source){const existingColAndIndex=this.findExistingColumn(colDef,existingColsCopy);existingColAndIndex&&(null==existingColsCopy||existingColsCopy.splice(existingColAndIndex.idx,1));let column=null==existingColAndIndex?void 0:existingColAndIndex.column;if(column){const colDefMerged=this.addColumnDefaultAndTypes(colDef,column.getColId());column.setColDef(colDefMerged,colDef,source),this.applyColumnState(column,colDefMerged,source)}else{const colId=columnKeyCreator.getUniqueKey(colDef.colId,colDef.field),colDefMerged=this.addColumnDefaultAndTypes(colDef,colId);column=new Column(colDefMerged,colDef,colId,primaryColumns),this.context.createBean(column)}return this.dataTypeService.addColumnListeners(column),column}applyColumnState(column,colDef,source){const flex=attrToNumber(colDef.flex);void 0!==flex&&column.setFlex(flex);if(column.getFlex()<=0){const width=attrToNumber(colDef.width);if(null!=width)column.setActualWidth(width,source);else{const widthBeforeUpdate=column.getActualWidth();column.setActualWidth(widthBeforeUpdate,source)}}void 0!==colDef.sort&&("asc"==colDef.sort||"desc"==colDef.sort?column.setSort(colDef.sort,source):column.setSort(void 0,source));const sortIndex=attrToNumber(colDef.sortIndex);void 0!==sortIndex&&column.setSortIndex(sortIndex);const hide=attrToBoolean(colDef.hide);void 0!==hide&&column.setVisible(!hide,source),void 0!==colDef.pinned&&column.setPinned(colDef.pinned)}findExistingColumn(newColDef,existingColsCopy){if(existingColsCopy)for(let i=0;i<existingColsCopy.length;i++){const def=existingColsCopy[i].getUserProvidedColDef();if(!def)continue;if(null!=newColDef.colId){if(existingColsCopy[i].getId()===newColDef.colId)return{idx:i,column:existingColsCopy[i]};continue}if(null!=newColDef.field){if(def.field===newColDef.field)return{idx:i,column:existingColsCopy[i]}}else if(def===newColDef)return{idx:i,column:existingColsCopy[i]}}}findExistingGroup(newGroupDef,existingGroups){if(null!=newGroupDef.groupId)for(let i=0;i<existingGroups.length;i++){const existingGroup=existingGroups[i];if(existingGroup.getColGroupDef()&&existingGroup.getId()===newGroupDef.groupId)return{idx:i,group:existingGroup}}}addColumnDefaultAndTypes(colDef,colId){const res={};mergeDeep(res,this.gos.get("defaultColDef"),!1,!0);const columnType=this.dataTypeService.updateColDefAndGetColumnType(res,colDef,colId);columnType&&this.assignColumnTypes(columnType,res),mergeDeep(res,colDef,!1,!0);const autoGroupColDef=this.gos.get("autoGroupColumnDef"),isSortingCoupled=this.gos.isColumnsSortingCoupledToGroup();return colDef.rowGroup&&autoGroupColDef&&isSortingCoupled&&mergeDeep(res,{sort:autoGroupColDef.sort,initialSort:autoGroupColDef.initialSort},!1,!0),this.dataTypeService.validateColDef(res),res}assignColumnTypes(typeKeys,colDefMerged){if(!typeKeys.length)return;const allColumnTypes=Object.assign({},DefaultColumnTypes);iterateObject(this.gos.get("columnTypes")||{},(key,value)=>{if(key in allColumnTypes)console.warn(`AG Grid: the column type '${key}' is a default column type and cannot be overridden.`);else{value.type&&warnOnce("Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type."),allColumnTypes[key]=value}}),typeKeys.forEach(t=>{const typeColDef=allColumnTypes[t.trim()];typeColDef?mergeDeep(colDefMerged,typeColDef,!1,!0):console.warn("AG Grid: colDef.type '"+t+"' does not correspond to defined gridOptions.columnTypes")})}isColumnGroup(abstractColDef){return void 0!==abstractColDef.children}};function depthFirstOriginalTreeSearch(parent,tree,callback){if(tree)for(let i=0;i<tree.length;i++){const child=tree[i];child instanceof ProvidedColumnGroup&&depthFirstOriginalTreeSearch(child,child.getChildren(),callback),callback(child,parent)}}__decorateClass([Autowired("dataTypeService")],ColumnFactory.prototype,"dataTypeService",2),__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],ColumnFactory.prototype,"setBeans",1),ColumnFactory=__decorateClass([Bean("columnFactory")],ColumnFactory);var _ColumnGroup=class _ColumnGroup{constructor(providedColumnGroup,groupId,partId,pinned){this.displayedChildren=[],this.localEventService=new EventService,this.groupId=groupId,this.partId=partId,this.providedColumnGroup=providedColumnGroup,this.pinned=pinned}static createUniqueId(groupId,instanceId){return groupId+"_"+instanceId}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}setParent(parent){this.parent=parent}getUniqueId(){return _ColumnGroup.createUniqueId(this.groupId,this.partId)}isEmptyGroup(){return 0===this.displayedChildren.length}isMoving(){const allLeafColumns=this.getProvidedColumnGroup().getLeafColumns();return!(!allLeafColumns||0===allLeafColumns.length)&&allLeafColumns.every(col=>col.isMoving())}checkLeft(){if(this.displayedChildren.forEach(child=>{child instanceof _ColumnGroup&&child.checkLeft()}),this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const lastChildLeft=last(this.displayedChildren).getLeft();this.setLeft(lastChildLeft)}else{const firstChildLeft=this.displayedChildren[0].getLeft();this.setLeft(firstChildLeft)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(left){this.oldLeft=this.left,this.left!==left&&(this.left=left,this.localEventService.dispatchEvent(this.createAgEvent(_ColumnGroup.EVENT_LEFT_CHANGED)))}getPinned(){return this.pinned}createAgEvent(type){return{type}}addEventListener(eventType,listener){this.localEventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.localEventService.removeEventListener(eventType,listener)}getGroupId(){return this.groupId}getPartId(){return this.partId}isChildInThisGroupDeepSearch(wantedChild){let result=!1;return this.children.forEach(foundChild=>{wantedChild===foundChild&&(result=!0),foundChild instanceof _ColumnGroup&&foundChild.isChildInThisGroupDeepSearch(wantedChild)&&(result=!0)}),result}getActualWidth(){let groupActualWidth=0;return this.displayedChildren&&this.displayedChildren.forEach(child=>{groupActualWidth+=child.getActualWidth()}),groupActualWidth}isResizable(){if(!this.displayedChildren)return!1;let result=!1;return this.displayedChildren.forEach(child=>{child.isResizable()&&(result=!0)}),result}getMinWidth(){let result=0;return this.displayedChildren.forEach(groupChild=>{result+=groupChild.getMinWidth()||0}),result}addChild(child){this.children||(this.children=[]),this.children.push(child)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const result=[];return this.addLeafColumns(result),result}getDisplayedLeafColumns(){const result=[];return this.addDisplayedLeafColumns(result),result}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(expanded){this.providedColumnGroup.setExpanded(expanded)}addDisplayedLeafColumns(leafColumns){this.displayedChildren.forEach(child=>{child instanceof Column?leafColumns.push(child):child instanceof _ColumnGroup&&child.addDisplayedLeafColumns(leafColumns)})}addLeafColumns(leafColumns){this.children.forEach(child=>{child instanceof Column?leafColumns.push(child):child instanceof _ColumnGroup&&child.addLeafColumns(leafColumns)})}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const parent=this.getParent();return this.isPadding()&&parent&&parent.isPadding()?1+parent.getPaddingLevel():0}calculateDisplayedColumns(){this.displayedChildren=[];let parentWithExpansion=this;for(;null!=parentWithExpansion&&parentWithExpansion.isPadding();)parentWithExpansion=parentWithExpansion.getParent();if(!(!!parentWithExpansion&&parentWithExpansion.providedColumnGroup.isExpandable()))return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(_ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach(child=>{if(child instanceof _ColumnGroup&&(!child.displayedChildren||!child.displayedChildren.length))return;switch(child.getColumnGroupShow()){case"open":parentWithExpansion.providedColumnGroup.isExpanded()&&this.displayedChildren.push(child);break;case"closed":parentWithExpansion.providedColumnGroup.isExpanded()||this.displayedChildren.push(child);break;default:this.displayedChildren.push(child)}}),this.localEventService.dispatchEvent(this.createAgEvent(_ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED))}};_ColumnGroup.EVENT_LEFT_CHANGED="leftChanged",_ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",__decorateClass([Autowired("gridOptionsService")],_ColumnGroup.prototype,"gos",2);var ColumnGroup=_ColumnGroup,Events=class{};Events.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",Events.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",Events.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",Events.EVENT_PIVOT_MAX_COLUMNS_EXCEEDED="pivotMaxColumnsExceeded",Events.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",Events.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",Events.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",Events.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",Events.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",Events.EVENT_COLUMN_MOVED="columnMoved",Events.EVENT_COLUMN_VISIBLE="columnVisible",Events.EVENT_COLUMN_PINNED="columnPinned",Events.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",Events.EVENT_COLUMN_RESIZED="columnResized",Events.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",Events.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED="suppressMovableColumns",Events.EVENT_SUPPRESS_MENU_HIDE_CHANGED="suppressMenuHide",Events.EVENT_SUPPRESS_FIELD_DOT_NOTATION="suppressFieldDotNotation",Events.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",Events.EVENT_COLUMN_HEADER_MOUSE_OVER="columnHeaderMouseOver",Events.EVENT_COLUMN_HEADER_MOUSE_LEAVE="columnHeaderMouseLeave",Events.EVENT_COLUMN_HEADER_CLICKED="columnHeaderClicked",Events.EVENT_COLUMN_HEADER_CONTEXT_MENU="columnHeaderContextMenu",Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",Events.EVENT_ROW_GROUP_OPENED="rowGroupOpened",Events.EVENT_ROW_DATA_UPDATED="rowDataUpdated",Events.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",Events.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",Events.EVENT_CHART_CREATED="chartCreated",Events.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",Events.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",Events.EVENT_CHART_DESTROYED="chartDestroyed",Events.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",Events.EVENT_TOOL_PANEL_SIZE_CHANGED="toolPanelSizeChanged",Events.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",Events.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",Events.EVENT_MODEL_UPDATED="modelUpdated",Events.EVENT_CUT_START="cutStart",Events.EVENT_CUT_END="cutEnd",Events.EVENT_PASTE_START="pasteStart",Events.EVENT_PASTE_END="pasteEnd",Events.EVENT_FILL_START="fillStart",Events.EVENT_FILL_END="fillEnd",Events.EVENT_RANGE_DELETE_START="rangeDeleteStart",Events.EVENT_RANGE_DELETE_END="rangeDeleteEnd",Events.EVENT_UNDO_STARTED="undoStarted",Events.EVENT_UNDO_ENDED="undoEnded",Events.EVENT_REDO_STARTED="redoStarted",Events.EVENT_REDO_ENDED="redoEnded",Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START="keyShortcutChangedCellStart",Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END="keyShortcutChangedCellEnd",Events.EVENT_CELL_CLICKED="cellClicked",Events.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",Events.EVENT_CELL_MOUSE_DOWN="cellMouseDown",Events.EVENT_CELL_CONTEXT_MENU="cellContextMenu",Events.EVENT_CELL_VALUE_CHANGED="cellValueChanged",Events.EVENT_CELL_EDIT_REQUEST="cellEditRequest",Events.EVENT_ROW_VALUE_CHANGED="rowValueChanged",Events.EVENT_CELL_FOCUSED="cellFocused",Events.EVENT_CELL_FOCUS_CLEARED="cellFocusCleared",Events.EVENT_FULL_WIDTH_ROW_FOCUSED="fullWidthRowFocused",Events.EVENT_ROW_SELECTED="rowSelected",Events.EVENT_SELECTION_CHANGED="selectionChanged",Events.EVENT_TOOLTIP_SHOW="tooltipShow",Events.EVENT_TOOLTIP_HIDE="tooltipHide",Events.EVENT_CELL_KEY_DOWN="cellKeyDown",Events.EVENT_CELL_MOUSE_OVER="cellMouseOver",Events.EVENT_CELL_MOUSE_OUT="cellMouseOut",Events.EVENT_FILTER_CHANGED="filterChanged",Events.EVENT_FILTER_MODIFIED="filterModified",Events.EVENT_FILTER_OPENED="filterOpened",Events.EVENT_ADVANCED_FILTER_BUILDER_VISIBLE_CHANGED="advancedFilterBuilderVisibleChanged",Events.EVENT_SORT_CHANGED="sortChanged",Events.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",Events.EVENT_ROW_CLICKED="rowClicked",Events.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",Events.EVENT_GRID_READY="gridReady",Events.EVENT_GRID_PRE_DESTROYED="gridPreDestroyed",Events.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",Events.EVENT_VIEWPORT_CHANGED="viewportChanged",Events.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",Events.EVENT_FIRST_DATA_RENDERED="firstDataRendered",Events.EVENT_DRAG_STARTED="dragStarted",Events.EVENT_DRAG_STOPPED="dragStopped",Events.EVENT_CHECKBOX_CHANGED="checkboxChanged",Events.EVENT_ROW_EDITING_STARTED="rowEditingStarted",Events.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",Events.EVENT_CELL_EDITING_STARTED="cellEditingStarted",Events.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",Events.EVENT_BODY_SCROLL="bodyScroll",Events.EVENT_BODY_SCROLL_END="bodyScrollEnd",Events.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",Events.EVENT_PAGINATION_CHANGED="paginationChanged",Events.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",Events.EVENT_STORE_REFRESHED="storeRefreshed",Events.EVENT_STATE_UPDATED="stateUpdated",Events.EVENT_COLUMN_MENU_VISIBLE_CHANGED="columnMenuVisibleChanged",Events.EVENT_CONTEXT_MENU_VISIBLE_CHANGED="contextMenuVisibleChanged",Events.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED="columnContainerWidthChanged",Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",Events.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",Events.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",Events.EVENT_FLASH_CELLS="flashCells",Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",Events.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",Events.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",Events.EVENT_HEADER_HEIGHT_CHANGED="headerHeightChanged",Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED="columnHeaderHeightChanged",Events.EVENT_ROW_DRAG_ENTER="rowDragEnter",Events.EVENT_ROW_DRAG_MOVE="rowDragMove",Events.EVENT_ROW_DRAG_LEAVE="rowDragLeave",Events.EVENT_ROW_DRAG_END="rowDragEnd",Events.EVENT_GRID_STYLES_CHANGED="gridStylesChanged",Events.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",Events.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",Events.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",Events.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",Events.EVENT_STORE_UPDATED="storeUpdated",Events.EVENT_FILTER_DESTROYED="filterDestroyed",Events.EVENT_ROW_DATA_UPDATE_STARTED="rowDataUpdateStarted",Events.EVENT_ROW_COUNT_READY="rowCountReady",Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED="advancedFilterEnabledChanged",Events.EVENT_DATA_TYPES_INFERRED="dataTypesInferred",Events.EVENT_FIELD_VALUE_CHANGED="fieldValueChanged",Events.EVENT_FIELD_PICKER_VALUE_SELECTED="fieldPickerValueSelected",Events.EVENT_SIDE_BAR_UPDATED="sideBarUpdated";var ALWAYS_SYNC_GLOBAL_EVENTS=new Set([Events.EVENT_GRID_PRE_DESTROYED,Events.EVENT_FILL_START]),GroupInstanceIdCreator=class{constructor(){this.existingIds={}}getInstanceIdForKey(key){const lastResult=this.existingIds[key];let result;return result="number"!=typeof lastResult?0:lastResult+1,this.existingIds[key]=result,result}},AutoGroupColService=class extends BeanStub{createAutoGroupColumns(rowGroupColumns){const groupAutoColumns=[],doingTreeData=this.gos.get("treeData");let doingMultiAutoColumn=this.gos.isGroupMultiAutoColumn();return doingTreeData&&doingMultiAutoColumn&&(console.warn('AG Grid: you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data'),doingMultiAutoColumn=!1),doingMultiAutoColumn?rowGroupColumns.forEach((rowGroupCol,index)=>{groupAutoColumns.push(this.createOneAutoGroupColumn(rowGroupCol,index))}):groupAutoColumns.push(this.createOneAutoGroupColumn()),groupAutoColumns}updateAutoGroupColumns(autoGroupColumns,source){autoGroupColumns.forEach((column,index)=>this.updateOneAutoGroupColumn(column,index,source))}createOneAutoGroupColumn(rowGroupCol,index){let colId;colId=rowGroupCol?`ag-Grid-AutoColumn-${rowGroupCol.getId()}`:"ag-Grid-AutoColumn";const colDef=this.createAutoGroupColDef(colId,rowGroupCol,index);colDef.colId=colId;const newCol=new Column(colDef,null,colId,!0);return this.context.createBean(newCol),newCol}updateOneAutoGroupColumn(colToUpdate,index,source){const oldColDef=colToUpdate.getColDef(),underlyingColId="string"==typeof oldColDef.showRowGroup?oldColDef.showRowGroup:void 0,underlyingColumn=null!=underlyingColId?this.columnModel.getPrimaryColumn(underlyingColId):void 0,colDef=this.createAutoGroupColDef(colToUpdate.getId(),null!=underlyingColumn?underlyingColumn:void 0,index);colToUpdate.setColDef(colDef,null,source),this.columnFactory.applyColumnState(colToUpdate,colDef,source)}createAutoGroupColDef(colId,underlyingColumn,index){let res=this.createBaseColDef(underlyingColumn);if(mergeDeep(res,this.gos.get("autoGroupColumnDef")),res=this.columnFactory.addColumnDefaultAndTypes(res,colId),!this.gos.get("treeData")){missing(res.field)&&missing(res.valueGetter)&&missing(res.filterValueGetter)&&"agGroupColumnFilter"!==res.filter&&(res.filter=!1)}index&&index>0&&(res.headerCheckboxSelection=!1);const isSortingCoupled=this.gos.isColumnsSortingCoupledToGroup(),hasOwnData=res.valueGetter||null!=res.field;return isSortingCoupled&&!hasOwnData&&(res.sortIndex=void 0,res.initialSort=void 0),res}createBaseColDef(rowGroupCol){const userDef=this.gos.get("autoGroupColumnDef"),res={headerName:this.localeService.getLocaleTextFunc()("group","Group")};if(userDef&&(userDef.cellRenderer||userDef.cellRendererSelector)||(res.cellRenderer="agGroupCellRenderer"),rowGroupCol){const colDef=rowGroupCol.getColDef();Object.assign(res,{headerName:this.columnModel.getDisplayNameForColumn(rowGroupCol,"header"),headerValueGetter:colDef.headerValueGetter}),colDef.cellRenderer&&Object.assign(res,{cellRendererParams:{innerRenderer:colDef.cellRenderer,innerRendererParams:colDef.cellRendererParams}}),res.showRowGroup=rowGroupCol.getColId()}else res.showRowGroup=!0;return res}};__decorateClass([Autowired("columnModel")],AutoGroupColService.prototype,"columnModel",2),__decorateClass([Autowired("columnFactory")],AutoGroupColService.prototype,"columnFactory",2),AutoGroupColService=__decorateClass([Bean("autoGroupColService")],AutoGroupColService);var string_exports={};__export(string_exports,{camelCaseToHumanText:()=>camelCaseToHumanText,camelCaseToHyphenated:()=>camelCaseToHyphenated,capitalise:()=>capitalise,escapeString:()=>escapeString,utf8_encode:()=>utf8_encode});var reUnescapedHtml=/[&<>"']/g,HTML_ESCAPES={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function utf8_encode(s){const stringFromCharCode=String.fromCharCode;function createByte(point,shift){return stringFromCharCode(point>>shift&63|128)}function encodeCodePoint(point){if(point>=0&&point<=31&&10!==point){return`_x${point.toString(16).toUpperCase().padStart(4,"0")}_`}if(!(4294967168&point))return stringFromCharCode(point);let symbol="";return 4294965248&point?4294901760&point?4292870144&point||(symbol=stringFromCharCode(point>>18&7|240),symbol+=createByte(point,12),symbol+=createByte(point,6)):(!function checkScalarValue(point){if(point>=55296&&point<=57343)throw Error("Lone surrogate U+"+point.toString(16).toUpperCase()+" is not a scalar value")}(point),symbol=stringFromCharCode(point>>12&15|224),symbol+=createByte(point,6)):symbol=stringFromCharCode(point>>6&31|192),symbol+=stringFromCharCode(63&point|128),symbol}const codePoints=function ucs2decode(string){const output=[];if(!string)return[];const len=string.length;let value,extra,counter=0;for(;counter<len;)value=string.charCodeAt(counter++),value>=55296&&value<=56319&&counter<len?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}(s),length=codePoints.length;let codePoint,index=-1,byteString="";for(;++index<length;)codePoint=codePoints[index],byteString+=encodeCodePoint(codePoint);return byteString}function capitalise(str){return str[0].toUpperCase()+str.substring(1).toLowerCase()}function escapeString(toEscape,skipEscapingHtmlChars){if(null==toEscape)return null;const stringResult=toEscape.toString().toString();return skipEscapingHtmlChars?stringResult:stringResult.replace(reUnescapedHtml,chr=>HTML_ESCAPES[chr])}function camelCaseToHumanText(camelCase){if(!camelCase||null==camelCase)return null;return camelCase.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/([A-Z]+)([A-Z])([a-z])/g,"$1 $2$3").replace(/\./g," ").split(" ").map(word=>word.substring(0,1).toUpperCase()+(word.length>1?word.substring(1,word.length):"")).join(" ")}function camelCaseToHyphenated(camelCase){return camelCase.replace(/[A-Z]/g,s=>`-${s.toLocaleLowerCase()}`)}var map_exports={};function convertToMap(arr){const map=new Map;return arr.forEach(pair=>map.set(pair[0],pair[1])),map}function mapById(arr,callback){const map=new Map;return arr.forEach(item=>map.set(callback(item),item)),map}function keys(map){const arr=[];return map.forEach((_2,key)=>arr.push(key)),arr}__export(map_exports,{convertToMap:()=>convertToMap,keys:()=>keys,mapById:()=>mapById});var ColumnModel=class extends BeanStub{constructor(){super(...arguments),this.primaryHeaderRowCount=0,this.secondaryHeaderRowCount=0,this.gridHeaderRowCount=0,this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.displayedColumnsAndGroupsMap={},this.viewportColumns=[],this.viewportColumnsHash="",this.headerViewportColumns=[],this.viewportColumnsCenter=[],this.headerViewportColumnsCenter=[],this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.autoHeightActiveAtLeastOnce=!1,this.rowGroupColumns=[],this.valueColumns=[],this.pivotColumns=[],this.ready=!1,this.changeEventsDispatching=!1,this.autoGroupsNeedBuilding=!1,this.forceRecreateAutoGroups=!1,this.pivotMode=!1,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.bodyWidthDirty=!0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}init(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation");const pivotMode=this.gos.get("pivotMode");this.isPivotSettingAllowed(pivotMode)&&(this.pivotMode=pivotMode),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents"],event=>this.buildAutoGroupColumns(convertSourceType(event.source))),this.addManagedPropertyListener("autoGroupColumnDef",event=>this.onAutoGroupColumnDefChanged(convertSourceType(event.source))),this.addManagedPropertyListeners(["defaultColDef","columnTypes","suppressFieldDotNotation"],event=>this.onSharedColDefChanged(convertSourceType(event.source))),this.addManagedPropertyListener("pivotMode",event=>this.setPivotMode(this.gos.get("pivotMode"),convertSourceType(event.source))),this.addManagedListener(this.eventService,Events.EVENT_FIRST_DATA_RENDERED,()=>this.onFirstDataRendered())}buildAutoGroupColumns(source){this.columnDefs&&(this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns(source))}onAutoGroupColumnDefChanged(source){this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,source)}onSharedColDefChanged(source){this.gridColumns&&(this.groupAutoColumns&&this.autoGroupColService.updateAutoGroupColumns(this.groupAutoColumns,source),this.createColumnsFromColumnDefs(!0,source))}setColumnDefs(columnDefs,source){const colsPreviouslyExisted=!!this.columnDefs;this.columnDefs=columnDefs,this.createColumnsFromColumnDefs(colsPreviouslyExisted,source)}recreateColumnDefs(source){this.onSharedColDefChanged(source)}destroyOldColumns(oldTree,newTree){const oldObjectsById={};if(!oldTree)return;depthFirstOriginalTreeSearch(null,oldTree,child=>{oldObjectsById[child.getInstanceId()]=child}),newTree&&depthFirstOriginalTreeSearch(null,newTree,child=>{oldObjectsById[child.getInstanceId()]=null});const colsToDestroy=Object.values(oldObjectsById).filter(item=>null!=item);this.destroyBeans(colsToDestroy)}destroyColumns(){this.destroyOldColumns(this.primaryColumnTree),this.destroyOldColumns(this.secondaryBalancedTree),this.destroyOldColumns(this.groupAutoColsBalancedTree)}createColumnsFromColumnDefs(colsPreviouslyExisted,source){const dispatchEventsFunc=colsPreviouslyExisted?this.compareColumnStatesAndDispatchEvents(source):void 0;this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;const oldPrimaryColumns=this.primaryColumns,oldPrimaryTree=this.primaryColumnTree,balancedTreeResult=this.columnFactory.createColumnTree(this.columnDefs,!0,oldPrimaryTree,source);this.destroyOldColumns(this.primaryColumnTree,balancedTreeResult.columnTree),this.primaryColumnTree=balancedTreeResult.columnTree,this.primaryHeaderRowCount=balancedTreeResult.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(col=>this.primaryColumnsMap[col.getId()]=col),this.extractRowGroupColumns(source,oldPrimaryColumns),this.extractPivotColumns(source,oldPrimaryColumns),this.extractValueColumns(source,oldPrimaryColumns),this.ready=!0;const gridColsNotProcessed=void 0===this.gridColsArePrimary;(this.gridColsArePrimary||gridColsNotProcessed||this.autoGroupsNeedBuilding)&&(this.updateGridColumns(),colsPreviouslyExisted&&this.gridColsArePrimary&&!this.gos.get("maintainColumnOrder")&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(source),this.checkViewportColumns()),this.dispatchEverythingChanged(source),this.changeEventsDispatching=!0,dispatchEventsFunc&&dispatchEventsFunc(),this.changeEventsDispatching=!1,this.dispatchNewColumnsLoaded(source)}shouldRowModelIgnoreRefresh(){return this.changeEventsDispatching}dispatchNewColumnsLoaded(source){const newColumnsLoadedEvent={type:Events.EVENT_NEW_COLUMNS_LOADED,source};this.eventService.dispatchEvent(newColumnsLoadedEvent),"gridInitializing"===source&&this.onColumnsReady()}dispatchEverythingChanged(source){const eventEverythingChanged={type:Events.EVENT_COLUMN_EVERYTHING_CHANGED,source};this.eventService.dispatchEvent(eventEverythingChanged)}orderGridColumnsLikePrimary(){const primaryColumns=this.primaryColumns;if(!primaryColumns)return;const primaryColsOrdered=primaryColumns.filter(col=>this.gridColumns.indexOf(col)>=0),otherCols=this.gridColumns.filter(col=>primaryColsOrdered.indexOf(col)<0);this.gridColumns=[...otherCols,...primaryColsOrdered],this.gridColumns=this.placeLockedColumns(this.gridColumns)}getAllDisplayedAutoHeightCols(){return this.displayedAutoHeightCols}setViewport(){this.gos.get("enableRtl")?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)}checkViewportColumns(afterScroll=!1){if(null==this.displayedColumnsCenter)return;if(!this.extractViewport())return;const event={type:Events.EVENT_VIRTUAL_COLUMNS_CHANGED,afterScroll};this.eventService.dispatchEvent(event)}setViewportPosition(scrollWidth,scrollPosition,afterScroll=!1){(scrollWidth!==this.scrollWidth||scrollPosition!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=scrollWidth,this.scrollPosition=scrollPosition,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns(afterScroll))}isPivotMode(){return this.pivotMode}isPivotSettingAllowed(pivot){return!pivot||!this.gos.get("treeData")||(warnOnce("Pivot mode not available with treeData."),!1)}setPivotMode(pivotMode,source){if(pivotMode===this.pivotMode||!this.isPivotSettingAllowed(this.pivotMode))return;if(this.pivotMode=pivotMode,!this.gridColumns)return;this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(source);const event={type:Events.EVENT_COLUMN_PIVOT_MODE_CHANGED};this.eventService.dispatchEvent(event)}getSecondaryPivotColumn(pivotKeys,valueColKey){if(missing(this.secondaryColumns))return null;const valueColumnToFind=this.getPrimaryColumn(valueColKey);let foundColumn=null;return this.secondaryColumns.forEach(column=>{const thisPivotKeys=column.getColDef().pivotKeys,pivotValueColumn=column.getColDef().pivotValueColumn;areEqual(thisPivotKeys,pivotKeys)&&pivotValueColumn===valueColumnToFind&&(foundColumn=column)}),foundColumn}setBeans(loggerFactory){this.logger=loggerFactory.create("columnModel")}setFirstRightAndLastLeftPinned(source){let lastLeft,firstRight;this.gos.get("enableRtl")?(lastLeft=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,firstRight=this.displayedColumnsRight?last(this.displayedColumnsRight):null):(lastLeft=this.displayedColumnsLeft?last(this.displayedColumnsLeft):null,firstRight=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(column=>{column.setLastLeftPinned(column===lastLeft,source),column.setFirstRightPinned(column===firstRight,source)})}autoSizeColumns(params){if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.autoSizeColumns(params));const{columns,skipHeader,skipHeaderGroups,stopAtGroup,source="api"}=params;this.animationFrameService.flushAllFrames();const columnsAutosized=[];let changesThisTimeAround=-1;const shouldSkipHeader=null!=skipHeader?skipHeader:this.gos.get("skipHeaderOnAutoSize"),shouldSkipHeaderGroups=null!=skipHeaderGroups?skipHeaderGroups:shouldSkipHeader;for(;0!==changesThisTimeAround;)changesThisTimeAround=0,this.actionOnGridColumns(columns,column=>{if(columnsAutosized.indexOf(column)>=0)return!1;const preferredWidth=this.autoWidthCalculator.getPreferredWidthForColumn(column,shouldSkipHeader);if(preferredWidth>0){const newWidth=this.normaliseColumnWidth(column,preferredWidth);column.setActualWidth(newWidth,source),columnsAutosized.push(column),changesThisTimeAround++}return!0},source);shouldSkipHeaderGroups||this.autoSizeColumnGroupsByColumns(columns,source,stopAtGroup),this.dispatchColumnResizedEvent(columnsAutosized,!0,"autosizeColumns")}dispatchColumnResizedEvent(columns,finished,source,flexColumns=null){if(columns&&columns.length){const event={type:Events.EVENT_COLUMN_RESIZED,columns,column:1===columns.length?columns[0]:null,flexColumns,finished,source};this.eventService.dispatchEvent(event)}}dispatchColumnChangedEvent(type,columns,source){const event={type,columns,column:columns&&1==columns.length?columns[0]:null,source};this.eventService.dispatchEvent(event)}dispatchColumnMovedEvent(params){const{movedColumns,source,toIndex,finished}=params,event={type:Events.EVENT_COLUMN_MOVED,columns:movedColumns,column:movedColumns&&1===movedColumns.length?movedColumns[0]:null,toIndex,finished,source};this.eventService.dispatchEvent(event)}dispatchColumnPinnedEvent(changedColumns,source){if(!changedColumns.length)return;const column=1===changedColumns.length?changedColumns[0]:null,pinned=this.getCommonValue(changedColumns,col=>col.getPinned()),event={type:Events.EVENT_COLUMN_PINNED,pinned:null!=pinned?pinned:null,columns:changedColumns,column,source};this.eventService.dispatchEvent(event)}dispatchColumnVisibleEvent(changedColumns,source){if(!changedColumns.length)return;const column=1===changedColumns.length?changedColumns[0]:null,visible=this.getCommonValue(changedColumns,col=>col.isVisible()),event={type:Events.EVENT_COLUMN_VISIBLE,visible,columns:changedColumns,column,source};this.eventService.dispatchEvent(event)}autoSizeColumn(key,source,skipHeader){key&&this.autoSizeColumns({columns:[key],skipHeader,skipHeaderGroups:!0,source})}autoSizeColumnGroupsByColumns(keys2,source,stopAtGroup){const columnGroups=new Set;let headerGroupCtrl;this.getGridColumns(keys2).forEach(col=>{let parent=col.getParent();for(;parent&&parent!=stopAtGroup;)parent.isPadding()||columnGroups.add(parent),parent=parent.getParent()});for(const columnGroup of columnGroups){for(const headerContainerCtrl of this.ctrlsService.getHeaderRowContainerCtrls())if(headerGroupCtrl=headerContainerCtrl.getHeaderCtrlForColumn(columnGroup),headerGroupCtrl)break;headerGroupCtrl&&headerGroupCtrl.resizeLeafColumnsToFit(source)}return[]}autoSizeAllColumns(source,skipHeader){if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.autoSizeAllColumns(source,skipHeader));const allDisplayedColumns=this.getAllDisplayedColumns();this.autoSizeColumns({columns:allDisplayedColumns,skipHeader,source})}getColumnsFromTree(rootColumns){const result=[],recursiveFindColumns=childColumns=>{for(let i=0;i<childColumns.length;i++){const child=childColumns[i];child instanceof Column?result.push(child):child instanceof ProvidedColumnGroup&&recursiveFindColumns(child.getChildren())}};return recursiveFindColumns(rootColumns),result}getAllDisplayedTrees(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null}getPrimaryColumnTree(){return this.primaryColumnTree}getHeaderRowCount(){return this.gridHeaderRowCount}getDisplayedTreeLeft(){return this.displayedTreeLeft}getDisplayedTreeRight(){return this.displayedTreeRight}getDisplayedTreeCentre(){return this.displayedTreeCentre}isColumnDisplayed(column){return this.getAllDisplayedColumns().indexOf(column)>=0}getAllDisplayedColumns(){return this.displayedColumns}getViewportColumns(){return this.viewportColumns}getDisplayedLeftColumnsForRow(rowNode){return this.colSpanActive?this.getDisplayedColumnsForRow(rowNode,this.displayedColumnsLeft):this.displayedColumnsLeft}getDisplayedRightColumnsForRow(rowNode){return this.colSpanActive?this.getDisplayedColumnsForRow(rowNode,this.displayedColumnsRight):this.displayedColumnsRight}isColSpanActive(){return this.colSpanActive}getDisplayedColumnsForRow(rowNode,displayedColumns,filterCallback,emptySpaceBeforeColumn){const result=[];let lastConsideredCol=null;for(let i=0;i<displayedColumns.length;i++){const col=displayedColumns[i],maxAllowedColSpan=displayedColumns.length-i,colSpan=Math.min(col.getColSpan(rowNode),maxAllowedColSpan),columnsToCheckFilter=[col];if(colSpan>1){const colsToRemove=colSpan-1;for(let j=1;j<=colsToRemove;j++)columnsToCheckFilter.push(displayedColumns[i+j]);i+=colsToRemove}let filterPasses;if(filterCallback?(filterPasses=!1,columnsToCheckFilter.forEach(colForFilter=>{filterCallback(colForFilter)&&(filterPasses=!0)})):filterPasses=!0,filterPasses){if(0===result.length&&lastConsideredCol){!!emptySpaceBeforeColumn&&emptySpaceBeforeColumn(col)&&result.push(lastConsideredCol)}result.push(col)}lastConsideredCol=col}return result}getViewportCenterColumnsForRow(rowNode){if(!this.colSpanActive)return this.viewportColumnsCenter;const filterCallback=this.isColumnVirtualisationSuppressed()?null:this.isColumnInRowViewport.bind(this);return this.getDisplayedColumnsForRow(rowNode,this.displayedColumnsCenter,filterCallback,col=>{const left=col.getLeft();return exists(left)&&left>this.viewportLeft})}isColumnAtEdge(col,edge){const allColumns=this.getAllDisplayedColumns();if(!allColumns.length)return!1;const isFirst="first"===edge;let columnToCompare;if(col instanceof ColumnGroup){const leafColumns=col.getDisplayedLeafColumns();if(!leafColumns.length)return!1;columnToCompare=isFirst?leafColumns[0]:last(leafColumns)}else columnToCompare=col;return(isFirst?allColumns[0]:last(allColumns))===columnToCompare}getAriaColumnIndex(col){let targetColumn;return targetColumn=col instanceof ColumnGroup?col.getLeafColumns()[0]:col,this.ariaOrderColumns.indexOf(targetColumn)+1}isColumnInHeaderViewport(col){return!!col.isAutoHeaderHeight()||this.isColumnInRowViewport(col)}isColumnInRowViewport(col){if(col.isAutoHeight())return!0;const columnLeft=col.getLeft()||0,columnRight=columnLeft+col.getActualWidth(),leftBounds=this.viewportLeft-200,rightBounds=this.viewportRight+200;return!(columnLeft<leftBounds&&columnRight<leftBounds)&&!(columnLeft>rightBounds&&columnRight>rightBounds)}getDisplayedColumnsLeftWidth(){return this.getWidthOfColsInList(this.displayedColumnsLeft)}getDisplayedColumnsRightWidth(){return this.getWidthOfColsInList(this.displayedColumnsRight)}updatePrimaryColumnList(keys2,masterList,actionIsAdd,columnCallback,eventType,source){if(!keys2||missingOrEmpty(keys2))return;let atLeastOne=!1;if(keys2.forEach(key=>{if(!key)return;const columnToAdd=this.getPrimaryColumn(key);if(columnToAdd){if(actionIsAdd){if(masterList.indexOf(columnToAdd)>=0)return;masterList.push(columnToAdd)}else{if(masterList.indexOf(columnToAdd)<0)return;removeFromArray(masterList,columnToAdd)}columnCallback(columnToAdd),atLeastOne=!0}}),!atLeastOne)return;this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(source);const event={type:eventType,columns:masterList,column:1===masterList.length?masterList[0]:null,source};this.eventService.dispatchEvent(event)}setRowGroupColumns(colKeys,source){this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(colKeys,this.rowGroupColumns,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,!0,this.setRowGroupActive.bind(this),source)}setRowGroupActive(active,column,source){active!==column.isRowGroupActive()&&(column.setRowGroupActive(active,source),active&&!this.gos.get("suppressRowGroupHidesColumns")&&this.setColumnsVisible([column],!1,source),active||this.gos.get("suppressMakeColumnVisibleAfterUnGroup")||this.setColumnsVisible([column],!0,source))}addRowGroupColumns(keys2,source){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(keys2,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),Events.EVENT_COLUMN_ROW_GROUP_CHANGED,source)}removeRowGroupColumns(keys2,source){this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(keys2,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),Events.EVENT_COLUMN_ROW_GROUP_CHANGED,source)}addPivotColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.pivotColumns,!0,column=>column.setPivotActive(!0,source),Events.EVENT_COLUMN_PIVOT_CHANGED,source)}setPivotColumns(colKeys,source){this.setPrimaryColumnList(colKeys,this.pivotColumns,Events.EVENT_COLUMN_PIVOT_CHANGED,!0,(added,column)=>{column.setPivotActive(added,source)},source)}removePivotColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.pivotColumns,!1,column=>column.setPivotActive(!1,source),Events.EVENT_COLUMN_PIVOT_CHANGED,source)}setPrimaryColumnList(colKeys,masterList,eventName,detectOrderChange,columnCallback,source){if(!this.gridColumns)return;const changes=new Map;masterList.forEach((col,idx)=>changes.set(col,idx)),masterList.length=0,exists(colKeys)&&colKeys.forEach(key=>{const column=this.getPrimaryColumn(key);column&&masterList.push(column)}),masterList.forEach((col,idx)=>{const oldIndex=changes.get(col);void 0!==oldIndex?detectOrderChange&&oldIndex!==idx||changes.delete(col):changes.set(col,0)}),(this.primaryColumns||[]).forEach(column=>{const added=masterList.indexOf(column)>=0;columnCallback(added,column)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(source),this.dispatchColumnChangedEvent(eventName,[...changes.keys()],source)}setValueColumns(colKeys,source){this.setPrimaryColumnList(colKeys,this.valueColumns,Events.EVENT_COLUMN_VALUE_CHANGED,!1,this.setValueActive.bind(this),source)}setValueActive(active,column,source){if(active!==column.isValueActive()&&(column.setValueActive(active,source),active&&!column.getAggFunc()&&this.aggFuncService)){const initialAggFunc=this.aggFuncService.getDefaultAggFunc(column);column.setAggFunc(initialAggFunc)}}addValueColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.valueColumns,!0,this.setValueActive.bind(this,!0),Events.EVENT_COLUMN_VALUE_CHANGED,source)}removeValueColumns(keys2,source){this.updatePrimaryColumnList(keys2,this.valueColumns,!1,this.setValueActive.bind(this,!1),Events.EVENT_COLUMN_VALUE_CHANGED,source)}normaliseColumnWidth(column,newWidth){const minWidth=column.getMinWidth();exists(minWidth)&&newWidth<minWidth&&(newWidth=minWidth);const maxWidth=column.getMaxWidth();return exists(maxWidth)&&column.isGreaterThanMax(newWidth)&&(newWidth=maxWidth),newWidth}getPrimaryOrGridColumn(key){return this.getPrimaryColumn(key)||this.getGridColumn(key)}setColumnWidths(columnWidths,shiftKey,finished,source){const sets=[];columnWidths.forEach(columnWidth=>{const col=this.getPrimaryOrGridColumn(columnWidth.key);if(!col)return;sets.push({width:columnWidth.newWidth,ratios:[1],columns:[col]});if("shift"===this.gos.get("colResizeDefault")&&(shiftKey=!shiftKey),shiftKey){const otherCol=this.getDisplayedColAfter(col);if(!otherCol)return;const widthDiff=col.getActualWidth()-columnWidth.newWidth,otherColWidth=otherCol.getActualWidth()+widthDiff;sets.push({width:otherColWidth,ratios:[1],columns:[otherCol]})}}),0!==sets.length&&this.resizeColumnSets({resizeSets:sets,finished,source})}checkMinAndMaxWidthsForSet(columnResizeSet){const{columns,width}=columnResizeSet;let minWidthAccumulated=0,maxWidthAccumulated=0,maxWidthActive=!0;columns.forEach(col=>{const minWidth=col.getMinWidth();minWidthAccumulated+=minWidth||0;const maxWidth=col.getMaxWidth();exists(maxWidth)&&maxWidth>0?maxWidthAccumulated+=maxWidth:maxWidthActive=!1});return width>=minWidthAccumulated&&(!maxWidthActive||width<=maxWidthAccumulated)}resizeColumnSets(params){const{resizeSets,finished,source}=params;if(!(!resizeSets||resizeSets.every(columnResizeSet=>this.checkMinAndMaxWidthsForSet(columnResizeSet)))){if(finished){const columns=resizeSets&&resizeSets.length>0?resizeSets[0].columns:null;this.dispatchColumnResizedEvent(columns,finished,source)}return}const changedCols=[],allResizedCols=[];resizeSets.forEach(set=>{const{width,columns,ratios}=set,newWidths={},finishedCols={};columns.forEach(col=>allResizedCols.push(col));let finishedColsGrew=!0,loopCount=0;for(;finishedColsGrew;){if(loopCount++,loopCount>1e3){console.error("AG Grid: infinite loop in resizeColumnSets");break}finishedColsGrew=!1;const subsetCols=[];let subsetRatioTotal=0,pixelsToDistribute=width;columns.forEach((col,index)=>{if(finishedCols[col.getId()])pixelsToDistribute-=newWidths[col.getId()];else{subsetCols.push(col);const ratioThisCol=ratios[index];subsetRatioTotal+=ratioThisCol}});const ratioScale=1/subsetRatioTotal;subsetCols.forEach((col,index)=>{let colNewWidth;index===subsetCols.length-1?colNewWidth=pixelsToDistribute:(colNewWidth=Math.round(ratios[index]*width*ratioScale),pixelsToDistribute-=colNewWidth);const minWidth=col.getMinWidth(),maxWidth=col.getMaxWidth();exists(minWidth)&&colNewWidth<minWidth?(colNewWidth=minWidth,finishedCols[col.getId()]=!0,finishedColsGrew=!0):exists(maxWidth)&&maxWidth>0&&colNewWidth>maxWidth&&(colNewWidth=maxWidth,finishedCols[col.getId()]=!0,finishedColsGrew=!0),newWidths[col.getId()]=colNewWidth})}columns.forEach(col=>{const newWidth=newWidths[col.getId()];col.getActualWidth()!==newWidth&&(col.setActualWidth(newWidth,source),changedCols.push(col))})});const atLeastOneColChanged=changedCols.length>0;let flexedCols=[];atLeastOneColChanged&&(flexedCols=this.refreshFlexedColumns({resizingCols:allResizedCols,skipSetLeft:!0}),this.setLeftValues(source),this.updateBodyWidths(),this.checkViewportColumns());const colsForEvent=allResizedCols.concat(flexedCols);(atLeastOneColChanged||finished)&&this.dispatchColumnResizedEvent(colsForEvent,finished,source,flexedCols)}setColumnAggFunc(key,aggFunc,source){if(!key)return;const column=this.getPrimaryColumn(key);column&&(column.setAggFunc(aggFunc),this.dispatchColumnChangedEvent(Events.EVENT_COLUMN_VALUE_CHANGED,[column],source))}moveRowGroupColumn(fromIndex,toIndex,source){if(this.isRowGroupEmpty())return;const column=this.rowGroupColumns[fromIndex],impactedColumns=this.rowGroupColumns.slice(fromIndex,toIndex);this.rowGroupColumns.splice(fromIndex,1),this.rowGroupColumns.splice(toIndex,0,column);const event={type:Events.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:impactedColumns,column:1===impactedColumns.length?impactedColumns[0]:null,source};this.eventService.dispatchEvent(event)}moveColumns(columnsToMoveKeys,toIndex,source,finished=!0){if(!this.gridColumns)return;if(this.columnAnimationService.start(),toIndex>this.gridColumns.length-columnsToMoveKeys.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+toIndex),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");const movedColumns=this.getGridColumns(columnsToMoveKeys);!this.doesMovePassRules(movedColumns,toIndex)||(moveInArray(this.gridColumns,movedColumns,toIndex),this.updateDisplayedColumns(source),this.dispatchColumnMovedEvent({movedColumns,source,toIndex,finished}),this.columnAnimationService.finish())}doesMovePassRules(columnsToMove,toIndex){const proposedColumnOrder=this.getProposedColumnOrder(columnsToMove,toIndex);return this.doesOrderPassRules(proposedColumnOrder)}doesOrderPassRules(gridOrder){return!!this.doesMovePassMarryChildren(gridOrder)&&!!this.doesMovePassLockedPositions(gridOrder)}getProposedColumnOrder(columnsToMove,toIndex){const proposedColumnOrder=this.gridColumns.slice();return moveInArray(proposedColumnOrder,columnsToMove,toIndex),proposedColumnOrder}sortColumnsLikeGridColumns(cols){if(!cols||cols.length<=1)return;cols.filter(c=>this.gridColumns.indexOf(c)<0).length>0||cols.sort((a,b)=>this.gridColumns.indexOf(a)-this.gridColumns.indexOf(b))}doesMovePassLockedPositions(proposedColumnOrder){let lastPlacement=0,rulePassed=!0;return proposedColumnOrder.forEach(col=>{const placement=(position=col.getColDef().lockPosition)?!0===position||"left"===position?0:2:1;var position;placement<lastPlacement&&(rulePassed=!1),lastPlacement=placement}),rulePassed}doesMovePassMarryChildren(allColumnsCopy){let rulePassed=!0;return depthFirstOriginalTreeSearch(null,this.gridBalancedTree,child=>{if(!(child instanceof ProvidedColumnGroup))return;const columnGroup=child,colGroupDef=columnGroup.getColGroupDef();if(!(colGroupDef&&colGroupDef.marryChildren))return;const newIndexes=[];columnGroup.getLeafColumns().forEach(col=>{const newColIndex=allColumnsCopy.indexOf(col);newIndexes.push(newColIndex)});Math.max.apply(Math,newIndexes)-Math.min.apply(Math,newIndexes)>columnGroup.getLeafColumns().length-1&&(rulePassed=!1)}),rulePassed}moveColumnByIndex(fromIndex,toIndex,source){if(!this.gridColumns)return;const column=this.gridColumns[fromIndex];this.moveColumns([column],toIndex,source)}getColumnDefs(){if(!this.primaryColumns)return;const cols=this.primaryColumns.slice();return this.gridColsArePrimary?cols.sort((a,b)=>this.gridColumns.indexOf(a)-this.gridColumns.indexOf(b)):this.lastPrimaryOrder&&cols.sort((a,b)=>this.lastPrimaryOrder.indexOf(a)-this.lastPrimaryOrder.indexOf(b)),this.columnDefFactory.buildColumnDefs(cols,this.rowGroupColumns,this.pivotColumns)}getBodyContainerWidth(){return this.bodyWidth}getContainerWidth(pinned){switch(pinned){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}updateBodyWidths(){const newBodyWidth=this.getWidthOfColsInList(this.displayedColumnsCenter),newLeftWidth=this.getWidthOfColsInList(this.displayedColumnsLeft),newRightWidth=this.getWidthOfColsInList(this.displayedColumnsRight);this.bodyWidthDirty=this.bodyWidth!==newBodyWidth;if(this.bodyWidth!==newBodyWidth||this.leftWidth!==newLeftWidth||this.rightWidth!==newRightWidth){this.bodyWidth=newBodyWidth,this.leftWidth=newLeftWidth,this.rightWidth=newRightWidth;const evt={type:Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED};this.eventService.dispatchEvent(evt);const event={type:Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED};this.eventService.dispatchEvent(event)}}getValueColumns(){return this.valueColumns?this.valueColumns:[]}getPivotColumns(){return this.pivotColumns?this.pivotColumns:[]}isPivotActive(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode}getRowGroupColumns(){return this.rowGroupColumns?this.rowGroupColumns:[]}getDisplayedCenterColumns(){return this.displayedColumnsCenter}getDisplayedLeftColumns(){return this.displayedColumnsLeft}getDisplayedRightColumns(){return this.displayedColumnsRight}getAllPrimaryColumns(){return this.primaryColumns?this.primaryColumns:null}getSecondaryColumns(){return this.secondaryColumns?this.secondaryColumns:null}getAllColumnsForQuickFilter(){return this.columnsForQuickFilter}getAllGridColumns(){var _a;return null!=(_a=this.gridColumns)?_a:[]}isRowGroupEmpty(){return missingOrEmpty(this.rowGroupColumns)}setColumnsVisible(keys2,visible=!1,source){this.applyColumnState({state:keys2.map(key=>({colId:"string"==typeof key?key:key.getColId(),hide:!visible}))},source)}setColumnsPinned(keys2,pinned,source){if(!this.gridColumns)return;if(this.gos.isDomLayout("print"))return void console.warn("AG Grid: Changing the column pinning status is not allowed with domLayout='print'");let actualPinned;this.columnAnimationService.start(),actualPinned=!0===pinned||"left"===pinned?"left":"right"===pinned?"right":null,this.actionOnGridColumns(keys2,col=>col.getPinned()!==actualPinned&&(col.setPinned(actualPinned),!0),source,()=>({type:Events.EVENT_COLUMN_PINNED,pinned:actualPinned,column:null,columns:null,source})),this.columnAnimationService.finish()}actionOnGridColumns(keys2,action,source,createEvent){if(missingOrEmpty(keys2))return;const updatedColumns=[];if(keys2.forEach(key=>{if(!key)return;const column=this.getGridColumn(key);if(!column)return;!1!==action(column)&&updatedColumns.push(column)}),updatedColumns.length&&(this.updateDisplayedColumns(source),exists(createEvent)&&createEvent)){const event=createEvent();event.columns=updatedColumns,event.column=1===updatedColumns.length?updatedColumns[0]:null,this.eventService.dispatchEvent(event)}}getDisplayedColBefore(col){const allDisplayedColumns=this.getAllDisplayedColumns(),oldIndex=allDisplayedColumns.indexOf(col);return oldIndex>0?allDisplayedColumns[oldIndex-1]:null}getDisplayedColAfter(col){const allDisplayedColumns=this.getAllDisplayedColumns(),oldIndex=allDisplayedColumns.indexOf(col);return oldIndex<allDisplayedColumns.length-1?allDisplayedColumns[oldIndex+1]:null}getDisplayedGroupAtDirection(columnGroup,direction){const requiredLevel=columnGroup.getProvidedColumnGroup().getLevel()+columnGroup.getPaddingLevel(),colGroupLeafColumns=columnGroup.getDisplayedLeafColumns(),col="After"===direction?last(colGroupLeafColumns):colGroupLeafColumns[0],getDisplayColMethod=`getDisplayedCol${direction}`;for(;;){const column=this[getDisplayColMethod](col);if(!column)return null;const groupPointer=this.getColumnGroupAtLevel(column,requiredLevel);if(groupPointer!==columnGroup)return groupPointer}}getColumnGroupAtLevel(column,level){let originalGroupLevel,groupPointerLevel,groupPointer=column.getParent();for(;;){if(originalGroupLevel=groupPointer.getProvidedColumnGroup().getLevel(),groupPointerLevel=groupPointer.getPaddingLevel(),originalGroupLevel+groupPointerLevel<=level)break;groupPointer=groupPointer.getParent()}return groupPointer}isPinningLeft(){return this.displayedColumnsLeft.length>0}isPinningRight(){return this.displayedColumnsRight.length>0}getPrimaryAndSecondaryAndAutoColumns(){return[].concat(this.primaryColumns||[],this.groupAutoColumns||[],this.secondaryColumns||[])}createStateItemFromColumn(column){const rowGroupIndex=column.isRowGroupActive()?this.rowGroupColumns.indexOf(column):null,pivotIndex=column.isPivotActive()?this.pivotColumns.indexOf(column):null,aggFunc=column.isValueActive()?column.getAggFunc():null,sort=null!=column.getSort()?column.getSort():null,sortIndex=null!=column.getSortIndex()?column.getSortIndex():null,flex=null!=column.getFlex()&&column.getFlex()>0?column.getFlex():null;return{colId:column.getColId(),width:column.getActualWidth(),hide:!column.isVisible(),pinned:column.getPinned(),sort,sortIndex,aggFunc,rowGroup:column.isRowGroupActive(),rowGroupIndex,pivot:column.isPivotActive(),pivotIndex,flex}}getColumnState(){if(missing(this.primaryColumns)||!this.isAlive())return[];const res=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.orderColumnStateList(res),res}orderColumnStateList(columnStateList){const colIdToGridIndexMap=convertToMap(this.gridColumns.map((col,index)=>[col.getColId(),index]));columnStateList.sort((itemA,itemB)=>(colIdToGridIndexMap.has(itemA.colId)?colIdToGridIndexMap.get(itemA.colId):-1)-(colIdToGridIndexMap.has(itemB.colId)?colIdToGridIndexMap.get(itemB.colId):-1))}resetColumnState(source){if(missingOrEmpty(this.primaryColumns))return;const primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),columnStates=[];let letRowGroupIndex=1e3,letPivotIndex=1e3,colsToProcess=[];this.groupAutoColumns&&(colsToProcess=colsToProcess.concat(this.groupAutoColumns)),primaryColumns&&(colsToProcess=colsToProcess.concat(primaryColumns)),colsToProcess.forEach(column=>{const stateItem=this.getColumnStateFromColDef(column);missing(stateItem.rowGroupIndex)&&stateItem.rowGroup&&(stateItem.rowGroupIndex=letRowGroupIndex++),missing(stateItem.pivotIndex)&&stateItem.pivot&&(stateItem.pivotIndex=letPivotIndex++),columnStates.push(stateItem)}),this.applyColumnState({state:columnStates,applyOrder:!0},source)}getColumnStateFromColDef(column){const getValueOrNull=(a,b)=>null!=a?a:null!=b?b:null,colDef=column.getColDef(),sort=getValueOrNull(colDef.sort,colDef.initialSort),sortIndex=getValueOrNull(colDef.sortIndex,colDef.initialSortIndex),hide=getValueOrNull(colDef.hide,colDef.initialHide),pinned=getValueOrNull(colDef.pinned,colDef.initialPinned),width=getValueOrNull(colDef.width,colDef.initialWidth),flex=getValueOrNull(colDef.flex,colDef.initialFlex);let rowGroupIndex=getValueOrNull(colDef.rowGroupIndex,colDef.initialRowGroupIndex),rowGroup=getValueOrNull(colDef.rowGroup,colDef.initialRowGroup);null!=rowGroupIndex||null!=rowGroup&&0!=rowGroup||(rowGroupIndex=null,rowGroup=null);let pivotIndex=getValueOrNull(colDef.pivotIndex,colDef.initialPivotIndex),pivot=getValueOrNull(colDef.pivot,colDef.initialPivot);null!=pivotIndex||null!=pivot&&0!=pivot||(pivotIndex=null,pivot=null);const aggFunc=getValueOrNull(colDef.aggFunc,colDef.initialAggFunc);return{colId:column.getColId(),sort,sortIndex,hide,pinned,width,flex,rowGroup,rowGroupIndex,pivot,pivotIndex,aggFunc}}applyColumnState(params,source){if(missingOrEmpty(this.primaryColumns))return!1;if(params&&params.state&&!params.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;const applyStates=(states,existingColumns,getById)=>{const dispatchEventsFunc=this.compareColumnStatesAndDispatchEvents(source);this.autoGroupsNeedBuilding=!0;const columnsWithNoState=existingColumns.slice(),rowGroupIndexes={},pivotIndexes={},autoGroupColumnStates=[],unmatchedAndAutoStates2=[];let unmatchedCount2=0;const previousRowGroupCols=this.rowGroupColumns.slice(),previousPivotCols=this.pivotColumns.slice();states.forEach(state=>{const colId=state.colId||"";if(colId.startsWith("ag-Grid-AutoColumn"))return autoGroupColumnStates.push(state),void unmatchedAndAutoStates2.push(state);const column=getById(colId);column?(this.syncColumnWithStateItem(column,state,params.defaultState,rowGroupIndexes,pivotIndexes,!1,source),removeFromArray(columnsWithNoState,column)):(unmatchedAndAutoStates2.push(state),unmatchedCount2+=1)});const applyDefaultsFunc=col=>this.syncColumnWithStateItem(col,null,params.defaultState,rowGroupIndexes,pivotIndexes,!1,source);columnsWithNoState.forEach(applyDefaultsFunc);const comparator=(indexes,oldList,colA,colB)=>{const indexA=indexes[colA.getId()],indexB=indexes[colB.getId()],aHasIndex=null!=indexA,bHasIndex=null!=indexB;if(aHasIndex&&bHasIndex)return indexA-indexB;if(aHasIndex)return-1;if(bHasIndex)return 1;const oldIndexA=oldList.indexOf(colA),oldIndexB=oldList.indexOf(colB),aHasOldIndex=oldIndexA>=0;return aHasOldIndex&&oldIndexB>=0?oldIndexA-oldIndexB:aHasOldIndex?-1:1};this.rowGroupColumns.sort(comparator.bind(this,rowGroupIndexes,previousRowGroupCols)),this.pivotColumns.sort(comparator.bind(this,pivotIndexes,previousPivotCols)),this.updateGridColumns();const autoGroupColsCopy=this.groupAutoColumns?this.groupAutoColumns.slice():[];return autoGroupColumnStates.forEach(stateItem=>{const autoCol=this.getAutoColumn(stateItem.colId);removeFromArray(autoGroupColsCopy,autoCol),this.syncColumnWithStateItem(autoCol,stateItem,params.defaultState,null,null,!0,source)}),autoGroupColsCopy.forEach(applyDefaultsFunc),this.applyOrderAfterApplyState(params),this.updateDisplayedColumns(source),this.dispatchEverythingChanged(source),dispatchEventsFunc(),{unmatchedAndAutoStates:unmatchedAndAutoStates2,unmatchedCount:unmatchedCount2}};this.columnAnimationService.start();let{unmatchedAndAutoStates,unmatchedCount}=applyStates(params.state||[],this.primaryColumns||[],id=>this.getPrimaryColumn(id));return(unmatchedAndAutoStates.length>0||exists(params.defaultState))&&(unmatchedCount=applyStates(unmatchedAndAutoStates,this.secondaryColumns||[],id=>this.getSecondaryColumn(id)).unmatchedCount),this.columnAnimationService.finish(),0===unmatchedCount}applyOrderAfterApplyState(params){if(!params.applyOrder||!params.state)return;let newOrder=[];const processedColIds={};params.state.forEach(item=>{if(!item.colId||processedColIds[item.colId])return;const col=this.gridColumnsMap[item.colId];col&&(newOrder.push(col),processedColIds[item.colId]=!0)});let autoGroupInsertIndex=0;this.gridColumns.forEach(col=>{const colId=col.getColId();if(null!=processedColIds[colId])return;colId.startsWith("ag-Grid-AutoColumn")?insertIntoArray(newOrder,col,autoGroupInsertIndex++):newOrder.push(col)}),newOrder=this.placeLockedColumns(newOrder),this.doesMovePassMarryChildren(newOrder)?this.gridColumns=newOrder:console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.")}compareColumnStatesAndDispatchEvents(source){const startState={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},columnStateBefore=this.getColumnState(),columnStateBeforeMap={};return columnStateBefore.forEach(col=>{columnStateBeforeMap[col.colId]=col}),()=>{const colsForState=this.getPrimaryAndSecondaryAndAutoColumns(),dispatchWhenListsDifferent=(eventType,colsBefore,colsAfter,idMapper)=>{if(areEqual(colsBefore.map(idMapper),colsAfter.map(idMapper)))return;const changes=new Set(colsBefore);colsAfter.forEach(id=>{changes.delete(id)||changes.add(id)});const changesArr=[...changes],event={type:eventType,columns:changesArr,column:1===changesArr.length?changesArr[0]:null,source};this.eventService.dispatchEvent(event)},getChangedColumns=changedPredicate=>{const changedColumns2=[];return colsForState.forEach(column=>{const colStateBefore=columnStateBeforeMap[column.getColId()];colStateBefore&&changedPredicate(colStateBefore,column)&&changedColumns2.push(column)}),changedColumns2},columnIdMapper=c=>c.getColId();dispatchWhenListsDifferent(Events.EVENT_COLUMN_ROW_GROUP_CHANGED,startState.rowGroupColumns,this.rowGroupColumns,columnIdMapper),dispatchWhenListsDifferent(Events.EVENT_COLUMN_PIVOT_CHANGED,startState.pivotColumns,this.pivotColumns,columnIdMapper);const changedValues=getChangedColumns((cs,c)=>{const oldActive=null!=cs.aggFunc,activeChanged=oldActive!=c.isValueActive(),aggFuncChanged=oldActive&&cs.aggFunc!=c.getAggFunc();return activeChanged||aggFuncChanged});changedValues.length>0&&this.dispatchColumnChangedEvent(Events.EVENT_COLUMN_VALUE_CHANGED,changedValues,source);this.dispatchColumnResizedEvent(getChangedColumns((cs,c)=>cs.width!=c.getActualWidth()),!0,source);this.dispatchColumnPinnedEvent(getChangedColumns((cs,c)=>cs.pinned!=c.getPinned()),source);this.dispatchColumnVisibleEvent(getChangedColumns((cs,c)=>cs.hide==c.isVisible()),source);const changedColumns=getChangedColumns((cs,c)=>cs.sort!=c.getSort()||cs.sortIndex!=c.getSortIndex());changedColumns.length>0&&this.sortController.dispatchSortChangedEvents(source,changedColumns),this.normaliseColumnMovedEventForColumnState(columnStateBefore,source)}}getCommonValue(cols,valueGetter){if(!cols||0==cols.length)return;const firstValue=valueGetter(cols[0]);for(let i=1;i<cols.length;i++)if(firstValue!==valueGetter(cols[i]))return;return firstValue}normaliseColumnMovedEventForColumnState(colStateBefore,source){const colStateAfter=this.getColumnState(),colStateAfterMapped={};colStateAfter.forEach(s=>colStateAfterMapped[s.colId]=s);const colsIntersectIds={};colStateBefore.forEach(s=>{colStateAfterMapped[s.colId]&&(colsIntersectIds[s.colId]=!0)});const beforeFiltered=colStateBefore.filter(c=>colsIntersectIds[c.colId]),afterFiltered=colStateAfter.filter(c=>colsIntersectIds[c.colId]),movedColumns=[];afterFiltered.forEach((csAfter,index)=>{const csBefore=beforeFiltered&&beforeFiltered[index];if(csBefore&&csBefore.colId!==csAfter.colId){const gridCol=this.getGridColumn(csBefore.colId);gridCol&&movedColumns.push(gridCol)}}),movedColumns.length&&this.dispatchColumnMovedEvent({movedColumns,source,finished:!0})}syncColumnWithStateItem(column,stateItem,defaultState,rowGroupIndexes,pivotIndexes,autoCol,source){var _a;if(!column)return;const getValue=(key1,key2)=>{const obj={value1:void 0,value2:void 0};let calculated=!1;return stateItem&&(void 0!==stateItem[key1]&&(obj.value1=stateItem[key1],calculated=!0),exists(key2)&&void 0!==stateItem[key2]&&(obj.value2=stateItem[key2],calculated=!0)),!calculated&&defaultState&&(void 0!==defaultState[key1]&&(obj.value1=defaultState[key1]),exists(key2)&&void 0!==defaultState[key2]&&(obj.value2=defaultState[key2])),obj},hide=getValue("hide").value1;void 0!==hide&&column.setVisible(!hide,source);const pinned=getValue("pinned").value1;void 0!==pinned&&column.setPinned(pinned);const minColWidth=null!=(_a=column.getColDef().minWidth)?_a:this.environment.getMinColWidth(),flex=getValue("flex").value1;if(void 0!==flex&&column.setFlex(flex),null==flex){const width=getValue("width").value1;null!=width&&null!=minColWidth&&width>=minColWidth&&column.setActualWidth(width,source)}const sort=getValue("sort").value1;void 0!==sort&&("desc"===sort||"asc"===sort?column.setSort(sort,source):column.setSort(void 0,source));const sortIndex=getValue("sortIndex").value1;if(void 0!==sortIndex&&column.setSortIndex(sortIndex),autoCol||!column.isPrimary())return;const aggFunc=getValue("aggFunc").value1;void 0!==aggFunc&&("string"==typeof aggFunc?(column.setAggFunc(aggFunc),column.isValueActive()||(column.setValueActive(!0,source),this.valueColumns.push(column))):(exists(aggFunc)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),column.isValueActive()&&(column.setValueActive(!1,source),removeFromArray(this.valueColumns,column))));const{value1:rowGroup,value2:rowGroupIndex}=getValue("rowGroup","rowGroupIndex");void 0===rowGroup&&void 0===rowGroupIndex||("number"==typeof rowGroupIndex||rowGroup?(column.isRowGroupActive()||(column.setRowGroupActive(!0,source),this.rowGroupColumns.push(column)),rowGroupIndexes&&"number"==typeof rowGroupIndex&&(rowGroupIndexes[column.getId()]=rowGroupIndex)):column.isRowGroupActive()&&(column.setRowGroupActive(!1,source),removeFromArray(this.rowGroupColumns,column)));const{value1:pivot,value2:pivotIndex}=getValue("pivot","pivotIndex");void 0===pivot&&void 0===pivotIndex||("number"==typeof pivotIndex||pivot?(column.isPivotActive()||(column.setPivotActive(!0,source),this.pivotColumns.push(column)),pivotIndexes&&"number"==typeof pivotIndex&&(pivotIndexes[column.getId()]=pivotIndex)):column.isPivotActive()&&(column.setPivotActive(!1,source),removeFromArray(this.pivotColumns,column)))}getGridColumns(keys2){return this.getColumns(keys2,this.getGridColumn.bind(this))}getColumns(keys2,columnLookupCallback){const foundColumns=[];return keys2&&keys2.forEach(key=>{const column=columnLookupCallback(key);column&&foundColumns.push(column)}),foundColumns}getColumnWithValidation(key){if(null==key)return null;const column=this.getGridColumn(key);return column||console.warn("AG Grid: could not find column "+key),column}getPrimaryColumn(key){return this.primaryColumns?this.getColumn(key,this.primaryColumns,this.primaryColumnsMap):null}getGridColumn(key){return this.getColumn(key,this.gridColumns,this.gridColumnsMap)}lookupGridColumn(key){return this.gridColumnsMap[key]}getSecondaryColumn(key){return this.secondaryColumns?this.getColumn(key,this.secondaryColumns,this.secondaryColumnsMap):null}getColumn(key,columnList,columnMap){if(!key||!columnMap)return null;if("string"==typeof key&&columnMap[key])return columnMap[key];for(let i=0;i<columnList.length;i++)if(this.columnsMatch(columnList[i],key))return columnList[i];return this.getAutoColumn(key)}getSourceColumnsForGroupColumn(groupCol){const sourceColumnId=groupCol.getColDef().showRowGroup;if(!sourceColumnId)return null;if(!0===sourceColumnId)return this.rowGroupColumns.slice(0);const column=this.getPrimaryColumn(sourceColumnId);return column?[column]:null}getAutoColumn(key){return this.groupAutoColumns&&exists(this.groupAutoColumns)&&!missing(this.groupAutoColumns)&&this.groupAutoColumns.find(groupCol=>this.columnsMatch(groupCol,key))||null}columnsMatch(column,key){const columnMatches=column===key,colDefMatches=column.getColDef()===key,idMatches=column.getColId()==key;return columnMatches||colDefMatches||idMatches}getDisplayNameForColumn(column,location,includeAggFunc=!1){if(!column)return null;const headerName=this.getHeaderName(column.getColDef(),column,null,null,location);return includeAggFunc?this.wrapHeaderNameWithAggFunc(column,headerName):headerName}getDisplayNameForProvidedColumnGroup(columnGroup,providedColumnGroup,location){const colGroupDef=providedColumnGroup?providedColumnGroup.getColGroupDef():null;return colGroupDef?this.getHeaderName(colGroupDef,null,columnGroup,providedColumnGroup,location):null}getDisplayNameForColumnGroup(columnGroup,location){return this.getDisplayNameForProvidedColumnGroup(columnGroup,columnGroup.getProvidedColumnGroup(),location)}getHeaderName(colDef,column,columnGroup,providedColumnGroup,location){const headerValueGetter=colDef.headerValueGetter;if(headerValueGetter){const params=this.gos.addGridCommonParams({colDef,column,columnGroup,providedColumnGroup,location});return"function"==typeof headerValueGetter?headerValueGetter(params):"string"==typeof headerValueGetter?this.expressionService.evaluate(headerValueGetter,params):(console.warn("AG Grid: headerValueGetter must be a function or a string"),"")}return null!=colDef.headerName?colDef.headerName:colDef.field?camelCaseToHumanText(colDef.field):""}wrapHeaderNameWithAggFunc(column,headerName){if(this.gos.get("suppressAggFuncInHeader"))return headerName;const pivotValueColumn=column.getColDef().pivotValueColumn;let aggFuncFound,aggFunc=null;if(exists(pivotValueColumn)){const isCollapsedHeaderEnabled=this.gos.get("removePivotHeaderRowWhenSingleValueColumn")&&1===this.valueColumns.length,isTotalColumn=void 0!==column.getColDef().pivotTotalColumnIds;if(isCollapsedHeaderEnabled&&!isTotalColumn)return headerName;aggFunc=pivotValueColumn?pivotValueColumn.getAggFunc():null,aggFuncFound=!0}else{const measureActive=column.isValueActive(),aggregationPresent=this.pivotMode||!this.isRowGroupEmpty();measureActive&&aggregationPresent?(aggFunc=column.getAggFunc(),aggFuncFound=!0):aggFuncFound=!1}if(aggFuncFound){const aggFuncString="string"==typeof aggFunc?aggFunc:"func";return`${this.localeService.getLocaleTextFunc()(aggFuncString,aggFuncString)}(${headerName})`}return headerName}getColumnGroup(colId,partId){if(!colId)return null;if(colId instanceof ColumnGroup)return colId;const allColumnGroups=this.getAllDisplayedTrees(),checkPartId="number"==typeof partId;let result=null;return depthFirstAllColumnTreeSearch(allColumnGroups,!1,child=>{if(child instanceof ColumnGroup){const columnGroup=child;let matched;matched=checkPartId?colId===columnGroup.getGroupId()&&partId===columnGroup.getPartId():colId===columnGroup.getGroupId(),matched&&(result=columnGroup)}}),result}isReady(){return this.ready}extractValueColumns(source,oldPrimaryColumns){this.valueColumns=this.extractColumns(oldPrimaryColumns,this.valueColumns,(col,flag)=>col.setValueActive(flag,source),()=>{},()=>{},colDef=>{const aggFunc=colDef.aggFunc;return null===aggFunc||""===aggFunc?null:void 0!==aggFunc?!!aggFunc:void 0},colDef=>null!=colDef.initialAggFunc&&""!=colDef.initialAggFunc),this.valueColumns.forEach(col=>{const colDef=col.getColDef();null!=colDef.aggFunc&&""!=colDef.aggFunc?col.setAggFunc(colDef.aggFunc):col.getAggFunc()||col.setAggFunc(colDef.initialAggFunc)})}extractRowGroupColumns(source,oldPrimaryColumns){this.rowGroupColumns=this.extractColumns(oldPrimaryColumns,this.rowGroupColumns,(col,flag)=>col.setRowGroupActive(flag,source),colDef=>colDef.rowGroupIndex,colDef=>colDef.initialRowGroupIndex,colDef=>colDef.rowGroup,colDef=>colDef.initialRowGroup)}extractColumns(oldPrimaryColumns=[],previousCols=[],setFlagFunc,getIndexFunc,getInitialIndexFunc,getValueFunc,getInitialValueFunc){const colsWithIndex=[],colsWithValue=[];(this.primaryColumns||[]).forEach(col=>{const colIsNew=oldPrimaryColumns.indexOf(col)<0,colDef=col.getColDef(),value=attrToBoolean(getValueFunc(colDef)),initialValue=attrToBoolean(getInitialValueFunc(colDef)),index=attrToNumber(getIndexFunc(colDef)),initialIndex=attrToNumber(getInitialIndexFunc(colDef));let include;if(include=void 0!==value?value:void 0!==index?null!==index&&index>=0:colIsNew?void 0!==initialValue?initialValue:!!(void 0!==initialIndex)&&(null!=initialIndex&&initialIndex>=0):previousCols.indexOf(col)>=0,include){(colIsNew?null!=index||null!=initialIndex:null!=index)?colsWithIndex.push(col):colsWithValue.push(col)}});const getIndexForCol=col=>{const index=getIndexFunc(col.getColDef()),defaultIndex=getInitialIndexFunc(col.getColDef());return null!=index?index:defaultIndex};colsWithIndex.sort((colA,colB)=>{const indexA=getIndexForCol(colA),indexB=getIndexForCol(colB);return indexA===indexB?0:indexA<indexB?-1:1});const res=[].concat(colsWithIndex);return previousCols.forEach(col=>{colsWithValue.indexOf(col)>=0&&res.push(col)}),colsWithValue.forEach(col=>{res.indexOf(col)<0&&res.push(col)}),previousCols.forEach(col=>{res.indexOf(col)<0&&setFlagFunc(col,!1)}),res.forEach(col=>{previousCols.indexOf(col)<0&&setFlagFunc(col,!0)}),res}extractPivotColumns(source,oldPrimaryColumns){this.pivotColumns=this.extractColumns(oldPrimaryColumns,this.pivotColumns,(col,flag)=>col.setPivotActive(flag,source),colDef=>colDef.pivotIndex,colDef=>colDef.initialPivotIndex,colDef=>colDef.pivot,colDef=>colDef.initialPivot)}resetColumnGroupState(source){if(!this.primaryColumnTree)return;const stateItems=[];depthFirstOriginalTreeSearch(null,this.primaryColumnTree,child=>{if(child instanceof ProvidedColumnGroup){const colGroupDef=child.getColGroupDef(),groupState={groupId:child.getGroupId(),open:colGroupDef?colGroupDef.openByDefault:void 0};stateItems.push(groupState)}}),this.setColumnGroupState(stateItems,source)}getColumnGroupState(){const columnGroupState=[];return depthFirstOriginalTreeSearch(null,this.gridBalancedTree,node=>{node instanceof ProvidedColumnGroup&&columnGroupState.push({groupId:node.getGroupId(),open:node.isExpanded()})}),columnGroupState}setColumnGroupState(stateItems,source){if(!this.gridBalancedTree)return;this.columnAnimationService.start();const impactedGroups=[];if(stateItems.forEach(stateItem=>{const groupKey=stateItem.groupId,newValue=stateItem.open,providedColumnGroup=this.getProvidedColumnGroup(groupKey);providedColumnGroup&&providedColumnGroup.isExpanded()!==newValue&&(this.logger.log("columnGroupOpened("+providedColumnGroup.getGroupId()+","+newValue+")"),providedColumnGroup.setExpanded(newValue),impactedGroups.push(providedColumnGroup))}),this.updateGroupsAndDisplayedColumns(source),this.setFirstRightAndLastLeftPinned(source),impactedGroups.length){const event={type:Events.EVENT_COLUMN_GROUP_OPENED,columnGroup:void 0,columnGroups:impactedGroups};this.eventService.dispatchEvent(event)}this.columnAnimationService.finish()}setColumnGroupOpened(key,newValue,source){let keyAsString;keyAsString=key instanceof ProvidedColumnGroup?key.getId():key||"",this.setColumnGroupState([{groupId:keyAsString,open:newValue}],source)}getProvidedColumnGroup(key){"string"!=typeof key&&console.error("AG Grid: group key must be a string");let res=null;return depthFirstOriginalTreeSearch(null,this.gridBalancedTree,node=>{node instanceof ProvidedColumnGroup&&node.getId()===key&&(res=node)}),res}calculateColumnsForDisplay(){let columnsForDisplay;return columnsForDisplay=this.pivotMode&&missing(this.secondaryColumns)?this.gridColumns.filter(column=>{const isAutoGroupCol=this.groupAutoColumns&&includes(this.groupAutoColumns,column),isValueCol=this.valueColumns&&includes(this.valueColumns,column);return isAutoGroupCol||isValueCol}):this.gridColumns.filter(column=>this.groupAutoColumns&&includes(this.groupAutoColumns,column)||column.isVisible()),columnsForDisplay}checkColSpanActiveInCols(columns){let result=!1;return columns.forEach(col=>{exists(col.getColDef().colSpan)&&(result=!0)}),result}calculateColumnsForGroupDisplay(){this.groupDisplayColumns=[],this.groupDisplayColumnsMap={};this.gridColumns.forEach(col=>{const colDef=col.getColDef(),underlyingColumn=colDef.showRowGroup;colDef&&exists(underlyingColumn)&&(this.groupDisplayColumns.push(col),"string"==typeof underlyingColumn?this.groupDisplayColumnsMap[underlyingColumn]=col:!0===underlyingColumn&&this.getRowGroupColumns().forEach(rowGroupCol=>{this.groupDisplayColumnsMap[rowGroupCol.getId()]=col}))})}getGroupDisplayColumns(){return this.groupDisplayColumns}getGroupDisplayColumnForGroup(rowGroupColumnId){return this.groupDisplayColumnsMap[rowGroupColumnId]}updateDisplayedColumns(source){const columnsForDisplay=this.calculateColumnsForDisplay();this.buildDisplayedTrees(columnsForDisplay),this.updateGroupsAndDisplayedColumns(source),this.setFirstRightAndLastLeftPinned(source)}isSecondaryColumnsPresent(){return exists(this.secondaryColumns)}setSecondaryColumns(colDefs,source){if(!this.gridColumns)return;const newColsPresent=colDefs;if(newColsPresent||!missing(this.secondaryColumns)){if(newColsPresent){this.processSecondaryColumnDefinitions(colDefs);const balancedTreeResult=this.columnFactory.createColumnTree(colDefs,!1,this.secondaryBalancedTree||this.previousSecondaryColumns||void 0,source);this.destroyOldColumns(this.secondaryBalancedTree,balancedTreeResult.columnTree),this.secondaryBalancedTree=balancedTreeResult.columnTree,this.secondaryHeaderRowCount=balancedTreeResult.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsMap={},this.secondaryColumns.forEach(col=>this.secondaryColumnsMap[col.getId()]=col),this.previousSecondaryColumns=null}else this.previousSecondaryColumns=this.secondaryBalancedTree,this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsMap={};this.updateGridColumns(),this.updateDisplayedColumns(source)}}processSecondaryColumnDefinitions(colDefs){const columnCallback=this.gos.get("processPivotResultColDef"),groupCallback=this.gos.get("processPivotResultColGroupDef");if(!columnCallback&&!groupCallback)return;const searchForColDefs=colDefs2=>{colDefs2.forEach(abstractColDef=>{if(exists(abstractColDef.children)){const colGroupDef=abstractColDef;groupCallback&&groupCallback(colGroupDef),searchForColDefs(colGroupDef.children)}else{columnCallback&&columnCallback(abstractColDef)}})};colDefs&&searchForColDefs(colDefs)}updateGridColumns(){const prevGridCols=this.gridBalancedTree;this.gridColsArePrimary?this.lastPrimaryOrder=this.gridColumns:this.lastSecondaryOrder=this.gridColumns;if(this.createGroupAutoColumnsIfNeeded()){const groupAutoColsMap=convertToMap(this.groupAutoColumns.map(col=>[col,!0]));this.lastPrimaryOrder&&(this.lastPrimaryOrder=this.lastPrimaryOrder.filter(col=>!groupAutoColsMap.has(col)),this.lastPrimaryOrder=[...this.groupAutoColumns,...this.lastPrimaryOrder]),this.lastSecondaryOrder&&(this.lastSecondaryOrder=this.lastSecondaryOrder.filter(col=>!groupAutoColsMap.has(col)),this.lastSecondaryOrder=[...this.groupAutoColumns,...this.lastSecondaryOrder])}let sortOrderToRecover;if(this.secondaryColumns&&this.secondaryBalancedTree){const hasSameColumns=this.secondaryColumns.some(col=>void 0!==this.gridColumnsMap[col.getColId()]);this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1,hasSameColumns&&(sortOrderToRecover=this.lastSecondaryOrder)}else this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,sortOrderToRecover=this.lastPrimaryOrder);if(this.addAutoGroupToGridColumns(),this.orderGridColsLike(sortOrderToRecover),this.gridColumns=this.placeLockedColumns(this.gridColumns),this.calculateColumnsForGroupDisplay(),this.refreshQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(col=>this.gridColumnsMap[col.getId()]=col),this.setAutoHeightActive(),!areEqual(prevGridCols,this.gridBalancedTree)){const event={type:Events.EVENT_GRID_COLUMNS_CHANGED};this.eventService.dispatchEvent(event)}}setAutoHeightActive(){if(this.autoHeightActive=this.gridColumns.filter(col=>col.isAutoHeight()).length>0,this.autoHeightActive){this.autoHeightActiveAtLeastOnce=!0;this.gos.isRowModelType("clientSide")||this.gos.isRowModelType("serverSide")||warnOnce("autoHeight columns only work with Client Side Row Model and Server Side Row Model.")}}orderGridColsLike(colsOrder){if(missing(colsOrder))return;const lastOrderMapped=convertToMap(colsOrder.map((col,index)=>[col,index]));let noColsFound=!0;if(this.gridColumns.forEach(col=>{lastOrderMapped.has(col)&&(noColsFound=!1)}),noColsFound)return;const gridColsMap=convertToMap(this.gridColumns.map(col=>[col,!0])),oldColsOrdered=colsOrder.filter(col=>gridColsMap.has(col)),oldColsMap=convertToMap(oldColsOrdered.map(col=>[col,!0])),newColsOrdered=this.gridColumns.filter(col=>!oldColsMap.has(col)),newGridColumns=oldColsOrdered.slice();newColsOrdered.forEach(newCol=>{let parent=newCol.getOriginalParent();if(!parent)return void newGridColumns.push(newCol);const siblings=[];for(;!siblings.length&&parent;){parent.getLeafColumns().forEach(leafCol=>{const presentInNewGriColumns=newGridColumns.indexOf(leafCol)>=0,noYetInSiblings=siblings.indexOf(leafCol)<0;presentInNewGriColumns&&noYetInSiblings&&siblings.push(leafCol)}),parent=parent.getOriginalParent()}if(!siblings.length)return void newGridColumns.push(newCol);const indexes=siblings.map(col=>newGridColumns.indexOf(col)),lastIndex=Math.max(...indexes);insertIntoArray(newGridColumns,newCol,lastIndex+1)}),this.gridColumns=newGridColumns}isPrimaryColumnGroupsPresent(){return this.primaryHeaderRowCount>1}refreshQuickFilterColumns(){var _a;let columnsForQuickFilter=null!=(_a=this.isPivotMode()&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")?this.secondaryColumns:this.primaryColumns)?_a:[];this.groupAutoColumns&&(columnsForQuickFilter=columnsForQuickFilter.concat(this.groupAutoColumns)),this.columnsForQuickFilter=this.gos.get("includeHiddenColumnsInQuickFilter")?columnsForQuickFilter:columnsForQuickFilter.filter(col=>col.isVisible()||col.isRowGroupActive())}placeLockedColumns(cols){const left=[],normal=[],right=[];return cols.forEach(col=>{const position=col.getColDef().lockPosition;"right"===position?right.push(col):"left"===position||!0===position?left.push(col):normal.push(col)}),[...left,...normal,...right]}addAutoGroupToGridColumns(){if(missing(this.groupAutoColumns))return this.destroyOldColumns(this.groupAutoColsBalancedTree),void(this.groupAutoColsBalancedTree=null);this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;const newAutoColsTree=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.destroyOldColumns(this.groupAutoColsBalancedTree,newAutoColsTree),this.groupAutoColsBalancedTree=newAutoColsTree,this.gridBalancedTree=newAutoColsTree.concat(this.gridBalancedTree)}clearDisplayedAndViewportColumns(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.ariaOrderColumns=[],this.viewportColumns=[],this.headerViewportColumns=[],this.viewportColumnsHash=""}updateGroupsAndDisplayedColumns(source){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(source),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths();const event={type:Events.EVENT_DISPLAYED_COLUMNS_CHANGED};this.eventService.dispatchEvent(event)}deriveDisplayedColumns(source){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinColumnsAriaOrder(),this.joinDisplayedColumns(),this.setLeftValues(source),this.displayedAutoHeightCols=this.displayedColumns.filter(col=>col.isAutoHeight())}isAutoRowHeightActive(){return this.autoHeightActive}wasAutoRowHeightEverActive(){return this.autoHeightActiveAtLeastOnce}joinColumnsAriaOrder(){const allColumns=this.getAllGridColumns(),pinnedLeft=[],center=[],pinnedRight=[];for(const col of allColumns){const pinned=col.getPinned();pinned?!0===pinned||"left"===pinned?pinnedLeft.push(col):pinnedRight.push(col):center.push(col)}this.ariaOrderColumns=pinnedLeft.concat(center).concat(pinnedRight)}joinDisplayedColumns(){this.gos.get("enableRtl")?this.displayedColumns=this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumns=this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)}setLeftValues(source){this.setLeftValuesOfColumns(source),this.setLeftValuesOfGroups()}setLeftValuesOfColumns(source){if(!this.primaryColumns)return;const allColumns=this.getPrimaryAndSecondaryAndAutoColumns().slice(0),doingRtl=this.gos.get("enableRtl");[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(columns=>{if(doingRtl){let left=this.getWidthOfColsInList(columns);columns.forEach(column=>{left-=column.getActualWidth(),column.setLeft(left,source)})}else{let left=0;columns.forEach(column=>{column.setLeft(left,source),left+=column.getActualWidth()})}removeAllFromUnorderedArray(allColumns,columns)}),allColumns.forEach(column=>{column.setLeft(null,source)})}setLeftValuesOfGroups(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(columns=>{columns.forEach(column=>{if(column instanceof ColumnGroup){column.checkLeft()}})})}derivedDisplayedColumnsFromDisplayedTree(tree,columns){columns.length=0,depthFirstAllColumnTreeSearch(tree,!0,child=>{child instanceof Column&&columns.push(child)})}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||0===this.viewportRight}extractViewportColumns(){this.isColumnVirtualisationSuppressed()?(this.viewportColumnsCenter=this.displayedColumnsCenter,this.headerViewportColumnsCenter=this.displayedColumnsCenter):(this.viewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInRowViewport.bind(this)),this.headerViewportColumnsCenter=this.displayedColumnsCenter.filter(this.isColumnInHeaderViewport.bind(this))),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight),this.headerViewportColumns=this.headerViewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)}getVirtualHeaderGroupRow(type,dept){let result;switch(type){case"left":result=this.viewportRowLeft[dept];break;case"right":result=this.viewportRowRight[dept];break;default:result=this.viewportRowCenter[dept]}return missing(result)&&(result=[]),result}calculateHeaderRows(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};const virtualColIds={};this.headerViewportColumns.forEach(col=>virtualColIds[col.getId()]=!0);const testGroup=(children,result,dept)=>{let returnValue=!1;for(let i=0;i<children.length;i++){const child=children[i];let addThisItem=!1;if(child instanceof Column)addThisItem=!0===virtualColIds[child.getId()];else{const displayedChildren=child.getDisplayedChildren();displayedChildren&&(addThisItem=testGroup(displayedChildren,result,dept+1))}addThisItem&&(returnValue=!0,result[dept]||(result[dept]=[]),result[dept].push(child))}return returnValue};testGroup(this.displayedTreeLeft,this.viewportRowLeft,0),testGroup(this.displayedTreeRight,this.viewportRowRight,0),testGroup(this.displayedTreeCentre,this.viewportRowCenter,0)}extractViewport(){this.extractViewportColumns();const newHash=this.viewportColumns.map(c=>`${c.getId()}-${c.getPinned()||"normal"}`).join("#"),changed=this.viewportColumnsHash!==newHash;return changed&&(this.viewportColumnsHash=newHash,this.calculateHeaderRows()),changed}refreshFlexedColumns(params={}){var _a;const source=params.source?params.source:"flex";if(null!=params.viewportWidth&&(this.flexViewportWidth=params.viewportWidth),!this.flexViewportWidth)return[];let flexAfterDisplayIndex=-1;if(params.resizingCols){const allResizingCols=new Set(params.resizingCols);let displayedCols=this.displayedColumnsCenter;for(let i=displayedCols.length-1;i>=0;i--)if(allResizingCols.has(displayedCols[i])){flexAfterDisplayIndex=i;break}}let knownColumnsWidth=0,flexingColumns=[],minimumFlexedWidth=0,totalFlex=0;for(let i=0;i<this.displayedColumnsCenter.length;i++){this.displayedColumnsCenter[i].getFlex()&&i>flexAfterDisplayIndex?(flexingColumns.push(this.displayedColumnsCenter[i]),totalFlex+=this.displayedColumnsCenter[i].getFlex(),minimumFlexedWidth+=null!=(_a=this.displayedColumnsCenter[i].getMinWidth())?_a:0):knownColumnsWidth+=this.displayedColumnsCenter[i].getActualWidth()}if(!flexingColumns.length)return[];let changedColumns=[];knownColumnsWidth+minimumFlexedWidth>this.flexViewportWidth&&(flexingColumns.forEach(col=>{var _a2;return col.setActualWidth(null!=(_a2=col.getMinWidth())?_a2:0,source)}),changedColumns=flexingColumns,flexingColumns=[]);const flexingColumnSizes=[];let spaceForFlexingColumns;outer:for(;;){spaceForFlexingColumns=this.flexViewportWidth-knownColumnsWidth;const spacePerFlex=spaceForFlexingColumns/totalFlex;for(let i=0;i<flexingColumns.length;i++){const col=flexingColumns[i],widthByFlexRule=spacePerFlex*col.getFlex();let constrainedWidth=0;const minWidth=col.getMinWidth(),maxWidth=col.getMaxWidth();if(exists(minWidth)&&widthByFlexRule<minWidth?constrainedWidth=minWidth:exists(maxWidth)&&widthByFlexRule>maxWidth&&(constrainedWidth=maxWidth),constrainedWidth){col.setActualWidth(constrainedWidth,source),removeFromUnorderedArray(flexingColumns,col),totalFlex-=col.getFlex(),changedColumns.push(col),knownColumnsWidth+=col.getActualWidth();continue outer}flexingColumnSizes[i]=Math.round(widthByFlexRule)}break}let remainingSpace=spaceForFlexingColumns;return flexingColumns.forEach((col,i)=>{col.setActualWidth(Math.min(flexingColumnSizes[i],remainingSpace),source),changedColumns.push(col),remainingSpace-=flexingColumnSizes[i]}),params.skipSetLeft||this.setLeftValues(source),params.updateBodyWidths&&this.updateBodyWidths(),params.fireResizedEvent&&this.dispatchColumnResizedEvent(changedColumns,!0,source,flexingColumns),flexingColumns}sizeColumnsToFit(gridWidth,source="sizeColumnsToFit",silent,params){var _c,_d,_e,_f,_g;if(this.shouldQueueResizeOperations)return void this.resizeOperationQueue.push(()=>this.sizeColumnsToFit(gridWidth,source,silent,params));const limitsMap={};params&&(null==(_c=null==params?void 0:params.columnLimits)||_c.forEach(_a=>{var _b=_a,{key}=_b,dimensions=((source,exclude)=>{var target={};for(var prop in source)__hasOwnProp.call(source,prop)&&exclude.indexOf(prop)<0&&(target[prop]=source[prop]);if(null!=source&&__getOwnPropSymbols)for(var prop of __getOwnPropSymbols(source))exclude.indexOf(prop)<0&&__propIsEnum.call(source,prop)&&(target[prop]=source[prop]);return target})(_b,["key"]);limitsMap["string"==typeof key?key:key.getColId()]=dimensions}));const allDisplayedColumns=this.getAllDisplayedColumns(),doColumnsAlreadyFit=gridWidth===this.getWidthOfColsInList(allDisplayedColumns);if(gridWidth<=0||!allDisplayedColumns.length||doColumnsAlreadyFit)return;const colsToSpread=[],colsToNotSpread=[];allDisplayedColumns.forEach(column=>{!0===column.getColDef().suppressSizeToFit?colsToNotSpread.push(column):colsToSpread.push(column)});const colsToDispatchEventFor=colsToSpread.slice(0);let finishedResizing=!1;const moveToNotSpread=column=>{removeFromArray(colsToSpread,column),colsToNotSpread.push(column)};for(colsToSpread.forEach(column=>{var _a,_b;column.resetActualWidth(source);const widthOverride=null==limitsMap?void 0:limitsMap[column.getId()],minOverride=null!=(_a=null==widthOverride?void 0:widthOverride.minWidth)?_a:null==params?void 0:params.defaultMinWidth,maxOverride=null!=(_b=null==widthOverride?void 0:widthOverride.maxWidth)?_b:null==params?void 0:params.defaultMaxWidth,colWidth=column.getActualWidth();"number"==typeof minOverride&&colWidth<minOverride?column.setActualWidth(minOverride,source,!0):"number"==typeof maxOverride&&colWidth>maxOverride&&column.setActualWidth(maxOverride,source,!0)});!finishedResizing;){finishedResizing=!0;const availablePixels=gridWidth-this.getWidthOfColsInList(colsToNotSpread);if(availablePixels<=0)colsToSpread.forEach(column=>{var _a,_b;const widthOverride=null!=(_b=null==(_a=null==limitsMap?void 0:limitsMap[column.getId()])?void 0:_a.minWidth)?_b:null==params?void 0:params.defaultMinWidth;"number"!=typeof widthOverride?column.setMinimum(source):column.setActualWidth(widthOverride,source,!0)});else{const scale=availablePixels/this.getWidthOfColsInList(colsToSpread);let pixelsForLastCol=availablePixels;for(let i=colsToSpread.length-1;i>=0;i--){const column=colsToSpread[i],widthOverride=null==limitsMap?void 0:limitsMap[column.getId()],minOverride=null!=(_d=null==widthOverride?void 0:widthOverride.minWidth)?_d:null==params?void 0:params.defaultMinWidth,maxOverride=null!=(_e=null==widthOverride?void 0:widthOverride.maxWidth)?_e:null==params?void 0:params.defaultMaxWidth,colMinWidth=null!=(_f=column.getMinWidth())?_f:0,colMaxWidth=null!=(_g=column.getMaxWidth())?_g:Number.MAX_VALUE,minWidth="number"==typeof minOverride&&minOverride>colMinWidth?minOverride:column.getMinWidth(),maxWidth="number"==typeof maxOverride&&maxOverride<colMaxWidth?maxOverride:column.getMaxWidth();let newWidth=Math.round(column.getActualWidth()*scale);exists(minWidth)&&newWidth<minWidth?(newWidth=minWidth,moveToNotSpread(column),finishedResizing=!1):exists(maxWidth)&&newWidth>maxWidth?(newWidth=maxWidth,moveToNotSpread(column),finishedResizing=!1):0===i&&(newWidth=pixelsForLastCol),column.setActualWidth(newWidth,source,!0),pixelsForLastCol-=newWidth}}}colsToDispatchEventFor.forEach(col=>{col.fireColumnWidthChangedEvent(source)}),this.setLeftValues(source),this.updateBodyWidths(),silent||this.dispatchColumnResizedEvent(colsToDispatchEventFor,!0,source)}buildDisplayedTrees(visibleColumns){const leftVisibleColumns=[],rightVisibleColumns=[],centerVisibleColumns=[];visibleColumns.forEach(column=>{switch(column.getPinned()){case"left":leftVisibleColumns.push(column);break;case"right":rightVisibleColumns.push(column);break;default:centerVisibleColumns.push(column)}});const groupInstanceIdCreator=new GroupInstanceIdCreator;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(leftVisibleColumns,groupInstanceIdCreator,"left",this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(rightVisibleColumns,groupInstanceIdCreator,"right",this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(centerVisibleColumns,groupInstanceIdCreator,null,this.displayedTreeCentre),this.updateDisplayedMap()}updateDisplayedMap(){this.displayedColumnsAndGroupsMap={};const func=child=>{this.displayedColumnsAndGroupsMap[child.getUniqueId()]=child};depthFirstAllColumnTreeSearch(this.displayedTreeCentre,!1,func),depthFirstAllColumnTreeSearch(this.displayedTreeLeft,!1,func),depthFirstAllColumnTreeSearch(this.displayedTreeRight,!1,func)}isDisplayed(item){return this.displayedColumnsAndGroupsMap[item.getUniqueId()]===item}updateOpenClosedVisibilityInColumnGroups(){depthFirstAllColumnTreeSearch(this.getAllDisplayedTrees(),!1,child=>{child instanceof ColumnGroup&&child.calculateDisplayedColumns()})}getGroupAutoColumns(){return this.groupAutoColumns}createGroupAutoColumnsIfNeeded(){const forceRecreateAutoGroups=this.forceRecreateAutoGroups;if(this.forceRecreateAutoGroups=!1,!this.autoGroupsNeedBuilding)return!1;this.autoGroupsNeedBuilding=!1;const groupFullWidthRow=this.gos.isGroupUseEntireRow(this.pivotMode),suppressAutoColumn=this.pivotMode?this.gos.get("pivotSuppressAutoColumn"):this.isGroupSuppressAutoColumn();if((this.rowGroupColumns.length>0||this.gos.get("treeData"))&&!suppressAutoColumn&&!groupFullWidthRow){const newAutoGroupCols=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);if(!this.autoColsEqual(newAutoGroupCols,this.groupAutoColumns)||forceRecreateAutoGroups)return this.groupAutoColumns=newAutoGroupCols,!0}else this.groupAutoColumns=null;return!1}isGroupSuppressAutoColumn(){if("custom"===this.gos.get("groupDisplayType"))return!0;return"custom"===this.gos.get("treeDataDisplayType")}autoColsEqual(colsA,colsB){return areEqual(colsA,colsB,(a,b)=>a.getColId()===b.getColId())}getWidthOfColsInList(columnList){return columnList.reduce((width,col)=>width+col.getActualWidth(),0)}getFirstDisplayedColumn(){const isRtl=this.gos.get("enableRtl"),queryOrder=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];isRtl&&queryOrder.reverse();for(let i=0;i<queryOrder.length;i++){const container=this[queryOrder[i]]();if(container.length)return isRtl?last(container):container[0]}return null}setColumnHeaderHeight(col,height){if(col.setAutoHeaderHeight(height)){const event={type:Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,column:col,columns:[col],source:"autosizeColumnHeaderHeight"};this.eventService.dispatchEvent(event)}}getColumnGroupHeaderRowHeight(){return this.isPivotMode()?this.getPivotGroupHeaderHeight():this.getGroupHeaderHeight()}getColumnHeaderRowHeight(){const defaultHeight=this.isPivotMode()?this.getPivotHeaderHeight():this.getHeaderHeight(),displayedHeights=this.getAllDisplayedColumns().filter(col=>col.isAutoHeaderHeight()).map(col=>col.getAutoHeaderHeight()||0);return Math.max(defaultHeight,...displayedHeights)}getHeaderHeight(){var _a;return null!=(_a=this.gos.get("headerHeight"))?_a:this.environment.getFromTheme(25,"headerHeight")}getFloatingFiltersHeight(){var _a;return null!=(_a=this.gos.get("floatingFiltersHeight"))?_a:this.getHeaderHeight()}getGroupHeaderHeight(){var _a;return null!=(_a=this.gos.get("groupHeaderHeight"))?_a:this.getHeaderHeight()}getPivotHeaderHeight(){var _a;return null!=(_a=this.gos.get("pivotHeaderHeight"))?_a:this.getHeaderHeight()}getPivotGroupHeaderHeight(){var _a;return null!=(_a=this.gos.get("pivotGroupHeaderHeight"))?_a:this.getGroupHeaderHeight()}queueResizeOperations(){this.shouldQueueResizeOperations=!0}processResizeOperations(){this.shouldQueueResizeOperations=!1,this.resizeOperationQueue.forEach(resizeOperation=>resizeOperation()),this.resizeOperationQueue=[]}resetColumnDefIntoColumn(column,source){const userColDef=column.getUserProvidedColDef();if(!userColDef)return!1;const newColDef=this.columnFactory.addColumnDefaultAndTypes(userColDef,column.getColId());return column.setColDef(newColDef,userColDef,source),!0}isColumnGroupingLocked(column){const groupLockGroupColumns=this.gos.get("groupLockGroupColumns");if(!column.isRowGroupActive()||0===groupLockGroupColumns)return!1;if(-1===groupLockGroupColumns)return!0;return groupLockGroupColumns>this.rowGroupColumns.findIndex(groupCol=>groupCol.getColId()===column.getColId())}generateColumnStateForRowGroupAndPivotIndexes(updatedRowGroupColumnState,updatedPivotColumnState){let existingColumnStateUpdates={};const orderColumns=(updatedColumnState,colList,enableProp,initialEnableProp,indexProp,initialIndexProp)=>{if(!colList.length||!this.primaryColumns)return[];const updatedColIdArray=Object.keys(updatedColumnState),updatedColIds=new Set(updatedColIdArray),newColIds=new Set(updatedColIdArray),allColIds=new Set(colList.map(column=>{const colId=column.getColId();return newColIds.delete(colId),colId}).concat(updatedColIdArray)),colIdsInOriginalOrder=[],originalOrderMap={};let orderIndex=0;for(let i=0;i<this.primaryColumns.length;i++){const colId=this.primaryColumns[i].getColId();allColIds.has(colId)&&(colIdsInOriginalOrder.push(colId),originalOrderMap[colId]=orderIndex++)}let index=1e3,hasAddedNewCols=!1,lastIndex=0;const processPrecedingNewCols=colId=>{const originalOrderIndex=originalOrderMap[colId];for(let i=lastIndex;i<originalOrderIndex;i++){const newColId=colIdsInOriginalOrder[i];newColIds.has(newColId)&&(updatedColumnState[newColId][indexProp]=index++,newColIds.delete(newColId))}lastIndex=originalOrderIndex};colList.forEach(column=>{const colId=column.getColId();if(updatedColIds.has(colId))processPrecedingNewCols(colId),updatedColumnState[colId][indexProp]=index++;else{const colDef=column.getColDef();if(null===colDef[indexProp]||void 0===colDef[indexProp]&&null==colDef[initialIndexProp]){if(!hasAddedNewCols){colDef[enableProp]||void 0===colDef[enableProp]&&colDef[initialEnableProp]?processPrecedingNewCols(colId):(newColIds.forEach(newColId=>{updatedColumnState[newColId][indexProp]=index+originalOrderMap[newColId]}),index+=colIdsInOriginalOrder.length,hasAddedNewCols=!0)}existingColumnStateUpdates[colId]||(existingColumnStateUpdates[colId]={colId}),existingColumnStateUpdates[colId][indexProp]=index++}}})};return orderColumns(updatedRowGroupColumnState,this.rowGroupColumns,"rowGroup","initialRowGroup","rowGroupIndex","initialRowGroupIndex"),orderColumns(updatedPivotColumnState,this.pivotColumns,"pivot","initialPivot","pivotIndex","initialPivotIndex"),Object.values(existingColumnStateUpdates)}onColumnsReady(){const autoSizeStrategy=this.gos.get("autoSizeStrategy");if(!autoSizeStrategy)return;const{type}=autoSizeStrategy;setTimeout(()=>{if("fitGridWidth"===type){const{columnLimits:propColumnLimits,defaultMinWidth,defaultMaxWidth}=autoSizeStrategy,columnLimits=null==propColumnLimits?void 0:propColumnLimits.map(({colId:key,minWidth,maxWidth})=>({key,minWidth,maxWidth}));this.ctrlsService.getGridBodyCtrl().sizeColumnsToFit({defaultMinWidth,defaultMaxWidth,columnLimits})}else"fitProvidedWidth"===type&&this.sizeColumnsToFit(autoSizeStrategy.width,"sizeColumnsToFit")})}onFirstDataRendered(){const autoSizeStrategy=this.gos.get("autoSizeStrategy");if("fitCellContents"!==(null==autoSizeStrategy?void 0:autoSizeStrategy.type))return;const{colIds:columns,skipHeader}=autoSizeStrategy;setTimeout(()=>{columns?this.autoSizeColumns({columns,skipHeader,source:"autosizeColumns"}):this.autoSizeAllColumns("autosizeColumns",skipHeader)})}};function convertSourceType(source){return"gridOptionsUpdated"===source?"gridOptionsChanged":source}function depthFirstAllColumnTreeSearch(tree,useDisplayedChildren,callback){if(tree)for(let i=0;i<tree.length;i++){const child=tree[i];if(child instanceof ColumnGroup){depthFirstAllColumnTreeSearch(useDisplayedChildren?child.getDisplayedChildren():child.getChildren(),useDisplayedChildren,callback)}callback(child)}}__decorateClass([Autowired("expressionService")],ColumnModel.prototype,"expressionService",2),__decorateClass([Autowired("columnFactory")],ColumnModel.prototype,"columnFactory",2),__decorateClass([Autowired("displayedGroupCreator")],ColumnModel.prototype,"displayedGroupCreator",2),__decorateClass([Autowired("ctrlsService")],ColumnModel.prototype,"ctrlsService",2),__decorateClass([Autowired("autoWidthCalculator")],ColumnModel.prototype,"autoWidthCalculator",2),__decorateClass([Autowired("columnAnimationService")],ColumnModel.prototype,"columnAnimationService",2),__decorateClass([Autowired("autoGroupColService")],ColumnModel.prototype,"autoGroupColService",2),__decorateClass([Autowired("valueCache")],ColumnModel.prototype,"valueCache",2),__decorateClass([Autowired("animationFrameService")],ColumnModel.prototype,"animationFrameService",2),__decorateClass([Autowired("sortController")],ColumnModel.prototype,"sortController",2),__decorateClass([Autowired("columnDefFactory")],ColumnModel.prototype,"columnDefFactory",2),__decorateClass([Optional("aggFuncService")],ColumnModel.prototype,"aggFuncService",2),__decorateClass([PostConstruct],ColumnModel.prototype,"init",1),__decorateClass([PreDestroy],ColumnModel.prototype,"destroyColumns",1),__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],ColumnModel.prototype,"setBeans",1),ColumnModel=__decorateClass([Bean("columnModel")],ColumnModel);var DisplayedGroupCreator=class extends BeanStub{createDisplayedGroups(sortedVisibleColumns,groupInstanceIdCreator,pinned,oldDisplayedGroups){const oldColumnsMapped=this.mapOldGroupsById(oldDisplayedGroups),topLevelResultCols=[];let groupsOrColsAtCurrentLevel=sortedVisibleColumns;for(;groupsOrColsAtCurrentLevel.length;){const currentlyIterating=groupsOrColsAtCurrentLevel;groupsOrColsAtCurrentLevel=[];let lastGroupedColIdx=0;const createGroupToIndex=to=>{const from=lastGroupedColIdx;lastGroupedColIdx=to;const previousNode=currentlyIterating[from],previousNodeParent=(previousNode instanceof ColumnGroup?previousNode.getProvidedColumnGroup():previousNode).getOriginalParent();if(null==previousNodeParent){for(let i=from;i<to;i++)topLevelResultCols.push(currentlyIterating[i]);return}const newGroup=this.createColumnGroup(previousNodeParent,groupInstanceIdCreator,oldColumnsMapped,pinned);for(let i=from;i<to;i++)newGroup.addChild(currentlyIterating[i]);groupsOrColsAtCurrentLevel.push(newGroup)};for(let i=1;i<currentlyIterating.length;i++){const thisNode=currentlyIterating[i],thisNodeParent=(thisNode instanceof ColumnGroup?thisNode.getProvidedColumnGroup():thisNode).getOriginalParent(),previousNode=currentlyIterating[lastGroupedColIdx];thisNodeParent!==(previousNode instanceof ColumnGroup?previousNode.getProvidedColumnGroup():previousNode).getOriginalParent()&&createGroupToIndex(i)}lastGroupedColIdx<currentlyIterating.length&&createGroupToIndex(currentlyIterating.length)}return this.setupParentsIntoColumns(topLevelResultCols,null),topLevelResultCols}createColumnGroup(providedGroup,groupInstanceIdCreator,oldColumnsMapped,pinned){const groupId=providedGroup.getGroupId(),instanceId=groupInstanceIdCreator.getInstanceIdForKey(groupId);let columnGroup=oldColumnsMapped[ColumnGroup.createUniqueId(groupId,instanceId)];return columnGroup&&columnGroup.getProvidedColumnGroup()!==providedGroup&&(columnGroup=null),exists(columnGroup)?columnGroup.reset():(columnGroup=new ColumnGroup(providedGroup,groupId,instanceId,pinned),this.context.createBean(columnGroup)),columnGroup}mapOldGroupsById(displayedGroups){const result={},recursive=columnsOrGroups=>{columnsOrGroups.forEach(columnOrGroup=>{if(columnOrGroup instanceof ColumnGroup){const columnGroup=columnOrGroup;result[columnOrGroup.getUniqueId()]=columnGroup,recursive(columnGroup.getChildren())}})};return displayedGroups&&recursive(displayedGroups),result}setupParentsIntoColumns(columnsOrGroups,parent){columnsOrGroups.forEach(columnsOrGroup=>{if(columnsOrGroup.setParent(parent),columnsOrGroup instanceof ColumnGroup){const columnGroup=columnsOrGroup;this.setupParentsIntoColumns(columnGroup.getChildren(),columnGroup)}})}};DisplayedGroupCreator=__decorateClass([Bean("displayedGroupCreator")],DisplayedGroupCreator);var INITIAL_GRID_OPTION_KEYS={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,excludeHiddenColumnsFromQuickFilter:!0,advancedFilterModel:!0,customChartThemes:!0,chartThemeOverrides:!0,enableChartToolPanelsButton:!0,suppressChartToolPanelsButton:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressParentsInRowNodes:!0,suppressTouch:!0,suppressAsyncEvents:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,suppressAggFuncInHeader:!0,suppressAggAtRootLevel:!0,removePivotHeaderRowWhenSingleValueColumn:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,suppressGroupMaintainValueType:!0,groupLockGroupColumns:!0,rowGroupPanelSuppressSort:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,suppressServerSideInfiniteScroll:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,functionsPassive:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,columnMenu:!0},_PropertyKeys=class _PropertyKeys{};_PropertyKeys.STRING_PROPERTIES=["rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","grandTotalRow"],_PropertyKeys.OBJECT_PROPERTIES=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","statusBar","sideBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterModel","advancedFilterParent","advancedFilterBuilderParams","initialState","autoSizeStrategy"],_PropertyKeys.ARRAY_PROPERTIES=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector"],_PropertyKeys.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns"],_PropertyKeys.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupIncludeTotalFooter","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","excludeHiddenColumnsFromQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterMovesDown","enterMovesDownAfterEdit","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","enableChartToolPanelsButton","suppressChartToolPanelsButton","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilterAllLevels","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","serverSideSortOnServer","serverSideFilterOnServer","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","suppressServerSideInfiniteScroll","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","suppressGroupMaintainValueType","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval"],_PropertyKeys.OTHER_PROPERTIES=["suppressStickyTotalRow"],_PropertyKeys.FUNCTIONAL_PROPERTIES=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","fullWidthCellRenderer","loadingCellRenderer","loadingOverlayComponent","noRowsOverlayComponent","detailCellRenderer","quickFilterParser","quickFilterMatcher"],_PropertyKeys.CALLBACK_PROPERTIES=["getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","groupIncludeFooter","loadingCellRendererSelector","getRowId","groupAggFiltering","chartMenuItems","groupTotalRow"],_PropertyKeys.FUNCTION_PROPERTIES=[..._PropertyKeys.FUNCTIONAL_PROPERTIES,..._PropertyKeys.CALLBACK_PROPERTIES],_PropertyKeys.ALL_PROPERTIES=[..._PropertyKeys.ARRAY_PROPERTIES,..._PropertyKeys.OBJECT_PROPERTIES,..._PropertyKeys.STRING_PROPERTIES,..._PropertyKeys.NUMBER_PROPERTIES,..._PropertyKeys.FUNCTION_PROPERTIES,..._PropertyKeys.BOOLEAN_PROPERTIES,..._PropertyKeys.OTHER_PROPERTIES];var PropertyKeys=_PropertyKeys,_ComponentUtil=class _ComponentUtil{static getCallbackForEvent(eventName){return!eventName||eventName.length<2?eventName:"on"+eventName[0].toUpperCase()+eventName.substring(1)}static getGridOptionKeys(){return this.ALL_PROPERTIES_AND_CALLBACKS}static combineAttributesAndGridOptions(gridOptions,component){"object"!=typeof gridOptions&&(gridOptions={});const mergedOptions=__spreadValues({},gridOptions);return _ComponentUtil.getGridOptionKeys().forEach(key=>{const value=component[key];void 0!==value&&value!==_ComponentUtil.VUE_OMITTED_PROPERTY&&(mergedOptions[key]=value)}),mergedOptions}static processOnChange(changes,api,isVue){if(!changes)return;const gridChanges={};let hasChanges=!1;if(Object.keys(changes).filter(key=>_ComponentUtil.ALL_PROPERTIES_AND_CALLBACKS_SET.has(key)).forEach(key=>{gridChanges[key]=changes[key],hasChanges=!0}),!hasChanges)return;api.__internalUpdateGridOptions(gridChanges,!0);const event={type:Events.EVENT_COMPONENT_STATE_CHANGED};iterateObject(gridChanges,(key,value)=>{event[key]=value}),api.dispatchEvent(event)}};_ComponentUtil.EVENTS=values(Events),_ComponentUtil.VUE_OMITTED_PROPERTY="AG-VUE-OMITTED-PROPERTY",_ComponentUtil.EXCLUDED_INTERNAL_EVENTS=[Events.EVENT_SCROLLBAR_WIDTH_CHANGED,Events.EVENT_CHECKBOX_CHANGED,Events.EVENT_HEIGHT_SCALE_CHANGED,Events.EVENT_BODY_HEIGHT_CHANGED,Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,Events.EVENT_SCROLL_VISIBILITY_CHANGED,Events.EVENT_COLUMN_HOVER_CHANGED,Events.EVENT_FLASH_CELLS,Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,Events.EVENT_DISPLAYED_ROWS_CHANGED,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,Events.EVENT_STORE_UPDATED,Events.EVENT_COLUMN_PANEL_ITEM_DRAG_START,Events.EVENT_COLUMN_PANEL_ITEM_DRAG_END,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,Events.EVENT_FULL_WIDTH_ROW_FOCUSED,Events.EVENT_HEADER_HEIGHT_CHANGED,Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,Events.EVENT_CELL_FOCUS_CLEARED,Events.EVENT_GRID_STYLES_CHANGED,Events.EVENT_FILTER_DESTROYED,Events.EVENT_ROW_DATA_UPDATE_STARTED,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,Events.EVENT_DATA_TYPES_INFERRED,Events.EVENT_FIELD_VALUE_CHANGED,Events.EVENT_FIELD_PICKER_VALUE_SELECTED,Events.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,Events.EVENT_SUPPRESS_MENU_HIDE_CHANGED,Events.EVENT_SUPPRESS_FIELD_DOT_NOTATION,Events.EVENT_ROW_COUNT_READY,Events.EVENT_SIDE_BAR_UPDATED],_ComponentUtil.PUBLIC_EVENTS=_ComponentUtil.EVENTS.filter(e=>!includes(_ComponentUtil.EXCLUDED_INTERNAL_EVENTS,e)),_ComponentUtil.EVENT_CALLBACKS=_ComponentUtil.EVENTS.map(event=>_ComponentUtil.getCallbackForEvent(event)),_ComponentUtil.BOOLEAN_PROPERTIES=PropertyKeys.BOOLEAN_PROPERTIES,_ComponentUtil.ALL_PROPERTIES=PropertyKeys.ALL_PROPERTIES,_ComponentUtil.ALL_PROPERTIES_AND_CALLBACKS=[..._ComponentUtil.ALL_PROPERTIES,..._ComponentUtil.EVENT_CALLBACKS],_ComponentUtil.ALL_PROPERTIES_AND_CALLBACKS_SET=new Set(_ComponentUtil.ALL_PROPERTIES_AND_CALLBACKS);var ComponentUtil=_ComponentUtil,AgStackComponentsRegistry=class extends BeanStub{constructor(){super(...arguments),this.componentsMappedByName={}}setupComponents(components){components&&components.forEach(componentMeta=>this.addComponent(componentMeta))}addComponent(componentMeta){const classUpperCase=componentMeta.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[classUpperCase]=componentMeta.componentClass}getComponentClass(htmlTag){return this.componentsMappedByName[htmlTag]}};AgStackComponentsRegistry=__decorateClass([Bean("agStackComponentsRegistry")],AgStackComponentsRegistry);var aria_exports={};function toggleAriaAttribute(element,attribute,value){null==value||"string"==typeof value&&""==value?removeAriaAttribute(element,attribute):setAriaAttribute(element,attribute,value)}function setAriaAttribute(element,attribute,value){element.setAttribute(ariaAttributeName(attribute),value.toString())}function removeAriaAttribute(element,attribute){element.removeAttribute(ariaAttributeName(attribute))}function ariaAttributeName(attribute){return`aria-${attribute}`}function setAriaRole(element,role){role?element.setAttribute("role",role):element.removeAttribute("role")}function getAriaSortState(sortDirection){let sort;return sort="asc"===sortDirection?"ascending":"desc"===sortDirection?"descending":"mixed"===sortDirection?"other":"none",sort}function getAriaLevel(element){return parseInt(element.getAttribute("aria-level"),10)}function getAriaPosInSet(element){return parseInt(element.getAttribute("aria-posinset"),10)}function getAriaLabel(element){return element.getAttribute("aria-label")}function setAriaLabel(element,label){toggleAriaAttribute(element,"label",label)}function setAriaLabelledBy(element,labelledBy){toggleAriaAttribute(element,"labelledby",labelledBy)}function setAriaDescribedBy(element,describedby){toggleAriaAttribute(element,"describedby",describedby)}function setAriaLive(element,live){toggleAriaAttribute(element,"live",live)}function setAriaAtomic(element,atomic){toggleAriaAttribute(element,"atomic",atomic)}function setAriaRelevant(element,relevant){toggleAriaAttribute(element,"relevant",relevant)}function setAriaLevel(element,level){toggleAriaAttribute(element,"level",level)}function setAriaDisabled(element,disabled){toggleAriaAttribute(element,"disabled",disabled)}function setAriaHidden(element,hidden){toggleAriaAttribute(element,"hidden",hidden)}function setAriaActiveDescendant(element,descendantId){toggleAriaAttribute(element,"activedescendant",descendantId)}function setAriaExpanded(element,expanded){setAriaAttribute(element,"expanded",expanded)}function removeAriaExpanded(element){removeAriaAttribute(element,"expanded")}function setAriaSetSize(element,setsize){setAriaAttribute(element,"setsize",setsize)}function setAriaPosInSet(element,position){setAriaAttribute(element,"posinset",position)}function setAriaMultiSelectable(element,multiSelectable){setAriaAttribute(element,"multiselectable",multiSelectable)}function setAriaRowCount(element,rowCount){setAriaAttribute(element,"rowcount",rowCount)}function setAriaRowIndex(element,rowIndex){setAriaAttribute(element,"rowindex",rowIndex)}function setAriaColCount(element,colCount){setAriaAttribute(element,"colcount",colCount)}function setAriaColIndex(element,colIndex){setAriaAttribute(element,"colindex",colIndex)}function setAriaColSpan(element,colSpan){setAriaAttribute(element,"colspan",colSpan)}function setAriaSort(element,sort){setAriaAttribute(element,"sort",sort)}function removeAriaSort(element){removeAriaAttribute(element,"sort")}function setAriaSelected(element,selected){toggleAriaAttribute(element,"selected",selected)}function setAriaChecked(element,checked){setAriaAttribute(element,"checked",void 0===checked?"mixed":checked)}function setAriaControls(controllerElement,controlledElement){toggleAriaAttribute(controllerElement,"controls",controlledElement.id),setAriaLabelledBy(controlledElement,controllerElement.id)}function getAriaCheckboxStateName(translate,state){return void 0===state?translate("ariaIndeterminate","indeterminate"):!0===state?translate("ariaChecked","checked"):translate("ariaUnchecked","unchecked")}__export(aria_exports,{getAriaCheckboxStateName:()=>getAriaCheckboxStateName,getAriaLabel:()=>getAriaLabel,getAriaLevel:()=>getAriaLevel,getAriaPosInSet:()=>getAriaPosInSet,getAriaSortState:()=>getAriaSortState,removeAriaExpanded:()=>removeAriaExpanded,removeAriaSort:()=>removeAriaSort,setAriaActiveDescendant:()=>setAriaActiveDescendant,setAriaAtomic:()=>setAriaAtomic,setAriaChecked:()=>setAriaChecked,setAriaColCount:()=>setAriaColCount,setAriaColIndex:()=>setAriaColIndex,setAriaColSpan:()=>setAriaColSpan,setAriaControls:()=>setAriaControls,setAriaDescribedBy:()=>setAriaDescribedBy,setAriaDisabled:()=>setAriaDisabled,setAriaExpanded:()=>setAriaExpanded,setAriaHidden:()=>setAriaHidden,setAriaLabel:()=>setAriaLabel,setAriaLabelledBy:()=>setAriaLabelledBy,setAriaLevel:()=>setAriaLevel,setAriaLive:()=>setAriaLive,setAriaMultiSelectable:()=>setAriaMultiSelectable,setAriaPosInSet:()=>setAriaPosInSet,setAriaRelevant:()=>setAriaRelevant,setAriaRole:()=>setAriaRole,setAriaRowCount:()=>setAriaRowCount,setAriaRowIndex:()=>setAriaRowIndex,setAriaSelected:()=>setAriaSelected,setAriaSetSize:()=>setAriaSetSize,setAriaSort:()=>setAriaSort});var isSafari,safariVersion,isChrome,isFirefox,isMacOs,isIOS,invisibleScrollbar,browserScrollbarWidth,browser_exports={};function isBrowserSafari(){return void 0===isSafari&&(isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),isSafari}function getSafariVersion(){if(void 0===safariVersion)if(isBrowserSafari()){const versionMatch=navigator.userAgent.match(/version\/(\d+)/i);versionMatch&&(safariVersion=null!=versionMatch[1]?parseFloat(versionMatch[1]):0)}else safariVersion=0;return safariVersion}function isBrowserChrome(){if(void 0===isChrome){const win=window;isChrome=!!win.chrome&&(!!win.chrome.webstore||!!win.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return isChrome}function isBrowserFirefox(){return void 0===isFirefox&&(isFirefox=/(firefox)/i.test(navigator.userAgent)),isFirefox}function isMacOsUserAgent(){return void 0===isMacOs&&(isMacOs=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),isMacOs}function isIOSUserAgent(){return void 0===isIOS&&(isIOS=/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1),isIOS}function browserSupportsPreventScroll(){return!isBrowserSafari()||getSafariVersion()>=15}function getTabIndex(el){if(!el)return null;const numberTabIndex=el.tabIndex,tabIndex=el.getAttribute("tabIndex");return-1!==numberTabIndex||null!==tabIndex&&(""!==tabIndex||isBrowserFirefox())?numberTabIndex.toString():null}function getMaxDivHeight(){if(!document.body)return-1;let res=1e6;const testUpTo=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,div=document.createElement("div");for(document.body.appendChild(div);;){const test=2*res;if(div.style.height=test+"px",test>testUpTo||div.clientHeight!==test)break;res=test}return document.body.removeChild(div),res}function getBodyWidth(){var _a,_b,_c;return null!=(_c=null==(_a=document.body)?void 0:_a.clientWidth)?_c:window.innerHeight||(null==(_b=document.documentElement)?void 0:_b.clientWidth)||-1}function getBodyHeight(){var _a,_b,_c;return null!=(_c=null==(_a=document.body)?void 0:_a.clientHeight)?_c:window.innerHeight||(null==(_b=document.documentElement)?void 0:_b.clientHeight)||-1}function getScrollbarWidth(){return null==browserScrollbarWidth&&initScrollbarWidthAndVisibility(),browserScrollbarWidth}function initScrollbarWidthAndVisibility(){const body=document.body,div=document.createElement("div");div.style.width=div.style.height="100px",div.style.opacity="0",div.style.overflow="scroll",div.style.msOverflowStyle="scrollbar",div.style.position="absolute",body.appendChild(div);let width=div.offsetWidth-div.clientWidth;0===width&&0===div.clientWidth&&(width=null),div.parentNode&&div.parentNode.removeChild(div),null!=width&&(browserScrollbarWidth=width,invisibleScrollbar=0===width)}function isInvisibleScrollbar(){return null==invisibleScrollbar&&initScrollbarWidthAndVisibility(),invisibleScrollbar}__export(browser_exports,{browserSupportsPreventScroll:()=>browserSupportsPreventScroll,getBodyHeight:()=>getBodyHeight,getBodyWidth:()=>getBodyWidth,getMaxDivHeight:()=>getMaxDivHeight,getSafariVersion:()=>getSafariVersion,getScrollbarWidth:()=>getScrollbarWidth,getTabIndex:()=>getTabIndex,isBrowserChrome:()=>isBrowserChrome,isBrowserFirefox:()=>isBrowserFirefox,isBrowserSafari:()=>isBrowserSafari,isIOSUserAgent:()=>isIOSUserAgent,isInvisibleScrollbar:()=>isInvisibleScrollbar,isMacOsUserAgent:()=>isMacOsUserAgent});var date_exports={};__export(date_exports,{dateToFormattedString:()=>dateToFormattedString,parseDateTimeFromString:()=>parseDateTimeFromString,serialiseDate:()=>serialiseDate});var number_exports={};function padStartWidthZeros(value,totalStringSize){return value.toString().padStart(totalStringSize,"0")}function createArrayOfNumbers(first,last2){const result=[];for(let i=first;i<=last2;i++)result.push(i);return result}function cleanNumber(value){return"string"==typeof value&&(value=parseInt(value,10)),"number"==typeof value?Math.floor(value):null}function decToHex(number,bytes){let hex="";for(let i=0;i<bytes;i++)hex+=String.fromCharCode(255&number),number>>>=8;return hex}function formatNumberTwoDecimalPlacesAndCommas(value,thousandSeparator,decimalSeparator){return"number"!=typeof value?"":formatNumberCommas(Math.round(100*value)/100,thousandSeparator,decimalSeparator)}function formatNumberCommas(value,thousandSeparator,decimalSeparator){return"number"!=typeof value?"":value.toString().replace(".",decimalSeparator).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${thousandSeparator}`)}function sum(values2){return null==values2?null:values2.reduce((total,value)=>total+value,0)}function serialiseDate(date,includeTime=!0,separator="-"){if(!date)return null;let serialised=[date.getFullYear(),date.getMonth()+1,date.getDate()].map(part=>padStartWidthZeros(part,2)).join(separator);return includeTime&&(serialised+=" "+[date.getHours(),date.getMinutes(),date.getSeconds()].map(part=>padStartWidthZeros(part,2)).join(":")),serialised}__export(number_exports,{cleanNumber:()=>cleanNumber,createArrayOfNumbers:()=>createArrayOfNumbers,decToHex:()=>decToHex,formatNumberCommas:()=>formatNumberCommas,formatNumberTwoDecimalPlacesAndCommas:()=>formatNumberTwoDecimalPlacesAndCommas,padStartWidthZeros:()=>padStartWidthZeros,sum:()=>sum});var calculateOrdinal=value=>{if(value>3&&value<21)return"th";switch(value%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"};function dateToFormattedString(date,format="YYYY-MM-DD"){const fullYear=padStartWidthZeros(date.getFullYear(),4),months=["January","February","March","April","May","June","July","August","September","October","November","December"],days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],replace={YYYY:()=>fullYear.slice(fullYear.length-4,fullYear.length),YY:()=>fullYear.slice(fullYear.length-2,fullYear.length),Y:()=>`${date.getFullYear()}`,MMMM:()=>months[date.getMonth()],MMM:()=>months[date.getMonth()].slice(0,3),MM:()=>padStartWidthZeros(date.getMonth()+1,2),Mo:()=>`${date.getMonth()+1}${calculateOrdinal(date.getMonth()+1)}`,M:()=>`${date.getMonth()+1}`,Do:()=>`${date.getDate()}${calculateOrdinal(date.getDate())}`,DD:()=>padStartWidthZeros(date.getDate(),2),D:()=>`${date.getDate()}`,dddd:()=>days[date.getDay()],ddd:()=>days[date.getDay()].slice(0,3),dd:()=>days[date.getDay()].slice(0,2),do:()=>`${date.getDay()}${calculateOrdinal(date.getDay())}`,d:()=>`${date.getDay()}`},regexp=new RegExp(Object.keys(replace).join("|"),"g");return format.replace(regexp,match=>match in replace?replace[match]():match)}function parseDateTimeFromString(value){if(!value)return null;const[dateStr,timeStr]=value.split(" ");if(!dateStr)return null;const fields=dateStr.split("-").map(f=>parseInt(f,10));if(3!==fields.filter(f=>!isNaN(f)).length)return null;const[year,month,day]=fields,date=new Date(year,month-1,day);if(date.getFullYear()!==year||date.getMonth()!==month-1||date.getDate()!==day)return null;if(!timeStr||"00:00:00"===timeStr)return date;const[hours,minutes,seconds]=timeStr.split(":").map(part=>parseInt(part,10));return hours>=0&&hours<24&&date.setHours(hours),minutes>=0&&minutes<60&&date.setMinutes(minutes),seconds>=0&&seconds<60&&date.setSeconds(seconds),date}var rtlNegativeScroll,dom_exports={};function radioCssClass(element,elementClass,otherElementClass){const parent=element.parentElement;let sibling=parent&&parent.firstChild;for(;sibling;)elementClass&&sibling.classList.toggle(elementClass,sibling===element),otherElementClass&&sibling.classList.toggle(otherElementClass,sibling!==element),sibling=sibling.nextSibling}__export(dom_exports,{FOCUSABLE_EXCLUDE:()=>FOCUSABLE_EXCLUDE,FOCUSABLE_SELECTOR:()=>FOCUSABLE_SELECTOR,addOrRemoveAttribute:()=>addOrRemoveAttribute,addStylesToElement:()=>addStylesToElement,bindCellRendererToHtmlElement:()=>bindCellRendererToHtmlElement,clearElement:()=>clearElement,copyNodeList:()=>copyNodeList,ensureDomOrder:()=>ensureDomOrder,formatSize:()=>formatSize,getAbsoluteHeight:()=>getAbsoluteHeight,getAbsoluteWidth:()=>getAbsoluteWidth,getElementRectWithOffset:()=>getElementRectWithOffset,getElementSize:()=>getElementSize,getInnerHeight:()=>getInnerHeight,getInnerWidth:()=>getInnerWidth,getScrollLeft:()=>getScrollLeft,insertWithDomOrder:()=>insertWithDomOrder,isElementChildOfClass:()=>isElementChildOfClass,isFocusableFormField:()=>isFocusableFormField,isHorizontalScrollShowing:()=>isHorizontalScrollShowing,isInDOM:()=>isInDOM,isNodeOrElement:()=>isNodeOrElement,isRtlNegativeScroll:()=>isRtlNegativeScroll,isVerticalScrollShowing:()=>isVerticalScrollShowing,isVisible:()=>isVisible,iterateNamedNodeMap:()=>iterateNamedNodeMap,loadTemplate:()=>loadTemplate,nodeListForEach:()=>nodeListForEach,radioCssClass:()=>radioCssClass,removeFromParent:()=>removeFromParent,setDisabled:()=>setDisabled,setDisplayed:()=>setDisplayed,setDomChildOrder:()=>setDomChildOrder,setElementHeight:()=>setElementHeight,setElementWidth:()=>setElementWidth,setFixedHeight:()=>setFixedHeight,setFixedWidth:()=>setFixedWidth,setScrollLeft:()=>setScrollLeft,setVisible:()=>setVisible});var FOCUSABLE_SELECTOR="[tabindex], input, select, button, textarea, [href]",FOCUSABLE_EXCLUDE="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function isFocusableFormField(element){const matches=Element.prototype.matches||Element.prototype.msMatchesSelector,isFocusable=matches.call(element,"input, select, button, textarea"),isNotFocusable=matches.call(element,FOCUSABLE_EXCLUDE),isElementVisible=isVisible(element);return isFocusable&&!isNotFocusable&&isElementVisible}function setDisplayed(element,displayed,options={}){const{skipAriaHidden}=options;element.classList.toggle("ag-hidden",!displayed),skipAriaHidden||setAriaHidden(element,!displayed)}function setVisible(element,visible,options={}){const{skipAriaHidden}=options;element.classList.toggle("ag-invisible",!visible),skipAriaHidden||setAriaHidden(element,!visible)}function setDisabled(element,disabled){const addOrRemoveDisabledAttribute=disabled?e=>e.setAttribute("disabled",""):e=>e.removeAttribute("disabled");addOrRemoveDisabledAttribute(element),nodeListForEach(element.querySelectorAll("input"),input=>addOrRemoveDisabledAttribute(input))}function isElementChildOfClass(element,cls,maxNest){let counter=0;for(;element;){if(element.classList.contains(cls))return!0;if(element=element.parentElement,"number"==typeof maxNest){if(++counter>maxNest)break}else if(element===maxNest)break}return!1}function getElementSize(el){const{height,width,borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth,paddingTop,paddingRight,paddingBottom,paddingLeft,marginTop,marginRight,marginBottom,marginLeft,boxSizing}=window.getComputedStyle(el);return{height:parseFloat(height||"0"),width:parseFloat(width||"0"),borderTopWidth:parseFloat(borderTopWidth||"0"),borderRightWidth:parseFloat(borderRightWidth||"0"),borderBottomWidth:parseFloat(borderBottomWidth||"0"),borderLeftWidth:parseFloat(borderLeftWidth||"0"),paddingTop:parseFloat(paddingTop||"0"),paddingRight:parseFloat(paddingRight||"0"),paddingBottom:parseFloat(paddingBottom||"0"),paddingLeft:parseFloat(paddingLeft||"0"),marginTop:parseFloat(marginTop||"0"),marginRight:parseFloat(marginRight||"0"),marginBottom:parseFloat(marginBottom||"0"),marginLeft:parseFloat(marginLeft||"0"),boxSizing}}function getInnerHeight(el){const size=getElementSize(el);return"border-box"===size.boxSizing?size.height-size.paddingTop-size.paddingBottom:size.height}function getInnerWidth(el){const size=getElementSize(el);return"border-box"===size.boxSizing?size.width-size.paddingLeft-size.paddingRight:size.width}function getAbsoluteHeight(el){const size=getElementSize(el),marginRight=size.marginBottom+size.marginTop;return Math.ceil(el.offsetHeight+marginRight)}function getAbsoluteWidth(el){const size=getElementSize(el),marginWidth=size.marginLeft+size.marginRight;return Math.ceil(el.offsetWidth+marginWidth)}function getElementRectWithOffset(el){const offsetElementRect=el.getBoundingClientRect(),{borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth}=getElementSize(el);return{top:offsetElementRect.top+(borderTopWidth||0),left:offsetElementRect.left+(borderLeftWidth||0),right:offsetElementRect.right+(borderRightWidth||0),bottom:offsetElementRect.bottom+(borderBottomWidth||0)}}function isRtlNegativeScroll(){if("boolean"==typeof rtlNegativeScroll)return rtlNegativeScroll;const template=document.createElement("div");return template.style.direction="rtl",template.style.width="1px",template.style.height="1px",template.style.position="fixed",template.style.top="0px",template.style.overflow="hidden",template.dir="rtl",template.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(template),template.scrollLeft=1,rtlNegativeScroll=0===Math.floor(template.scrollLeft),document.body.removeChild(template),rtlNegativeScroll}function getScrollLeft(element,rtl){let scrollLeft=element.scrollLeft;return rtl&&(scrollLeft=Math.abs(scrollLeft),isBrowserChrome()&&!isRtlNegativeScroll()&&(scrollLeft=element.scrollWidth-element.clientWidth-scrollLeft)),scrollLeft}function setScrollLeft(element,value,rtl){rtl&&(isRtlNegativeScroll()?value*=-1:(isBrowserSafari()||isBrowserChrome())&&(value=element.scrollWidth-element.clientWidth-value)),element.scrollLeft=value}function clearElement(el){for(;el&&el.firstChild;)el.removeChild(el.firstChild)}function removeFromParent(node){node&&node.parentNode&&node.parentNode.removeChild(node)}function isInDOM(element){return!!element.offsetParent}function isVisible(element){const el=element;if(el.checkVisibility)return el.checkVisibility({checkVisibilityCSS:!0});return!(!isInDOM(element)||"visible"!==window.getComputedStyle(element).visibility)}function loadTemplate(template){const tempDiv=document.createElement("div");return tempDiv.innerHTML=(template||"").trim(),tempDiv.firstChild}function ensureDomOrder(eContainer,eChild,eChildBefore){eChildBefore&&eChildBefore.nextSibling===eChild||(eChildBefore?eChildBefore.nextSibling?eContainer.insertBefore(eChild,eChildBefore.nextSibling):eContainer.appendChild(eChild):eContainer.firstChild&&eContainer.firstChild!==eChild&&eContainer.insertAdjacentElement("afterbegin",eChild))}function setDomChildOrder(eContainer,orderedChildren){for(let i=0;i<orderedChildren.length;i++){const correctCellAtIndex=orderedChildren[i],actualCellAtIndex=eContainer.children[i];actualCellAtIndex!==correctCellAtIndex&&eContainer.insertBefore(correctCellAtIndex,actualCellAtIndex)}}function insertWithDomOrder(eContainer,eToInsert,eChildBefore){eChildBefore?eChildBefore.insertAdjacentElement("afterend",eToInsert):eContainer.firstChild?eContainer.insertAdjacentElement("afterbegin",eToInsert):eContainer.appendChild(eToInsert)}function addStylesToElement(eElement,styles){if(styles)for(const[key,value]of Object.entries(styles)){if(!key||!key.length||null==value)continue;const parsedKey=camelCaseToHyphenated(key),valueAsString=value.toString(),parsedValue=valueAsString.replace(/\s*!important/g,""),priority=parsedValue.length!=valueAsString.length?"important":void 0;eElement.style.setProperty(parsedKey,parsedValue,priority)}}function isHorizontalScrollShowing(element){return element.clientWidth<element.scrollWidth}function isVerticalScrollShowing(element){return element.clientHeight<element.scrollHeight}function setElementWidth(element,width){"flex"===width?(element.style.removeProperty("width"),element.style.removeProperty("minWidth"),element.style.removeProperty("maxWidth"),element.style.flex="1 1 auto"):setFixedWidth(element,width)}function setFixedWidth(element,width){width=formatSize(width),element.style.width=width.toString(),element.style.maxWidth=width.toString(),element.style.minWidth=width.toString()}function setElementHeight(element,height){"flex"===height?(element.style.removeProperty("height"),element.style.removeProperty("minHeight"),element.style.removeProperty("maxHeight"),element.style.flex="1 1 auto"):setFixedHeight(element,height)}function setFixedHeight(element,height){height=formatSize(height),element.style.height=height.toString(),element.style.maxHeight=height.toString(),element.style.minHeight=height.toString()}function formatSize(size){return"number"==typeof size?`${size}px`:size}function isNodeOrElement(o){return o instanceof Node||o instanceof HTMLElement}function copyNodeList(nodeList){if(null==nodeList)return[];const result=[];return nodeListForEach(nodeList,node=>result.push(node)),result}function iterateNamedNodeMap(map,callback){if(map)for(let i=0;i<map.length;i++){const attr=map[i];callback(attr.name,attr.value)}}function addOrRemoveAttribute(element,name,value){null==value?element.removeAttribute(name):element.setAttribute(name,value.toString())}function nodeListForEach(nodeList,action){if(null!=nodeList)for(let i=0;i<nodeList.length;i++)action(nodeList[i])}function bindCellRendererToHtmlElement(cellRendererPromise,eTarget){cellRendererPromise.then(cellRenderer=>{const gui=cellRenderer.getGui();null!=gui&&("object"==typeof gui?eTarget.appendChild(gui):eTarget.innerHTML=gui)})}var fuzzyMatch_exports={};function fuzzyCheckStrings(inputValues,validValues,allSuggestions){const fuzzyMatches={},invalidInputs=inputValues.filter(inputValue=>!validValues.some(validValue=>validValue===inputValue));return invalidInputs.length>0&&invalidInputs.forEach(invalidInput=>fuzzyMatches[invalidInput]=fuzzySuggestions(invalidInput,allSuggestions).values),fuzzyMatches}function fuzzySuggestions(inputValue,allSuggestions,hideIrrelevant,filterByPercentageOfBestMatch){let thisSuggestions=allSuggestions.map((text,idx)=>({value:text,relevance:stringWeightedDistances(inputValue.toLowerCase(),text.toLocaleLowerCase()),idx}));if(thisSuggestions.sort((a,b)=>b.relevance-a.relevance),hideIrrelevant&&(thisSuggestions=thisSuggestions.filter(suggestion=>0!==suggestion.relevance)),thisSuggestions.length>0&&filterByPercentageOfBestMatch&&filterByPercentageOfBestMatch>0){const limit=thisSuggestions[0].relevance*filterByPercentageOfBestMatch;thisSuggestions=thisSuggestions.filter(suggestion=>limit-suggestion.relevance<0)}const values2=[],indices=[];for(const suggestion of thisSuggestions)values2.push(suggestion.value),indices.push(suggestion.idx);return{values:values2,indices}}function stringWeightedDistances(str1,str2){const a=str1.replace(/\s/g,""),b=str2.replace(/\s/g,"");let weight=0,lastIndex=-1;for(let i=0;i<a.length;i++){const idx=b.indexOf(a[i],lastIndex+1);-1!==idx&&(lastIndex=idx,weight+=100-100*lastIndex/1e4*100)}return weight}__export(fuzzyMatch_exports,{fuzzyCheckStrings:()=>fuzzyCheckStrings,fuzzySuggestions:()=>fuzzySuggestions});var icon_exports={};__export(icon_exports,{createIcon:()=>createIcon,createIconNoSpan:()=>createIconNoSpan,iconNameClassMap:()=>iconNameClassMap});var iconNameClassMap={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",setFilterGroupClosed:"tree-closed",setFilterGroupOpen:"tree-open",setFilterGroupIndeterminate:"tree-indeterminate",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",menuAlt:"menu-alt",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardCut:"cut",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",advancedFilterBuilder:"group",advancedFilterBuilderDrag:"grip",advancedFilterBuilderInvalid:"not-allowed",advancedFilterBuilderMoveUp:"up",advancedFilterBuilderMoveDown:"down",advancedFilterBuilderAdd:"plus",advancedFilterBuilderRemove:"minus",chartsMenuEdit:"chart",chartsMenuAdvancedSettings:"settings",chartsMenuAdd:"plus"};function createIcon(iconName,gos,column){const iconContents=createIconNoSpan(iconName,gos,column);if(iconContents){const{className}=iconContents;if("string"==typeof className&&className.indexOf("ag-icon")>-1||"object"==typeof className&&className["ag-icon"])return iconContents}const eResult=document.createElement("span");return eResult.appendChild(iconContents),eResult}function createIconNoSpan(iconName,gos,column,forceCreate){let userProvidedIcon=null;const icons=column&&column.getColDef().icons;if(icons&&(userProvidedIcon=icons[iconName]),gos&&!userProvidedIcon){const optionsIcons=gos.get("icons");optionsIcons&&(userProvidedIcon=optionsIcons[iconName])}if(!userProvidedIcon){const span=document.createElement("span");let cssClass=iconNameClassMap[iconName];return cssClass||(forceCreate?cssClass=iconName:(console.warn(`AG Grid: Did not find icon ${iconName}`),cssClass="")),span.setAttribute("class",`ag-icon ag-icon-${cssClass}`),span.setAttribute("unselectable","on"),setAriaRole(span,"presentation"),span}{let rendererResult;if("function"==typeof userProvidedIcon)rendererResult=userProvidedIcon();else{if("string"!=typeof userProvidedIcon)throw new Error("icon from grid options needs to be a string or a function");rendererResult=userProvidedIcon}if("string"==typeof rendererResult)return loadTemplate(rendererResult);if(isNodeOrElement(rendererResult))return rendererResult;console.warn("AG Grid: iconRenderer should return back a string or a dom object")}}var keyboard_exports={};__export(keyboard_exports,{isDeleteKey:()=>isDeleteKey,isEventFromPrintableCharacter:()=>isEventFromPrintableCharacter,isUserSuppressingHeaderKeyboardEvent:()=>isUserSuppressingHeaderKeyboardEvent,isUserSuppressingKeyboardEvent:()=>isUserSuppressingKeyboardEvent,normaliseQwertyAzerty:()=>normaliseQwertyAzerty});var KeyCode=class{};KeyCode.BACKSPACE="Backspace",KeyCode.TAB="Tab",KeyCode.ENTER="Enter",KeyCode.ESCAPE="Escape",KeyCode.SPACE=" ",KeyCode.LEFT="ArrowLeft",KeyCode.UP="ArrowUp",KeyCode.RIGHT="ArrowRight",KeyCode.DOWN="ArrowDown",KeyCode.DELETE="Delete",KeyCode.F2="F2",KeyCode.PAGE_UP="PageUp",KeyCode.PAGE_DOWN="PageDown",KeyCode.PAGE_HOME="Home",KeyCode.PAGE_END="End",KeyCode.A="KeyA",KeyCode.C="KeyC",KeyCode.D="KeyD",KeyCode.V="KeyV",KeyCode.X="KeyX",KeyCode.Y="KeyY",KeyCode.Z="KeyZ";var A_KEYCODE=65,C_KEYCODE=67,V_KEYCODE=86,D_KEYCODE=68,Z_KEYCODE=90,Y_KEYCODE=89;function isEventFromPrintableCharacter(event){if(event.altKey||event.ctrlKey||event.metaKey)return!1;return 1===event.key.length}function isUserSuppressingKeyboardEvent(gos,keyboardEvent,rowNode,column,editing){const colDefFunc=column?column.getColDef().suppressKeyboardEvent:void 0;if(!colDefFunc)return!1;const params=gos.addGridCommonParams({event:keyboardEvent,editing,column,node:rowNode,data:rowNode.data,colDef:column.getColDef()});if(colDefFunc){if(colDefFunc(params))return!0}return!1}function isUserSuppressingHeaderKeyboardEvent(gos,keyboardEvent,headerRowIndex,column){const colDef=column.getDefinition(),colDefFunc=colDef&&colDef.suppressHeaderKeyboardEvent;if(!exists(colDefFunc))return!1;return!!colDefFunc(gos.addGridCommonParams({colDef,column,headerRowIndex,event:keyboardEvent}))}function normaliseQwertyAzerty(keyboardEvent){const{keyCode}=keyboardEvent;let code;switch(keyCode){case A_KEYCODE:code=KeyCode.A;break;case C_KEYCODE:code=KeyCode.C;break;case V_KEYCODE:code=KeyCode.V;break;case D_KEYCODE:code=KeyCode.D;break;case Z_KEYCODE:code=KeyCode.Z;break;case Y_KEYCODE:code=KeyCode.Y;break;default:code=keyboardEvent.code}return code}function isDeleteKey(key,alwaysReturnFalseOnBackspace=!1){return key===KeyCode.DELETE||!alwaysReturnFalseOnBackspace&&key===KeyCode.BACKSPACE&&isMacOsUserAgent()}var mouse_exports={};function areEventsNear(e1,e2,pixelCount){if(0===pixelCount)return!1;const diffX=Math.abs(e1.clientX-e2.clientX),diffY=Math.abs(e1.clientY-e2.clientY);return Math.max(diffX,diffY)<=pixelCount}__export(mouse_exports,{areEventsNear:()=>areEventsNear});var rowNode_exports={};function sortRowNodesByOrder(rowNodes,rowNodeOrder){if(!rowNodes)return!1;const comparator=(nodeA,nodeB)=>{const positionA=rowNodeOrder[nodeA.id],positionB=rowNodeOrder[nodeB.id],aHasIndex=void 0!==positionA,bHasIndex=void 0!==positionB;return aHasIndex&&bHasIndex?positionA-positionB:!aHasIndex&&!bHasIndex?nodeA.__objectId-nodeB.__objectId:aHasIndex?1:-1};let rowNodeA,rowNodeB,atLeastOneOutOfOrder=!1;for(let i=0;i<rowNodes.length-1;i++)if(rowNodeA=rowNodes[i],rowNodeB=rowNodes[i+1],comparator(rowNodeA,rowNodeB)>0){atLeastOneOutOfOrder=!0;break}return!!atLeastOneOutOfOrder&&(rowNodes.sort(comparator),!0)}__export(rowNode_exports,{sortRowNodesByOrder:()=>sortRowNodesByOrder});var set_exports={};function convertToSet(list){const set=new Set;return list.forEach(x=>set.add(x)),set}__export(set_exports,{convertToSet:()=>convertToSet});var _=__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues(__spreadValues({},aria_exports),array_exports),browser_exports),date_exports),dom_exports),event_exports),function_exports),fuzzyMatch_exports),generic_exports),icon_exports),keyboard_exports),map_exports),mouse_exports),number_exports),object_exports),rowNode_exports),set_exports),string_exports),NumberSequence=class{constructor(initValue=0,step=1){this.nextValue=initValue,this.step=step}next(){const valToReturn=this.nextValue;return this.nextValue+=this.step,valToReturn}peek(){return this.nextValue}skip(count){this.nextValue+=count}},AgPromise=class _AgPromise{constructor(callback){this.status=0,this.resolution=null,this.waiters=[],callback(value=>this.onDone(value),params=>this.onReject(params))}static all(promises){return new _AgPromise(resolve=>{let remainingToResolve=promises.length;const combinedValues=new Array(remainingToResolve);promises.forEach((promise,index)=>{promise.then(value=>{combinedValues[index]=value,remainingToResolve--,0===remainingToResolve&&resolve(combinedValues)})})})}static resolve(value=null){return new _AgPromise(resolve=>resolve(value))}then(func){return new _AgPromise(resolve=>{1===this.status?resolve(func(this.resolution)):this.waiters.push(value=>resolve(func(value)))})}resolveNow(ifNotResolvedValue,ifResolved){return 1===this.status?ifResolved(this.resolution):ifNotResolvedValue}onDone(value){this.status=1,this.resolution=value,this.waiters.forEach(waiter=>waiter(value))}onReject(params){console.warn("TBI")}},CssClassManager=class{constructor(getGui){this.cssClassStates={},this.getGui=getGui}addCssClass(className){const list=(className||"").split(" ");if(list.length>1)return void list.forEach(cls=>this.addCssClass(cls));if(!0!==this.cssClassStates[className]&&className.length){const eGui=this.getGui();eGui&&eGui.classList.add(className),this.cssClassStates[className]=!0}}removeCssClass(className){const list=(className||"").split(" ");if(list.length>1)return void list.forEach(cls=>this.removeCssClass(cls));if(!1!==this.cssClassStates[className]&&className.length){const eGui=this.getGui();eGui&&eGui.classList.remove(className),this.cssClassStates[className]=!1}}containsCssClass(className){const eGui=this.getGui();return!!eGui&&eGui.classList.contains(className)}addOrRemoveCssClass(className,addOrRemove){if(!className)return;if(className.indexOf(" ")>=0){const list=(className||"").split(" ");if(list.length>1)return void list.forEach(cls=>this.addOrRemoveCssClass(cls,addOrRemove))}if(this.cssClassStates[className]!==addOrRemove&&className.length){const eGui=this.getGui();eGui&&eGui.classList.toggle(className,addOrRemove),this.cssClassStates[className]=addOrRemove}}},_TooltipStateManager=class _TooltipStateManager extends BeanStub{constructor(parentComp,tooltipShowDelayOverride,tooltipHideDelayOverride,shouldDisplayTooltip){super(),this.parentComp=parentComp,this.tooltipShowDelayOverride=tooltipShowDelayOverride,this.tooltipHideDelayOverride=tooltipHideDelayOverride,this.shouldDisplayTooltip=shouldDisplayTooltip,this.SHOW_QUICK_TOOLTIP_DIFF=1e3,this.FADE_OUT_TOOLTIP_TIMEOUT=1e3,this.INTERACTIVE_HIDE_DELAY=100,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const el=this.parentComp.getGui();0===this.tooltipTrigger&&(this.addManagedListener(el,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(el,"mouseleave",this.onMouseLeave.bind(this))),1===this.tooltipTrigger&&(this.addManagedListener(el,"focusin",this.onFocusIn.bind(this)),this.addManagedListener(el,"focusout",this.onFocusOut.bind(this))),this.addManagedListener(el,"mousemove",this.onMouseMove.bind(this)),this.interactionEnabled||(this.addManagedListener(el,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(el,"keydown",this.onKeyDown.bind(this)))}getGridOptionsTooltipDelay(delayOption){const delay=this.gos.get(delayOption);return delay<0&&warnOnce(`${delayOption} should not be lower than 0`),Math.max(200,delay)}getTooltipDelay(type){var _a,_b;return"show"===type?null!=(_a=this.tooltipShowDelayOverride)?_a:this.getGridOptionsTooltipDelay("tooltipShowDelay"):null!=(_b=this.tooltipHideDelayOverride)?_b:this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const trigger=this.gos.get("tooltipTrigger");return trigger&&"hover"!==trigger?1:0}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),isIOSUserAgent()||(_TooltipStateManager.isLocked?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},this.INTERACTIVE_HIDE_DELAY):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&2===this.state&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){var _a;const relatedTarget=e.relatedTarget,parentCompGui=this.parentComp.getGui(),tooltipGui=null==(_a=this.tooltipComp)?void 0:_a.getGui();this.isInteractingWithTooltip||parentCompGui.contains(relatedTarget)||this.interactionEnabled&&(null==tooltipGui?void 0:tooltipGui.contains(relatedTarget))||this.setToDoNothing()}onKeyDown(){this.setToDoNothing()}prepareToShowTooltip(mouseEvent){if(0!=this.state||_TooltipStateManager.isLocked)return;let delay=0;mouseEvent&&(delay=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=mouseEvent||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),delay),this.state=1}isLastTooltipHiddenRecently(){return(new Date).getTime()-_TooltipStateManager.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF}setToDoNothing(){2===this.state&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.onColumnMovedEventCallback&&(this.onColumnMovedEventCallback(),this.onColumnMovedEventCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const params=__spreadValues({},this.parentComp.getTooltipParams());if(!exists(params.value)||this.shouldDisplayTooltip&&!this.shouldDisplayTooltip())return void this.setToDoNothing();this.state=2,this.tooltipInstanceCount++;const callback=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(params).newAgStackInstance().then(callback)}hideTooltip(forceHide){if(!forceHide&&this.isInteractingWithTooltip)return;this.tooltipComp&&(this.destroyTooltipComp(),_TooltipStateManager.lastTooltipHideTime=(new Date).getTime());const event={type:Events.EVENT_TOOLTIP_HIDE,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(event),this.state=0}newTooltipComponentCallback(tooltipInstanceCopy,tooltipComp){if(2!==this.state||this.tooltipInstanceCount!==tooltipInstanceCopy)return void this.getContext().destroyBean(tooltipComp);const eGui=tooltipComp.getGui();this.tooltipComp=tooltipComp,eGui.classList.contains("ag-tooltip")||eGui.classList.add("ag-tooltip-custom"),0===this.tooltipTrigger&&eGui.classList.add("ag-tooltip-animate"),this.interactionEnabled&&eGui.classList.add("ag-tooltip-interactive");const translate=this.localeService.getLocaleTextFunc(),addPopupRes=this.popupService.addPopup({eChild:eGui,ariaLabel:translate("ariaLabelTooltip","Tooltip")});addPopupRes&&(this.tooltipPopupDestroyFunc=addPopupRes.hideFunc),this.positionTooltip(),1===this.tooltipTrigger&&(this.onBodyScrollEventCallback=this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,this.setToDoNothing.bind(this)),this.onColumnMovedEventCallback=this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,this.setToDoNothing.bind(this))),this.interactionEnabled&&(0===this.tooltipTrigger?(this.tooltipMouseEnterListener=this.addManagedListener(eGui,"mouseenter",this.onTooltipMouseEnter.bind(this))||null,this.tooltipMouseLeaveListener=this.addManagedListener(eGui,"mouseleave",this.onTooltipMouseLeave.bind(this))||null):(this.tooltipFocusInListener=this.addManagedListener(eGui,"focusin",this.onTooltipFocusIn.bind(this))||null,this.tooltipFocusOutListener=this.addManagedListener(eGui,"focusout",this.onTooltipFocusOut.bind(this))||null));const event={type:Events.EVENT_TOOLTIP_SHOW,tooltipGui:eGui,parentGui:this.parentComp.getGui()};this.eventService.dispatchEvent(event),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isInteractingWithTooltip=!1,this.lockService()}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}onTooltipFocusOut(e){var _a;const parentGui=this.parentComp.getGui(),tooltipGui=null==(_a=this.tooltipComp)?void 0:_a.getGui(),relatedTarget=e.relatedTarget;(null==tooltipGui?void 0:tooltipGui.contains(relatedTarget))||(this.isInteractingWithTooltip=!1,parentGui.contains(relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const params={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupService.positionPopupUnderMouseEvent(__spreadProps(__spreadValues({},params),{mouseEvent:this.lastMouseEvent})):this.popupService.positionPopupByComponent(__spreadProps(__spreadValues({},params),{eventSource:this.parentComp.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5}))}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const tooltipPopupDestroyFunc=this.tooltipPopupDestroyFunc,tooltipComp=this.tooltipComp,delay=0===this.tooltipTrigger?this.FADE_OUT_TOOLTIP_TIMEOUT:0;window.setTimeout(()=>{tooltipPopupDestroyFunc(),this.getContext().destroyBean(tooltipComp)},delay),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener].forEach(listener=>{listener&&listener()}),this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){_TooltipStateManager.isLocked=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},this.INTERACTIVE_HIDE_DELAY)}unlockService(){_TooltipStateManager.isLocked=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}};_TooltipStateManager.isLocked=!1,__decorateClass([Autowired("popupService")],_TooltipStateManager.prototype,"popupService",2),__decorateClass([Autowired("userComponentFactory")],_TooltipStateManager.prototype,"userComponentFactory",2),__decorateClass([PostConstruct],_TooltipStateManager.prototype,"postConstruct",1);var TooltipStateManager=_TooltipStateManager,TooltipFeature=class extends BeanStub{constructor(ctrl,beans){super(),this.ctrl=ctrl,beans&&(this.beans=beans)}postConstruct(){this.refreshToolTip()}setBrowserTooltip(tooltip){const eGui=this.ctrl.getGui();eGui&&(null!=tooltip&&""!=tooltip?eGui.setAttribute("title",tooltip):eGui.removeAttribute("title"))}updateTooltipText(){this.tooltip=this.ctrl.getTooltipValue()}createTooltipFeatureIfNeeded(){var _a,_b,_c,_d;if(null!=this.tooltipManager)return;const parent={getTooltipParams:()=>this.getTooltipParams(),getGui:()=>this.ctrl.getGui()};this.tooltipManager=this.createBean(new TooltipStateManager(parent,null==(_b=(_a=this.ctrl).getTooltipShowDelayOverride)?void 0:_b.call(_a),null==(_d=(_c=this.ctrl).getTooltipHideDelayOverride)?void 0:_d.call(_c),this.ctrl.shouldDisplayTooltip),this.beans.context)}refreshToolTip(){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context))):(this.setBrowserTooltip(null),this.createTooltipFeatureIfNeeded())}getTooltipParams(){const ctrl=this.ctrl,column=ctrl.getColumn?ctrl.getColumn():void 0,colDef=ctrl.getColDef?ctrl.getColDef():void 0,rowNode=ctrl.getRowNode?ctrl.getRowNode():void 0;return{location:ctrl.getLocation(),colDef,column,rowIndex:ctrl.getRowIndex?ctrl.getRowIndex():void 0,node:rowNode,data:rowNode?rowNode.data:void 0,value:this.getTooltipText(),valueFormatted:ctrl.getValueFormatted?ctrl.getValueFormatted():void 0,hideTooltipCallback:()=>{var _a;return null==(_a=this.tooltipManager)?void 0:_a.hideTooltip(!0)}}}getTooltipText(){return this.tooltip}destroy(){this.tooltipManager&&(this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)),super.destroy()}};__decorateClass([Autowired("beans")],TooltipFeature.prototype,"beans",2),__decorateClass([PostConstruct],TooltipFeature.prototype,"postConstruct",1);var compIdSequence=new NumberSequence,_Component=class _Component extends BeanStub{constructor(template){super(),this.displayed=!0,this.visible=!0,this.compId=compIdSequence.next(),this.cssClassManager=new CssClassManager(()=>this.eGui),template&&this.setTemplate(template)}preConstructOnComponent(){this.usingBrowserTooltips=this.gos.get("enableBrowserTooltips")}getCompId(){return this.compId}getTooltipParams(){return{value:this.tooltipText,location:"UNKNOWN"}}setTooltip(params){const{newTooltipText,showDelayOverride,hideDelayOverride,location,shouldDisplayTooltip}=params||{};this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),this.tooltipText!==newTooltipText&&(this.tooltipText=newTooltipText);const getTooltipValue=()=>this.tooltipText;null!=newTooltipText&&(this.tooltipFeature=this.createBean(new TooltipFeature({getTooltipValue,getGui:()=>this.getGui(),getLocation:()=>null!=location?location:"UNKNOWN",getColDef:null==params?void 0:params.getColDef,getColumn:null==params?void 0:params.getColumn,getTooltipShowDelayOverride:null!=showDelayOverride?()=>showDelayOverride:void 0,getTooltipHideDelayOverride:null!=hideDelayOverride?()=>hideDelayOverride:void 0,shouldDisplayTooltip})))}createChildComponentsFromTags(parentNode,paramsMap){copyNodeList(parentNode.childNodes).forEach(childNode=>{if(!(childNode instanceof HTMLElement))return;const childComp=this.createComponentFromElement(childNode,childComp2=>{childComp2.getGui()&&this.copyAttributesFromNode(childNode,childComp2.getGui())},paramsMap);if(childComp){if(childComp.addItems&&childNode.children.length){this.createChildComponentsFromTags(childNode,paramsMap);const items=Array.prototype.slice.call(childNode.children);childComp.addItems(items)}this.swapComponentForNode(childComp,parentNode,childNode)}else childNode.childNodes&&this.createChildComponentsFromTags(childNode,paramsMap)})}createComponentFromElement(element,afterPreCreateCallback,paramsMap){const key=element.nodeName,componentParams=paramsMap?paramsMap[element.getAttribute("ref")]:void 0,ComponentClass=this.agStackComponentsRegistry.getComponentClass(key);if(ComponentClass){_Component.elementGettingCreated=element;const newComponent=new ComponentClass(componentParams);return newComponent.setParentComponent(this),this.createBean(newComponent,null,afterPreCreateCallback),newComponent}return null}copyAttributesFromNode(source,dest){iterateNamedNodeMap(source.attributes,(name,value)=>dest.setAttribute(name,value))}swapComponentForNode(newComponent,parentNode,childNode){const eComponent=newComponent.getGui();parentNode.replaceChild(eComponent,childNode),parentNode.insertBefore(document.createComment(childNode.nodeName),eComponent),this.addDestroyFunc(this.destroyBean.bind(this,newComponent)),this.swapInComponentForQuerySelectors(newComponent,childNode)}swapInComponentForQuerySelectors(newComponent,childNode){const thisNoType=this;this.iterateOverQuerySelectors(querySelector=>{thisNoType[querySelector.attributeName]===childNode&&(thisNoType[querySelector.attributeName]=newComponent)})}iterateOverQuerySelectors(action){let thisPrototype=Object.getPrototypeOf(this);for(;null!=thisPrototype;){const metaData=thisPrototype.__agComponentMetaData,currentProtoName=getFunctionName(thisPrototype.constructor);metaData&&metaData[currentProtoName]&&metaData[currentProtoName].querySelectors&&metaData[currentProtoName].querySelectors.forEach(querySelector=>action(querySelector)),thisPrototype=Object.getPrototypeOf(thisPrototype)}}activateTabIndex(elements){const tabIndex=this.gos.get("tabIndex");elements||(elements=[]),elements.length||elements.push(this.getGui()),elements.forEach(el=>el.setAttribute("tabindex",tabIndex.toString()))}setTemplate(template,paramsMap){const eGui=loadTemplate(template);this.setTemplateFromElement(eGui,paramsMap)}setTemplateFromElement(element,paramsMap){this.eGui=element,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),paramsMap)}createChildComponentsPreConstruct(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())}wireQuerySelectors(){if(!this.eGui)return;const thisNoType=this;this.iterateOverQuerySelectors(querySelector=>{const setResult=result=>thisNoType[querySelector.attributeName]=result;if(querySelector.refSelector&&this.getAttribute("ref")===querySelector.refSelector)setResult(this.eGui);else{const resultOfQuery=this.eGui.querySelector(querySelector.querySelector);resultOfQuery&&setResult(resultOfQuery.__agComponent||resultOfQuery)}})}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(component){this.parentComponent=component}getParentComponent(){return this.parentComponent}setGui(eGui){this.eGui=eGui}queryForHtmlElement(cssSelector){return this.eGui.querySelector(cssSelector)}queryForHtmlInputElement(cssSelector){return this.eGui.querySelector(cssSelector)}appendChild(newChild,container){if(null!=newChild)if(container||(container=this.eGui),isNodeOrElement(newChild))container.appendChild(newChild);else{const childComponent=newChild;container.appendChild(childComponent.getGui())}}isDisplayed(){return this.displayed}setVisible(visible,options={}){if(visible!==this.visible){this.visible=visible;const{skipAriaHidden}=options;setVisible(this.eGui,visible,{skipAriaHidden})}}setDisplayed(displayed,options={}){if(displayed!==this.displayed){this.displayed=displayed;const{skipAriaHidden}=options;setDisplayed(this.eGui,displayed,{skipAriaHidden});const event={type:_Component.EVENT_DISPLAYED_CHANGED,visible:this.displayed};this.dispatchEvent(event)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const eGui=this.eGui;eGui&&eGui.__agComponent&&(eGui.__agComponent=void 0),super.destroy()}addGuiEventListener(event,listener,options){this.eGui.addEventListener(event,listener,options),this.addDestroyFunc(()=>this.eGui.removeEventListener(event,listener))}addCssClass(className){this.cssClassManager.addCssClass(className)}removeCssClass(className){this.cssClassManager.removeCssClass(className)}containsCssClass(className){return this.cssClassManager.containsCssClass(className)}addOrRemoveCssClass(className,addOrRemove){this.cssClassManager.addOrRemoveCssClass(className,addOrRemove)}getAttribute(key){const{eGui}=this;return eGui?eGui.getAttribute(key):null}getRefElement(refName){return this.queryForHtmlElement(`[ref="${refName}"]`)}};_Component.EVENT_DISPLAYED_CHANGED="displayedChanged",__decorateClass([Autowired("agStackComponentsRegistry")],_Component.prototype,"agStackComponentsRegistry",2),__decorateClass([PreConstruct],_Component.prototype,"preConstructOnComponent",1),__decorateClass([PreConstruct],_Component.prototype,"createChildComponentsPreConstruct",1);var Component=_Component;function RefSelector(ref){return querySelectorFunc.bind(this,`[ref=${ref}]`,ref)}function querySelectorFunc(selector,refSelector,classPrototype,methodOrAttributeName,index){null!==selector?"number"!=typeof index?function addToObjectProps(target,key,value){const props=function getOrCreateProps2(target,instanceName){target.__agComponentMetaData||(target.__agComponentMetaData={});target.__agComponentMetaData[instanceName]||(target.__agComponentMetaData[instanceName]={});return target.__agComponentMetaData[instanceName]}(target,getFunctionName(target.constructor));props[key]||(props[key]=[]);props[key].push(value)}(classPrototype,"querySelectors",{attributeName:methodOrAttributeName,querySelector:selector,refSelector}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}var ReadOnlyFloatingFilter=class extends Component{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')}destroy(){super.destroy()}init(params){this.params=params;const displayName=this.columnModel.getDisplayNameForColumn(params.column,"header",!0),translate=this.localeService.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${displayName} ${translate("ariaFilterInput","Filter Input")}`)}onParentModelChanged(parentModel){null!=parentModel?this.params.parentFilterInstance(filterInstance=>{if(filterInstance.getModelAsString){const modelAsString=filterInstance.getModelAsString(parentModel);this.eFloatingFilterText.setValue(modelAsString)}}):this.eFloatingFilterText.setValue("")}onParamsUpdated(params){this.refresh(params)}refresh(params){this.init(params)}};__decorateClass([RefSelector("eFloatingFilterText")],ReadOnlyFloatingFilter.prototype,"eFloatingFilterText",2),__decorateClass([Autowired("columnModel")],ReadOnlyFloatingFilter.prototype,"columnModel",2);var DateCompWrapper=class{constructor(context,userComponentFactory,dateComponentParams,eParent,onReady){this.alive=!0,this.context=context,this.eParent=eParent;userComponentFactory.getDateCompDetails(dateComponentParams).newAgStackInstance().then(dateComp=>{this.alive?(this.dateComp=dateComp,dateComp&&(eParent.appendChild(dateComp.getGui()),dateComp.afterGuiAttached&&dateComp.afterGuiAttached(),this.tempValue&&dateComp.setDate(this.tempValue),null!=this.disabled&&this.setDateCompDisabled(this.disabled),null==onReady||onReady(this))):context.destroyBean(dateComp)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(value){this.dateComp?this.dateComp.setDate(value):this.tempValue=value}setDisabled(disabled){this.dateComp?this.setDateCompDisabled(disabled):this.disabled=disabled}setDisplayed(displayed){setDisplayed(this.eParent,displayed)}setInputPlaceholder(placeholder){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(placeholder)}setInputAriaLabel(label){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(label)}afterGuiAttached(params){this.dateComp&&"function"==typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(params)}updateParams(params){var _a,_b;let hasRefreshed=!1;if((null==(_a=this.dateComp)?void 0:_a.refresh)&&"function"==typeof this.dateComp.refresh){null!==this.dateComp.refresh(params)&&(hasRefreshed=!0)}if(!hasRefreshed&&(null==(_b=this.dateComp)?void 0:_b.onParamsUpdated)&&"function"==typeof this.dateComp.onParamsUpdated){null!==this.dateComp.onParamsUpdated(params)&&warnOnce("Custom date component method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}}setDateCompDisabled(disabled){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(disabled)}},OptionsFactory=class{constructor(){this.customFilterOptions={}}init(params,defaultOptions){this.filterOptions=params.filterOptions||defaultOptions,this.mapCustomOptions(),this.selectDefaultItem(params)}getFilterOptions(){return this.filterOptions}mapCustomOptions(){this.filterOptions&&this.filterOptions.forEach(filterOption=>{if("string"==typeof filterOption)return;[["displayKey"],["displayName"],["predicate","test"]].every(keys2=>!!keys2.some(key=>null!=filterOption[key])||(console.warn(`AG Grid: ignoring FilterOptionDef as it doesn't contain one of '${keys2}'`),!1))?this.customFilterOptions[filterOption.displayKey]=filterOption:this.filterOptions=this.filterOptions.filter(v=>v===filterOption)||[]})}selectDefaultItem(params){if(params.defaultOption)this.defaultOption=params.defaultOption;else if(this.filterOptions.length>=1){const firstFilterOption=this.filterOptions[0];"string"==typeof firstFilterOption?this.defaultOption=firstFilterOption:firstFilterOption.displayKey?this.defaultOption=firstFilterOption.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")}getDefaultOption(){return this.defaultOption}getCustomOption(name){return this.customFilterOptions[name]}},FILTER_LOCALE_TEXT={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},_ManagedFocusFeature=class _ManagedFocusFeature extends BeanStub{constructor(eFocusableElement,callbacks={}){super(),this.eFocusableElement=eFocusableElement,this.callbacks=callbacks,this.callbacks=__spreadValues({shouldStopEventPropagation:()=>!1,onTabKeyDown:e=>{if(e.defaultPrevented)return;const nextRoot=this.focusService.findNextFocusableElement(this.eFocusableElement,!1,e.shiftKey);nextRoot&&(nextRoot.focus(),e.preventDefault())}},callbacks)}postConstruct(){this.eFocusableElement.classList.add(_ManagedFocusFeature.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)}addKeyDownListeners(eGui){this.addManagedListener(eGui,"keydown",e=>{e.defaultPrevented||isStopPropagationForAgGrid(e)||(this.callbacks.shouldStopEventPropagation(e)?stopPropagationForAgGrid(e):e.key===KeyCode.TAB?this.callbacks.onTabKeyDown(e):this.callbacks.handleKeyDown&&this.callbacks.handleKeyDown(e))})}};_ManagedFocusFeature.FOCUS_MANAGED_CLASS="ag-focus-managed",__decorateClass([Autowired("focusService")],_ManagedFocusFeature.prototype,"focusService",2),__decorateClass([PostConstruct],_ManagedFocusFeature.prototype,"postConstruct",1);var ManagedFocusFeature=_ManagedFocusFeature,PositionableFeature=class extends BeanStub{constructor(element,config){super(),this.element=element,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config=Object.assign({},{popup:!1},config)}center(){const{clientHeight,clientWidth}=this.offsetParent,x=clientWidth/2-this.getWidth()/2,y=clientHeight/2-this.getHeight()/2;this.offsetElement(x,y)}initialisePosition(){if(this.positioned)return;const{centered,forcePopupParentAsOffsetParent,minWidth,width,minHeight,height,x,y}=this.config;this.offsetParent||this.setOffsetParent();let computedMinHeight=0,computedMinWidth=0;const isElementVisible=isVisible(this.element);if(isElementVisible){const boundaryEl=this.findBoundaryElement(),offsetParentComputedStyles=window.getComputedStyle(boundaryEl);if(null!=offsetParentComputedStyles.minWidth){const paddingWidth=boundaryEl.offsetWidth-this.element.offsetWidth;computedMinWidth=parseInt(offsetParentComputedStyles.minWidth,10)-paddingWidth}if(null!=offsetParentComputedStyles.minHeight){const paddingHeight=boundaryEl.offsetHeight-this.element.offsetHeight;computedMinHeight=parseInt(offsetParentComputedStyles.minHeight,10)-paddingHeight}}if(this.minHeight=minHeight||computedMinHeight,this.minWidth=minWidth||computedMinWidth,width&&this.setWidth(width),height&&this.setHeight(height),width&&height||this.refreshSize(),centered)this.center();else if(x||y)this.offsetElement(x,y);else if(isElementVisible&&forcePopupParentAsOffsetParent){let boundaryEl=this.boundaryEl,initialisedDuringPositioning=!0;if(boundaryEl||(boundaryEl=this.findBoundaryElement(),initialisedDuringPositioning=!1),boundaryEl){const top=parseFloat(boundaryEl.style.top),left=parseFloat(boundaryEl.style.left);initialisedDuringPositioning?this.offsetElement(isNaN(left)?0:left,isNaN(top)?0:top):this.setPosition(left,top)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(movable,moveElement){if(!this.config.popup||movable===this.movable)return;this.movable=movable;const params=this.moveElementDragListener||{eElement:moveElement,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};movable?(this.dragService.addDragSource(params),this.moveElementDragListener=params):(this.dragService.removeDragSource(params),this.moveElementDragListener=void 0)}setResizable(resizable){if(this.clearResizeListeners(),resizable?this.addResizers():this.removeResizers(),"boolean"==typeof resizable){if(!1===resizable)return;resizable={topLeft:resizable,top:resizable,topRight:resizable,right:resizable,bottomRight:resizable,bottom:resizable,bottomLeft:resizable,left:resizable}}Object.keys(resizable).forEach(side=>{const isSideResizable=!!resizable[side],resizerEl=this.getResizerElement(side),params={dragStartPixels:0,eElement:resizerEl,onDragStart:e=>this.onResizeStart(e,side),onDragging:this.onResize.bind(this),onDragStop:e=>this.onResizeEnd(e,side)};(isSideResizable||!this.isAlive()&&!isSideResizable)&&(isSideResizable?(this.dragService.addDragSource(params),this.resizeListeners.push(params),resizerEl.style.pointerEvents="all"):resizerEl.style.pointerEvents="none",this.resizable[side]=isSideResizable)})}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height,width}=this.lastSize;-1!==width&&(this.element.style.width=`${width}px`),-1!==height&&(this.element.style.height=`${height}px`)}getHeight(){return this.element.offsetHeight}setHeight(height){const{popup}=this.config,eGui=this.element;let isPercent=!1;if("string"==typeof height&&-1!==height.indexOf("%"))setFixedHeight(eGui,height),height=getAbsoluteHeight(eGui),isPercent=!0;else if(height=Math.max(this.minHeight,height),this.positioned){const availableHeight=this.getAvailableHeight();availableHeight&&height>availableHeight&&(height=availableHeight)}this.getHeight()!==height&&(isPercent?(eGui.style.maxHeight="unset",eGui.style.minHeight="unset"):popup?setFixedHeight(eGui,height):(eGui.style.height=`${height}px`,eGui.style.flex="0 0 auto",this.lastSize.height="number"==typeof height?height:parseFloat(height)))}getAvailableHeight(){const{popup,forcePopupParentAsOffsetParent}=this.config;this.positioned||this.initialisePosition();const{clientHeight}=this.offsetParent;if(!clientHeight)return null;const elRect=this.element.getBoundingClientRect(),offsetParentRect=this.offsetParent.getBoundingClientRect(),yPosition=popup?this.position.y:elRect.top,parentTop=popup?0:offsetParentRect.top;let additionalHeight=0;if(forcePopupParentAsOffsetParent){const parentEl=this.element.parentElement;if(parentEl){const{bottom}=parentEl.getBoundingClientRect();additionalHeight=bottom-elRect.bottom}}return clientHeight+parentTop-yPosition-additionalHeight}getWidth(){return this.element.offsetWidth}setWidth(width){const eGui=this.element,{popup}=this.config;let isPercent=!1;if("string"==typeof width&&-1!==width.indexOf("%"))setFixedWidth(eGui,width),width=getAbsoluteWidth(eGui),isPercent=!0;else if(this.positioned){width=Math.max(this.minWidth,width);const{clientWidth}=this.offsetParent,xPosition=popup?this.position.x:this.element.getBoundingClientRect().left;clientWidth&&width+xPosition>clientWidth&&(width=clientWidth-xPosition)}this.getWidth()!==width&&(isPercent?(eGui.style.maxWidth="unset",eGui.style.minWidth="unset"):this.config.popup?setFixedWidth(eGui,width):(eGui.style.width=`${width}px`,eGui.style.flex=" unset",this.lastSize.width="number"==typeof width?width:parseFloat(width)))}offsetElement(x=0,y=0){const{forcePopupParentAsOffsetParent}=this.config,ePopup=forcePopupParentAsOffsetParent?this.boundaryEl:this.element;ePopup&&(this.popupService.positionPopup({ePopup,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x,y})}),this.setPosition(parseFloat(ePopup.style.left),parseFloat(ePopup.style.top)))}constrainSizeToAvailableHeight(constrain){if(!this.config.forcePopupParentAsOffsetParent)return;const applyMaxHeightToElement=()=>{const availableHeight=this.getAvailableHeight();this.element.style.setProperty("max-height",`${availableHeight}px`)};constrain?this.resizeObserverSubscriber=this.resizeObserverService.observeResize(this.popupService.getPopupParent(),applyMaxHeightToElement):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(x,y){this.position.x=x,this.position.y=y}updateDragStartPosition(x,y){this.dragStartPosition={x,y}}calculateMouseMovement(params){const{e,isLeft,isTop,anywhereWithin,topBuffer}=params,xDiff=e.clientX-this.dragStartPosition.x,yDiff=e.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(e,!!isLeft,!!anywhereWithin,xDiff)?0:xDiff,movementY:this.shouldSkipY(e,!!isTop,topBuffer,yDiff)?0:yDiff}}shouldSkipX(e,isLeft,anywhereWithin,diff){const elRect=this.element.getBoundingClientRect(),parentRect=this.offsetParent.getBoundingClientRect(),boundaryElRect=this.boundaryEl.getBoundingClientRect(),xPosition=this.config.popup?this.position.x:elRect.left;let skipX=xPosition<=0&&parentRect.left>=e.clientX||parentRect.right<=e.clientX&&parentRect.right<=boundaryElRect.right;return!!skipX||(skipX=isLeft?diff<0&&e.clientX>xPosition+parentRect.left||diff>0&&e.clientX<xPosition+parentRect.left:anywhereWithin?diff<0&&e.clientX>boundaryElRect.right||diff>0&&e.clientX<xPosition+parentRect.left:diff<0&&e.clientX>boundaryElRect.right||diff>0&&e.clientX<boundaryElRect.right,skipX)}shouldSkipY(e,isTop,topBuffer=0,diff){const elRect=this.element.getBoundingClientRect(),parentRect=this.offsetParent.getBoundingClientRect(),boundaryElRect=this.boundaryEl.getBoundingClientRect(),yPosition=this.config.popup?this.position.y:elRect.top;let skipY=yPosition<=0&&parentRect.top>=e.clientY||parentRect.bottom<=e.clientY&&parentRect.bottom<=boundaryElRect.bottom;return!!skipY||(skipY=isTop?diff<0&&e.clientY>yPosition+parentRect.top+topBuffer||diff>0&&e.clientY<yPosition+parentRect.top:diff<0&&e.clientY>boundaryElRect.bottom||diff>0&&e.clientY<boundaryElRect.bottom,skipY)}createResizeMap(){const eGui=this.element;this.resizerMap={topLeft:{element:eGui.querySelector("[ref=eTopLeftResizer]")},top:{element:eGui.querySelector("[ref=eTopResizer]")},topRight:{element:eGui.querySelector("[ref=eTopRightResizer]")},right:{element:eGui.querySelector("[ref=eRightResizer]")},bottomRight:{element:eGui.querySelector("[ref=eBottomRightResizer]")},bottom:{element:eGui.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:eGui.querySelector("[ref=eBottomLeftResizer]")},left:{element:eGui.querySelector("[ref=eLeftResizer]")}}}addResizers(){if(this.resizersAdded)return;const eGui=this.element;if(!eGui)return;const resizers=(new DOMParser).parseFromString('<div class="ag-resizer-wrapper">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',"text/html").body;eGui.appendChild(resizers.firstChild),this.createResizeMap(),this.resizersAdded=!0}removeResizers(){this.resizerMap=void 0;const resizerEl=this.element.querySelector(".ag-resizer-wrapper");resizerEl&&this.element.removeChild(resizerEl),this.resizersAdded=!1}getResizerElement(side){return this.resizerMap[side].element}onResizeStart(e,side){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!side.match(/top/i),isRight:!!side.match(/right/i),isBottom:!!side.match(/bottom/i),isLeft:!!side.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[side].element.classList.add("ag-active");const{popup,forcePopupParentAsOffsetParent}=this.config;popup||forcePopupParentAsOffsetParent||this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const parent=this.element.parentElement;return parent?Array.prototype.slice.call(parent.children).filter(el=>!el.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const siblings=this.getSiblings()||[];let height=0,width=0;for(let i=0;i<siblings.length;i++){const currentEl=siblings[i],isFlex=!!currentEl.style.flex&&"0 0 auto"!==currentEl.style.flex;if(currentEl===this.element)continue;let nextHeight=this.minHeight||0,nextWidth=this.minWidth||0;if(isFlex){const computedStyle=window.getComputedStyle(currentEl);computedStyle.minHeight&&(nextHeight=parseInt(computedStyle.minHeight,10)),computedStyle.minWidth&&(nextWidth=parseInt(computedStyle.minWidth,10))}else nextHeight=currentEl.offsetHeight,nextWidth=currentEl.offsetWidth;height+=nextHeight,width+=nextWidth}return{height,width}}applySizeToSiblings(vertical){let containerToFlex=null;const siblings=this.getSiblings();if(siblings){for(let i=0;i<siblings.length;i++){const el=siblings[i];el!==containerToFlex&&(vertical?el.style.height=`${el.offsetHeight}px`:el.style.width=`${el.offsetWidth}px`,el.style.flex="0 0 auto",el===this.element&&(containerToFlex=siblings[i+1]))}containerToFlex&&(containerToFlex.style.removeProperty("height"),containerToFlex.style.removeProperty("min-height"),containerToFlex.style.removeProperty("max-height"),containerToFlex.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(value=>value)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup,forcePopupParentAsOffsetParent}=this.config,{isTop,isRight,isBottom,isLeft}=this.currentResizer,isHorizontal=isRight||isLeft,isVertical=isBottom||isTop,{movementX,movementY}=this.calculateMouseMovement({e,isLeft,isTop}),xPosition=this.position.x,yPosition=this.position.y;let offsetLeft=0,offsetTop=0;if(isHorizontal&&movementX){const direction=isLeft?-1:1,oldWidth=this.getWidth(),newWidth=oldWidth+movementX*direction;let skipWidth=!1;isLeft&&(offsetLeft=oldWidth-newWidth,(xPosition+offsetLeft<=0||newWidth<=this.minWidth)&&(skipWidth=!0,offsetLeft=0)),skipWidth||this.setWidth(newWidth)}if(isVertical&&movementY){const direction=isTop?-1:1,oldHeight=this.getHeight(),newHeight=oldHeight+movementY*direction;let skipHeight=!1;isTop?(offsetTop=oldHeight-newHeight,(yPosition+offsetTop<=0||newHeight<=this.minHeight)&&(skipHeight=!0,offsetTop=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&oldHeight<newHeight&&this.getMinSizeOfSiblings().height+newHeight>this.element.parentElement.offsetHeight&&(skipHeight=!0),skipHeight||this.setHeight(newHeight)}this.updateDragStartPosition(e.clientX,e.clientY),((popup||forcePopupParentAsOffsetParent)&&offsetLeft||offsetTop)&&this.offsetElement(xPosition+offsetLeft,yPosition+offsetTop)}onResizeEnd(e,side){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;this.element.classList.remove("ag-resizing"),this.resizerMap[side].element.classList.remove("ag-active"),this.dispatchEvent({type:"resize"})}refreshSize(){const eGui=this.element;this.config.popup&&(this.config.width||this.setWidth(eGui.offsetWidth),this.config.height||this.setHeight(eGui.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x,y}=this.position;let topBuffer;this.config.calculateTopBuffer&&(topBuffer=this.config.calculateTopBuffer());const{movementX,movementY}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer});this.offsetElement(x+movementX,y+movementY),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent?this.offsetParent=this.popupService.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let el=this.element;for(;el;){if("static"!==window.getComputedStyle(el).position)return el;el=el.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const params=this.resizeListeners.pop();this.dragService.removeDragSource(params)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}};__decorateClass([Autowired("popupService")],PositionableFeature.prototype,"popupService",2),__decorateClass([Autowired("resizeObserverService")],PositionableFeature.prototype,"resizeObserverService",2),__decorateClass([Autowired("dragService")],PositionableFeature.prototype,"dragService",2);var _ProvidedFilter=class _ProvidedFilter extends Component{constructor(filterNameKey){super(),this.filterNameKey=filterNameKey,this.applyActive=!1,this.hidePopup=null,this.debouncePending=!1,this.appliedModel=null,this.buttonListeners=[]}postConstruct(){this.resetTemplate(),this.createManagedBean(new ManagedFocusFeature(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=new PositionableFeature(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}),this.createBean(this.positionableFeature)}handleKeyDown(e){}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return!!this.appliedModel}resetTemplate(paramsMap){let eGui=this.getGui();eGui&&eGui.removeEventListener("submit",this.onFormSubmit);const templateString=`\n            <form class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-${this.getCssIdentifier()}-body-wrapper" ref="eFilterBody">\n                    ${this.createBodyTemplate()}\n                </div>\n            </form>`;this.setTemplate(templateString,paramsMap),eGui=this.getGui(),eGui&&eGui.addEventListener("submit",this.onFormSubmit)}isReadOnly(){return!!this.providedFilterParams.readOnly}init(params){this.setParams(params),this.resetUiToDefaults(!0).then(()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}setParams(params){this.providedFilterParams=params,this.applyActive=_ProvidedFilter.isUseApplyButton(params),this.resetButtonsPanel()}updateParams(params){this.providedFilterParams=params,this.applyActive=_ProvidedFilter.isUseApplyButton(params),this.resetUiToActiveModel(this.getModel(),()=>{this.updateUiVisibility(),this.setupOnBtApplyDebounce()})}resetButtonsPanel(){const{buttons}=this.providedFilterParams,hasButtons=buttons&&buttons.length>0&&!this.isReadOnly();if(this.eButtonsPanel?(clearElement(this.eButtonsPanel),this.buttonListeners.forEach(destroyFunc=>null==destroyFunc?void 0:destroyFunc()),this.buttonListeners=[]):hasButtons&&(this.eButtonsPanel=document.createElement("div"),this.eButtonsPanel.classList.add("ag-filter-apply-panel")),!hasButtons)return void(this.eButtonsPanel&&removeFromParent(this.eButtonsPanel));const fragment=document.createDocumentFragment(),addButton=type=>{let text,clickListener;switch(type){case"apply":text=this.translate("applyFilter"),clickListener=e=>this.onBtApply(!1,!1,e);break;case"clear":text=this.translate("clearFilter"),clickListener=()=>this.onBtClear();break;case"reset":text=this.translate("resetFilter"),clickListener=()=>this.onBtReset();break;case"cancel":text=this.translate("cancelFilter"),clickListener=e=>{this.onBtCancel(e)};break;default:return void console.warn("AG Grid: Unknown button type specified")}const button=loadTemplate(`<button\n                    type="${"apply"===type?"submit":"button"}"\n                    ref="${type}FilterButton"\n                    class="ag-button ag-standard-button ag-filter-apply-panel-button"\n                >${text}\n                </button>`);this.buttonListeners.push(this.addManagedListener(button,"click",clickListener)),fragment.append(button)};convertToSet(buttons).forEach(type=>addButton(type)),this.eButtonsPanel.append(fragment),this.getGui().appendChild(this.eButtonsPanel)}getDefaultDebounceMs(){return 0}setupOnBtApplyDebounce(){const debounceMs=_ProvidedFilter.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs()),debounceFunc=debounce(this.checkApplyDebounce.bind(this),debounceMs);this.onBtApplyDebounce=()=>{this.debouncePending=!0,debounceFunc()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.onBtApply())}getModel(){return this.appliedModel?this.appliedModel:null}setModel(model){return(null!=model?this.setModelIntoUi(model):this.resetUiToDefaults()).then(()=>{this.updateUiVisibility(),this.applyModel("api")})}onBtCancel(e){this.resetUiToActiveModel(this.getModel(),()=>{this.handleCancelEnd(e)})}handleCancelEnd(e){this.providedFilterParams.closeOnApply&&this.close(e)}resetUiToActiveModel(currentModel,afterUiUpdatedFunc){const afterAppliedFunc=()=>{this.onUiChanged(!1,"prevent"),null==afterUiUpdatedFunc||afterUiUpdatedFunc()};null!=currentModel?this.setModelIntoUi(currentModel).then(afterAppliedFunc):this.resetUiToDefaults().then(afterAppliedFunc)}onBtClear(){this.resetUiToDefaults().then(()=>this.onUiChanged())}onBtReset(){this.onBtClear(),this.onBtApply()}applyModel(source="api"){const newModel=this.getModelFromUi();if(!this.isModelValid(newModel))return!1;const previousModel=this.appliedModel;return this.appliedModel=newModel,!this.areModelsEqual(previousModel,newModel)}isModelValid(model){return!0}onFormSubmit(e){e.preventDefault()}onBtApply(afterFloatingFilter=!1,afterDataChange=!1,e){if(e&&e.preventDefault(),this.applyModel(afterDataChange?"rowDataUpdated":"ui")){const source="columnFilter";this.providedFilterParams.filterChangedCallback({afterFloatingFilter,afterDataChange,source})}const{closeOnApply}=this.providedFilterParams;closeOnApply&&this.applyActive&&!afterFloatingFilter&&!afterDataChange&&this.close(e)}onNewRowsLoaded(){}close(e){if(!this.hidePopup)return;const keyboardEvent=e,key=keyboardEvent&&keyboardEvent.key;let params;"Enter"!==key&&"Space"!==key||(params={keyboardEvent}),this.hidePopup(params),this.hidePopup=null}onUiChanged(fromFloatingFilter=!1,apply){if(this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly()){const isValid=this.isModelValid(this.getModelFromUi()),applyFilterButton=this.getRefElement("applyFilterButton");applyFilterButton&&setDisabled(applyFilterButton,!isValid)}fromFloatingFilter&&!apply||"immediately"===apply?this.onBtApply(fromFloatingFilter):(this.applyActive||apply)&&"debounce"!==apply||this.onBtApplyDebounce()}afterGuiAttached(params){params&&(this.hidePopup=params.hidePopup),this.refreshFilterResizer(null==params?void 0:params.container)}refreshFilterResizer(containerType){if(!this.positionableFeature||"toolPanel"===containerType)return;const isResizable="floatingFilter"===containerType||"columnFilter"===containerType,{positionableFeature,gos}=this;isResizable?(positionableFeature.restoreLastSize(),positionableFeature.setResizable(gos.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(this.positionableFeature.removeSizeFromEl(),this.positionableFeature.setResizable(!1)),this.positionableFeature.constrainSizeToAvailableHeight(!0)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature&&this.positionableFeature.constrainSizeToAvailableHeight(!1)}static getDebounceMs(params,debounceDefault){return _ProvidedFilter.isUseApplyButton(params)?(null!=params.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=params.debounceMs?params.debounceMs:debounceDefault}static isUseApplyButton(params){return!!params.buttons&&params.buttons.indexOf("apply")>=0}refresh(newParams){return this.providedFilterParams=newParams,!0}destroy(){const eGui=this.getGui();eGui&&eGui.removeEventListener("submit",this.onFormSubmit),this.hidePopup=null,this.positionableFeature&&(this.positionableFeature=this.destroyBean(this.positionableFeature)),this.appliedModel=null,super.destroy()}translate(key){return this.localeService.getLocaleTextFunc()(key,FILTER_LOCALE_TEXT[key])}getCellValue(rowNode){return this.providedFilterParams.getValue(rowNode)}getPositionableElement(){return this.eFilterBody}};__decorateClass([Autowired("rowModel")],_ProvidedFilter.prototype,"rowModel",2),__decorateClass([RefSelector("eFilterBody")],_ProvidedFilter.prototype,"eFilterBody",2),__decorateClass([PostConstruct],_ProvidedFilter.prototype,"postConstruct",1);var ProvidedFilter=_ProvidedFilter,AgAbstractLabel=class extends Component{constructor(config,template){super(template),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=config||{}}postConstruct(){this.addCssClass("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator,label,labelWidth,labelAlignment,disabled}=this.config;null!=disabled&&this.setDisabled(disabled),null!=labelSeparator&&this.setLabelSeparator(labelSeparator),null!=label&&this.setLabel(label),null!=labelWidth&&this.setLabelWidth(labelWidth),this.setLabelAlignment(labelAlignment||this.labelAlignment),this.refreshLabel()}refreshLabel(){clearElement(this.eLabel),"string"==typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(setDisplayed(this.eLabel,!1),setAriaRole(this.eLabel,"presentation")):(setDisplayed(this.eLabel,!0),setAriaRole(this.eLabel,null))}setLabelSeparator(labelSeparator){return this.labelSeparator===labelSeparator||(this.labelSeparator=labelSeparator,null!=this.label&&this.refreshLabel()),this}getLabelId(){return this.eLabel.id=this.eLabel.id||`ag-${this.getCompId()}-label`,this.eLabel.id}getLabel(){return this.label}setLabel(label){return this.label===label||(this.label=label,this.refreshLabel()),this}setLabelAlignment(alignment){const eGuiClassList=this.getGui().classList;return eGuiClassList.toggle("ag-label-align-left","left"===alignment),eGuiClassList.toggle("ag-label-align-right","right"===alignment),eGuiClassList.toggle("ag-label-align-top","top"===alignment),this}setLabelEllipsis(hasEllipsis){return this.eLabel.classList.toggle("ag-label-ellipsis",hasEllipsis),this}setLabelWidth(width){return null==this.label||setElementWidth(this.eLabel,width),this}setDisabled(disabled){disabled=!!disabled;const element=this.getGui();return setDisabled(element,disabled),element.classList.toggle("ag-disabled",disabled),this.disabled=disabled,this}isDisabled(){return!!this.disabled}};__decorateClass([PostConstruct],AgAbstractLabel.prototype,"postConstruct",1);var AgAbstractField=class extends AgAbstractLabel{constructor(config,template,className){super(config,template),this.className=className}postConstruct(){super.postConstruct();const{width,value,onValueChange}=this.config;null!=width&&this.setWidth(width),null!=value&&this.setValue(value),null!=onValueChange&&this.onValueChange(onValueChange),this.className&&this.addCssClass(this.className),this.refreshAriaLabelledBy()}refreshAriaLabelledBy(){const ariaEl=this.getAriaElement(),labelId=this.getLabelId();null!==getAriaLabel(ariaEl)?setAriaLabelledBy(ariaEl,""):setAriaLabelledBy(ariaEl,null!=labelId?labelId:"")}setAriaLabel(label){return setAriaLabel(this.getAriaElement(),label),this.refreshAriaLabelledBy(),this}onValueChange(callbackFn){return this.addManagedListener(this,Events.EVENT_FIELD_VALUE_CHANGED,()=>callbackFn(this.getValue())),this}getWidth(){return this.getGui().clientWidth}setWidth(width){return setFixedWidth(this.getGui(),width),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(value,silent){return this.value===value||(this.previousValue=this.value,this.value=value,silent||this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED})),this}},AgPickerField=class extends AgAbstractField{constructor(config){if(super(config,(null==config?void 0:config.template)||'\n    <div class="ag-picker-field" role="presentation">\n        <div ref="eLabel"></div>\n            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-picker-collapsed">\n            <div ref="eDisplayField" class="ag-picker-field-display"></div>\n            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n        </div>\n    </div>',null==config?void 0:config.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.ariaRole=null==config?void 0:config.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!config)return;const{pickerGap,maxPickerHeight,variableWidth,minPickerWidth,maxPickerWidth}=config;null!=pickerGap&&(this.pickerGap=pickerGap),this.variableWidth=!!variableWidth,null!=maxPickerHeight&&this.setPickerMaxHeight(maxPickerHeight),null!=minPickerWidth&&this.setPickerMinWidth(minPickerWidth),null!=maxPickerWidth&&this.setPickerMaxWidth(maxPickerWidth)}postConstruct(){super.postConstruct(),this.setupAria();const displayId=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",displayId);const ariaEl=this.getAriaElement();this.addManagedListener(ariaEl,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(this.eLabel,"mousedown",this.onLabelOrWrapperMouseDown.bind(this)),this.addManagedListener(this.eWrapper,"mousedown",this.onLabelOrWrapperMouseDown.bind(this));const{pickerIcon,inputWidth}=this.config;if(pickerIcon){const icon=createIconNoSpan(pickerIcon,this.gos);icon&&this.eIcon.appendChild(icon)}null!=inputWidth&&this.setInputWidth(inputWidth)}setupAria(){const ariaEl=this.getAriaElement();ariaEl.setAttribute("tabindex",this.gos.get("tabIndex").toString()),setAriaExpanded(ariaEl,!1),this.ariaRole&&setAriaRole(ariaEl,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const focusableEl=this.getFocusableElement();if(focusableEl!==this.eWrapper&&(null==e?void 0:e.target)===focusableEl)return;e.preventDefault(),this.getFocusableElement().focus()}this.skipClick?this.skipClick=!1:this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case KeyCode.UP:case KeyCode.DOWN:case KeyCode.ENTER:case KeyCode.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case KeyCode.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker())}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const pickerGui=this.pickerComponent.getGui();pickerGui.addEventListener("focusin",this.onPickerFocusIn),pickerGui.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const eDocument=this.gos.getDocument(),ePicker=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||(this.destroyMouseWheelFunc=this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,()=>{this.hidePicker()}));const translate=this.localeService.getLocaleTextFunc(),{pickerAriaLabelKey,pickerAriaLabelValue,modalPicker=!0}=this.config,popupParams={modal:modalPicker,eChild:ePicker,closeOnEsc:!0,closedCallback:()=>{const activeEl=this.gos.getActiveDomElement(),shouldRestoreFocus=!activeEl||activeEl===eDocument.body;this.beforeHidePicker(),shouldRestoreFocus&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:translate(pickerAriaLabelKey,pickerAriaLabelValue)},addPopupRes=this.popupService.addPopup(popupParams),{maxPickerHeight,minPickerWidth,maxPickerWidth,variableWidth}=this;variableWidth?(minPickerWidth&&(ePicker.style.minWidth=minPickerWidth),ePicker.style.width=formatSize(getAbsoluteWidth(this.eWrapper)),maxPickerWidth&&(ePicker.style.maxWidth=maxPickerWidth)):setElementWidth(ePicker,null!=maxPickerWidth?maxPickerWidth:getAbsoluteWidth(this.eWrapper));const maxHeight=null!=maxPickerHeight?maxPickerHeight:`${getInnerHeight(this.popupService.getPopupParent())}px`;return ePicker.style.setProperty("max-height",maxHeight),ePicker.style.position="absolute",this.alignPickerToComponent(),addPopupRes.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerType}=this.config,{pickerGap}=this,alignSide=this.gos.get("enableRtl")?"right":"left";this.popupService.positionPopupByComponent({type:pickerType,eventSource:this.eWrapper,ePopup:this.pickerComponent.getGui(),position:"under",alignSide,keepWithinBounds:!0,nudgeY:pickerGap})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const pickerGui=this.pickerComponent.getGui();pickerGui.removeEventListener("focusin",this.onPickerFocusIn),pickerGui.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(expanded){if(!this.isAlive())return;setAriaExpanded(this.getAriaElement(),expanded),this.eWrapper.classList.toggle("ag-picker-expanded",expanded),this.eWrapper.classList.toggle("ag-picker-collapsed",!expanded)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){var _a;(null==(_a=this.pickerComponent)?void 0:_a.getGui().contains(e.relatedTarget))||this.togglePickerHasFocus(!1)}togglePickerHasFocus(focused){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",focused)}hidePicker(){this.hideCurrentPicker&&this.hideCurrentPicker()}setInputWidth(width){return setElementWidth(this.eWrapper,width),this}getFocusableElement(){return this.eWrapper}setPickerGap(gap){return this.pickerGap=gap,this}setPickerMinWidth(width){return"number"==typeof width&&(width=`${width}px`),this.minPickerWidth=null==width?void 0:width,this}setPickerMaxWidth(width){return"number"==typeof width&&(width=`${width}px`),this.maxPickerWidth=null==width?void 0:width,this}setPickerMaxHeight(height){return"number"==typeof height&&(height=`${height}px`),this.maxPickerHeight=null==height?void 0:height,this}destroy(){this.hidePicker(),super.destroy()}};__decorateClass([Autowired("popupService")],AgPickerField.prototype,"popupService",2),__decorateClass([RefSelector("eLabel")],AgPickerField.prototype,"eLabel",2),__decorateClass([RefSelector("eWrapper")],AgPickerField.prototype,"eWrapper",2),__decorateClass([RefSelector("eDisplayField")],AgPickerField.prototype,"eDisplayField",2),__decorateClass([RefSelector("eIcon")],AgPickerField.prototype,"eIcon",2);var _AgList=class _AgList extends Component{constructor(cssIdentifier="default",unFocusable=!1){super(`<div class="ag-list ag-${cssIdentifier}-list" role="listbox"></div>`),this.cssIdentifier=cssIdentifier,this.unFocusable=unFocusable,this.options=[],this.itemEls=[]}init(){const eGui=this.getGui();this.addManagedListener(eGui,"mouseleave",()=>this.clearHighlighted()),this.unFocusable||this.addManagedListener(eGui,"keydown",this.handleKeyDown.bind(this))}handleKeyDown(e){const key=e.key;switch(key){case KeyCode.ENTER:if(this.highlightedEl){const pos=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(pos)}else this.setValue(this.getValue());break;case KeyCode.DOWN:case KeyCode.UP:e.preventDefault(),this.navigate(key);break;case KeyCode.PAGE_DOWN:case KeyCode.PAGE_UP:case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:e.preventDefault(),this.navigateToPage(key)}}navigate(key){const isDown=key===KeyCode.DOWN;let itemToHighlight;if(this.highlightedEl){let nextPos=this.itemEls.indexOf(this.highlightedEl)+(isDown?1:-1);nextPos=Math.min(Math.max(nextPos,0),this.itemEls.length-1),itemToHighlight=this.itemEls[nextPos]}else itemToHighlight=this.itemEls[isDown?0:this.itemEls.length-1];this.highlightItem(itemToHighlight)}navigateToPage(key){if(!this.highlightedEl||0===this.itemEls.length)return;const currentIdx=this.itemEls.indexOf(this.highlightedEl),rowCount=this.options.length-1,itemHeight=this.itemEls[0].clientHeight,pageSize=Math.floor(this.getGui().clientHeight/itemHeight);let newIndex=-1;key===KeyCode.PAGE_HOME?newIndex=0:key===KeyCode.PAGE_END?newIndex=rowCount:key===KeyCode.PAGE_DOWN?newIndex=Math.min(currentIdx+pageSize,rowCount):key===KeyCode.PAGE_UP&&(newIndex=Math.max(currentIdx-pageSize,0)),-1!==newIndex&&this.highlightItem(this.itemEls[newIndex])}addOptions(listOptions){return listOptions.forEach(listOption=>this.addOption(listOption)),this}addOption(listOption){const{value,text}=listOption,valueToRender=text||value;return this.options.push({value,text:valueToRender}),this.renderOption(value,valueToRender),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0),this.itemEls.forEach(itemEl=>{removeFromParent(itemEl)}),this.itemEls=[]}updateIndices(){const options=this.getGui().querySelectorAll(".ag-list-item");options.forEach((option,idx)=>{setAriaPosInSet(option,idx+1),setAriaSetSize(option,options.length)})}renderOption(value,text){const eDocument=this.gos.getDocument(),itemEl=eDocument.createElement("div");setAriaRole(itemEl,"option"),itemEl.classList.add("ag-list-item",`ag-${this.cssIdentifier}-list-item`);const span=eDocument.createElement("span");itemEl.appendChild(span),span.textContent=text,this.unFocusable||(itemEl.tabIndex=-1),this.itemEls.push(itemEl),this.addManagedListener(itemEl,"mousemove",()=>this.highlightItem(itemEl)),this.addManagedListener(itemEl,"mousedown",e=>{e.preventDefault(),this.setValue(value)}),this.createManagedBean(new TooltipFeature({getTooltipValue:()=>text,getGui:()=>itemEl,getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>span.scrollWidth>span.clientWidth})),this.getGui().appendChild(itemEl)}setValue(value,silent){if(this.value===value)return this.fireItemSelected(),this;if(null==value)return this.reset(silent),this;const idx=this.options.findIndex(option=>option.value===value);if(-1!==idx){const option=this.options[idx];this.value=option.value,this.displayValue=option.text,this.highlightItem(this.itemEls[idx]),silent||this.fireChangeEvent()}return this}setValueByIndex(idx){return this.setValue(this.options[idx].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const idx=this.options.findIndex(option=>option.value===this.value);-1!==idx&&this.highlightItem(this.itemEls[idx])}reset(silent){this.value=null,this.displayValue=null,this.clearHighlighted(),silent||this.fireChangeEvent()}highlightItem(el){if(!isVisible(el))return;this.clearHighlighted(),this.highlightedEl=el,this.highlightedEl.classList.add(_AgList.ACTIVE_CLASS),setAriaSelected(this.highlightedEl,!0);const eGui=this.getGui(),{scrollTop,clientHeight}=eGui,{offsetTop,offsetHeight}=el;(offsetTop+offsetHeight>scrollTop+clientHeight||offsetTop<scrollTop)&&this.highlightedEl.scrollIntoView({block:"nearest"}),this.unFocusable||this.highlightedEl.focus()}clearHighlighted(){this.highlightedEl&&isVisible(this.highlightedEl)&&(this.highlightedEl.classList.remove(_AgList.ACTIVE_CLASS),setAriaSelected(this.highlightedEl,!1),this.highlightedEl=null)}fireChangeEvent(){this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED}),this.fireItemSelected()}fireItemSelected(){this.dispatchEvent({type:_AgList.EVENT_ITEM_SELECTED})}};_AgList.EVENT_ITEM_SELECTED="selectedItem",_AgList.ACTIVE_CLASS="ag-active-item",__decorateClass([PostConstruct],_AgList.prototype,"init",1);var AgList=_AgList,_AgSelect=class _AgSelect extends AgPickerField{constructor(config){super(__spreadValues({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"smallDown",ariaRole:"combobox"},config))}postConstruct(){super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options,value,placeholder}=this.config;null!=options&&this.addOptions(options),null!=value&&this.setValue(value,!0),placeholder&&null==value&&(this.eDisplayField.textContent=placeholder),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){this.listComponent=this.createBean(new AgList("select",!0)),this.listComponent.setParentComponent(this);const eListAriaEl=this.listComponent.getAriaElement(),listId=`ag-select-list-${this.listComponent.getCompId()}`;eListAriaEl.setAttribute("id",listId),setAriaControls(this.getAriaElement(),eListAriaEl),this.listComponent.addManagedListener(this.listComponent,AgList.EVENT_ITEM_SELECTED,()=>{this.hidePicker(),this.dispatchEvent({type:_AgSelect.EVENT_ITEM_SELECTED})}),this.listComponent.addManagedListener(this.listComponent,Events.EVENT_FIELD_VALUE_CHANGED,()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())})}createPickerComponent(){return this.listComponent}onKeyDown(e){var _a;const{key}=e;switch(key===KeyCode.TAB&&this.hidePicker(),key){case KeyCode.ENTER:case KeyCode.UP:case KeyCode.DOWN:case KeyCode.PAGE_UP:case KeyCode.PAGE_DOWN:case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:e.preventDefault(),this.isPickerDisplayed?null==(_a=this.listComponent)||_a.handleKeyDown(e):super.onKeyDown(e);break;case KeyCode.ESCAPE:super.onKeyDown(e)}}showPicker(){this.listComponent&&(super.showPicker(),this.listComponent.refreshHighlighted())}addOptions(options){return options.forEach(option=>this.addOption(option)),this}addOption(option){return this.listComponent.addOption(option),this}clearOptions(){var _a;return null==(_a=this.listComponent)||_a.clearOptions(),this}setValue(value,silent,fromPicker){if(this.value===value||!this.listComponent)return this;fromPicker||this.listComponent.setValue(value,!0);if(this.listComponent.getValue()===this.getValue())return this;let displayValue=this.listComponent.getDisplayValue();return null==displayValue&&this.config.placeholder&&(displayValue=this.config.placeholder),this.eDisplayField.textContent=displayValue,this.setTooltip({newTooltipText:null!=displayValue?displayValue:null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth}),super.setValue(value,silent)}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),super.destroy()}};_AgSelect.EVENT_ITEM_SELECTED="selectedItem";var AgSelect=_AgSelect,AgAbstractInputField=class extends AgAbstractField{constructor(config,className,inputType="text",displayFieldTag="input"){super(config,`\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <${displayFieldTag} ref="eInput" class="ag-input-field-input"></${displayFieldTag}>\n                </div>\n            </div>`,className),this.inputType=inputType,this.displayFieldTag=displayFieldTag}postConstruct(){super.postConstruct(),this.setInputType(),this.eLabel.classList.add(`${this.className}-label`),this.eWrapper.classList.add(`${this.className}-input-wrapper`),this.eInput.classList.add(`${this.className}-input`),this.addCssClass("ag-input-field"),this.eInput.id=this.eInput.id||`ag-${this.getCompId()}-input`;const{inputName,inputWidth}=this.config;null!=inputName&&this.setInputName(inputName),null!=inputWidth&&this.setInputWidth(inputWidth),this.addInputListeners(),this.activateTabIndex([this.eInput])}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>this.setValue(e.target.value))}setInputType(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)}getInputElement(){return this.eInput}setInputWidth(width){return setElementWidth(this.eWrapper,width),this}setInputName(name){return this.getInputElement().setAttribute("name",name),this}getFocusableElement(){return this.eInput}setMaxLength(length){return this.eInput.maxLength=length,this}setInputPlaceholder(placeholder){return addOrRemoveAttribute(this.eInput,"placeholder",placeholder),this}setInputAriaLabel(label){return setAriaLabel(this.eInput,label),this.refreshAriaLabelledBy(),this}setDisabled(disabled){return setDisabled(this.eInput,disabled),super.setDisabled(disabled)}setAutoComplete(value){if(!0===value)addOrRemoveAttribute(this.eInput,"autocomplete",null);else{const autoCompleteValue="string"==typeof value?value:"off";addOrRemoveAttribute(this.eInput,"autocomplete",autoCompleteValue)}return this}};__decorateClass([RefSelector("eLabel")],AgAbstractInputField.prototype,"eLabel",2),__decorateClass([RefSelector("eWrapper")],AgAbstractInputField.prototype,"eWrapper",2),__decorateClass([RefSelector("eInput")],AgAbstractInputField.prototype,"eInput",2);var AgCheckbox=class extends AgAbstractInputField{constructor(config,className="ag-checkbox",inputType="checkbox"){super(config,className,inputType),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly,passive}=this.config;"boolean"==typeof readOnly&&this.setReadOnly(readOnly),"boolean"==typeof passive&&this.setPassive(passive)}addInputListeners(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))}getNextValue(){return void 0===this.selected||!this.selected}setPassive(passive){this.passive=passive}isReadOnly(){return this.readOnly}setReadOnly(readOnly){this.eWrapper.classList.toggle("ag-disabled",readOnly),this.eInput.disabled=readOnly,this.readOnly=readOnly}setDisabled(disabled){return this.eWrapper.classList.toggle("ag-disabled",disabled),super.setDisabled(disabled)}toggle(){if(this.eInput.disabled)return;const previousValue=this.isSelected(),nextValue=this.getNextValue();this.passive?this.dispatchChange(nextValue,previousValue):this.setValue(nextValue)}getValue(){return this.isSelected()}setValue(value,silent){return this.refreshSelectedClass(value),this.setSelected(value,silent),this}setName(name){return this.getInputElement().name=name,this}isSelected(){return this.selected}setSelected(selected,silent){this.isSelected()!==selected&&(this.previousValue=this.isSelected(),selected=this.selected="boolean"==typeof selected?selected:void 0,this.eInput.checked=selected,this.eInput.indeterminate=void 0===selected,silent||this.dispatchChange(this.selected,this.previousValue))}dispatchChange(selected,previousValue,event){this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED,selected,previousValue,event});const input=this.getInputElement(),checkboxChangedEvent={type:Events.EVENT_CHECKBOX_CHANGED,id:input.id,name:input.name,selected,previousValue};this.eventService.dispatchEvent(checkboxChangedEvent)}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const previousValue=this.isSelected(),selected=this.selected=e.target.checked;this.refreshSelectedClass(selected),this.dispatchChange(selected,previousValue,e)}refreshSelectedClass(value){this.eWrapper.classList.toggle("ag-checked",!0===value),this.eWrapper.classList.toggle("ag-indeterminate",null==value)}},AgRadioButton=class extends AgCheckbox{constructor(config){super(config,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedListener(this.eventService,Events.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))}onChange(event){event.selected&&event.name&&this.eInput.name&&this.eInput.name===event.name&&event.id&&this.eInput.id!==event.id&&this.setValue(!1,!0)}},SimpleFilterModelFormatter=class{constructor(localeService,optionsFactory,valueFormatter){this.localeService=localeService,this.optionsFactory=optionsFactory,this.valueFormatter=valueFormatter}getModelAsString(model){if(!model)return null;const isCombined=null!=model.operator,translate=this.localeService.getLocaleTextFunc();if(isCombined){const combinedModel=model;let{conditions}=combinedModel;if(!conditions){const{condition1,condition2}=combinedModel;conditions=[condition1,condition2]}const customOptions=conditions.map(condition=>this.getModelAsString(condition)),joinOperatorTranslateKey="AND"===combinedModel.operator?"andCondition":"orCondition";return customOptions.join(` ${translate(joinOperatorTranslateKey,FILTER_LOCALE_TEXT[joinOperatorTranslateKey])} `)}if(model.type===SimpleFilter.BLANK||model.type===SimpleFilter.NOT_BLANK)return translate(model.type,model.type);{const condition=model,customOption=this.optionsFactory.getCustomOption(condition.type),{displayKey,displayName,numberOfInputs}=customOption||{};return displayKey&&displayName&&0===numberOfInputs?(translate(displayKey,displayName),displayName):this.conditionToString(condition,customOption)}}updateParams(params){this.optionsFactory=params.optionsFactory}formatValue(value){var _a;return this.valueFormatter?null!=(_a=this.valueFormatter(null!=value?value:null))?_a:"":String(value)}},_SimpleFilter=class _SimpleFilter extends ProvidedFilter{constructor(){super(...arguments),this.eTypes=[],this.eJoinOperatorPanels=[],this.eJoinOperatorsAnd=[],this.eJoinOperatorsOr=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}getNumberOfInputs(type){const customOpts=this.optionsFactory.getCustomOption(type);if(customOpts){const{numberOfInputs}=customOpts;return null!=numberOfInputs?numberOfInputs:1}const zeroInputTypes=[_SimpleFilter.EMPTY,_SimpleFilter.NOT_BLANK,_SimpleFilter.BLANK];return type&&zeroInputTypes.indexOf(type)>=0?0:type===_SimpleFilter.IN_RANGE?2:1}onFloatingFilterChanged(type,value){this.setTypeFromFloatingFilter(type),this.setValueFromFloatingFilter(value),this.onUiChanged(!0)}setTypeFromFloatingFilter(type){this.eTypes.forEach((eType,position)=>{0===position?eType.setValue(type,!0):eType.setValue(this.optionsFactory.getDefaultOption(),!0)})}getModelFromUi(){const conditions=this.getUiCompleteConditions();return 0===conditions.length?null:this.maxNumConditions>1&&conditions.length>1?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:conditions[0],condition2:conditions[1],conditions}:conditions[0]}getConditionTypes(){return this.eTypes.map(eType=>eType.getValue())}getConditionType(position){return this.eTypes[position].getValue()}getJoinOperator(){return 0===this.eJoinOperatorsOr.length?this.defaultJoinOperator:!0===this.eJoinOperatorsOr[0].getValue()?"OR":"AND"}areModelsEqual(a,b){if(!a&&!b)return!0;if(!a&&b||a&&!b)return!1;const aIsSimple=!a.operator,bIsSimple=!b.operator;if(!aIsSimple&&bIsSimple||aIsSimple&&!bIsSimple)return!1;let res;if(aIsSimple){const aSimple=a,bSimple=b;res=this.areSimpleModelsEqual(aSimple,bSimple)}else{const aCombined=a,bCombined=b;res=aCombined.operator===bCombined.operator&&areEqual(aCombined.conditions,bCombined.conditions,(aModel,bModel)=>this.areSimpleModelsEqual(aModel,bModel))}return res}shouldRefresh(newParams){var _a,_b,_c;const model=this.getModel(),conditions=model?null!=(_a=model.conditions)?_a:[model]:null,newOptionsList=null!=(_c=null==(_b=newParams.filterOptions)?void 0:_b.map(option=>"string"==typeof option?option:option.displayKey))?_c:this.getDefaultFilterOptions();return!(conditions&&!conditions.every(condition=>void 0!==newOptionsList.find(option=>option===condition.type)))&&!("number"==typeof newParams.maxNumConditions&&conditions&&conditions.length>newParams.maxNumConditions)}refresh(newParams){if(!this.shouldRefresh(newParams))return!1;return!!super.refresh(newParams)&&(this.setParams(newParams),this.removeConditionsAndOperators(0),this.createOption(),this.setModel(this.getModel()),!0)}setModelIntoUi(model){if(model.operator){let combinedModel=model;combinedModel.conditions||(combinedModel.conditions=[combinedModel.condition1,combinedModel.condition2]);const numConditions=this.validateAndUpdateConditions(combinedModel.conditions),numPrevConditions=this.getNumConditions();if(numConditions<numPrevConditions)this.removeConditionsAndOperators(numConditions);else if(numConditions>numPrevConditions)for(let i=numPrevConditions;i<numConditions;i++)this.createJoinOperatorPanel(),this.createOption();const orChecked="OR"===combinedModel.operator;this.eJoinOperatorsAnd.forEach(eJoinOperatorAnd=>eJoinOperatorAnd.setValue(!orChecked,!0)),this.eJoinOperatorsOr.forEach(eJoinOperatorOr=>eJoinOperatorOr.setValue(orChecked,!0)),combinedModel.conditions.forEach((condition,position)=>{this.eTypes[position].setValue(condition.type,!0),this.setConditionIntoUi(condition,position)})}else{const simpleModel=model;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(simpleModel.type,!0),this.setConditionIntoUi(simpleModel,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.onUiChanged(),AgPromise.resolve()}validateAndUpdateConditions(conditions){let numConditions=conditions.length;return numConditions>this.maxNumConditions&&(conditions.splice(this.maxNumConditions),warnOnce('Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.'),numConditions=this.maxNumConditions),numConditions}doesFilterPass(params){var _a;const model=this.getModel();if(null==model)return!0;const{operator}=model,models=[];if(operator){const combinedModel=model;models.push(...null!=(_a=combinedModel.conditions)?_a:[])}else models.push(model);return models[operator&&"OR"===operator?"some":"every"](m=>this.individualConditionPasses(params,m))}setParams(params){super.setParams(params),this.setNumConditions(params),this.defaultJoinOperator=this.getDefaultJoinOperator(params.defaultJoinOperator),this.filterPlaceholder=params.filterPlaceholder,this.optionsFactory=new OptionsFactory,this.optionsFactory.init(params,this.getDefaultFilterOptions()),this.createFilterListOptions(),this.createOption(),this.createMissingConditionsAndOperators(),this.isReadOnly()&&this.eFilterBody.setAttribute("tabindex","-1")}setNumConditions(params){var _a,_b;null!=params.suppressAndOrCondition&&warnOnce('Since v29.2 "filterParams.suppressAndOrCondition" is deprecated. Use "filterParams.maxNumConditions = 1" instead.'),null!=params.alwaysShowBothConditions&&warnOnce('Since v29.2 "filterParams.alwaysShowBothConditions" is deprecated. Use "filterParams.numAlwaysVisibleConditions = 2" instead.'),this.maxNumConditions=null!=(_a=params.maxNumConditions)?_a:params.suppressAndOrCondition?1:2,this.maxNumConditions<1&&(warnOnce('"filterParams.maxNumConditions" must be greater than or equal to zero.'),this.maxNumConditions=1),this.numAlwaysVisibleConditions=null!=(_b=params.numAlwaysVisibleConditions)?_b:params.alwaysShowBothConditions?2:1,this.numAlwaysVisibleConditions<1&&(warnOnce('"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.'),this.numAlwaysVisibleConditions=1),this.numAlwaysVisibleConditions>this.maxNumConditions&&(warnOnce('"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".'),this.numAlwaysVisibleConditions=this.maxNumConditions)}createOption(){const eType=this.createManagedBean(new AgSelect);this.eTypes.push(eType),eType.addCssClass("ag-filter-select"),this.eFilterBody.appendChild(eType.getGui());const eConditionBody=this.createValueElement();this.eConditionBodies.push(eConditionBody),this.eFilterBody.appendChild(eConditionBody),this.putOptionsIntoDropdown(eType),this.resetType(eType);const position=this.getNumConditions()-1;this.forEachPositionInput(position,element=>this.resetInput(element)),this.addChangedListeners(eType,position)}createJoinOperatorPanel(){const eJoinOperatorPanel=document.createElement("div");this.eJoinOperatorPanels.push(eJoinOperatorPanel),eJoinOperatorPanel.classList.add("ag-filter-condition");const eJoinOperatorAnd=this.createJoinOperator(this.eJoinOperatorsAnd,eJoinOperatorPanel,"and"),eJoinOperatorOr=this.createJoinOperator(this.eJoinOperatorsOr,eJoinOperatorPanel,"or");this.eFilterBody.appendChild(eJoinOperatorPanel);const index=this.eJoinOperatorPanels.length-1,uniqueGroupId=this.joinOperatorId++;this.resetJoinOperatorAnd(eJoinOperatorAnd,index,uniqueGroupId),this.resetJoinOperatorOr(eJoinOperatorOr,index,uniqueGroupId),this.isReadOnly()||(eJoinOperatorAnd.onValueChange(this.listener),eJoinOperatorOr.onValueChange(this.listener))}createJoinOperator(eJoinOperators,eJoinOperatorPanel,andOr){const eJoinOperator=this.createManagedBean(new AgRadioButton);return eJoinOperators.push(eJoinOperator),eJoinOperator.addCssClass("ag-filter-condition-operator"),eJoinOperator.addCssClass(`ag-filter-condition-operator-${andOr}`),eJoinOperatorPanel.appendChild(eJoinOperator.getGui()),eJoinOperator}getDefaultJoinOperator(defaultJoinOperator){return"AND"===defaultJoinOperator||"OR"===defaultJoinOperator?defaultJoinOperator:"AND"}createFilterListOptions(){const filterOptions=this.optionsFactory.getFilterOptions();this.filterListOptions=filterOptions.map(option=>"string"==typeof option?this.createBoilerplateListOption(option):this.createCustomListOption(option))}putOptionsIntoDropdown(eType){this.filterListOptions.forEach(listOption=>{eType.addOption(listOption)}),eType.setDisabled(this.filterListOptions.length<=1)}createBoilerplateListOption(option){return{value:option,text:this.translate(option)}}createCustomListOption(option){const{displayKey}=option,customOption=this.optionsFactory.getCustomOption(option.displayKey);return{value:displayKey,text:customOption?this.localeService.getLocaleTextFunc()(customOption.displayKey,customOption.displayName):this.translate(displayKey)}}isAllowTwoConditions(){return this.maxNumConditions>=2}createBodyTemplate(){return""}getCssIdentifier(){return"simple-filter"}updateUiVisibility(){const joinOperator=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,joinOperator)}updateNumConditions(){var _a;let lastUiCompletePosition=-1,areAllConditionsUiComplete=!0;for(let position=0;position<this.getNumConditions();position++)this.isConditionUiComplete(position)?lastUiCompletePosition=position:areAllConditionsUiComplete=!1;if(this.shouldAddNewConditionAtEnd(areAllConditionsUiComplete))this.createJoinOperatorPanel(),this.createOption();else{const activePosition=null!=(_a=this.lastUiCompletePosition)?_a:this.getNumConditions()-2;if(lastUiCompletePosition<activePosition){this.removeConditionsAndOperators(activePosition+1);const removeStartPosition=lastUiCompletePosition+1,numConditionsToRemove=activePosition-removeStartPosition;numConditionsToRemove>0&&this.removeConditionsAndOperators(removeStartPosition,numConditionsToRemove),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=lastUiCompletePosition}updateConditionStatusesAndValues(lastUiCompletePosition,joinOperator){this.eTypes.forEach((eType,position)=>{const disabled=this.isConditionDisabled(position,lastUiCompletePosition);eType.setDisabled(disabled||this.filterListOptions.length<=1),1===position&&(setDisabled(this.eJoinOperatorPanels[0],disabled),this.eJoinOperatorsAnd[0].setDisabled(disabled),this.eJoinOperatorsOr[0].setDisabled(disabled))}),this.eConditionBodies.forEach((element,index)=>{setDisplayed(element,this.isConditionBodyVisible(index))});const orChecked="OR"===(null!=joinOperator?joinOperator:this.getJoinOperator());this.eJoinOperatorsAnd.forEach((eJoinOperatorAnd,index)=>{eJoinOperatorAnd.setValue(!orChecked,!0)}),this.eJoinOperatorsOr.forEach((eJoinOperatorOr,index)=>{eJoinOperatorOr.setValue(orChecked,!0)}),this.forEachInput((element,index,position,numberOfInputs)=>{this.setElementDisplayed(element,index<numberOfInputs),this.setElementDisabled(element,this.isConditionDisabled(position,lastUiCompletePosition))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(areAllConditionsUiComplete){return areAllConditionsUiComplete&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(startPosition,deleteCount){if(startPosition>=this.getNumConditions())return;this.removeComponents(this.eTypes,startPosition,deleteCount),this.removeElements(this.eConditionBodies,startPosition,deleteCount),this.removeValueElements(startPosition,deleteCount);const joinOperatorIndex=Math.max(startPosition-1,0);this.removeElements(this.eJoinOperatorPanels,joinOperatorIndex,deleteCount),this.removeComponents(this.eJoinOperatorsAnd,joinOperatorIndex,deleteCount),this.removeComponents(this.eJoinOperatorsOr,joinOperatorIndex,deleteCount)}removeElements(elements,startPosition,deleteCount){this.removeItems(elements,startPosition,deleteCount).forEach(element=>removeFromParent(element))}removeComponents(components,startPosition,deleteCount){this.removeItems(components,startPosition,deleteCount).forEach(comp=>{removeFromParent(comp.getGui()),this.destroyBean(comp)})}removeItems(items,startPosition,deleteCount){return null==deleteCount?items.splice(startPosition):items.splice(startPosition,deleteCount)}afterGuiAttached(params){if(super.afterGuiAttached(params),this.resetPlaceholder(),!(null==params?void 0:params.suppressFocus))if(this.isReadOnly())this.eFilterBody.focus();else{const firstInput=this.getInputs(0)[0];if(!firstInput)return;firstInput instanceof AgAbstractInputField&&firstInput.getInputElement().focus()}}afterGuiDetached(){super.afterGuiDetached();const appliedModel=this.getModel();this.resetUiToActiveModel(appliedModel);let lastUiCompletePosition=-1,updatedLastUiCompletePosition=-1,conditionsRemoved=!1;const joinOperator=this.getJoinOperator();for(let position=this.getNumConditions()-1;position>=0;position--)if(this.isConditionUiComplete(position))-1===lastUiCompletePosition&&(lastUiCompletePosition=position,updatedLastUiCompletePosition=position);else{const positionBeforeLastUiCompletePosition=position<lastUiCompletePosition;(position>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(position-1)||positionBeforeLastUiCompletePosition)&&(this.removeConditionsAndOperators(position,1),conditionsRemoved=!0,positionBeforeLastUiCompletePosition&&updatedLastUiCompletePosition--)}let shouldUpdateConditionStatusesAndValues=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),shouldUpdateConditionStatusesAndValues=!0),this.shouldAddNewConditionAtEnd(updatedLastUiCompletePosition===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),shouldUpdateConditionStatusesAndValues=!0),shouldUpdateConditionStatusesAndValues&&this.updateConditionStatusesAndValues(updatedLastUiCompletePosition,joinOperator),conditionsRemoved&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=updatedLastUiCompletePosition}getPlaceholderText(defaultPlaceholder,position){let placeholder=this.translate(defaultPlaceholder);if(isFunction(this.filterPlaceholder)){const filterPlaceholderFn=this.filterPlaceholder,filterOptionKey=this.eTypes[position].getValue();placeholder=filterPlaceholderFn({filterOptionKey,filterOption:this.translate(filterOptionKey),placeholder})}else"string"==typeof this.filterPlaceholder&&(placeholder=this.filterPlaceholder);return placeholder}resetPlaceholder(){const globalTranslate=this.localeService.getLocaleTextFunc();this.forEachInput((element,index,position,numberOfInputs)=>{if(!(element instanceof AgAbstractInputField))return;const placeholder=0===index&&numberOfInputs>1?"inRangeStart":0===index?"filterOoo":"inRangeEnd",ariaLabel=0===index&&numberOfInputs>1?globalTranslate("ariaFilterFromValue","Filter from value"):0===index?globalTranslate("ariaFilterValue","Filter Value"):globalTranslate("ariaFilterToValue","Filter to Value");element.setInputPlaceholder(this.getPlaceholderText(placeholder,position)),element.setInputAriaLabel(ariaLabel)})}setElementValue(element,value,fromFloatingFilter){element instanceof AgAbstractInputField&&element.setValue(null!=value?String(value):null,!0)}setElementDisplayed(element,displayed){element instanceof Component&&setDisplayed(element.getGui(),displayed)}setElementDisabled(element,disabled){element instanceof Component&&setDisabled(element.getGui(),disabled)}attachElementOnChange(element,listener){element instanceof AgAbstractInputField&&element.onValueChange(listener)}forEachInput(cb){this.getConditionTypes().forEach((type,position)=>{this.forEachPositionTypeInput(position,type,cb)})}forEachPositionInput(position,cb){const type=this.getConditionType(position);this.forEachPositionTypeInput(position,type,cb)}forEachPositionTypeInput(position,type,cb){const numberOfInputs=this.getNumberOfInputs(type),inputs=this.getInputs(position);for(let index=0;index<inputs.length;index++){const input=inputs[index];null!=input&&cb(input,index,position,numberOfInputs)}}isConditionDisabled(position,lastUiCompletePosition){return!!this.isReadOnly()||0!==position&&position>lastUiCompletePosition+1}isConditionBodyVisible(position){const type=this.getConditionType(position);return this.getNumberOfInputs(type)>0}isConditionUiComplete(position){if(position>=this.getNumConditions())return!1;return this.getConditionType(position)!==_SimpleFilter.EMPTY&&!this.getValues(position).some(v=>null==v)}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const conditions=[];for(let position=0;position<this.getNumConditions();position++)this.isConditionUiComplete(position)&&conditions.push(this.createCondition(position));return conditions}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let i=this.getNumConditions();i<this.numAlwaysVisibleConditions;i++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(silent){return this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(eType=>this.resetType(eType)),this.eJoinOperatorsAnd.forEach((eJoinOperatorAnd,index)=>this.resetJoinOperatorAnd(eJoinOperatorAnd,index,this.joinOperatorId+index)),this.eJoinOperatorsOr.forEach((eJoinOperatorOr,index)=>this.resetJoinOperatorOr(eJoinOperatorOr,index,this.joinOperatorId+index)),this.joinOperatorId++,this.forEachInput(element=>this.resetInput(element)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,silent||this.onUiChanged(),AgPromise.resolve()}resetType(eType){const filteringLabel=this.localeService.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");eType.setValue(this.optionsFactory.getDefaultOption(),!0).setAriaLabel(filteringLabel).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(eJoinOperatorAnd,index,uniqueGroupId){this.resetJoinOperator(eJoinOperatorAnd,index,this.isDefaultOperator("AND"),this.translate("andCondition"),uniqueGroupId)}resetJoinOperatorOr(eJoinOperatorOr,index,uniqueGroupId){this.resetJoinOperator(eJoinOperatorOr,index,this.isDefaultOperator("OR"),this.translate("orCondition"),uniqueGroupId)}resetJoinOperator(eJoinOperator,index,value,label,uniqueGroupId){this.updateJoinOperatorDisabled(eJoinOperator.setValue(value,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${uniqueGroupId}`).setLabel(label),index)}updateJoinOperatorsDisabled(){this.eJoinOperatorsAnd.forEach((eJoinOperator,index)=>this.updateJoinOperatorDisabled(eJoinOperator,index)),this.eJoinOperatorsOr.forEach((eJoinOperator,index)=>this.updateJoinOperatorDisabled(eJoinOperator,index))}updateJoinOperatorDisabled(eJoinOperator,index){eJoinOperator.setDisabled(this.isReadOnly()||index>0)}resetInput(element){this.setElementValue(element,null),this.setElementDisabled(element,this.isReadOnly())}setConditionIntoUi(model,position){const values2=this.mapValuesFromModel(model);this.forEachInput((element,index,elPosition,_2)=>{elPosition===position&&this.setElementValue(element,null!=values2[index]?values2[index]:null)})}setValueFromFloatingFilter(value){this.forEachInput((element,index,position,_2)=>{this.setElementValue(element,0===index&&0===position?value:null,!0)})}isDefaultOperator(operator){return operator===this.defaultJoinOperator}addChangedListeners(eType,position){this.isReadOnly()||(eType.onValueChange(this.listener),this.forEachPositionInput(position,element=>{this.attachElementOnChange(element,this.listener)}))}individualConditionPasses(params,filterModel){const cellValue=this.getCellValue(params.node),values2=this.mapValuesFromModel(filterModel),customFilterOption=this.optionsFactory.getCustomOption(filterModel.type),customFilterResult=this.evaluateCustomFilter(customFilterOption,values2,cellValue);return null!=customFilterResult?customFilterResult:null==cellValue?this.evaluateNullValue(filterModel.type):this.evaluateNonNullValue(values2,cellValue,filterModel,params)}evaluateCustomFilter(customFilterOption,values2,cellValue){if(null==customFilterOption)return;const{predicate}=customFilterOption;return null==predicate||values2.some(v=>null==v)?void 0:predicate(values2,cellValue)}isBlank(cellValue){return null==cellValue||"string"==typeof cellValue&&0===cellValue.trim().length}hasInvalidInputs(){return!1}};_SimpleFilter.EMPTY="empty",_SimpleFilter.BLANK="blank",_SimpleFilter.NOT_BLANK="notBlank",_SimpleFilter.EQUALS="equals",_SimpleFilter.NOT_EQUAL="notEqual",_SimpleFilter.LESS_THAN="lessThan",_SimpleFilter.LESS_THAN_OR_EQUAL="lessThanOrEqual",_SimpleFilter.GREATER_THAN="greaterThan",_SimpleFilter.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",_SimpleFilter.IN_RANGE="inRange",_SimpleFilter.CONTAINS="contains",_SimpleFilter.NOT_CONTAINS="notContains",_SimpleFilter.STARTS_WITH="startsWith",_SimpleFilter.ENDS_WITH="endsWith";var SimpleFilter=_SimpleFilter,ScalarFilter=class _ScalarFilter extends SimpleFilter{setParams(params){super.setParams(params),this.scalarFilterParams=params}evaluateNullValue(filterType){switch(filterType){case _ScalarFilter.EQUALS:case _ScalarFilter.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case _ScalarFilter.GREATER_THAN:case _ScalarFilter.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case _ScalarFilter.LESS_THAN:case _ScalarFilter.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case _ScalarFilter.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0;break;case _ScalarFilter.BLANK:return!0;case _ScalarFilter.NOT_BLANK:return!1}return!1}evaluateNonNullValue(values2,cellValue,filterModel){const comparator=this.comparator(),compareResult=null!=values2[0]?comparator(values2[0],cellValue):0;switch(filterModel.type){case _ScalarFilter.EQUALS:return 0===compareResult;case _ScalarFilter.NOT_EQUAL:return 0!==compareResult;case _ScalarFilter.GREATER_THAN:return compareResult>0;case _ScalarFilter.GREATER_THAN_OR_EQUAL:return compareResult>=0;case _ScalarFilter.LESS_THAN:return compareResult<0;case _ScalarFilter.LESS_THAN_OR_EQUAL:return compareResult<=0;case _ScalarFilter.IN_RANGE:{const compareToResult=comparator(values2[1],cellValue);return this.scalarFilterParams.inRangeInclusive?compareResult>=0&&compareToResult<=0:compareResult>0&&compareToResult<0}case _ScalarFilter.BLANK:return this.isBlank(cellValue);case _ScalarFilter.NOT_BLANK:return!this.isBlank(cellValue);default:return console.warn('AG Grid: Unexpected type of filter "'+filterModel.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}}},DateFilterModelFormatter=class extends SimpleFilterModelFormatter{constructor(dateFilterParams,localeService,optionsFactory){super(localeService,optionsFactory),this.dateFilterParams=dateFilterParams}conditionToString(condition,options){const{type}=condition,{numberOfInputs}=options||{},isRange=type==SimpleFilter.IN_RANGE||2===numberOfInputs,dateFrom=parseDateTimeFromString(condition.dateFrom),dateTo=parseDateTimeFromString(condition.dateTo),format=this.dateFilterParams.inRangeFloatingFilterDateFormat;if(isRange){return`${null!==dateFrom?dateToFormattedString(dateFrom,format):"null"}-${null!==dateTo?dateToFormattedString(dateTo,format):"null"}`}return null!=dateFrom?dateToFormattedString(dateFrom,format):`${type}`}updateParams(params){super.updateParams(params),this.dateFilterParams=params.dateFilterParams}},_DateFilter=class _DateFilter extends ScalarFilter{constructor(){super("dateFilter"),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=1e3,this.maxValidYear=Infinity,this.minValidDate=null,this.maxValidDate=null}afterGuiAttached(params){super.afterGuiAttached(params),this.dateConditionFromComps[0].afterGuiAttached(params)}mapValuesFromModel(filterModel){const{dateFrom,dateTo,type}=filterModel||{};return[dateFrom&&parseDateTimeFromString(dateFrom)||null,dateTo&&parseDateTimeFromString(dateTo)||null].slice(0,this.getNumberOfInputs(type))}comparator(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)}defaultComparator(filterDate,cellValue){return null==cellValue||cellValue<filterDate?-1:cellValue>filterDate?1:0}setParams(params){this.dateFilterParams=params,super.setParams(params);const yearParser=(param,fallback)=>{if(null!=params[param]){if(!isNaN(params[param]))return null==params[param]?fallback:Number(params[param]);console.warn(`AG Grid: DateFilter ${param} is not a number`)}return fallback};this.minValidYear=yearParser("minValidYear",1e3),this.maxValidYear=yearParser("maxValidYear",Infinity),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),params.minValidDate?this.minValidDate=params.minValidDate instanceof Date?params.minValidDate:parseDateTimeFromString(params.minValidDate):this.minValidDate=null,params.maxValidDate?this.maxValidDate=params.maxValidDate instanceof Date?params.maxValidDate:parseDateTimeFromString(params.maxValidDate):this.maxValidDate=null,this.minValidDate&&this.maxValidDate&&this.minValidDate>this.maxValidDate&&console.warn("AG Grid: DateFilter minValidDate should be <= maxValidDate"),this.filterModelFormatter=new DateFilterModelFormatter(this.dateFilterParams,this.localeService,this.optionsFactory)}createDateCompWrapper(element){const dateCompWrapper=new DateCompWrapper(this.getContext(),this.userComponentFactory,{onDateChanged:()=>this.onUiChanged(),filterParams:this.dateFilterParams},element);return this.addDestroyFunc(()=>dateCompWrapper.destroy()),dateCompWrapper}setElementValue(element,value){element.setDate(value)}setElementDisplayed(element,displayed){element.setDisplayed(displayed)}setElementDisabled(element,disabled){element.setDisabled(disabled)}getDefaultFilterOptions(){return _DateFilter.DEFAULT_FILTER_OPTIONS}createValueElement(){const eCondition=this.gos.getDocument().createElement("div");return eCondition.classList.add("ag-filter-body"),this.createFromToElement(eCondition,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(eCondition,this.eConditionPanelsTo,this.dateConditionToComps,"to"),eCondition}createFromToElement(eCondition,eConditionPanels,dateConditionComps,fromTo){const eConditionPanel=this.gos.getDocument().createElement("div");eConditionPanel.classList.add(`ag-filter-${fromTo}`),eConditionPanel.classList.add(`ag-filter-date-${fromTo}`),eConditionPanels.push(eConditionPanel),eCondition.appendChild(eConditionPanel),dateConditionComps.push(this.createDateCompWrapper(eConditionPanel))}removeValueElements(startPosition,deleteCount){this.removeDateComps(this.dateConditionFromComps,startPosition,deleteCount),this.removeDateComps(this.dateConditionToComps,startPosition,deleteCount),this.removeItems(this.eConditionPanelsFrom,startPosition,deleteCount),this.removeItems(this.eConditionPanelsTo,startPosition,deleteCount)}removeDateComps(components,startPosition,deleteCount){this.removeItems(components,startPosition,deleteCount).forEach(comp=>comp.destroy())}isValidDateValue(value){if(null===value)return!1;if(this.minValidDate){if(value<this.minValidDate)return!1}else if(value.getUTCFullYear()<this.minValidYear)return!1;if(this.maxValidDate){if(value>this.maxValidDate)return!1}else if(value.getUTCFullYear()>this.maxValidYear)return!1;return!0}isConditionUiComplete(position){if(!super.isConditionUiComplete(position))return!1;let valid=!0;return this.forEachInput((element,index,elPosition,numberOfInputs)=>{elPosition!==position||!valid||index>=numberOfInputs||(valid=valid&&this.isValidDateValue(element.getDate()))}),valid}areSimpleModelsEqual(aSimple,bSimple){return aSimple.dateFrom===bSimple.dateFrom&&aSimple.dateTo===bSimple.dateTo&&aSimple.type===bSimple.type}getFilterType(){return"date"}createCondition(position){const type=this.getConditionType(position),model={},values2=this.getValues(position);return values2.length>0&&(model.dateFrom=serialiseDate(values2[0])),values2.length>1&&(model.dateTo=serialiseDate(values2[1])),__spreadValues({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type},model)}resetPlaceholder(){const globalTranslate=this.localeService.getLocaleTextFunc(),placeholder=this.translate("dateFormatOoo"),ariaLabel=globalTranslate("ariaFilterValue","Filter Value");this.forEachInput(element=>{element.setInputPlaceholder(placeholder),element.setInputAriaLabel(ariaLabel)})}getInputs(position){return position>=this.dateConditionFromComps.length?[null,null]:[this.dateConditionFromComps[position],this.dateConditionToComps[position]]}getValues(position){const result=[];return this.forEachPositionInput(position,(element,index,_elPosition,numberOfInputs)=>{index<numberOfInputs&&result.push(element.getDate())}),result}translate(key){return key===ScalarFilter.LESS_THAN?super.translate("before"):key===ScalarFilter.GREATER_THAN?super.translate("after"):super.translate(key)}getModelAsString(model){var _a;return null!=(_a=this.filterModelFormatter.getModelAsString(model))?_a:""}};_DateFilter.DEFAULT_FILTER_OPTIONS=[ScalarFilter.EQUALS,ScalarFilter.NOT_EQUAL,ScalarFilter.LESS_THAN,ScalarFilter.GREATER_THAN,ScalarFilter.IN_RANGE,ScalarFilter.BLANK,ScalarFilter.NOT_BLANK],__decorateClass([Autowired("userComponentFactory")],_DateFilter.prototype,"userComponentFactory",2);var DateFilter=_DateFilter,SimpleFloatingFilter=class extends Component{getDefaultDebounceMs(){return 0}destroy(){super.destroy()}isEventFromFloatingFilter(event){return event&&event.afterFloatingFilter}isEventFromDataChange(event){return null==event?void 0:event.afterDataChange}getLastType(){return this.lastType}isReadOnly(){return this.readOnly}setLastTypeFromModel(model){if(!model)return void(this.lastType=this.optionsFactory.getDefaultOption());let condition;if(model.operator){condition=model.conditions[0]}else condition=model;this.lastType=condition.type}canWeEditAfterModelFromParentFilter(model){if(!model)return this.isTypeEditable(this.lastType);if(model.operator)return!1;const simpleModel=model;return this.isTypeEditable(simpleModel.type)}init(params){this.setSimpleParams(params,!1)}setSimpleParams(params,update=!0){this.optionsFactory=new OptionsFactory,this.optionsFactory.init(params.filterParams,this.getDefaultFilterOptions()),update||(this.lastType=this.optionsFactory.getDefaultOption()),this.readOnly=!!params.filterParams.readOnly;const editable=this.isTypeEditable(this.optionsFactory.getDefaultOption());this.setEditable(editable)}onParamsUpdated(params){this.refresh(params)}refresh(params){this.setSimpleParams(params)}doesFilterHaveSingleInput(filterType){const customFilterOption=this.optionsFactory.getCustomOption(filterType),{numberOfInputs}=customFilterOption||{};return null==numberOfInputs||1==numberOfInputs}isTypeEditable(type){const uneditableTypes=[SimpleFilter.IN_RANGE,SimpleFilter.EMPTY,SimpleFilter.BLANK,SimpleFilter.NOT_BLANK];return!!type&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(type)&&uneditableTypes.indexOf(type)<0}getAriaLabel(params){return`${this.columnModel.getDisplayNameForColumn(params.column,"header",!0)} ${this.localeService.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}};__decorateClass([Autowired("columnModel")],SimpleFloatingFilter.prototype,"columnModel",2);var DateFloatingFilter=class extends SimpleFloatingFilter{constructor(){super('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')}getDefaultFilterOptions(){return DateFilter.DEFAULT_FILTER_OPTIONS}init(params){super.init(params),this.params=params,this.filterParams=params.filterParams,this.createDateComponent(),this.filterModelFormatter=new DateFilterModelFormatter(this.filterParams,this.localeService,this.optionsFactory);const translate=this.localeService.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(translate("ariaDateFilterInput","Date Filter Input"))}onParamsUpdated(params){this.refresh(params)}refresh(params){super.refresh(params),this.params=params,this.filterParams=params.filterParams,this.updateDateComponent(),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory,dateFilterParams:this.filterParams}),this.updateCompOnModelChange(params.currentParentModel())}updateCompOnModelChange(model){const allowEditing=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(model);if(this.setEditable(allowEditing),allowEditing){if(model){const dateModel=model;this.dateComp.setDate(parseDateTimeFromString(dateModel.dateFrom))}else this.dateComp.setDate(null);this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(model)),this.dateComp.setDate(null)}setEditable(editable){setDisplayed(this.eDateWrapper,editable),setDisplayed(this.eReadOnlyText.getGui(),!editable)}onParentModelChanged(model,event){this.isEventFromFloatingFilter(event)||this.isEventFromDataChange(event)||(super.setLastTypeFromModel(model),this.updateCompOnModelChange(model))}onDateChanged(){const filterValueText=serialiseDate(this.dateComp.getDate());this.params.parentFilterInstance(filterInstance=>{if(filterInstance){const date=parseDateTimeFromString(filterValueText);filterInstance.onFloatingFilterChanged(this.getLastType()||null,date)}})}getDateComponentParams(){const debounceMs=ProvidedFilter.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs());return{onDateChanged:debounce(this.onDateChanged.bind(this),debounceMs),filterParams:this.params.column.getColDef().filterParams}}createDateComponent(){this.dateComp=new DateCompWrapper(this.getContext(),this.userComponentFactory,this.getDateComponentParams(),this.eDateWrapper,dateComp=>{dateComp.setInputAriaLabel(this.getAriaLabel(this.params))}),this.addDestroyFunc(()=>this.dateComp.destroy())}updateDateComponent(){const params=this.gos.addGridCommonParams(this.getDateComponentParams());this.dateComp.updateParams(params)}getFilterModelFormatter(){return this.filterModelFormatter}};__decorateClass([Autowired("userComponentFactory")],DateFloatingFilter.prototype,"userComponentFactory",2),__decorateClass([RefSelector("eReadOnlyText")],DateFloatingFilter.prototype,"eReadOnlyText",2),__decorateClass([RefSelector("eDateWrapper")],DateFloatingFilter.prototype,"eDateWrapper",2);var DefaultDateComponent=class extends Component{constructor(){super('\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')}destroy(){super.destroy()}init(params){this.params=params,this.setParams(params);const inputElement=this.eDateInput.getInputElement();this.addManagedListener(inputElement,"mousedown",()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||inputElement.focus()}),this.addManagedListener(inputElement,"input",e=>{e.target===this.gos.getActiveDomElement()&&(this.eDateInput.isDisabled()||this.params.onDateChanged())})}setParams(params){const inputElement=this.eDateInput.getInputElement(),shouldUseBrowserDatePicker=this.shouldUseBrowserDatePicker(params);this.usingSafariDatePicker=shouldUseBrowserDatePicker&&isBrowserSafari(),inputElement.type=shouldUseBrowserDatePicker?"date":"text";const{minValidYear,maxValidYear,minValidDate,maxValidDate}=params.filterParams||{};if(minValidDate&&minValidYear&&warnOnce("DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored."),maxValidDate&&maxValidYear&&warnOnce("DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored."),minValidDate&&maxValidDate){const[parsedMinValidDate,parsedMaxValidDate]=[minValidDate,maxValidDate].map(v=>v instanceof Date?v:parseDateTimeFromString(v));parsedMinValidDate&&parsedMaxValidDate&&parsedMinValidDate.getTime()>parsedMaxValidDate.getTime()&&warnOnce("DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.")}minValidDate?minValidDate instanceof Date?inputElement.min=dateToFormattedString(minValidDate):inputElement.min=minValidDate:minValidYear&&(inputElement.min=`${minValidYear}-01-01`),maxValidDate?maxValidDate instanceof Date?inputElement.max=dateToFormattedString(maxValidDate):inputElement.max=maxValidDate:maxValidYear&&(inputElement.max=`${maxValidYear}-12-31`)}onParamsUpdated(params){this.refresh(params)}refresh(params){this.params=params,this.setParams(params)}getDate(){return parseDateTimeFromString(this.eDateInput.getValue())}setDate(date){this.eDateInput.setValue(serialiseDate(date,!1))}setInputPlaceholder(placeholder){this.eDateInput.setInputPlaceholder(placeholder)}setInputAriaLabel(ariaLabel){this.eDateInput.setAriaLabel(ariaLabel)}setDisabled(disabled){this.eDateInput.setDisabled(disabled)}afterGuiAttached(params){params&&params.suppressFocus||this.eDateInput.getInputElement().focus()}shouldUseBrowserDatePicker(params){return params.filterParams&&null!=params.filterParams.browserDatePicker?params.filterParams.browserDatePicker:isBrowserChrome()||isBrowserFirefox()||isBrowserSafari()&&getSafariVersion()>=14.1}};__decorateClass([RefSelector("eDateInput")],DefaultDateComponent.prototype,"eDateInput",2);var AgInputTextField=class extends AgAbstractInputField{constructor(config,className="ag-text-field",inputType="text"){super(config,className,inputType)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(value,silent){return this.eInput.value!==value&&(this.eInput.value=exists(value)?value:""),super.setValue(value,silent)}setStartValue(value){this.setValue(value,!0)}preventDisallowedCharacters(){const pattern=new RegExp(`[${this.config.allowedCharPattern}]`);this.addManagedListener(this.eInput,"keydown",event=>{isEventFromPrintableCharacter(event)&&event.key&&!pattern.test(event.key)&&event.preventDefault()}),this.addManagedListener(this.eInput,"paste",e=>{var _a;const text=null==(_a=e.clipboardData)?void 0:_a.getData("text");text&&text.split("").some(c=>!pattern.test(c))&&e.preventDefault()})}},AgInputNumberField=class extends AgInputTextField{constructor(config){super(config,"ag-number-field","number")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"blur",()=>{const floatedValue=parseFloat(this.eInput.value),value=isNaN(floatedValue)?"":this.normalizeValue(floatedValue.toString());this.value!==value&&this.setValue(value)}),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this)),this.eInput.step="any";const{precision,min,max,step}=this.config;"number"==typeof precision&&this.setPrecision(precision),"number"==typeof min&&this.setMin(min),"number"==typeof max&&this.setMax(max),"number"==typeof step&&this.setStep(step)}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}normalizeValue(value){if(""===value)return"";null!=this.precision&&(value=this.adjustPrecision(value));const val=parseFloat(value);return null!=this.min&&val<this.min?value=this.min.toString():null!=this.max&&val>this.max&&(value=this.max.toString()),value}adjustPrecision(value,isScientificNotation){if(null==this.precision)return value;if(isScientificNotation){const floatString=parseFloat(value).toFixed(this.precision);return parseFloat(floatString).toString()}const parts=String(value).split(".");if(parts.length>1){if(parts[1].length<=this.precision)return value;if(this.precision>0)return`${parts[0]}.${parts[1].slice(0,this.precision)}`}return parts[0]}setMin(min){return this.min===min||(this.min=min,addOrRemoveAttribute(this.eInput,"min",min)),this}setMax(max){return this.max===max||(this.max=max,addOrRemoveAttribute(this.eInput,"max",max)),this}setPrecision(precision){return this.precision=precision,this}setStep(step){return this.step===step||(this.step=step,addOrRemoveAttribute(this.eInput,"step",step)),this}setValue(value,silent){return this.setValueOrInputValue(v=>super.setValue(v,silent),()=>this,value)}setStartValue(value){return this.setValueOrInputValue(v=>super.setValue(v,!0),v=>{this.eInput.value=v},value)}setValueOrInputValue(setValueFunc,setInputValueOnlyFunc,value){if(exists(value)){let setInputValueOnly=this.isScientificNotation(value);if(setInputValueOnly&&this.eInput.validity.valid)return setValueFunc(value);if(!setInputValueOnly){setInputValueOnly=(value=this.adjustPrecision(value))!=this.normalizeValue(value)}if(setInputValueOnly)return setInputValueOnlyFunc(value)}return setValueFunc(value)}getValue(){if(!this.eInput.validity.valid)return;const inputValue=this.eInput.value;return this.isScientificNotation(inputValue)?this.adjustPrecision(inputValue,!0):super.getValue()}isScientificNotation(value){return"string"==typeof value&&value.includes("e")}},NumberFilterModelFormatter=class extends SimpleFilterModelFormatter{conditionToString(condition,options){const{numberOfInputs}=options||{};return condition.type==SimpleFilter.IN_RANGE||2===numberOfInputs?`${this.formatValue(condition.filter)}-${this.formatValue(condition.filterTo)}`:null!=condition.filter?this.formatValue(condition.filter):`${condition.type}`}};function getAllowedCharPattern(filterParams){const{allowedCharPattern}=null!=filterParams?filterParams:{};return null!=allowedCharPattern?allowedCharPattern:null}var _NumberFilter=class _NumberFilter extends ScalarFilter{constructor(){super("numberFilter"),this.eValuesFrom=[],this.eValuesTo=[]}refresh(params){return this.numberFilterParams.allowedCharPattern===params.allowedCharPattern&&super.refresh(params)}mapValuesFromModel(filterModel){const{filter,filterTo,type}=filterModel||{};return[this.processValue(filter),this.processValue(filterTo)].slice(0,this.getNumberOfInputs(type))}getDefaultDebounceMs(){return 500}comparator(){return(left,right)=>left===right?0:left<right?1:-1}setParams(params){this.numberFilterParams=params,super.setParams(params),this.filterModelFormatter=new NumberFilterModelFormatter(this.localeService,this.optionsFactory,this.numberFilterParams.numberFormatter)}getDefaultFilterOptions(){return _NumberFilter.DEFAULT_FILTER_OPTIONS}setElementValue(element,value,fromFloatingFilter){const valueToSet=!fromFloatingFilter&&this.numberFilterParams.numberFormatter?this.numberFilterParams.numberFormatter(null!=value?value:null):value;super.setElementValue(element,valueToSet)}createValueElement(){const allowedCharPattern=getAllowedCharPattern(this.numberFilterParams),eCondition=document.createElement("div");return eCondition.classList.add("ag-filter-body"),setAriaRole(eCondition,"presentation"),this.createFromToElement(eCondition,this.eValuesFrom,"from",allowedCharPattern),this.createFromToElement(eCondition,this.eValuesTo,"to",allowedCharPattern),eCondition}createFromToElement(eCondition,eValues,fromTo,allowedCharPattern){const eValue=this.createManagedBean(allowedCharPattern?new AgInputTextField({allowedCharPattern}):new AgInputNumberField);eValue.addCssClass(`ag-filter-${fromTo}`),eValue.addCssClass("ag-filter-filter"),eValues.push(eValue),eCondition.appendChild(eValue.getGui())}removeValueElements(startPosition,deleteCount){this.removeComponents(this.eValuesFrom,startPosition,deleteCount),this.removeComponents(this.eValuesTo,startPosition,deleteCount)}getValues(position){const result=[];return this.forEachPositionInput(position,(element,index,_elPosition,numberOfInputs)=>{index<numberOfInputs&&result.push(this.processValue(this.stringToFloat(element.getValue())))}),result}areSimpleModelsEqual(aSimple,bSimple){return aSimple.filter===bSimple.filter&&aSimple.filterTo===bSimple.filterTo&&aSimple.type===bSimple.type}getFilterType(){return"number"}processValue(value){return null==value||isNaN(value)?null:value}stringToFloat(value){if("number"==typeof value)return value;let filterText=makeNull(value);return null!=filterText&&""===filterText.trim()&&(filterText=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(filterText):null==filterText||"-"===filterText.trim()?null:parseFloat(filterText)}createCondition(position){const type=this.getConditionType(position),model={filterType:this.getFilterType(),type},values2=this.getValues(position);return values2.length>0&&(model.filter=values2[0]),values2.length>1&&(model.filterTo=values2[1]),model}getInputs(position){return position>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[position],this.eValuesTo[position]]}getModelAsString(model){var _a;return null!=(_a=this.filterModelFormatter.getModelAsString(model))?_a:""}hasInvalidInputs(){let invalidInputs=!1;return this.forEachInput(element=>{element.getInputElement().validity.valid||(invalidInputs=!0)}),invalidInputs}};_NumberFilter.DEFAULT_FILTER_OPTIONS=[ScalarFilter.EQUALS,ScalarFilter.NOT_EQUAL,ScalarFilter.GREATER_THAN,ScalarFilter.GREATER_THAN_OR_EQUAL,ScalarFilter.LESS_THAN,ScalarFilter.LESS_THAN_OR_EQUAL,ScalarFilter.IN_RANGE,ScalarFilter.BLANK,ScalarFilter.NOT_BLANK];var NumberFilter=_NumberFilter,TextFilterModelFormatter=class extends SimpleFilterModelFormatter{conditionToString(condition,options){const{numberOfInputs}=options||{};return condition.type==SimpleFilter.IN_RANGE||2===numberOfInputs?`${condition.filter}-${condition.filterTo}`:null!=condition.filter?`${condition.filter}`:`${condition.type}`}},_TextFilter=class _TextFilter extends SimpleFilter{constructor(){super("textFilter"),this.eValuesFrom=[],this.eValuesTo=[]}static trimInput(value){const trimmedInput=value&&value.trim();return""===trimmedInput?value:trimmedInput}getDefaultDebounceMs(){return 500}setParams(params){this.textFilterParams=params,super.setParams(params),this.matcher=this.getTextMatcher(),this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?_TextFilter.DEFAULT_FORMATTER:_TextFilter.DEFAULT_LOWERCASE_FORMATTER),this.filterModelFormatter=new TextFilterModelFormatter(this.localeService,this.optionsFactory)}getTextMatcher(){const legacyComparator=this.textFilterParams.textCustomComparator;return legacyComparator?(_.warnOnce("textCustomComparator is deprecated, use textMatcher instead."),({filterOption,value,filterText})=>legacyComparator(filterOption,value,filterText)):this.textFilterParams.textMatcher||_TextFilter.DEFAULT_MATCHER}createCondition(position){const type=this.getConditionType(position),model={filterType:this.getFilterType(),type},values2=this.getValuesWithSideEffects(position,!0);return values2.length>0&&(model.filter=values2[0]),values2.length>1&&(model.filterTo=values2[1]),model}getFilterType(){return"text"}areSimpleModelsEqual(aSimple,bSimple){return aSimple.filter===bSimple.filter&&aSimple.filterTo===bSimple.filterTo&&aSimple.type===bSimple.type}getInputs(position){return position>=this.eValuesFrom.length?[null,null]:[this.eValuesFrom[position],this.eValuesTo[position]]}getValues(position){return this.getValuesWithSideEffects(position,!1)}getValuesWithSideEffects(position,applySideEffects){const result=[];return this.forEachPositionInput(position,(element,index,_elPosition,numberOfInputs)=>{var _a;if(index<numberOfInputs){let value=makeNull(element.getValue());applySideEffects&&this.textFilterParams.trimInput&&(value=null!=(_a=_TextFilter.trimInput(value))?_a:null,element.setValue(value,!0)),result.push(value)}}),result}getDefaultFilterOptions(){return _TextFilter.DEFAULT_FILTER_OPTIONS}createValueElement(){const eCondition=document.createElement("div");return eCondition.classList.add("ag-filter-body"),setAriaRole(eCondition,"presentation"),this.createFromToElement(eCondition,this.eValuesFrom,"from"),this.createFromToElement(eCondition,this.eValuesTo,"to"),eCondition}createFromToElement(eCondition,eValues,fromTo){const eValue=this.createManagedBean(new AgInputTextField);eValue.addCssClass(`ag-filter-${fromTo}`),eValue.addCssClass("ag-filter-filter"),eValues.push(eValue),eCondition.appendChild(eValue.getGui())}removeValueElements(startPosition,deleteCount){this.removeComponents(this.eValuesFrom,startPosition,deleteCount),this.removeComponents(this.eValuesTo,startPosition,deleteCount)}mapValuesFromModel(filterModel){const{filter,filterTo,type}=filterModel||{};return[filter||null,filterTo||null].slice(0,this.getNumberOfInputs(type))}evaluateNullValue(filterType){const filterTypesAllowNulls=[SimpleFilter.NOT_EQUAL,SimpleFilter.NOT_CONTAINS,SimpleFilter.BLANK];return!!filterType&&filterTypesAllowNulls.indexOf(filterType)>=0}evaluateNonNullValue(values2,cellValue,filterModel,params){const formattedValues=values2.map(v=>this.formatter(v))||[],cellValueFormatted=this.formatter(cellValue),{api,colDef,column,columnApi,context,textFormatter}=this.textFilterParams;if(filterModel.type===SimpleFilter.BLANK)return this.isBlank(cellValue);if(filterModel.type===SimpleFilter.NOT_BLANK)return!this.isBlank(cellValue);const matcherParams={api,colDef,column,columnApi,context,node:params.node,data:params.data,filterOption:filterModel.type,value:cellValueFormatted,textFormatter};return formattedValues.some(v=>this.matcher(__spreadProps(__spreadValues({},matcherParams),{filterText:v})))}getModelAsString(model){var _a;return null!=(_a=this.filterModelFormatter.getModelAsString(model))?_a:""}};_TextFilter.DEFAULT_FILTER_OPTIONS=[SimpleFilter.CONTAINS,SimpleFilter.NOT_CONTAINS,SimpleFilter.EQUALS,SimpleFilter.NOT_EQUAL,SimpleFilter.STARTS_WITH,SimpleFilter.ENDS_WITH,SimpleFilter.BLANK,SimpleFilter.NOT_BLANK],_TextFilter.DEFAULT_FORMATTER=from=>from,_TextFilter.DEFAULT_LOWERCASE_FORMATTER=from=>null==from?null:from.toString().toLowerCase(),_TextFilter.DEFAULT_MATCHER=({filterOption,value,filterText})=>{if(null==filterText)return!1;switch(filterOption){case _TextFilter.CONTAINS:return value.indexOf(filterText)>=0;case _TextFilter.NOT_CONTAINS:return value.indexOf(filterText)<0;case _TextFilter.EQUALS:return value===filterText;case _TextFilter.NOT_EQUAL:return value!=filterText;case _TextFilter.STARTS_WITH:return 0===value.indexOf(filterText);case _TextFilter.ENDS_WITH:const index=value.lastIndexOf(filterText);return index>=0&&index===value.length-filterText.length;default:return!1}};var TextFilter=_TextFilter,FloatingFilterTextInputService=class extends BeanStub{constructor(params){super(),this.params=params,this.valueChangedListener=()=>{}}setupGui(parentElement){var _a;this.eFloatingFilterTextInput=this.createManagedBean(new AgInputTextField(null==(_a=this.params)?void 0:_a.config));const eInput=this.eFloatingFilterTextInput.getGui();parentElement.appendChild(eInput),this.addManagedListener(eInput,"input",e=>this.valueChangedListener(e)),this.addManagedListener(eInput,"keydown",e=>this.valueChangedListener(e))}setEditable(editable){this.eFloatingFilterTextInput.setDisabled(!editable)}setAutoComplete(autoComplete){this.eFloatingFilterTextInput.setAutoComplete(autoComplete)}getValue(){return this.eFloatingFilterTextInput.getValue()}setValue(value,silent){this.eFloatingFilterTextInput.setValue(value,silent)}setValueChangedListener(listener){this.valueChangedListener=listener}setParams(params){this.setAriaLabel(params.ariaLabel),void 0!==params.autoComplete&&this.setAutoComplete(params.autoComplete)}setAriaLabel(ariaLabel){this.eFloatingFilterTextInput.setInputAriaLabel(ariaLabel)}},TextInputFloatingFilter=class extends SimpleFloatingFilter{postConstruct(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation" ref="eFloatingFilterInputContainer"></div>\n        ')}getDefaultDebounceMs(){return 500}onParentModelChanged(model,event){this.isEventFromFloatingFilter(event)||this.isEventFromDataChange(event)||(this.setLastTypeFromModel(model),this.setEditable(this.canWeEditAfterModelFromParentFilter(model)),this.floatingFilterInputService.setValue(this.getFilterModelFormatter().getModelAsString(model)))}init(params){this.setupFloatingFilterInputService(params),super.init(params),this.setTextInputParams(params)}setupFloatingFilterInputService(params){this.floatingFilterInputService=this.createFloatingFilterInputService(params),this.floatingFilterInputService.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(params){var _a;this.params=params;const autoComplete=null!=(_a=params.browserAutoComplete)&&_a;if(this.floatingFilterInputService.setParams({ariaLabel:this.getAriaLabel(params),autoComplete}),this.applyActive=ProvidedFilter.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){const debounceMs=ProvidedFilter.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),toDebounce=debounce(this.syncUpWithParentFilter.bind(this),debounceMs);this.floatingFilterInputService.setValueChangedListener(toDebounce)}}onParamsUpdated(params){this.refresh(params)}refresh(params){super.refresh(params),this.setTextInputParams(params)}recreateFloatingFilterInputService(params){const value=this.floatingFilterInputService.getValue();clearElement(this.eFloatingFilterInputContainer),this.destroyBean(this.floatingFilterInputService),this.setupFloatingFilterInputService(params),this.floatingFilterInputService.setValue(value,!0)}syncUpWithParentFilter(e){const isEnterKey=e.key===KeyCode.ENTER;if(this.applyActive&&!isEnterKey)return;let value=this.floatingFilterInputService.getValue();this.params.filterParams.trimInput&&(value=TextFilter.trimInput(value),this.floatingFilterInputService.setValue(value,!0)),this.params.parentFilterInstance(filterInstance=>{filterInstance&&filterInstance.onFloatingFilterChanged(this.getLastType()||null,value||null)})}setEditable(editable){this.floatingFilterInputService.setEditable(editable)}};__decorateClass([RefSelector("eFloatingFilterInputContainer")],TextInputFloatingFilter.prototype,"eFloatingFilterInputContainer",2),__decorateClass([PostConstruct],TextInputFloatingFilter.prototype,"postConstruct",1);var FloatingFilterNumberInputService=class extends BeanStub{constructor(){super(...arguments),this.valueChangedListener=()=>{},this.numberInputActive=!0}setupGui(parentElement){this.eFloatingFilterNumberInput=this.createManagedBean(new AgInputNumberField),this.eFloatingFilterTextInput=this.createManagedBean(new AgInputTextField),this.eFloatingFilterTextInput.setDisabled(!0);const eNumberInput=this.eFloatingFilterNumberInput.getGui(),eTextInput=this.eFloatingFilterTextInput.getGui();parentElement.appendChild(eNumberInput),parentElement.appendChild(eTextInput),this.setupListeners(eNumberInput,e=>this.valueChangedListener(e)),this.setupListeners(eTextInput,e=>this.valueChangedListener(e))}setEditable(editable){this.numberInputActive=editable,this.eFloatingFilterNumberInput.setDisplayed(this.numberInputActive),this.eFloatingFilterTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(autoComplete){this.eFloatingFilterNumberInput.setAutoComplete(autoComplete),this.eFloatingFilterTextInput.setAutoComplete(autoComplete)}getValue(){return this.getActiveInputElement().getValue()}setValue(value,silent){this.getActiveInputElement().setValue(value,silent)}getActiveInputElement(){return this.numberInputActive?this.eFloatingFilterNumberInput:this.eFloatingFilterTextInput}setValueChangedListener(listener){this.valueChangedListener=listener}setupListeners(element,listener){this.addManagedListener(element,"input",listener),this.addManagedListener(element,"keydown",listener)}setParams(params){this.setAriaLabel(params.ariaLabel),void 0!==params.autoComplete&&this.setAutoComplete(params.autoComplete)}setAriaLabel(ariaLabel){this.eFloatingFilterNumberInput.setInputAriaLabel(ariaLabel),this.eFloatingFilterTextInput.setInputAriaLabel(ariaLabel)}},NumberFloatingFilter=class extends TextInputFloatingFilter{init(params){var _a;super.init(params),this.filterModelFormatter=new NumberFilterModelFormatter(this.localeService,this.optionsFactory,null==(_a=params.filterParams)?void 0:_a.numberFormatter)}onParamsUpdated(params){this.refresh(params)}refresh(params){getAllowedCharPattern(params.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(params),super.refresh(params),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return NumberFilter.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(params){return this.allowedCharPattern=getAllowedCharPattern(params.filterParams),this.allowedCharPattern?this.createManagedBean(new FloatingFilterTextInputService({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new FloatingFilterNumberInputService)}},TextFloatingFilter=class extends TextInputFloatingFilter{init(params){super.init(params),this.filterModelFormatter=new TextFilterModelFormatter(this.localeService,this.optionsFactory)}onParamsUpdated(params){this.refresh(params)}refresh(params){super.refresh(params),this.filterModelFormatter.updateParams({optionsFactory:this.optionsFactory})}getDefaultFilterOptions(){return TextFilter.DEFAULT_FILTER_OPTIONS}getFilterModelFormatter(){return this.filterModelFormatter}createFloatingFilterInputService(){return this.createManagedBean(new FloatingFilterTextInputService)}},_TouchListener=class _TouchListener{constructor(eElement,preventMouseClick=!1){this.destroyFuncs=[],this.touching=!1,this.eventService=new EventService,this.eElement=eElement,this.preventMouseClick=preventMouseClick;const startListener=this.onTouchStart.bind(this),moveListener=this.onTouchMove.bind(this),endListener=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",startListener,{passive:!0}),this.eElement.addEventListener("touchmove",moveListener,{passive:!0}),this.eElement.addEventListener("touchend",endListener,{passive:!1}),this.destroyFuncs.push(()=>{this.eElement.removeEventListener("touchstart",startListener,{passive:!0}),this.eElement.removeEventListener("touchmove",moveListener,{passive:!0}),this.eElement.removeEventListener("touchend",endListener,{passive:!1})})}getActiveTouch(touchList){for(let i=0;i<touchList.length;i++){if(touchList[i].identifier===this.touchStart.identifier)return touchList[i]}return null}addEventListener(eventType,listener){this.eventService.addEventListener(eventType,listener)}removeEventListener(eventType,listener){this.eventService.removeEventListener(eventType,listener)}onTouchStart(touchEvent){if(this.touching)return;this.touchStart=touchEvent.touches[0],this.touching=!0,this.moved=!1;const touchStartCopy=this.touchStart;window.setTimeout(()=>{const touchesMatch=this.touchStart===touchStartCopy;if(this.touching&&touchesMatch&&!this.moved){this.moved=!0;const event={type:_TouchListener.EVENT_LONG_TAP,touchStart:this.touchStart,touchEvent};this.eventService.dispatchEvent(event)}},500)}onTouchMove(touchEvent){if(!this.touching)return;const touch=this.getActiveTouch(touchEvent.touches);if(!touch)return;!areEventsNear(touch,this.touchStart,4)&&(this.moved=!0)}onTouchEnd(touchEvent){if(this.touching){if(!this.moved){const event={type:_TouchListener.EVENT_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(event),this.checkForDoubleTap()}this.preventMouseClick&&touchEvent.cancelable&&touchEvent.preventDefault(),this.touching=!1}}checkForDoubleTap(){const now=(new Date).getTime();if(this.lastTapTime&&this.lastTapTime>0){if(now-this.lastTapTime>_TouchListener.DOUBLE_TAP_MILLIS){const event={type:_TouchListener.EVENT_DOUBLE_TAP,touchStart:this.touchStart};this.eventService.dispatchEvent(event),this.lastTapTime=null}else this.lastTapTime=now}else this.lastTapTime=now}destroy(){this.destroyFuncs.forEach(func=>func())}};_TouchListener.EVENT_TAP="tap",_TouchListener.EVENT_DOUBLE_TAP="doubleTap",_TouchListener.EVENT_LONG_TAP="longTap",_TouchListener.DOUBLE_TAP_MILLIS=500;var TouchListener=_TouchListener,_SortIndicatorComp=class _SortIndicatorComp extends Component{constructor(skipTemplate){super(),skipTemplate||this.setTemplate(_SortIndicatorComp.TEMPLATE)}attachCustomElements(eSortOrder,eSortAsc,eSortDesc,eSortMixed,eSortNone){this.eSortOrder=eSortOrder,this.eSortAsc=eSortAsc,this.eSortDesc=eSortDesc,this.eSortMixed=eSortMixed,this.eSortNone=eSortNone}setupSort(column,suppressOrder=!1){this.column=column,this.suppressOrder=suppressOrder,this.setupMultiSortIndicator(),(this.column.isSortable()||this.column.getColDef().showRowGroup)&&(this.addInIcon("sortAscending",this.eSortAsc,column),this.addInIcon("sortDescending",this.eSortDesc,column),this.addInIcon("sortUnSort",this.eSortNone,column),this.addManagedPropertyListener("unSortIcon",()=>this.updateIcons()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.updateIcons()),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,()=>this.onSortChanged()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.onSortChanged()),this.onSortChanged())}addInIcon(iconName,eParent,column){if(null==eParent)return;const eIcon=createIconNoSpan(iconName,this.gos,column);eIcon&&eParent.appendChild(eIcon)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const sortDirection=this.sortController.getDisplaySortForColumn(this.column);if(this.eSortAsc){const isAscending="asc"===sortDirection;setDisplayed(this.eSortAsc,isAscending,{skipAriaHidden:!0})}if(this.eSortDesc){const isDescending="desc"===sortDirection;setDisplayed(this.eSortDesc,isDescending,{skipAriaHidden:!0})}if(this.eSortNone){const alwaysHideNoSort=!this.column.getColDef().unSortIcon&&!this.gos.get("unSortIcon"),isNone=null==sortDirection;setDisplayed(this.eSortNone,!alwaysHideNoSort&&isNone,{skipAriaHidden:!0})}}setupMultiSortIndicator(){this.addInIcon("sortUnSort",this.eSortMixed,this.column);const isColumnShowingRowGroup=this.column.getColDef().showRowGroup;this.gos.isColumnsSortingCoupledToGroup()&&isColumnShowingRowGroup&&(this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,()=>this.updateMultiSortIndicator()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateMultiSortIndicator()),this.updateMultiSortIndicator())}updateMultiSortIndicator(){if(this.eSortMixed){const isMixedSort="mixed"===this.sortController.getDisplaySortForColumn(this.column);setDisplayed(this.eSortMixed,isMixedSort,{skipAriaHidden:!0})}}updateSortOrder(){var _a;if(!this.eSortOrder)return;const allColumnsWithSorting=this.sortController.getColumnsWithSortingOrdered(),indexThisCol=null!=(_a=this.sortController.getDisplaySortIndexForColumn(this.column))?_a:-1,moreThanOneColSorting=allColumnsWithSorting.some(col=>{var _a2;return null!=(_a2=this.sortController.getDisplaySortIndexForColumn(col))&&_a2}),showIndex=indexThisCol>=0&&moreThanOneColSorting;setDisplayed(this.eSortOrder,showIndex,{skipAriaHidden:!0}),indexThisCol>=0?this.eSortOrder.textContent=(indexThisCol+1).toString():clearElement(this.eSortOrder)}};_SortIndicatorComp.TEMPLATE='<span class="ag-sort-indicator-container">\n            <span ref="eSortOrder" class="ag-sort-indicator-icon ag-sort-order ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortAsc" class="ag-sort-indicator-icon ag-sort-ascending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortDesc" class="ag-sort-indicator-icon ag-sort-descending-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortMixed" class="ag-sort-indicator-icon ag-sort-mixed-icon ag-hidden" aria-hidden="true"></span>\n            <span ref="eSortNone" class="ag-sort-indicator-icon ag-sort-none-icon ag-hidden" aria-hidden="true"></span>\n        </span>',__decorateClass([RefSelector("eSortOrder")],_SortIndicatorComp.prototype,"eSortOrder",2),__decorateClass([RefSelector("eSortAsc")],_SortIndicatorComp.prototype,"eSortAsc",2),__decorateClass([RefSelector("eSortDesc")],_SortIndicatorComp.prototype,"eSortDesc",2),__decorateClass([RefSelector("eSortMixed")],_SortIndicatorComp.prototype,"eSortMixed",2),__decorateClass([RefSelector("eSortNone")],_SortIndicatorComp.prototype,"eSortNone",2),__decorateClass([Autowired("columnModel")],_SortIndicatorComp.prototype,"columnModel",2),__decorateClass([Autowired("sortController")],_SortIndicatorComp.prototype,"sortController",2);var SortIndicatorComp=_SortIndicatorComp,_HeaderComp=class _HeaderComp extends Component{constructor(){super(...arguments),this.lastMovingChanged=0}destroy(){super.destroy()}refresh(params){const oldParams=this.params;return this.params=params,this.workOutTemplate()==this.currentTemplate&&this.workOutShowMenu()==this.currentShowMenu&&this.workOutSort()==this.currentSort&&this.shouldSuppressMenuHide()==this.currentSuppressMenuHide&&oldParams.enableFilterButton==params.enableFilterButton&&oldParams.enableFilterIcon==params.enableFilterIcon&&(this.setDisplayName(params),!0)}workOutTemplate(){var _a;let template=null!=(_a=this.params.template)?_a:_HeaderComp.TEMPLATE;return template=template&&template.trim?template.trim():template,template}init(params){this.params=params,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setupFilterButton(),this.setDisplayName(params)}setDisplayName(params){if(this.currentDisplayName!=params.displayName){this.currentDisplayName=params.displayName;const displayNameSanitised=escapeString(this.currentDisplayName,!0);this.eText&&(this.eText.textContent=displayNameSanitised)}}addInIcon(iconName,eParent,column){if(null==eParent)return;const eIcon=createIconNoSpan(iconName,this.gos,column);eIcon&&eParent.appendChild(eIcon)}setupTap(){const{gos}=this;if(gos.get("suppressTouch"))return;const touchListener=new TouchListener(this.getGui(),!0),suppressMenuHide=this.shouldSuppressMenuHide(),tapMenuButton=suppressMenuHide&&exists(this.eMenu),menuTouchListener=tapMenuButton?new TouchListener(this.eMenu,!0):touchListener;if(this.params.enableMenu){const eventType=tapMenuButton?"EVENT_TAP":"EVENT_LONG_TAP",showMenuFn=event=>this.params.showColumnMenuAfterMouseClick(event.touchStart);this.addManagedListener(menuTouchListener,TouchListener[eventType],showMenuFn)}if(this.params.enableSorting){const tapListener=event=>{var _a,_b;const target=event.touchStart.target;suppressMenuHide&&((null==(_a=this.eMenu)?void 0:_a.contains(target))||(null==(_b=this.eFilterButton)?void 0:_b.contains(target)))||this.sortController.progressSort(this.params.column,!1,"uiColumnSorted")};this.addManagedListener(touchListener,TouchListener.EVENT_TAP,tapListener)}if(this.params.enableFilterButton){const filterButtonTouchListener=new TouchListener(this.eFilterButton,!0);this.addManagedListener(filterButtonTouchListener,"tap",()=>this.params.showFilter(this.eFilterButton)),this.addDestroyFunc(()=>filterButtonTouchListener.destroy())}this.addDestroyFunc(()=>touchListener.destroy()),tapMenuButton&&this.addDestroyFunc(()=>menuTouchListener.destroy())}workOutShowMenu(){return this.params.enableMenu&&this.menuService.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return this.menuService.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return removeFromParent(this.eMenu),void(this.eMenu=void 0);const isLegacyMenu=this.menuService.isLegacyMenuEnabled();this.addInIcon(isLegacyMenu?"menu":"menuAlt",this.eMenu,this.params.column),this.eMenu.classList.toggle("ag-header-menu-icon",!isLegacyMenu),this.currentSuppressMenuHide=this.shouldSuppressMenuHide(),this.addManagedListener(this.eMenu,"click",()=>this.params.showColumnMenu(this.eMenu)),this.eMenu.classList.toggle("ag-header-menu-always-show",this.currentSuppressMenuHide)}onMenuKeyboardShortcut(isFilterShortcut){var _a,_b,_c,_d;const{column}=this.params,isLegacyMenuEnabled=this.menuService.isLegacyMenuEnabled();if(isFilterShortcut&&!isLegacyMenuEnabled){if(this.menuService.isFilterMenuInHeaderEnabled(column))return this.params.showFilter(null!=(_b=null!=(_a=this.eFilterButton)?_a:this.eMenu)?_b:this.getGui()),!0}else if(this.params.enableMenu)return this.params.showColumnMenu(null!=(_d=null!=(_c=this.eMenu)?_c:this.eFilterButton)?_d:this.getGui()),!0;return!1}workOutSort(){return this.params.enableSorting}setupSort(){if(this.currentSort=this.params.enableSorting,this.eSortIndicator||(this.eSortIndicator=this.context.createBean(new SortIndicatorComp(!0)),this.eSortIndicator.attachCustomElements(this.eSortOrder,this.eSortAsc,this.eSortDesc,this.eSortMixed,this.eSortNone)),this.eSortIndicator.setupSort(this.params.column),!this.currentSort)return;this.addManagedListener(this.params.column,Column.EVENT_MOVING_CHANGED,()=>{this.lastMovingChanged=(new Date).getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",event=>{const moving=this.params.column.isMoving(),movedRecently=(new Date).getTime()-this.lastMovingChanged<50;if(!(moving||movedRecently)){const multiSort="ctrl"===this.gos.get("multiSortKey")?event.ctrlKey||event.metaKey:event.shiftKey;this.params.progressSort(multiSort)}});const onSortingChanged=()=>{if(this.addOrRemoveCssClass("ag-header-cell-sorted-asc",this.params.column.isSortAscending()),this.addOrRemoveCssClass("ag-header-cell-sorted-desc",this.params.column.isSortDescending()),this.addOrRemoveCssClass("ag-header-cell-sorted-none",this.params.column.isSortNone()),this.params.column.getColDef().showRowGroup){const sourceColumns=this.columnModel.getSourceColumnsForGroupColumn(this.params.column),isMultiSorting=!(null==sourceColumns?void 0:sourceColumns.every(sourceCol=>this.params.column.getSort()==sourceCol.getSort()));this.addOrRemoveCssClass("ag-header-cell-sorted-mixed",isMultiSorting)}};this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,onSortingChanged),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,onSortingChanged)}setupFilterIcon(){this.eFilter&&this.configureFilter(this.params.enableFilterIcon,this.eFilter,this.onFilterChangedIcon.bind(this))}setupFilterButton(){if(!this.eFilterButton)return;this.configureFilter(this.params.enableFilterButton,this.eFilterButton,this.onFilterChangedButton.bind(this))?this.addManagedListener(this.eFilterButton,"click",()=>this.params.showFilter(this.eFilterButton)):this.eFilterButton=void 0}configureFilter(enabled,element,filterChangedCallback){if(!enabled)return removeFromParent(element),!1;const{column}=this.params;return this.addInIcon("filter",element,column),this.addManagedListener(column,Column.EVENT_FILTER_CHANGED,filterChangedCallback),filterChangedCallback(),!0}onFilterChangedIcon(){const filterPresent=this.params.column.isFilterActive();setDisplayed(this.eFilter,filterPresent,{skipAriaHidden:!0})}onFilterChangedButton(){const filterPresent=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",filterPresent)}getAnchorElementForMenu(isFilter){var _a,_b,_c,_d;return isFilter?null!=(_b=null!=(_a=this.eFilterButton)?_a:this.eMenu)?_b:this.getGui():null!=(_d=null!=(_c=this.eMenu)?_c:this.eFilterButton)?_d:this.getGui()}};_HeaderComp.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <span ref="eFilterButton" class="ag-header-icon ag-header-cell-filter-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation">\n                <span ref="eText" class="ag-header-cell-text"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <ag-sort-indicator ref="eSortIndicator"></ag-sort-indicator>\n            </div>\n        </div>',__decorateClass([Autowired("sortController")],_HeaderComp.prototype,"sortController",2),__decorateClass([Autowired("menuService")],_HeaderComp.prototype,"menuService",2),__decorateClass([Autowired("columnModel")],_HeaderComp.prototype,"columnModel",2),__decorateClass([RefSelector("eFilter")],_HeaderComp.prototype,"eFilter",2),__decorateClass([RefSelector("eFilterButton")],_HeaderComp.prototype,"eFilterButton",2),__decorateClass([RefSelector("eSortIndicator")],_HeaderComp.prototype,"eSortIndicator",2),__decorateClass([RefSelector("eMenu")],_HeaderComp.prototype,"eMenu",2),__decorateClass([RefSelector("eLabel")],_HeaderComp.prototype,"eLabel",2),__decorateClass([RefSelector("eText")],_HeaderComp.prototype,"eText",2),__decorateClass([RefSelector("eSortOrder")],_HeaderComp.prototype,"eSortOrder",2),__decorateClass([RefSelector("eSortAsc")],_HeaderComp.prototype,"eSortAsc",2),__decorateClass([RefSelector("eSortDesc")],_HeaderComp.prototype,"eSortDesc",2),__decorateClass([RefSelector("eSortMixed")],_HeaderComp.prototype,"eSortMixed",2),__decorateClass([RefSelector("eSortNone")],_HeaderComp.prototype,"eSortNone",2);var HeaderComp=_HeaderComp,_HeaderGroupComp=class _HeaderGroupComp extends Component{constructor(){super(_HeaderGroupComp.TEMPLATE)}destroy(){super.destroy()}init(params){this.params=params,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()}checkWarnings(){this.params.template&&warnOnce("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")}setupExpandIcons(){this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");const expandAction=event=>{if(isStopPropagationForAgGrid(event))return;const newExpandedValue=!this.params.columnGroup.isExpanded();this.columnModel.setColumnGroupOpened(this.params.columnGroup.getProvidedColumnGroup(),newExpandedValue,"uiColumnExpanded")};this.addTouchAndClickListeners(this.eCloseIcon,expandAction),this.addTouchAndClickListeners(this.eOpenIcon,expandAction);const stopPropagationAction=event=>{stopPropagationForAgGrid(event)};this.addManagedListener(this.eCloseIcon,"dblclick",stopPropagationAction),this.addManagedListener(this.eOpenIcon,"dblclick",stopPropagationAction),this.addManagedListener(this.getGui(),"dblclick",expandAction),this.updateIconVisibility();const providedColumnGroup=this.params.columnGroup.getProvidedColumnGroup();this.addManagedListener(providedColumnGroup,ProvidedColumnGroup.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(providedColumnGroup,ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))}addTouchAndClickListeners(eElement,action){const touchListener=new TouchListener(eElement,!0);this.addManagedListener(touchListener,TouchListener.EVENT_TAP,action),this.addDestroyFunc(()=>touchListener.destroy()),this.addManagedListener(eElement,"click",action)}updateIconVisibility(){if(this.params.columnGroup.isExpandable()){const expanded=this.params.columnGroup.isExpanded();setDisplayed(this.eOpenIcon,expanded),setDisplayed(this.eCloseIcon,!expanded)}else setDisplayed(this.eOpenIcon,!1),setDisplayed(this.eCloseIcon,!1)}addInIcon(iconName,refName){const eIcon=createIconNoSpan(iconName,this.gos,null);eIcon&&this.getRefElement(refName).appendChild(eIcon)}addGroupExpandIcon(){if(!this.params.columnGroup.isExpandable())return setDisplayed(this.eOpenIcon,!1),void setDisplayed(this.eCloseIcon,!1)}setupLabel(){var _a;const{displayName,columnGroup}=this.params;if(exists(displayName)){const displayNameSanitised=escapeString(displayName,!0);this.getRefElement("agLabel").textContent=displayNameSanitised}this.addOrRemoveCssClass("ag-sticky-label",!(null==(_a=columnGroup.getColGroupDef())?void 0:_a.suppressStickyLabel))}};_HeaderGroupComp.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',__decorateClass([Autowired("columnModel")],_HeaderGroupComp.prototype,"columnModel",2),__decorateClass([RefSelector("agOpened")],_HeaderGroupComp.prototype,"eOpenIcon",2),__decorateClass([RefSelector("agClosed")],_HeaderGroupComp.prototype,"eCloseIcon",2);var HeaderGroupComp=_HeaderGroupComp,PopupComponent=class extends Component{isPopup(){return!0}setParentComponent(container){container.addCssClass("ag-has-popup"),super.setParentComponent(container)}destroy(){const parentComp=this.parentComponent;parentComp&&parentComp.isAlive()&&parentComp.getGui().classList.remove("ag-has-popup"),super.destroy()}},_LargeTextCellEditor=class _LargeTextCellEditor extends PopupComponent{constructor(){super(_LargeTextCellEditor.TEMPLATE)}init(params){this.params=params,this.focusAfterAttached=params.cellStartedEdit,this.eTextArea.setMaxLength(params.maxLength||200).setCols(params.cols||60).setRows(params.rows||10),exists(params.value,!0)&&this.eTextArea.setValue(params.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}onKeyDown(event){const key=event.key;(key===KeyCode.LEFT||key===KeyCode.UP||key===KeyCode.RIGHT||key===KeyCode.DOWN||event.shiftKey&&key===KeyCode.ENTER)&&event.stopPropagation()}afterGuiAttached(){const translate=this.localeService.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(translate("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()}getValue(){const value=this.eTextArea.getValue();return exists(value)||exists(this.params.value)?this.params.parseValue(value):this.params.value}};_LargeTextCellEditor.TEMPLATE='<div class="ag-large-text">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',__decorateClass([RefSelector("eTextArea")],_LargeTextCellEditor.prototype,"eTextArea",2);var LargeTextCellEditor=_LargeTextCellEditor,SelectCellEditor=class extends PopupComponent{constructor(){super('<div class="ag-cell-edit-wrapper">\n                <ag-select class="ag-cell-editor" ref="eSelect"></ag-select>\n            </div>'),this.startedByEnter=!1}init(params){this.focusAfterAttached=params.cellStartedEdit;const{eSelect,valueService,gos}=this,{values:values2,value,eventKey}=params;if(missing(values2))return void console.warn("AG Grid: no values found for select cellEditor");this.startedByEnter=null!=eventKey&&eventKey===KeyCode.ENTER;let hasValue=!1;values2.forEach(currentValue=>{const option={value:currentValue},valueFormatted=valueService.formatValue(params.column,null,currentValue),valueFormattedExits=null!=valueFormatted;option.text=valueFormattedExits?valueFormatted:currentValue,eSelect.addOption(option),hasValue=hasValue||value===currentValue}),hasValue?eSelect.setValue(params.value,!0):params.values.length&&eSelect.setValue(params.values[0],!0);const{valueListGap,valueListMaxWidth,valueListMaxHeight}=params;null!=valueListGap&&eSelect.setPickerGap(valueListGap),null!=valueListMaxHeight&&eSelect.setPickerMaxHeight(valueListMaxHeight),null!=valueListMaxWidth&&eSelect.setPickerMaxWidth(valueListMaxWidth),"fullRow"!==gos.get("editType")&&this.addManagedListener(this.eSelect,AgSelect.EVENT_ITEM_SELECTED,()=>params.stopEditing())}afterGuiAttached(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eSelect.showPicker()})}focusIn(){this.eSelect.getFocusableElement().focus()}getValue(){return this.eSelect.getValue()}isPopup(){return!1}};__decorateClass([Autowired("valueService")],SelectCellEditor.prototype,"valueService",2),__decorateClass([RefSelector("eSelect")],SelectCellEditor.prototype,"eSelect",2);var SimpleCellEditor=class extends PopupComponent{constructor(cellEditorInput){super(`\n            <div class="ag-cell-edit-wrapper">\n                ${cellEditorInput.getTemplate()}\n            </div>`),this.cellEditorInput=cellEditorInput}init(params){this.params=params;const eInput=this.eInput;let startValue;if(this.cellEditorInput.init(eInput,params),params.cellStartedEdit){this.focusAfterAttached=!0;const eventKey=params.eventKey;eventKey===KeyCode.BACKSPACE||params.eventKey===KeyCode.DELETE?startValue="":eventKey&&1===eventKey.length?startValue=eventKey:(startValue=this.cellEditorInput.getStartValue(),eventKey!==KeyCode.F2&&(this.highlightAllOnFocus=!0))}else this.focusAfterAttached=!1,startValue=this.cellEditorInput.getStartValue();null!=startValue&&eInput.setStartValue(startValue),this.addManagedListener(eInput.getGui(),"keydown",event=>{const{key}=event;key!==KeyCode.PAGE_UP&&key!==KeyCode.PAGE_DOWN||event.preventDefault()})}afterGuiAttached(){var _a,_b;const translate=this.localeService.getLocaleTextFunc(),eInput=this.eInput;if(eInput.setInputAriaLabel(translate("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;isBrowserSafari()||eInput.getFocusableElement().focus();const inputEl=eInput.getInputElement();this.highlightAllOnFocus?inputEl.select():null==(_b=(_a=this.cellEditorInput).setCaret)||_b.call(_a)}focusIn(){const eInput=this.eInput,focusEl=eInput.getFocusableElement(),inputEl=eInput.getInputElement();focusEl.focus(),inputEl.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}};__decorateClass([RefSelector("eInput")],SimpleCellEditor.prototype,"eInput",2);var TextCellEditorInput=class{getTemplate(){return'<ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field>'}init(eInput,params){this.eInput=eInput,this.params=params,null!=params.maxLength&&eInput.setMaxLength(params.maxLength)}getValue(){const value=this.eInput.getValue();return exists(value)||exists(this.params.value)?this.params.parseValue(value):this.params.value}getStartValue(){return this.params.useFormatter||this.params.column.getColDef().refData?this.params.formatValue(this.params.value):this.params.value}setCaret(){const value=this.eInput.getValue(),len=exists(value)&&value.length||0;len&&this.eInput.getInputElement().setSelectionRange(len,len)}},TextCellEditor=class extends SimpleCellEditor{constructor(){super(new TextCellEditorInput)}},AnimateShowChangeCellRenderer=class extends Component{constructor(){super(),this.refreshCount=0;const template=document.createElement("span"),delta=document.createElement("span");delta.setAttribute("class","ag-value-change-delta");const value=document.createElement("span");value.setAttribute("class","ag-value-change-value"),template.appendChild(delta),template.appendChild(value),this.setTemplateFromElement(template)}init(params){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(params,!0)}showDelta(params,delta){const absDelta=Math.abs(delta),valueFormatted=params.formatValue(absDelta),valueToUse=exists(valueFormatted)?valueFormatted:absDelta,deltaUp=delta>=0;this.eDelta.textContent=deltaUp?"↑"+valueToUse:"↓"+valueToUse,this.eDelta.classList.toggle("ag-value-change-delta-up",deltaUp),this.eDelta.classList.toggle("ag-value-change-delta-down",!deltaUp)}setTimerToRemoveDelta(){this.refreshCount++;const refreshCountCopy=this.refreshCount;this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{refreshCountCopy===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),clearElement(this.eDelta)}refresh(params,isInitialRender=!1){const value=params.value;if(value===this.lastValue)return!1;if(exists(params.valueFormatted)?this.eValue.textContent=params.valueFormatted:exists(params.value)?this.eValue.textContent=value:clearElement(this.eValue),this.filterManager.isSuppressFlashingCellsBecauseFiltering())return!1;if("number"==typeof value&&"number"==typeof this.lastValue){const delta=value-this.lastValue;this.showDelta(params,delta)}return this.lastValue&&this.eValue.classList.add("ag-value-change-value-highlight"),isInitialRender||this.setTimerToRemoveDelta(),this.lastValue=value,!0}};__decorateClass([Autowired("filterManager")],AnimateShowChangeCellRenderer.prototype,"filterManager",2);var AnimateSlideCellRenderer=class extends Component{constructor(){super(),this.refreshCount=0;const template=document.createElement("span"),slide=document.createElement("span");slide.setAttribute("class","ag-value-slide-current"),template.appendChild(slide),this.setTemplateFromElement(template),this.eCurrent=this.queryForHtmlElement(".ag-value-slide-current")}init(params){this.refresh(params,!0)}addSlideAnimation(){this.refreshCount++;const refreshCountCopy=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious);const prevElement=document.createElement("span");prevElement.setAttribute("class","ag-value-slide-previous ag-value-slide-out"),this.ePrevious=prevElement,this.ePrevious.textContent=this.eCurrent.textContent,this.getGui().insertBefore(this.ePrevious,this.eCurrent),this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>{refreshCountCopy===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{refreshCountCopy===this.refreshCount&&(this.getGui().removeChild(this.ePrevious),this.ePrevious=null)},3e3)})}refresh(params,isInitialRender=!1){let value=params.value;return missing(value)&&(value=""),value!==this.lastValue&&(!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(isInitialRender||this.addSlideAnimation(),this.lastValue=value,exists(params.valueFormatted)?this.eCurrent.textContent=params.valueFormatted:exists(params.value)?this.eCurrent.textContent=value:clearElement(this.eCurrent),!0))}};__decorateClass([Autowired("filterManager")],AnimateSlideCellRenderer.prototype,"filterManager",2);var _RowNode=class _RowNode{constructor(beans){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=_RowNode.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.hovered=!1,this.selected=!1,this.beans=beans}setData(data){this.setDataCommon(data,!1)}updateData(data){this.setDataCommon(data,!0)}setDataCommon(data,update){const oldData=this.data;this.data=data,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable(),this.resetQuickFilterAggregateText();const event=this.createDataChangedEvent(data,oldData,update);this.dispatchLocalEvent(event)}updateDataOnDetailNode(){this.detailNode&&(this.detailNode.data=this.data)}createDataChangedEvent(newData,oldData,update){return{type:_RowNode.EVENT_DATA_CHANGED,node:this,oldData,newData,update}}createLocalRowEvent(type){return{type,node:this}}getRowIndexString(){return"top"===this.rowPinned?"t-"+this.rowIndex:"bottom"===this.rowPinned?"b-"+this.rowIndex:this.rowIndex.toString()}createDaemonNode(){const oldNode=new _RowNode(this.beans);return oldNode.id=this.id,oldNode.data=this.data,oldNode.__daemon=!0,oldNode.selected=this.selected,oldNode.level=this.level,oldNode}setDataAndId(data,id){const oldNode=exists(this.id)?this.createDaemonNode():null,oldData=this.data;this.data=data,this.updateDataOnDetailNode(),this.setId(id),this.checkRowSelectable(),this.beans.selectionService.syncInRowNode(this,oldNode);const event=this.createDataChangedEvent(data,oldData,!1);this.dispatchLocalEvent(event)}checkRowSelectable(){const isRowSelectableFunc=this.beans.gos.get("isRowSelectable");this.setRowSelectable(!isRowSelectableFunc||isRowSelectableFunc(this))}setRowSelectable(newVal,suppressSelectionUpdate){if(this.selectable!==newVal){if(this.selectable=newVal,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_SELECTABLE_CHANGED)),suppressSelectionUpdate)return;if(this.beans.gos.get("groupSelectsChildren")){const selected=this.calculateSelectedFromChildren();return void this.setSelectedParams({newValue:null!=selected&&selected,source:"selectableChanged"})}this.isSelected()&&!this.selectable&&this.setSelectedParams({newValue:!1,source:"selectableChanged"})}}setId(id){const getRowIdFunc=this.beans.gos.getCallback("getRowId");if(getRowIdFunc)if(this.data){const parentKeys=this.getGroupKeys(!0);this.id=getRowIdFunc({data:this.data,parentKeys:parentKeys.length>0?parentKeys:void 0,level:this.level}),null!==this.id&&"string"==typeof this.id&&this.id.startsWith(_RowNode.ID_PREFIX_ROW_GROUP)&&console.error(`AG Grid: Row IDs cannot start with ${_RowNode.ID_PREFIX_ROW_GROUP}, this is a reserved prefix for AG Grid's row grouping feature.`),null!==this.id&&"string"!=typeof this.id&&(this.id=""+this.id)}else this.id=void 0;else this.id=id}getGroupKeys(excludeSelf=!1){const keys2=[];let pointer=this;for(excludeSelf&&(pointer=pointer.parent);pointer&&pointer.level>=0;)keys2.push(pointer.key),pointer=pointer.parent;return keys2.reverse(),keys2}isPixelInRange(pixel){return!(!exists(this.rowTop)||!exists(this.rowHeight))&&(pixel>=this.rowTop&&pixel<this.rowTop+this.rowHeight)}setFirstChild(firstChild){this.firstChild!==firstChild&&(this.firstChild=firstChild,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_FIRST_CHILD_CHANGED)))}setLastChild(lastChild){this.lastChild!==lastChild&&(this.lastChild=lastChild,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_LAST_CHILD_CHANGED)))}setChildIndex(childIndex){this.childIndex!==childIndex&&(this.childIndex=childIndex,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_CHILD_INDEX_CHANGED)))}setRowTop(rowTop){this.oldRowTop=this.rowTop,this.rowTop!==rowTop&&(this.rowTop=rowTop,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_TOP_CHANGED)),this.setDisplayed(null!==rowTop))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setDisplayed(displayed){this.displayed!==displayed&&(this.displayed=displayed,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_DISPLAYED_CHANGED)))}setDragging(dragging){this.dragging!==dragging&&(this.dragging=dragging,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_DRAGGING_CHANGED)))}setHighlighted(highlighted){highlighted!==this.highlighted&&(this.highlighted=highlighted,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_HIGHLIGHT_CHANGED)))}setHovered(hovered){this.hovered!==hovered&&(this.hovered=hovered)}isHovered(){return this.hovered}setAllChildrenCount(allChildrenCount){this.allChildrenCount!==allChildrenCount&&(this.allChildrenCount=allChildrenCount,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED)))}setMaster(master){this.master!==master&&(this.master&&!master&&(this.expanded=!1),this.master=master,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_MASTER_CHANGED)))}setGroup(group){this.group!==group&&(this.group&&!group&&(this.expanded=!1),this.group=group,this.updateHasChildren(),this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_GROUP_CHANGED)))}setRowHeight(rowHeight,estimated=!1){this.rowHeight=rowHeight,this.rowHeightEstimated=estimated,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_HEIGHT_CHANGED))}setRowAutoHeight(cellHeight,column){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[column.getId()]=cellHeight,null!=cellHeight&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=debounce(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())}checkAutoHeights(){let notAllPresent=!1,nonePresent=!0,newRowHeight=0;const autoHeights=this.__autoHeights;if(null==autoHeights)return;if(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(col=>{let cellHeight=autoHeights[col.getId()];if(null==cellHeight){if(!this.beans.columnModel.isColSpanActive())return void(notAllPresent=!0);{let activeColsForRow=[];switch(col.getPinned()){case"left":activeColsForRow=this.beans.columnModel.getDisplayedLeftColumnsForRow(this);break;case"right":activeColsForRow=this.beans.columnModel.getDisplayedRightColumnsForRow(this);break;case null:activeColsForRow=this.beans.columnModel.getViewportCenterColumnsForRow(this)}if(activeColsForRow.includes(col))return void(notAllPresent=!0);cellHeight=-1}}else nonePresent=!1;cellHeight>newRowHeight&&(newRowHeight=cellHeight)}),notAllPresent)return;if((nonePresent||newRowHeight<10)&&(newRowHeight=this.beans.gos.getRowHeightForNode(this).height),newRowHeight==this.rowHeight)return;this.setRowHeight(newRowHeight);const rowModel=this.beans.rowModel;rowModel.onRowHeightChangedDebounced&&rowModel.onRowHeightChangedDebounced()}setRowIndex(rowIndex){this.rowIndex!==rowIndex&&(this.rowIndex=rowIndex,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_ROW_INDEX_CHANGED)))}setUiLevel(uiLevel){this.uiLevel!==uiLevel&&(this.uiLevel=uiLevel,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_UI_LEVEL_CHANGED)))}setExpanded(expanded,e,forceSync){if(this.expanded===expanded)return;this.expanded=expanded,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_EXPANDED_CHANGED));const event=Object.assign({},this.createGlobalRowEvent(Events.EVENT_ROW_GROUP_OPENED),{expanded,event:e||null});this.beans.rowNodeEventThrottle.dispatchExpanded(event,forceSync),this.beans.rowRenderer.refreshCells({rowNodes:[this]})}createGlobalRowEvent(type){return this.beans.gos.addGridCommonParams({type,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned})}dispatchLocalEvent(event){this.eventService&&this.eventService.dispatchEvent(event)}setDataValue(colKey,newValue,eventSource){const column=(()=>{var _a;return"string"!=typeof colKey?colKey:null!=(_a=this.beans.columnModel.getGridColumn(colKey))?_a:this.beans.columnModel.getPrimaryColumn(colKey)})(),oldValue=this.getValueFromValueService(column);if(this.beans.gos.get("readOnlyEdit"))return this.dispatchEventForSaveValueReadOnly(column,oldValue,newValue,eventSource),!1;const valueChanged=this.beans.valueService.setValue(this,column,newValue,eventSource);return this.dispatchCellChangedEvent(column,newValue,oldValue),this.checkRowSelectable(),valueChanged}getValueFromValueService(column){var _a,_b;const lockedClosedGroup=this.leafGroup&&this.beans.columnModel.isPivotMode(),isOpenGroup=this.group&&this.expanded&&!this.footer&&!lockedClosedGroup;let includeFooter=!1;const groupIncludeFooterOpt=null!=(_a=this.beans.gos.get("groupTotalRow"))?_a:this.beans.gos.get("groupIncludeFooter");if("function"!=typeof groupIncludeFooterOpt)includeFooter=!!groupIncludeFooterOpt;else{includeFooter=!!(null!=(_b=this.beans.gos.getCallback("groupTotalRow"))?_b:this.beans.gos.getCallback("groupIncludeFooter"))({node:this})}const groupAlwaysShowAggData=this.beans.gos.get("groupSuppressBlankHeader"),ignoreAggData=isOpenGroup&&includeFooter&&!groupAlwaysShowAggData;return this.beans.valueService.getValue(column,this,!1,ignoreAggData)}dispatchEventForSaveValueReadOnly(column,oldValue,newValue,eventSource){const event=this.beans.gos.addGridCommonParams({type:Events.EVENT_CELL_EDIT_REQUEST,event:null,rowIndex:this.rowIndex,rowPinned:this.rowPinned,column,colDef:column.getColDef(),data:this.data,node:this,oldValue,newValue,value:newValue,source:eventSource});this.beans.eventService.dispatchEvent(event)}setGroupValue(colKey,newValue){const column=this.beans.columnModel.getGridColumn(colKey);missing(this.groupData)&&(this.groupData={});const columnId=column.getColId(),oldValue=this.groupData[columnId];oldValue!==newValue&&(this.groupData[columnId]=newValue,this.dispatchCellChangedEvent(column,newValue,oldValue))}setAggData(newAggData){const oldAggData=this.aggData;if(this.aggData=newAggData,this.eventService){const eventFunc=colId=>{const value=this.aggData?this.aggData[colId]:void 0,oldValue=oldAggData?oldAggData[colId]:void 0;if(value===oldValue)return;const column=this.beans.columnModel.lookupGridColumn(colId);column&&this.dispatchCellChangedEvent(column,value,oldValue)};for(const key in this.aggData)eventFunc(key);for(const key in newAggData)key in this.aggData||eventFunc(key)}}updateHasChildren(){let newValue=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;if(this.beans.gos.isRowModelType("serverSide")){const isTreeData=this.beans.gos.get("treeData"),isGroupFunc=this.beans.gos.get("isServerSideGroup");newValue=!this.stub&&!this.footer&&(isTreeData?!!isGroupFunc&&isGroupFunc(this.data):!!this.group)}newValue!==this.__hasChildren&&(this.__hasChildren=!!newValue,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(_RowNode.EVENT_HAS_CHILDREN_CHANGED)))}hasChildren(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren}isEmptyRowGroupNode(){return this.group&&missingOrEmpty(this.childrenAfterGroup)}dispatchCellChangedEvent(column,newValue,oldValue){const cellChangedEvent={type:_RowNode.EVENT_CELL_CHANGED,node:this,column,newValue,oldValue};this.dispatchLocalEvent(cellChangedEvent)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return!this.footer&&(this.beans.columnModel.isPivotMode()?this.hasChildren()&&!this.leafGroup:this.hasChildren()||!!this.master)}isSelected(){return this.footer?this.sibling.isSelected():this.selected}depthFirstSearch(callback){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(child=>child.depthFirstSearch(callback)),callback(this)}calculateSelectedFromChildren(){var _a;let atLeastOneSelected=!1,atLeastOneDeSelected=!1,atLeastOneMixed=!1;if(!(null==(_a=this.childrenAfterGroup)?void 0:_a.length))return this.selectable?this.selected:null;for(let i=0;i<this.childrenAfterGroup.length;i++){const child=this.childrenAfterGroup[i];let childState=child.isSelected();if(!child.selectable){const selectable=child.calculateSelectedFromChildren();if(null===selectable)continue;childState=selectable}switch(childState){case!0:atLeastOneSelected=!0;break;case!1:atLeastOneDeSelected=!0;break;default:atLeastOneMixed=!0}}return atLeastOneMixed||atLeastOneSelected&&atLeastOneDeSelected?void 0:!!atLeastOneSelected||!atLeastOneDeSelected&&(this.selectable?this.selected:null)}setSelectedInitialValue(selected){this.selected=selected}selectThisNode(newValue,e,source="api"){const selectionNotAllowed=!this.selectable&&newValue,selectionNotChanged=this.selected===newValue;if(selectionNotAllowed||selectionNotChanged)return!1;this.selected=newValue,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(_RowNode.EVENT_ROW_SELECTED));const sibling=this.sibling;sibling&&sibling.footer&&sibling.eventService&&sibling.dispatchLocalEvent(sibling.createLocalRowEvent(_RowNode.EVENT_ROW_SELECTED));const event=__spreadProps(__spreadValues({},this.createGlobalRowEvent(Events.EVENT_ROW_SELECTED)),{event:e||null,source});return this.beans.eventService.dispatchEvent(event),!0}setSelected(newValue,clearSelection=!1,source="api"){"boolean"!=typeof source?this.setSelectedParams({newValue,clearSelection,rangeSelect:!1,source}):console.warn("AG Grid: since version v30, rowNode.setSelected() property `suppressFinishActions` has been removed, please use `gridApi.setNodesSelected()` for bulk actions, and the event `source` property for ignoring events instead.")}setSelectedParams(params){return this.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),0):void 0===this.id?(console.warn("AG Grid: cannot select node until id for node is known"),0):this.beans.selectionService.setNodesSelected(__spreadProps(__spreadValues({},params),{nodes:[this.footer?this.sibling:this]}))}isRowPinned(){return"top"===this.rowPinned||"bottom"===this.rowPinned}isParentOfNode(potentialParent){let parentNode=this.parent;for(;parentNode;){if(parentNode===potentialParent)return!0;parentNode=parentNode.parent}return!1}addEventListener(eventType,userListener){var _a,_b;this.eventService||(this.eventService=new EventService),this.beans.frameworkOverrides.shouldWrapOutgoing&&!this.frameworkEventListenerService&&(this.eventService.setFrameworkOverrides(this.beans.frameworkOverrides),this.frameworkEventListenerService=new FrameworkEventListenerService(this.beans.frameworkOverrides));const listener=null!=(_b=null==(_a=this.frameworkEventListenerService)?void 0:_a.wrap(userListener))?_b:userListener;this.eventService.addEventListener(eventType,listener)}removeEventListener(eventType,userListener){var _a,_b;if(!this.eventService)return;const listener=null!=(_b=null==(_a=this.frameworkEventListenerService)?void 0:_a.unwrap(userListener))?_b:userListener;this.eventService.removeEventListener(eventType,listener),this.eventService.noRegisteredListenersExist()&&(this.eventService=null)}onMouseEnter(){this.dispatchLocalEvent(this.createLocalRowEvent(_RowNode.EVENT_MOUSE_ENTER))}onMouseLeave(){this.dispatchLocalEvent(this.createLocalRowEvent(_RowNode.EVENT_MOUSE_LEAVE))}getFirstChildOfFirstChild(rowGroupColumn){let currentRowNode=this,isCandidate=!0,foundFirstChildPath=!1,nodeToSwapIn=null;for(;isCandidate&&!foundFirstChildPath;){const parentRowNode=currentRowNode.parent;exists(parentRowNode)&&currentRowNode.firstChild?parentRowNode.rowGroupColumn===rowGroupColumn&&(foundFirstChildPath=!0,nodeToSwapIn=parentRowNode):isCandidate=!1,currentRowNode=parentRowNode}return foundFirstChildPath?nodeToSwapIn:null}isFullWidthCell(){if(this.detail)return!0;const isFullWidthCellFunc=this.beans.gos.getCallback("isFullWidthRow");return!!isFullWidthCellFunc&&isFullWidthCellFunc({rowNode:this})}getRoute(){if(null==this.key)return;const res=[];let pointer=this;for(;null!=pointer.key;)res.push(pointer.key),pointer=pointer.parent;return res.reverse()}createFooter(){if(this.sibling)return;const ignoredProperties=new Set(["eventService","__objectId","sticky"]),footerNode=new _RowNode(this.beans);Object.keys(this).forEach(key=>{ignoredProperties.has(key)||(footerNode[key]=this[key])}),footerNode.footer=!0,footerNode.setRowTop(null),footerNode.setRowIndex(null),footerNode.oldRowTop=null,footerNode.id="rowGroupFooter_"+this.id,footerNode.sibling=this,this.sibling=footerNode}destroyFooter(){this.sibling&&(this.sibling.setRowTop(null),this.sibling.setRowIndex(null),this.sibling=void 0)}};_RowNode.ID_PREFIX_ROW_GROUP="row-group-",_RowNode.ID_PREFIX_TOP_PINNED="t-",_RowNode.ID_PREFIX_BOTTOM_PINNED="b-",_RowNode.OBJECT_ID_SEQUENCE=0,_RowNode.EVENT_ROW_SELECTED="rowSelected",_RowNode.EVENT_DATA_CHANGED="dataChanged",_RowNode.EVENT_CELL_CHANGED="cellChanged",_RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",_RowNode.EVENT_MASTER_CHANGED="masterChanged",_RowNode.EVENT_GROUP_CHANGED="groupChanged",_RowNode.EVENT_MOUSE_ENTER="mouseEnter",_RowNode.EVENT_MOUSE_LEAVE="mouseLeave",_RowNode.EVENT_HEIGHT_CHANGED="heightChanged",_RowNode.EVENT_TOP_CHANGED="topChanged",_RowNode.EVENT_DISPLAYED_CHANGED="displayedChanged",_RowNode.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",_RowNode.EVENT_LAST_CHILD_CHANGED="lastChildChanged",_RowNode.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",_RowNode.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",_RowNode.EVENT_EXPANDED_CHANGED="expandedChanged",_RowNode.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",_RowNode.EVENT_SELECTABLE_CHANGED="selectableChanged",_RowNode.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",_RowNode.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",_RowNode.EVENT_DRAGGING_CHANGED="draggingChanged";var RowNode=_RowNode,CheckboxSelectionComponent=class extends Component{constructor(){super('\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}postConstruct(){this.eCheckbox.setPassive(!0)}getCheckboxId(){return this.eCheckbox.getInputElement().id}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const translate=this.localeService.getLocaleTextFunc(),state=this.rowNode.isSelected(),stateName=getAriaCheckboxStateName(translate,state),[ariaKey,ariaLabel]=this.rowNode.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],translatedLabel=translate(ariaKey,ariaLabel);this.eCheckbox.setValue(state,!0),this.eCheckbox.setInputAriaLabel(`${translatedLabel} (${stateName})`)}onClicked(newValue,groupSelectsFiltered,event){return this.rowNode.setSelectedParams({newValue,rangeSelect:event.shiftKey,groupSelectsFiltered,event,source:"checkboxSelected"})}init(params){this.rowNode=params.rowNode,this.column=params.column,this.overrides=params.overrides,this.onSelectionChanged(),this.addManagedListener(this.eCheckbox.getInputElement(),"dblclick",event=>{stopPropagationForAgGrid(event)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",event=>{stopPropagationForAgGrid(event);const groupSelectsFiltered=this.gos.get("groupSelectsFiltered"),isSelected=this.eCheckbox.getValue();if(this.shouldHandleIndeterminateState(isSelected,groupSelectsFiltered)){0===this.onClicked(!0,groupSelectsFiltered,event||{})&&this.onClicked(!1,groupSelectsFiltered,event)}else isSelected?this.onClicked(!1,groupSelectsFiltered,event):this.onClicked(!0,groupSelectsFiltered,event||{})}),this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this));if(this.gos.get("isRowSelectable")||"function"==typeof this.getIsVisible()){const showOrHideSelectListener=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,showOrHideSelectListener),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,showOrHideSelectListener),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,showOrHideSelectListener),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}shouldHandleIndeterminateState(isSelected,groupSelectsFiltered){return groupSelectsFiltered&&(void 0===this.eCheckbox.getPreviousValue()||void 0===isSelected)&&this.gos.isRowModelType("clientSide")}showOrHideSelect(){var _a,_b,_c;let selectable=this.rowNode.selectable;const isVisible2=this.getIsVisible();if(selectable)if("function"==typeof isVisible2){const extraParams=null==(_a=this.overrides)?void 0:_a.callbackParams;if(this.column){const params=this.column.createColumnFunctionCallbackParams(this.rowNode);selectable=isVisible2(__spreadValues(__spreadValues({},extraParams),params))}else selectable=isVisible2(__spreadProps(__spreadValues({},extraParams),{node:this.rowNode,data:this.rowNode.data}))}else selectable=null!=isVisible2&&isVisible2;if(null==(_b=this.column)?void 0:_b.getColDef().showDisabledCheckboxes)return this.eCheckbox.setDisabled(!selectable),this.setVisible(!0),void this.setDisplayed(!0);(null==(_c=this.overrides)?void 0:_c.removeHidden)?this.setDisplayed(selectable):this.setVisible(selectable)}getIsVisible(){var _a,_b;return this.overrides?this.overrides.isVisible:null==(_b=null==(_a=this.column)?void 0:_a.getColDef())?void 0:_b.checkboxSelection}};__decorateClass([RefSelector("eCheckbox")],CheckboxSelectionComponent.prototype,"eCheckbox",2),__decorateClass([PostConstruct],CheckboxSelectionComponent.prototype,"postConstruct",1);var HorizontalDirection=(HorizontalDirection2=>(HorizontalDirection2[HorizontalDirection2.Left=0]="Left",HorizontalDirection2[HorizontalDirection2.Right=1]="Right",HorizontalDirection2))(HorizontalDirection||{}),DragAndDropService=class extends BeanStub{constructor(){super(...arguments),this.dragSourceAndParamsList=[],this.dropTargets=[]}init(){this.ePinnedIcon=createIcon("columnMovePin",this.gos,null),this.eHideIcon=createIcon("columnMoveHide",this.gos,null),this.eMoveIcon=createIcon("columnMoveMove",this.gos,null),this.eLeftIcon=createIcon("columnMoveLeft",this.gos,null),this.eRightIcon=createIcon("columnMoveRight",this.gos,null),this.eGroupIcon=createIcon("columnMoveGroup",this.gos,null),this.eAggregateIcon=createIcon("columnMoveValue",this.gos,null),this.ePivotIcon=createIcon("columnMovePivot",this.gos,null),this.eDropNotAllowedIcon=createIcon("dropNotAllowed",this.gos,null)}addDragSource(dragSource,allowTouch=!1){const params={eElement:dragSource.eElement,dragStartPixels:dragSource.dragStartPixels,onDragStart:this.onDragStart.bind(this,dragSource),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),includeTouch:allowTouch};this.dragSourceAndParamsList.push({params,dragSource}),this.dragService.addDragSource(params)}removeDragSource(dragSource){const sourceAndParams=this.dragSourceAndParamsList.find(item=>item.dragSource===dragSource);sourceAndParams&&(this.dragService.removeDragSource(sourceAndParams.params),removeFromArray(this.dragSourceAndParamsList,sourceAndParams))}clearDragSourceParamsList(){this.dragSourceAndParamsList.forEach(sourceAndParams=>this.dragService.removeDragSource(sourceAndParams.params)),this.dragSourceAndParamsList.length=0,this.dropTargets.length=0}nudge(){this.dragging&&this.onDragging(this.eventLastTime,!0)}onDragStart(dragSource,mouseEvent){this.dragging=!0,this.dragSource=dragSource,this.eventLastTime=mouseEvent,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=void 0,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()}onDragStop(mouseEvent){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){const draggingEvent=this.createDropTargetEvent(this.lastDropTarget,mouseEvent,null,null,!1);this.lastDropTarget.onDragStop(draggingEvent)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()}onDragging(mouseEvent,fromNudge){var _a,_b,_c,_d;const hDirection=this.getHorizontalDirection(mouseEvent),vDirection=this.getVerticalDirection(mouseEvent);this.eventLastTime=mouseEvent,this.positionGhost(mouseEvent);const validDropTargets=this.dropTargets.filter(target=>this.isMouseOnDropTarget(mouseEvent,target)),dropTarget=this.findCurrentDropTarget(mouseEvent,validDropTargets);if(dropTarget!==this.lastDropTarget)this.leaveLastTargetIfExists(mouseEvent,hDirection,vDirection,fromNudge),null!==this.lastDropTarget&&null===dropTarget&&(null==(_b=(_a=this.dragSource).onGridExit)||_b.call(_a,this.dragItem)),null===this.lastDropTarget&&null!==dropTarget&&(null==(_d=(_c=this.dragSource).onGridEnter)||_d.call(_c,this.dragItem)),this.enterDragTargetIfExists(dropTarget,mouseEvent,hDirection,vDirection,fromNudge),this.lastDropTarget=dropTarget;else if(dropTarget&&dropTarget.onDragging){const draggingEvent=this.createDropTargetEvent(dropTarget,mouseEvent,hDirection,vDirection,fromNudge);dropTarget.onDragging(draggingEvent)}}getAllContainersFromDropTarget(dropTarget){const secondaryContainers=dropTarget.getSecondaryContainers?dropTarget.getSecondaryContainers():null,containers=[[dropTarget.getContainer()]];return secondaryContainers?containers.concat(secondaryContainers):containers}allContainersIntersect(mouseEvent,containers){for(const container of containers){const rect=container.getBoundingClientRect();if(0===rect.width||0===rect.height)return!1;const horizontalFit=mouseEvent.clientX>=rect.left&&mouseEvent.clientX<rect.right,verticalFit=mouseEvent.clientY>=rect.top&&mouseEvent.clientY<rect.bottom;if(!horizontalFit||!verticalFit)return!1}return!0}isMouseOnDropTarget(mouseEvent,dropTarget){const allContainersFromDropTarget=this.getAllContainersFromDropTarget(dropTarget);let mouseOverTarget=!1;for(const currentContainers of allContainersFromDropTarget)if(this.allContainersIntersect(mouseEvent,currentContainers)){mouseOverTarget=!0;break}return!(dropTarget.targetContainsSource&&!dropTarget.getContainer().contains(this.dragSource.eElement))&&(mouseOverTarget&&dropTarget.isInterestedIn(this.dragSource.type,this.dragSource.eElement))}findCurrentDropTarget(mouseEvent,validDropTargets){const len=validDropTargets.length;if(0===len)return null;if(1===len)return validDropTargets[0];const elementStack=this.gos.getRootNode().elementsFromPoint(mouseEvent.clientX,mouseEvent.clientY);for(const el of elementStack)for(const dropTarget of validDropTargets){if(-1!==flatten(this.getAllContainersFromDropTarget(dropTarget)).indexOf(el))return dropTarget}return null}enterDragTargetIfExists(dropTarget,mouseEvent,hDirection,vDirection,fromNudge){if(dropTarget){if(dropTarget.onDragEnter){const dragEnterEvent=this.createDropTargetEvent(dropTarget,mouseEvent,hDirection,vDirection,fromNudge);dropTarget.onDragEnter(dragEnterEvent)}this.setGhostIcon(dropTarget.getIconName?dropTarget.getIconName():null)}}leaveLastTargetIfExists(mouseEvent,hDirection,vDirection,fromNudge){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){const dragLeaveEvent=this.createDropTargetEvent(this.lastDropTarget,mouseEvent,hDirection,vDirection,fromNudge);this.lastDropTarget.onDragLeave(dragLeaveEvent)}this.setGhostIcon(null)}}addDropTarget(dropTarget){this.dropTargets.push(dropTarget)}removeDropTarget(dropTarget){this.dropTargets=this.dropTargets.filter(target=>target.getContainer()!==dropTarget.getContainer())}hasExternalDropZones(){return this.dropTargets.some(zones=>zones.external)}findExternalZone(params){return this.dropTargets.filter(target=>target.external).find(zone=>zone.getContainer()===params.getContainer())||null}getHorizontalDirection(event){const clientX=this.eventLastTime&&this.eventLastTime.clientX,eClientX=event.clientX;return clientX===eClientX?null:clientX>eClientX?0:1}getVerticalDirection(event){const clientY=this.eventLastTime&&this.eventLastTime.clientY,eClientY=event.clientY;return clientY===eClientY?null:clientY>eClientY?0:1}createDropTargetEvent(dropTarget,event,hDirection,vDirection,fromNudge){const dropZoneTarget=dropTarget.getContainer(),rect=dropZoneTarget.getBoundingClientRect(),{gridApi:api,columnApi,dragItem,dragSource}=this;return{event,x:event.clientX-rect.left,y:event.clientY-rect.top,vDirection,hDirection,dragSource,fromNudge,dragItem,api,columnApi,dropZoneTarget}}positionGhost(event){const ghost=this.eGhost;if(!ghost)return;const ghostHeight=ghost.getBoundingClientRect().height,browserWidth=getBodyWidth()-2,browserHeight=getBodyHeight()-2,offsetParentSize=getElementRectWithOffset(ghost.offsetParent),{clientY,clientX}=event;let top=clientY-offsetParentSize.top-ghostHeight/2,left=clientX-offsetParentSize.left-10;const eDocument=this.gos.getDocument(),win=eDocument.defaultView||window,windowScrollY=win.pageYOffset||eDocument.documentElement.scrollTop,windowScrollX=win.pageXOffset||eDocument.documentElement.scrollLeft;browserWidth>0&&left+ghost.clientWidth>browserWidth+windowScrollX&&(left=browserWidth+windowScrollX-ghost.clientWidth),left<0&&(left=0),browserHeight>0&&top+ghost.clientHeight>browserHeight+windowScrollY&&(top=browserHeight+windowScrollY-ghost.clientHeight),top<0&&(top=0),ghost.style.left=`${left}px`,ghost.style.top=`${top}px`}removeGhost(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null}createGhost(){this.eGhost=loadTemplate(DragAndDropService.GHOST_TEMPLATE),this.mouseEventService.stampTopLevelGridCompWithGridInstance(this.eGhost);const{theme}=this.environment.getTheme();theme&&this.eGhost.classList.add(theme),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);const eText=this.eGhost.querySelector(".ag-dnd-ghost-label");let dragItemName=this.dragSource.dragItemName;isFunction(dragItemName)&&(dragItemName=dragItemName()),eText.innerHTML=escapeString(dragItemName)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";const eDocument=this.gos.getDocument();let rootNode=null,targetEl=null;try{rootNode=eDocument.fullscreenElement}catch(e){}finally{rootNode||(rootNode=this.gos.getRootNode());const body=rootNode.querySelector("body");targetEl=body||(rootNode instanceof ShadowRoot?rootNode:rootNode instanceof Document?null==rootNode?void 0:rootNode.documentElement:rootNode)}this.eGhostParent=targetEl,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")}setGhostIcon(iconName,shake=!1){clearElement(this.eGhostIcon);let eIcon=null;switch(iconName||(iconName=this.dragSource.getDefaultIconName?this.dragSource.getDefaultIconName():DragAndDropService.ICON_NOT_ALLOWED),iconName){case DragAndDropService.ICON_PINNED:eIcon=this.ePinnedIcon;break;case DragAndDropService.ICON_MOVE:eIcon=this.eMoveIcon;break;case DragAndDropService.ICON_LEFT:eIcon=this.eLeftIcon;break;case DragAndDropService.ICON_RIGHT:eIcon=this.eRightIcon;break;case DragAndDropService.ICON_GROUP:eIcon=this.eGroupIcon;break;case DragAndDropService.ICON_AGGREGATE:eIcon=this.eAggregateIcon;break;case DragAndDropService.ICON_PIVOT:eIcon=this.ePivotIcon;break;case DragAndDropService.ICON_NOT_ALLOWED:eIcon=this.eDropNotAllowedIcon;break;case DragAndDropService.ICON_HIDE:eIcon=this.eHideIcon}this.eGhostIcon.classList.toggle("ag-shake-left-to-right",shake),eIcon===this.eHideIcon&&this.gos.get("suppressDragLeaveHidesColumns")||eIcon&&this.eGhostIcon.appendChild(eIcon)}};DragAndDropService.ICON_PINNED="pinned",DragAndDropService.ICON_MOVE="move",DragAndDropService.ICON_LEFT="left",DragAndDropService.ICON_RIGHT="right",DragAndDropService.ICON_GROUP="group",DragAndDropService.ICON_AGGREGATE="aggregate",DragAndDropService.ICON_PIVOT="pivot",DragAndDropService.ICON_NOT_ALLOWED="notAllowed",DragAndDropService.ICON_HIDE="hide",DragAndDropService.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',__decorateClass([Autowired("dragService")],DragAndDropService.prototype,"dragService",2),__decorateClass([Autowired("mouseEventService")],DragAndDropService.prototype,"mouseEventService",2),__decorateClass([Autowired("columnApi")],DragAndDropService.prototype,"columnApi",2),__decorateClass([Autowired("gridApi")],DragAndDropService.prototype,"gridApi",2),__decorateClass([PostConstruct],DragAndDropService.prototype,"init",1),__decorateClass([PreDestroy],DragAndDropService.prototype,"clearDragSourceParamsList",1),DragAndDropService=__decorateClass([Bean("dragAndDropService")],DragAndDropService);var RowDragComp=class extends Component{constructor(cellValueFn,rowNode,column,customGui,dragStartPixels,suppressVisibilityChange){super(),this.cellValueFn=cellValueFn,this.rowNode=rowNode,this.column=column,this.customGui=customGui,this.dragStartPixels=dragStartPixels,this.suppressVisibilityChange=suppressVisibilityChange,this.dragSource=null}isCustomGui(){return null!=this.customGui}postConstruct(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(createIconNoSpan("rowDrag",this.gos,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){const strategy=this.gos.get("rowDragManaged")?new ManagedVisibilityStrategy(this,this.beans,this.rowNode,this.column):new NonManagedVisibilityStrategy(this,this.beans,this.rowNode,this.column);this.createManagedBean(strategy,this.beans.context)}}setDragElement(dragElement,dragStartPixels){this.setTemplateFromElement(dragElement),this.addDragSource(dragStartPixels)}getSelectedNodes(){if(!this.gos.get("rowDragMultiRow"))return[this.rowNode];const selection=this.beans.selectionService.getSelectedNodes();return-1!==selection.indexOf(this.rowNode)?selection:[this.rowNode]}checkCompatibility(){const managed=this.gos.get("rowDragManaged");this.gos.get("treeData")&&managed&&warnOnce("If using row drag with tree data, you cannot have rowDragManaged=true")}getDragItem(){return{rowNode:this.rowNode,rowNodes:this.getSelectedNodes(),columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()}}getRowDragText(column){if(column){const colDef=column.getColDef();if(colDef.rowDragText)return colDef.rowDragText}return this.gos.get("rowDragText")}addDragSource(dragStartPixels=4){this.dragSource&&this.removeDragSource();const translate=this.localeService.getLocaleTextFunc();this.dragSource={type:2,eElement:this.getGui(),dragItemName:()=>{var _a;const dragItem=this.getDragItem(),dragItemCount=(null==(_a=dragItem.rowNodes)?void 0:_a.length)||1,rowDragText=this.getRowDragText(this.column);return rowDragText?rowDragText(dragItem,dragItemCount):1===dragItemCount?this.cellValueFn():`${dragItemCount} ${translate("rowDragRows","rows")}`},getDragItem:()=>this.getDragItem(),dragStartPixels,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDropService.addDragSource(this.dragSource,!0)}removeDragSource(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null}};__decorateClass([Autowired("beans")],RowDragComp.prototype,"beans",2),__decorateClass([PostConstruct],RowDragComp.prototype,"postConstruct",1),__decorateClass([PreDestroy],RowDragComp.prototype,"removeDragSource",1);var VisibilityStrategy=class extends BeanStub{constructor(parent,rowNode,column){super(),this.parent=parent,this.rowNode=rowNode,this.column=column}setDisplayedOrVisible(neverDisplayed){const displayedOptions={skipAriaHidden:!0};if(neverDisplayed)this.parent.setDisplayed(!1,displayedOptions);else{let shown=!0,isShownSometimes=!1;this.column&&(shown=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),isShownSometimes=isFunction(this.column.getColDef().rowDrag)),isShownSometimes?(this.parent.setDisplayed(!0,displayedOptions),this.parent.setVisible(shown,displayedOptions)):(this.parent.setDisplayed(shown,displayedOptions),this.parent.setVisible(!0,displayedOptions))}}},NonManagedVisibilityStrategy=class extends VisibilityStrategy{constructor(parent,beans,rowNode,column){super(parent,rowNode,column),this.beans=beans}postConstruct(){this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const neverDisplayed=this.gos.get("suppressRowDrag");this.setDisplayedOrVisible(neverDisplayed)}};__decorateClass([PostConstruct],NonManagedVisibilityStrategy.prototype,"postConstruct",1);var ManagedVisibilityStrategy=class extends VisibilityStrategy{constructor(parent,beans,rowNode,column){super(parent,rowNode,column),this.beans=beans}postConstruct(){this.addManagedListener(this.beans.eventService,Events.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedPropertyListener("suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()}onSuppressRowDrag(){this.workOutVisibility()}workOutVisibility(){const rowDragFeature=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),shouldPreventRowMove=rowDragFeature&&rowDragFeature.shouldPreventRowMove(),suppressRowDrag=this.gos.get("suppressRowDrag"),hasExternalDropZones=this.beans.dragAndDropService.hasExternalDropZones(),neverDisplayed=shouldPreventRowMove&&!hasExternalDropZones||suppressRowDrag;this.setDisplayedOrVisible(neverDisplayed)}};__decorateClass([PostConstruct],ManagedVisibilityStrategy.prototype,"postConstruct",1);var GroupCellRendererCtrl=class extends BeanStub{init(comp,eGui,eCheckbox,eExpanded,eContracted,compClass,params){var _a,_b,_c,_d;this.params=params,this.eGui=eGui,this.eCheckbox=eCheckbox,this.eExpanded=eExpanded,this.eContracted=eContracted,this.comp=comp,this.compClass=compClass;const{node,value,colDef}=params,topLevelFooter=this.isTopLevelFooter();if(!topLevelFooter){if(this.isEmbeddedRowMismatch())return;if(node.footer&&this.gos.get("groupHideOpenParents")){if((colDef&&colDef.showRowGroup)!==(node.rowGroupColumn&&node.rowGroupColumn.getColId()))return}}if(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),!topLevelFooter){const showingFooterTotal=params.node.footer&&params.node.rowGroupIndex===this.columnModel.getRowGroupColumns().findIndex(c=>{var _a2;return c.getColId()===(null==(_a2=params.colDef)?void 0:_a2.showRowGroup)}),showOpenGroupValue="multipleColumns"!=this.gos.get("groupDisplayType")||this.gos.get("treeData")||this.gos.get("showOpenedGroup")&&!params.node.footer&&(!params.node.group||null!=params.node.rowGroupIndex&&params.node.rowGroupIndex>this.columnModel.getRowGroupColumns().findIndex(c=>{var _a2;return c.getColId()===(null==(_a2=params.colDef)?void 0:_a2.showRowGroup)})),leafWithValues=!node.group&&((null==(_a=this.params.colDef)?void 0:_a.field)||(null==(_b=this.params.colDef)?void 0:_b.valueGetter)),isExpandable=this.isExpandable(),showPivotModeLeafValue=this.columnModel.isPivotMode()&&node.leafGroup&&(null==(_c=node.rowGroupColumn)?void 0:_c.getColId())===(null==(_d=params.column)?void 0:_d.getColDef().showRowGroup);if(!(this.showingValueForOpenedParent||isExpandable||leafWithValues||showOpenGroupValue||showingFooterTotal||showPivotModeLeafValue))return}this.addExpandAndContract(),this.addFullWidthRowDraggerIfNeeded(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent(),this.refreshAriaExpanded()}getCellAriaRole(){var _a,_b;const colDefAriaRole=null==(_a=this.params.colDef)?void 0:_a.cellAriaRole,columnColDefAriaRole=null==(_b=this.params.column)?void 0:_b.getColDef().cellAriaRole;return colDefAriaRole||columnColDefAriaRole||"gridcell"}destroy(){super.destroy(),this.expandListener=null}refreshAriaExpanded(){const{node,eGridCell}=this.params;if(this.expandListener&&(this.expandListener=this.expandListener()),!this.isExpandable())return void removeAriaExpanded(eGridCell);const listener=()=>{setAriaExpanded(eGridCell,!!node.expanded)};this.expandListener=this.addManagedListener(node,RowNode.EVENT_EXPANDED_CHANGED,listener)||null,listener()}isTopLevelFooter(){if(!this.gos.getGrandTotalRow())return!1;if(null!=this.params.value||-1!=this.params.node.level)return!1;const colDef=this.params.colDef;if(null==colDef)return!0;if(!0===colDef.showRowGroup)return!0;const rowGroupCols=this.columnModel.getRowGroupColumns();if(!rowGroupCols||0===rowGroupCols.length)return!0;return rowGroupCols[0].getId()===colDef.showRowGroup}isEmbeddedRowMismatch(){if(!this.params.fullWidth||!this.gos.get("embedFullWidthRows"))return!1;const pinnedLeftCell="left"===this.params.pinned,pinnedRightCell="right"===this.params.pinned,bodyCell=!pinnedLeftCell&&!pinnedRightCell;return this.gos.get("enableRtl")?this.columnModel.isPinningLeft()?!pinnedRightCell:!bodyCell:this.columnModel.isPinningLeft()?!pinnedLeftCell:!bodyCell}findDisplayedGroupNode(){const column=this.params.column,rowNode=this.params.node;if(this.showingValueForOpenedParent){let pointer=rowNode.parent;for(;null!=pointer;){if(pointer.rowGroupColumn&&column.isRowGroupDisplayed(pointer.rowGroupColumn.getId())){this.displayedGroupNode=pointer;break}pointer=pointer.parent}}missing(this.displayedGroupNode)&&(this.displayedGroupNode=rowNode)}setupShowingValueForOpenedParent(){const rowNode=this.params.node,column=this.params.column;if(!this.gos.get("groupHideOpenParents"))return void(this.showingValueForOpenedParent=!1);if(!rowNode.groupData)return void(this.showingValueForOpenedParent=!1);if(null!=rowNode.rowGroupColumn){const keyOfGroupingColumn=rowNode.rowGroupColumn.getId();if(column.isRowGroupDisplayed(keyOfGroupingColumn))return void(this.showingValueForOpenedParent=!1)}const valPresent=null!=rowNode.groupData[column.getId()];this.showingValueForOpenedParent=valPresent}addValueElement(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())}addGroupValue(){var _a;const paramsAdjusted=this.adjustParamsWithDetailsFromRelatedColumn(),innerCompDetails=this.getInnerCompDetails(paramsAdjusted),{valueFormatted,value}=paramsAdjusted;let valueWhenNoRenderer=valueFormatted;if(null==valueWhenNoRenderer){const isGroupColForNode=this.displayedGroupNode.rowGroupColumn&&(null==(_a=this.params.column)?void 0:_a.isRowGroupDisplayed(this.displayedGroupNode.rowGroupColumn.getId()));if(""===this.displayedGroupNode.key&&this.displayedGroupNode.group&&isGroupColForNode){valueWhenNoRenderer=this.localeService.getLocaleTextFunc()("blanks","(Blanks)")}else valueWhenNoRenderer=null!=value?value:null}this.comp.setInnerRenderer(innerCompDetails,valueWhenNoRenderer)}adjustParamsWithDetailsFromRelatedColumn(){const relatedColumn=this.displayedGroupNode.rowGroupColumn,column=this.params.column;if(!relatedColumn)return this.params;if(null!=column){if(!column.isRowGroupDisplayed(relatedColumn.getId()))return this.params}const params=this.params,{value,node}=this.params,valueFormatted=this.valueService.formatValue(relatedColumn,node,value);return __spreadProps(__spreadValues({},params),{valueFormatted})}addFooterValue(){let footerValueGetter=this.params.totalValueGetter;if(!footerValueGetter){const legacyGetter=this.params.footerValueGetter;legacyGetter&&(footerValueGetter=legacyGetter,warnOnce("As of v31.3, footerValueGetter is deprecated. Use `totalValueGetter` instead."))}let footerValue="";if(footerValueGetter){const paramsClone=cloneObject(this.params);paramsClone.value=this.params.value,"function"==typeof footerValueGetter?footerValue=footerValueGetter(paramsClone):"string"==typeof footerValueGetter?footerValue=this.expressionService.evaluate(footerValueGetter,paramsClone):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else{footerValue=this.localeService.getLocaleTextFunc()("footerTotal","Total")+" "+(null!=this.params.value?this.params.value:"")}const innerCompDetails=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(innerCompDetails,footerValue)}getInnerCompDetails(params){if(params.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gos.get("groupRowRendererParams"),params);const innerCompDetails=this.userComponentFactory.getInnerRendererDetails(params,params),isGroupRowRenderer=details=>details&&details.componentClass==this.compClass;if(innerCompDetails&&!isGroupRowRenderer(innerCompDetails))return innerCompDetails;const relatedColumn=this.displayedGroupNode.rowGroupColumn,relatedColDef=relatedColumn?relatedColumn.getColDef():void 0;if(!relatedColDef)return;const relatedCompDetails=this.userComponentFactory.getCellRendererDetails(relatedColDef,params);if(relatedCompDetails&&!isGroupRowRenderer(relatedCompDetails))return relatedCompDetails;if(isGroupRowRenderer(relatedCompDetails)&&relatedColDef.cellRendererParams&&relatedColDef.cellRendererParams.innerRenderer){return this.userComponentFactory.getInnerRendererDetails(relatedColDef.cellRendererParams,params)}}addChildCount(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())}updateChildCount(){const allChildrenCount=this.displayedGroupNode.allChildrenCount,countString=this.isShowRowGroupForThisRow()&&null!=allChildrenCount&&allChildrenCount>=0?`(${allChildrenCount})`:"";this.comp.setChildCount(countString)}isShowRowGroupForThisRow(){if(this.gos.get("treeData"))return!0;const rowGroupColumn=this.displayedGroupNode.rowGroupColumn;if(!rowGroupColumn)return!1;const column=this.params.column;return null==column||column.isRowGroupDisplayed(rowGroupColumn.getId())}addExpandAndContract(){var _a;const params=this.params,eExpandedIcon=createIconNoSpan("groupExpanded",this.gos,null),eContractedIcon=createIconNoSpan("groupContracted",this.gos,null);eExpandedIcon&&this.eExpanded.appendChild(eExpandedIcon),eContractedIcon&&this.eContracted.appendChild(eContractedIcon);const eGroupCell=params.eGridCell;(null==(_a=this.params.column)?void 0:_a.isCellEditable(params.node))&&this.gos.get("enableGroupEdit")||!this.isExpandable()||params.suppressDoubleClickExpand||this.addManagedListener(eGroupCell,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(eGroupCell,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(params.node,RowNode.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();const expandableChangedListener=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_ALL_CHILDREN_COUNT_CHANGED,expandableChangedListener),this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_MASTER_CHANGED,expandableChangedListener),this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_GROUP_CHANGED,expandableChangedListener),this.addManagedListener(this.displayedGroupNode,RowNode.EVENT_HAS_CHILDREN_CHANGED,expandableChangedListener)}onExpandClicked(mouseEvent){isStopPropagationForAgGrid(mouseEvent)||(stopPropagationForAgGrid(mouseEvent),this.onExpandOrContract(mouseEvent))}onExpandOrContract(e){const rowNode=this.displayedGroupNode,nextExpandState=!rowNode.expanded;!nextExpandState&&rowNode.sticky&&this.scrollToStickyNode(rowNode),rowNode.setExpanded(nextExpandState,e)}scrollToStickyNode(rowNode){this.ctrlsService.getGridBodyCtrl().getScrollFeature().setVerticalScrollPosition(rowNode.rowTop-rowNode.stickyRowTop)}isExpandable(){if(this.showingValueForOpenedParent)return!0;const rowNode=this.displayedGroupNode,reducedLeafNode=this.columnModel.isPivotMode()&&rowNode.leafGroup;if(!(rowNode.isExpandable()&&!rowNode.footer&&!reducedLeafNode))return!1;const column=this.params.column;if(null!=column&&"string"==typeof column.getColDef().showRowGroup){return this.isShowRowGroupForThisRow()}return!0}showExpandAndContractIcons(){const{params,displayedGroupNode:displayedGroup,columnModel}=this,{node}=params,isExpandable=this.isExpandable();if(isExpandable){const expanded=!!this.showingValueForOpenedParent||node.expanded;this.comp.setExpandedDisplayed(expanded),this.comp.setContractedDisplayed(!expanded)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);const pivotMode=columnModel.isPivotMode(),pivotModeAndLeafGroup=pivotMode&&displayedGroup.leafGroup,addExpandableCss=isExpandable&&!pivotModeAndLeafGroup,isTotalFooterNode=node.footer&&-1===node.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",addExpandableCss),this.comp.addOrRemoveCssClass("ag-row-group",addExpandableCss),pivotMode?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",pivotModeAndLeafGroup):isTotalFooterNode||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!addExpandableCss)}onRowNodeIsExpandableChanged(){this.showExpandAndContractIcons(),this.setIndent(),this.refreshAriaExpanded()}setupIndent(){const node=this.params.node;this.params.suppressPadding||(this.addManagedListener(node,RowNode.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())}setIndent(){if(this.gos.get("groupHideOpenParents"))return;const params=this.params,rowNode=params.node,fullWithRow=!!params.colDef,treeData=this.gos.get("treeData"),paddingCount=!fullWithRow||treeData||!0===params.colDef.showRowGroup?rowNode.uiLevel:0;this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+paddingCount,this.comp.addOrRemoveCssClass(this.indentClass,!0)}addFullWidthRowDraggerIfNeeded(){if(!this.params.fullWidth||!this.params.rowDrag)return;const rowDragComp=new RowDragComp(()=>this.params.value,this.params.node);this.createManagedBean(rowDragComp,this.context),this.eGui.insertAdjacentElement("afterbegin",rowDragComp.getGui())}isUserWantsSelected(){const paramsCheckbox=this.params.checkbox;return"function"==typeof paramsCheckbox||!0===paramsCheckbox}addCheckboxIfNeeded(){const rowNode=this.displayedGroupNode,checkboxNeeded=this.isUserWantsSelected()&&!rowNode.footer&&!rowNode.rowPinned&&!rowNode.detail;if(checkboxNeeded){const cbSelectionComponent=new CheckboxSelectionComponent;this.getContext().createBean(cbSelectionComponent),cbSelectionComponent.init({rowNode:this.params.node,column:this.params.column,overrides:{isVisible:this.params.checkbox,callbackParams:this.params,removeHidden:!0}}),this.eCheckbox.appendChild(cbSelectionComponent.getGui()),this.addDestroyFunc(()=>this.getContext().destroyBean(cbSelectionComponent))}this.comp.setCheckboxVisible(checkboxNeeded)}onKeyDown(event){if(!(event.key===KeyCode.ENTER)||this.params.suppressEnterExpand)return;this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract(event)}onCellDblClicked(mouseEvent){if(isStopPropagationForAgGrid(mouseEvent))return;isElementInEventPath(this.eExpanded,mouseEvent)||isElementInEventPath(this.eContracted,mouseEvent)||this.onExpandOrContract(mouseEvent)}};__decorateClass([Autowired("expressionService")],GroupCellRendererCtrl.prototype,"expressionService",2),__decorateClass([Autowired("valueService")],GroupCellRendererCtrl.prototype,"valueService",2),__decorateClass([Autowired("columnModel")],GroupCellRendererCtrl.prototype,"columnModel",2),__decorateClass([Autowired("userComponentFactory")],GroupCellRendererCtrl.prototype,"userComponentFactory",2),__decorateClass([Autowired("ctrlsService")],GroupCellRendererCtrl.prototype,"ctrlsService",2);var _GroupCellRenderer=class _GroupCellRenderer extends Component{constructor(){super(_GroupCellRenderer.TEMPLATE)}init(params){const compProxy={setInnerRenderer:(compDetails,valueToDisplay)=>this.setRenderDetails(compDetails,valueToDisplay),setChildCount:count=>this.eChildCount.textContent=count,addOrRemoveCssClass:(cssClass,value)=>this.addOrRemoveCssClass(cssClass,value),setContractedDisplayed:expanded=>setDisplayed(this.eContracted,expanded),setExpandedDisplayed:expanded=>setDisplayed(this.eExpanded,expanded),setCheckboxVisible:visible=>this.eCheckbox.classList.toggle("ag-invisible",!visible)},ctrl=this.createManagedBean(new GroupCellRendererCtrl),fullWidth=!params.colDef,eGui=this.getGui();ctrl.init(compProxy,eGui,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,params),fullWidth&&setAriaRole(eGui,ctrl.getCellAriaRole())}setRenderDetails(compDetails,valueToDisplay){if(compDetails){const componentPromise=compDetails.newAgStackInstance();if(!componentPromise)return;componentPromise.then(comp=>{if(!comp)return;const destroyComp=()=>this.context.destroyBean(comp);this.isAlive()?(this.eValue.appendChild(comp.getGui()),this.addDestroyFunc(destroyComp)):destroyComp()})}else this.eValue.innerText=valueToDisplay}destroy(){this.getContext().destroyBean(this.innerCellRenderer),super.destroy()}refresh(){return!1}};_GroupCellRenderer.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',__decorateClass([RefSelector("eExpanded")],_GroupCellRenderer.prototype,"eExpanded",2),__decorateClass([RefSelector("eContracted")],_GroupCellRenderer.prototype,"eContracted",2),__decorateClass([RefSelector("eCheckbox")],_GroupCellRenderer.prototype,"eCheckbox",2),__decorateClass([RefSelector("eValue")],_GroupCellRenderer.prototype,"eValue",2),__decorateClass([RefSelector("eChildCount")],_GroupCellRenderer.prototype,"eChildCount",2);var GroupCellRenderer=_GroupCellRenderer,_LoadingCellRenderer=class _LoadingCellRenderer extends Component{constructor(){super(_LoadingCellRenderer.TEMPLATE)}init(params){params.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const localeTextFunc=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=localeTextFunc("loadingError","ERR")}setupLoading(){const eLoadingIcon=createIconNoSpan("groupLoading",this.gos,null);eLoadingIcon&&this.eLoadingIcon.appendChild(eLoadingIcon);const localeTextFunc=this.localeService.getLocaleTextFunc();this.eLoadingText.innerText=localeTextFunc("loadingOoo","Loading")}refresh(params){return!1}destroy(){super.destroy()}};_LoadingCellRenderer.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',__decorateClass([RefSelector("eLoadingIcon")],_LoadingCellRenderer.prototype,"eLoadingIcon",2),__decorateClass([RefSelector("eLoadingText")],_LoadingCellRenderer.prototype,"eLoadingText",2);var LoadingCellRenderer=_LoadingCellRenderer,_SkeletonCellRenderer=class _SkeletonCellRenderer extends Component{constructor(){super(_SkeletonCellRenderer.TEMPLATE)}init(params){const id=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",id),this.addDestroyFunc(()=>setAriaLabelledBy(params.eParentOfValue)),setAriaLabelledBy(params.eParentOfValue,id),params.node.failedLoad?this.setupFailed():this.setupLoading()}setupFailed(){const localeTextFunc=this.localeService.getLocaleTextFunc();this.getGui().innerText=localeTextFunc("loadingError","ERR");const ariaFailed=localeTextFunc("ariaSkeletonCellLoadingFailed","Row failed to load");setAriaLabel(this.getGui(),ariaFailed)}setupLoading(){const skeletonEffect=this.gos.getDocument().createElement("div");skeletonEffect.classList.add("ag-skeleton-effect"),this.getGui().appendChild(skeletonEffect);const ariaLoading=this.localeService.getLocaleTextFunc()("ariaSkeletonCellLoading","Row data is loading");setAriaLabel(this.getGui(),ariaLoading)}refresh(params){return!1}destroy(){super.destroy()}};_SkeletonCellRenderer.TEMPLATE='<div class="ag-skeleton-container"></div>';var SkeletonCellRenderer=_SkeletonCellRenderer,_LoadingOverlayComponent=class _LoadingOverlayComponent extends Component{constructor(){super()}destroy(){super.destroy()}init(params){const customTemplate=this.gos.get("overlayLoadingTemplate");if(this.setTemplate(null!=customTemplate?customTemplate:_LoadingOverlayComponent.DEFAULT_LOADING_OVERLAY_TEMPLATE),!customTemplate){const localeTextFunc=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=localeTextFunc("loadingOoo","Loading...")})}}};_LoadingOverlayComponent.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span aria-live="polite" aria-atomic="true" class="ag-overlay-loading-center"></span>';var LoadingOverlayComponent=_LoadingOverlayComponent,_NoRowsOverlayComponent=class _NoRowsOverlayComponent extends Component{constructor(){super()}destroy(){super.destroy()}init(params){const customTemplate=this.gos.get("overlayNoRowsTemplate");if(this.setTemplate(null!=customTemplate?customTemplate:_NoRowsOverlayComponent.DEFAULT_NO_ROWS_TEMPLATE),!customTemplate){const localeTextFunc=this.localeService.getLocaleTextFunc();setTimeout(()=>{this.getGui().textContent=localeTextFunc("noRowsToShow","No Rows To Show")})}}};_NoRowsOverlayComponent.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center"></span>';var NoRowsOverlayComponent=_NoRowsOverlayComponent,TooltipComponent=class extends PopupComponent{constructor(){super('<div class="ag-tooltip"></div>')}init(params){const{value}=params;this.getGui().textContent=escapeString(value,!0)}},NumberCellEditorInput=class{getTemplate(){return'<ag-input-number-field class="ag-cell-editor" ref="eInput"></ag-input-number-field>'}init(eInput,params){this.eInput=eInput,this.params=params,null!=params.max&&eInput.setMax(params.max),null!=params.min&&eInput.setMin(params.min),null!=params.precision&&eInput.setPrecision(params.precision),null!=params.step&&eInput.setStep(params.step);const inputEl=eInput.getInputElement();params.preventStepping?eInput.addManagedListener(inputEl,"keydown",this.preventStepping):params.showStepperButtons&&inputEl.classList.add("ag-number-field-input-stepper")}preventStepping(e){e.key!==KeyCode.UP&&e.key!==KeyCode.DOWN||e.preventDefault()}getValue(){const value=this.eInput.getValue();if(!exists(value)&&!exists(this.params.value))return this.params.value;let parsedValue=this.params.parseValue(value);if(null==parsedValue)return parsedValue;if("string"==typeof parsedValue){if(""===parsedValue)return null;parsedValue=Number(parsedValue)}return isNaN(parsedValue)?null:parsedValue}getStartValue(){return this.params.value}},NumberCellEditor=class extends SimpleCellEditor{constructor(){super(new NumberCellEditorInput)}},DateCellEditorInput=class{getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(eInput,params){this.eInput=eInput,this.params=params,null!=params.min&&eInput.setMin(params.min),null!=params.max&&eInput.setMax(params.max),null!=params.step&&eInput.setStep(params.step)}getValue(){const value=this.eInput.getDate();return exists(value)||exists(this.params.value)?null!=value?value:null:this.params.value}getStartValue(){const{value}=this.params;if(value instanceof Date)return serialiseDate(value,!1)}},DateCellEditor=class extends SimpleCellEditor{constructor(){super(new DateCellEditorInput)}},DateStringCellEditorInput=class{constructor(getDataTypeService){this.getDataTypeService=getDataTypeService}getTemplate(){return'<ag-input-date-field class="ag-cell-editor" ref="eInput"></ag-input-date-field>'}init(eInput,params){this.eInput=eInput,this.params=params,null!=params.min&&eInput.setMin(params.min),null!=params.max&&eInput.setMax(params.max),null!=params.step&&eInput.setStep(params.step)}getValue(){const value=this.formatDate(this.eInput.getDate());return exists(value)||exists(this.params.value)?this.params.parseValue(null!=value?value:""):this.params.value}getStartValue(){var _a,_b;return serialiseDate(null!=(_b=this.parseDate(null!=(_a=this.params.value)?_a:void 0))?_b:null,!1)}parseDate(value){return this.getDataTypeService().getDateParserFunction(this.params.column)(value)}formatDate(value){return this.getDataTypeService().getDateFormatterFunction(this.params.column)(value)}},DateStringCellEditor=class extends SimpleCellEditor{constructor(){super(new DateStringCellEditorInput(()=>this.dataTypeService))}};__decorateClass([Autowired("dataTypeService")],DateStringCellEditor.prototype,"dataTypeService",2);var _CheckboxCellRenderer=class _CheckboxCellRenderer extends Component{constructor(){super(_CheckboxCellRenderer.TEMPLATE)}init(params){this.params=params,this.updateCheckbox(params);const inputEl=this.eCheckbox.getInputElement();inputEl.setAttribute("tabindex","-1"),setAriaLive(inputEl,"polite"),this.addManagedListener(inputEl,"click",event=>{if(stopPropagationForAgGrid(event),this.eCheckbox.isDisabled())return;const isSelected=this.eCheckbox.getValue();this.onCheckboxChanged(isSelected)}),this.addManagedListener(inputEl,"dblclick",event=>{stopPropagationForAgGrid(event)}),this.addManagedListener(this.params.eGridCell,"keydown",event=>{if(event.key===KeyCode.SPACE&&!this.eCheckbox.isDisabled()){this.params.eGridCell===this.gos.getActiveDomElement()&&this.eCheckbox.toggle();const isSelected=this.eCheckbox.getValue();this.onCheckboxChanged(isSelected),event.preventDefault()}})}refresh(params){return this.params=params,this.updateCheckbox(params),!0}updateCheckbox(params){var _a,_b,_c;let isSelected,displayed=!0;if(params.node.group&&params.column){const colId=params.column.getColId();colId.startsWith("ag-Grid-AutoColumn")?isSelected=null==params.value||""===params.value?void 0:"true"===params.value:params.node.aggData&&void 0!==params.node.aggData[colId]?isSelected=null!=(_a=params.value)?_a:void 0:displayed=!1}else isSelected=null!=(_b=params.value)?_b:void 0;if(!displayed)return void this.eCheckbox.setDisplayed(!1);this.eCheckbox.setValue(isSelected);const disabled=null!=params.disabled?params.disabled:!(null==(_c=params.column)?void 0:_c.isCellEditable(params.node));this.eCheckbox.setDisabled(disabled);const translate=this.localeService.getLocaleTextFunc(),stateName=getAriaCheckboxStateName(translate,isSelected),ariaLabel=disabled?stateName:`${translate("ariaToggleCellValue","Press SPACE to toggle cell value")} (${stateName})`;this.eCheckbox.setInputAriaLabel(ariaLabel)}onCheckboxChanged(isSelected){const{column,node,rowIndex,value}=this.params,eventStarted={type:Events.EVENT_CELL_EDITING_STARTED,column,colDef:null==column?void 0:column.getColDef(),data:node.data,node,rowIndex,rowPinned:node.rowPinned,value};this.eventService.dispatchEvent(eventStarted);const valueChanged=this.params.node.setDataValue(this.params.column,isSelected,"edit"),eventStopped={type:Events.EVENT_CELL_EDITING_STOPPED,column,colDef:null==column?void 0:column.getColDef(),data:node.data,node,rowIndex,rowPinned:node.rowPinned,value,oldValue:value,newValue:isSelected,valueChanged};this.eventService.dispatchEvent(eventStopped)}};_CheckboxCellRenderer.TEMPLATE='\n        <div class="ag-cell-wrapper ag-checkbox-cell" role="presentation">\n            <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n        </div>',__decorateClass([RefSelector("eCheckbox")],_CheckboxCellRenderer.prototype,"eCheckbox",2);var CheckboxCellRenderer=_CheckboxCellRenderer,CheckboxCellEditor=class extends PopupComponent{constructor(){super('\n            <div class="ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')}init(params){var _a;this.params=params;const isSelected=null!=(_a=params.value)?_a:void 0;this.eCheckbox.setValue(isSelected);this.eCheckbox.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(isSelected),this.addManagedListener(this.eCheckbox,Events.EVENT_FIELD_VALUE_CHANGED,event=>this.setAriaLabel(event.selected))}getValue(){return this.eCheckbox.getValue()}focusIn(){this.eCheckbox.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(isSelected){const translate=this.localeService.getLocaleTextFunc(),stateName=getAriaCheckboxStateName(translate,isSelected),ariaLabel=translate("ariaToggleCellValue","Press SPACE to toggle cell value");this.eCheckbox.setInputAriaLabel(`${ariaLabel} (${stateName})`)}};__decorateClass([RefSelector("eCheckbox")],CheckboxCellEditor.prototype,"eCheckbox",2);var AgMenuItemRenderer=class extends Component{constructor(){super(),this.setTemplate("<div></div>")}init(params){var _a;this.params=params,this.cssClassPrefix=null!=(_a=this.params.cssClassPrefix)?_a:"ag-menu-option",this.addIcon(),this.addName(),this.addShortcut(),this.addSubMenu()}configureDefaults(){return!0}addIcon(){if(this.params.isCompact)return;const icon=loadTemplate(`<span ref="eIcon" class="${this.getClassName("part")} ${this.getClassName("icon")}" role="presentation"></span>`);this.params.checked?icon.appendChild(createIconNoSpan("check",this.gos)):this.params.icon&&(isNodeOrElement(this.params.icon)?icon.appendChild(this.params.icon):"string"==typeof this.params.icon?icon.innerHTML=this.params.icon:console.warn("AG Grid: menu item icon must be DOM node or string")),this.getGui().appendChild(icon)}addName(){const name=loadTemplate(`<span ref="eName" class="${this.getClassName("part")} ${this.getClassName("text")}">${this.params.name||""}</span>`);this.getGui().appendChild(name)}addShortcut(){if(this.params.isCompact)return;const shortcut=loadTemplate(`<span ref="eShortcut" class="${this.getClassName("part")} ${this.getClassName("shortcut")}">${this.params.shortcut||""}</span>`);this.getGui().appendChild(shortcut)}addSubMenu(){const pointer=loadTemplate(`<span ref="ePopupPointer" class="${this.getClassName("part")} ${this.getClassName("popup-pointer")}"></span>`),eGui=this.getGui();if(this.params.subMenu){const iconName=this.gos.get("enableRtl")?"smallLeft":"smallRight";setAriaExpanded(eGui,!1),pointer.appendChild(createIconNoSpan(iconName,this.gos))}eGui.appendChild(pointer)}getClassName(suffix){return`${this.cssClassPrefix}-${suffix}`}destroy(){super.destroy()}},UserComponentRegistry=class extends BeanStub{constructor(){super(...arguments),this.agGridDefaults={agDateInput:DefaultDateComponent,agColumnHeader:HeaderComp,agColumnGroupHeader:HeaderGroupComp,agSortIndicator:SortIndicatorComp,agTextColumnFloatingFilter:TextFloatingFilter,agNumberColumnFloatingFilter:NumberFloatingFilter,agDateColumnFloatingFilter:DateFloatingFilter,agReadOnlyFloatingFilter:ReadOnlyFloatingFilter,agAnimateShowChangeCellRenderer:AnimateShowChangeCellRenderer,agAnimateSlideCellRenderer:AnimateSlideCellRenderer,agGroupCellRenderer:GroupCellRenderer,agGroupRowRenderer:GroupCellRenderer,agLoadingCellRenderer:LoadingCellRenderer,agSkeletonCellRenderer:SkeletonCellRenderer,agCheckboxCellRenderer:CheckboxCellRenderer,agCellEditor:TextCellEditor,agTextCellEditor:TextCellEditor,agNumberCellEditor:NumberCellEditor,agDateCellEditor:DateCellEditor,agDateStringCellEditor:DateStringCellEditor,agSelectCellEditor:SelectCellEditor,agLargeTextCellEditor:LargeTextCellEditor,agCheckboxCellEditor:CheckboxCellEditor,agTextColumnFilter:TextFilter,agNumberColumnFilter:NumberFilter,agDateColumnFilter:DateFilter,agLoadingOverlay:LoadingOverlayComponent,agNoRowsOverlay:NoRowsOverlayComponent,agTooltipComponent:TooltipComponent,agMenuItem:AgMenuItemRenderer},this.enterpriseAgDefaultCompsModule={agSetColumnFilter:"@ag-grid-enterprise/set-filter",agSetColumnFloatingFilter:"@ag-grid-enterprise/set-filter",agMultiColumnFilter:"@ag-grid-enterprise/multi-filter",agMultiColumnFloatingFilter:"@ag-grid-enterprise/multi-filter",agGroupColumnFilter:"@ag-grid-enterprise/row-grouping",agGroupColumnFloatingFilter:"@ag-grid-enterprise/row-grouping",agRichSelect:"@ag-grid-enterprise/rich-select",agRichSelectCellEditor:"@ag-grid-enterprise/rich-select",agDetailCellRenderer:"@ag-grid-enterprise/master-detail",agSparklineCellRenderer:"@ag-grid-enterprise/sparklines"},this.jsComps={}}init(){const comps=this.gos.get("components");null!=comps&&iterateObject(comps,(key,component)=>this.registerJsComponent(key,component))}registerDefaultComponent(name,component){this.agGridDefaults[name]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[name]=component}registerJsComponent(name,component){this.jsComps[name]=component}retrieve(propertyName,name){const createResult=(component,componentFromFramework)=>({componentFromFramework,component}),registeredViaFrameworkComp=this.getFrameworkOverrides().frameworkComponent(name,this.gos.get("components"));if(null!=registeredViaFrameworkComp)return createResult(registeredViaFrameworkComp,!0);const jsComponent=this.jsComps[name];if(jsComponent){return createResult(jsComponent,this.getFrameworkOverrides().isFrameworkComponent(jsComponent))}const defaultComponent=this.agGridDefaults[name];if(defaultComponent)return createResult(defaultComponent,!1);const moduleForComponent=this.enterpriseAgDefaultCompsModule[name];return moduleForComponent?ModuleRegistry.__assertRegistered(moduleForComponent,`AG Grid '${propertyName}' component: ${name}`,this.context.getGridId()):doOnce(()=>{this.warnAboutMissingComponent(propertyName,name)},"MissingComp"+name),null}warnAboutMissingComponent(propertyName,componentName){const suggestions=fuzzySuggestions(componentName,[...Object.keys(this.agGridDefaults).filter(k=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(k)),...Object.keys(this.jsComps)],!0,.8).values;console.warn(`AG Grid: Could not find '${componentName}' component. It was configured as "${propertyName}: '${componentName}'" but it wasn't found in the list of registered components.`),suggestions.length>0&&console.warn(`         Did you mean: [${suggestions.slice(0,3)}]?`),console.warn(`If using a custom component check it has been registered as described in: ${this.getFrameworkOverrides().getDocLink("components/")}`)}};__decorateClass([PostConstruct],UserComponentRegistry.prototype,"init",1),UserComponentRegistry=__decorateClass([Bean("userComponentRegistry")],UserComponentRegistry);var DateComponent={propertyName:"dateComponent",cellRenderer:!1},HeaderComponent={propertyName:"headerComponent",cellRenderer:!1},HeaderGroupComponent={propertyName:"headerGroupComponent",cellRenderer:!1},CellRendererComponent={propertyName:"cellRenderer",cellRenderer:!0},LoadingCellRendererComponent={propertyName:"loadingCellRenderer",cellRenderer:!0},CellEditorComponent={propertyName:"cellEditor",cellRenderer:!1},InnerRendererComponent={propertyName:"innerRenderer",cellRenderer:!0},LoadingOverlayComponent2={propertyName:"loadingOverlayComponent",cellRenderer:!1},NoRowsOverlayComponent2={propertyName:"noRowsOverlayComponent",cellRenderer:!1},TooltipComponent2={propertyName:"tooltipComponent",cellRenderer:!1},FilterComponent={propertyName:"filter",cellRenderer:!1},FloatingFilterComponent={propertyName:"floatingFilterComponent",cellRenderer:!1},ToolPanelComponent={propertyName:"toolPanel",cellRenderer:!1},StatusPanelComponent={propertyName:"statusPanel",cellRenderer:!1},FullWidth={propertyName:"fullWidthCellRenderer",cellRenderer:!0},FullWidthLoading={propertyName:"loadingCellRenderer",cellRenderer:!0},FullWidthGroup={propertyName:"groupRowRenderer",cellRenderer:!0},FullWidthDetail={propertyName:"detailCellRenderer",cellRenderer:!0},MenuItemComponent={propertyName:"menuItem",cellRenderer:!1},FloatingFilterMapper=class{static getFloatingFilterType(filterType){return this.filterToFloatingFilterMapping[filterType]}};FloatingFilterMapper.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",group:"agGroupColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"};var UserComponentFactory=class extends BeanStub{getHeaderCompDetails(colDef,params){return this.getCompDetails(colDef,HeaderComponent,"agColumnHeader",params)}getHeaderGroupCompDetails(params){const colGroupDef=params.columnGroup.getColGroupDef();return this.getCompDetails(colGroupDef,HeaderGroupComponent,"agColumnGroupHeader",params)}getFullWidthCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidth,null,params,!0)}getFullWidthLoadingCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidthLoading,"agLoadingCellRenderer",params,!0)}getFullWidthGroupCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidthGroup,"agGroupRowRenderer",params,!0)}getFullWidthDetailCellRendererDetails(params){return this.getCompDetails(this.gridOptions,FullWidthDetail,"agDetailCellRenderer",params,!0)}getInnerRendererDetails(def,params){return this.getCompDetails(def,InnerRendererComponent,null,params)}getFullWidthGroupRowInnerCellRenderer(def,params){return this.getCompDetails(def,InnerRendererComponent,null,params)}getCellRendererDetails(def,params){return this.getCompDetails(def,CellRendererComponent,null,params)}getLoadingCellRendererDetails(def,params){return this.getCompDetails(def,LoadingCellRendererComponent,"agSkeletonCellRenderer",params,!0)}getCellEditorDetails(def,params){return this.getCompDetails(def,CellEditorComponent,"agCellEditor",params,!0)}getFilterDetails(def,params,defaultFilter){return this.getCompDetails(def,FilterComponent,defaultFilter,params,!0)}getDateCompDetails(params){return this.getCompDetails(this.gridOptions,DateComponent,"agDateInput",params,!0)}getLoadingOverlayCompDetails(params){return this.getCompDetails(this.gridOptions,LoadingOverlayComponent2,"agLoadingOverlay",params,!0)}getNoRowsOverlayCompDetails(params){return this.getCompDetails(this.gridOptions,NoRowsOverlayComponent2,"agNoRowsOverlay",params,!0)}getTooltipCompDetails(params){return this.getCompDetails(params.colDef,TooltipComponent2,"agTooltipComponent",params,!0)}getSetFilterCellRendererDetails(def,params){return this.getCompDetails(def,CellRendererComponent,null,params)}getFloatingFilterCompDetails(def,params,defaultFloatingFilter){return this.getCompDetails(def,FloatingFilterComponent,defaultFloatingFilter,params)}getToolPanelCompDetails(toolPanelDef,params){return this.getCompDetails(toolPanelDef,ToolPanelComponent,null,params,!0)}getStatusPanelCompDetails(def,params){return this.getCompDetails(def,StatusPanelComponent,null,params,!0)}getMenuItemCompDetails(def,params){return this.getCompDetails(def,MenuItemComponent,"agMenuItem",params,!0)}getCompDetails(defObject,type,defaultName,params,mandatory=!1){const{propertyName,cellRenderer}=type;let{compName,jsComp,fwComp,paramsFromSelector,popupFromSelector,popupPositionFromSelector}=this.getCompKeys(defObject,type,params);const lookupFromRegistry=key=>{const item=this.userComponentRegistry.retrieve(propertyName,key);item&&(jsComp=item.componentFromFramework?void 0:item.component,fwComp=item.componentFromFramework?item.component:void 0)};if(null!=compName&&lookupFromRegistry(compName),null==jsComp&&null==fwComp&&null!=defaultName&&lookupFromRegistry(defaultName),jsComp&&cellRenderer&&!this.agComponentUtils.doesImplementIComponent(jsComp)&&(jsComp=this.agComponentUtils.adaptFunction(propertyName,jsComp)),!jsComp&&!fwComp)return void(mandatory&&console.error(`AG Grid: Could not find component ${compName}, did you forget to configure this component?`));const paramsMerged=this.mergeParamsWithApplicationProvidedParams(defObject,type,params,paramsFromSelector),componentFromFramework=null==jsComp,componentClass=jsComp||fwComp;return{componentFromFramework,componentClass,params:paramsMerged,type,popupFromSelector,popupPositionFromSelector,newAgStackInstance:()=>this.newAgStackInstance(componentClass,componentFromFramework,paramsMerged,type)}}getCompKeys(defObject,type,params){const{propertyName}=type;let compName,jsComp,fwComp,paramsFromSelector,popupFromSelector,popupPositionFromSelector;if(defObject){const defObjectAny=defObject,selectorFunc=defObjectAny[propertyName+"Selector"],selectorRes=selectorFunc?selectorFunc(params):null,assignComp=providedJsComp=>{if("string"==typeof providedJsComp)compName=providedJsComp;else if(null!=providedJsComp&&!0!==providedJsComp){this.getFrameworkOverrides().isFrameworkComponent(providedJsComp)?fwComp=providedJsComp:jsComp=providedJsComp}};selectorRes?(assignComp(selectorRes.component),paramsFromSelector=selectorRes.params,popupFromSelector=selectorRes.popup,popupPositionFromSelector=selectorRes.popupPosition):assignComp(defObjectAny[propertyName])}return{compName,jsComp,fwComp,paramsFromSelector,popupFromSelector,popupPositionFromSelector}}newAgStackInstance(ComponentClass,componentFromFramework,params,type){const propertyName=type.propertyName;let instance;if(!componentFromFramework)instance=new ComponentClass;else{const thisComponentConfig=this.componentMetadataProvider.retrieve(propertyName);instance=this.frameworkComponentWrapper.wrap(ComponentClass,thisComponentConfig.mandatoryMethodList,thisComponentConfig.optionalMethodList,type)}const deferredInit=this.initComponent(instance,params);return null==deferredInit?AgPromise.resolve(instance):deferredInit.then(()=>instance)}mergeParamsWithApplicationProvidedParams(defObject,type,paramsFromGrid,paramsFromSelector=null){const params=this.gos.getGridCommonParams();mergeDeep(params,paramsFromGrid);const userParams=defObject&&defObject[type.propertyName+"Params"];if("function"==typeof userParams){mergeDeep(params,userParams(paramsFromGrid))}else"object"==typeof userParams&&mergeDeep(params,userParams);return mergeDeep(params,paramsFromSelector),params}initComponent(component,params){if(this.context.createBean(component),null!=component.init)return component.init(params)}getDefaultFloatingFilterType(def,getFromDefault){if(null==def)return null;let defaultFloatingFilterType=null,{compName,jsComp,fwComp}=this.getCompKeys(def,FilterComponent);if(compName)defaultFloatingFilterType=FloatingFilterMapper.getFloatingFilterType(compName);else{null==jsComp&&null==fwComp&&!0===def.filter&&(defaultFloatingFilterType=getFromDefault())}return defaultFloatingFilterType}};__decorateClass([Autowired("gridOptions")],UserComponentFactory.prototype,"gridOptions",2),__decorateClass([Autowired("agComponentUtils")],UserComponentFactory.prototype,"agComponentUtils",2),__decorateClass([Autowired("componentMetadataProvider")],UserComponentFactory.prototype,"componentMetadataProvider",2),__decorateClass([Autowired("userComponentRegistry")],UserComponentFactory.prototype,"userComponentRegistry",2),__decorateClass([Optional("frameworkComponentWrapper")],UserComponentFactory.prototype,"frameworkComponentWrapper",2),UserComponentFactory=__decorateClass([Bean("userComponentFactory")],UserComponentFactory);var AutoScrollService=class{constructor(params){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=params.scrollContainer,this.scrollHorizontally=-1!==params.scrollAxis.indexOf("x"),this.scrollVertically=-1!==params.scrollAxis.indexOf("y"),this.scrollByTick=null!=params.scrollByTick?params.scrollByTick:20,params.onScrollCallback&&(this.onScrollCallback=params.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=params.getVerticalPosition,this.setVerticalPosition=params.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=params.getHorizontalPosition,this.setHorizontalPosition=params.setHorizontalPosition),this.shouldSkipVerticalScroll=params.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=params.shouldSkipHorizontalScroll||(()=>!1)}check(mouseEvent,forceSkipVerticalScroll=!1){const skipVerticalScroll=forceSkipVerticalScroll||this.shouldSkipVerticalScroll();if(skipVerticalScroll&&this.shouldSkipHorizontalScroll())return;const rect=this.scrollContainer.getBoundingClientRect(),scrollTick=this.scrollByTick;this.tickLeft=mouseEvent.clientX<rect.left+scrollTick,this.tickRight=mouseEvent.clientX>rect.right-scrollTick,this.tickUp=mouseEvent.clientY<rect.top+scrollTick&&!skipVerticalScroll,this.tickDown=mouseEvent.clientY>rect.bottom-scrollTick&&!skipVerticalScroll,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){let tickAmount;if(this.tickCount++,tickAmount=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){const vScrollPosition=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(vScrollPosition-tickAmount),this.tickDown&&this.setVerticalPosition(vScrollPosition+tickAmount)}if(this.scrollHorizontally){const hScrollPosition=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(hScrollPosition-tickAmount),this.tickRight&&this.setHorizontalPosition(hScrollPosition+tickAmount)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},RowDragFeature=class extends BeanStub{constructor(eContainer){super(),this.eContainer=eContainer}postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.ctrlsService.whenReady(p=>{const gridBodyCon=p.gridBodyCtrl;this.autoScrollService=new AutoScrollService({scrollContainer:gridBodyCon.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:()=>gridBodyCon.getScrollFeature().getVScrollPosition().top,setVerticalPosition:position=>gridBodyCon.getScrollFeature().setVerticalScrollPosition(position),onScrollCallback:()=>{this.onDragging(this.lastDraggingEvent)}})})}getContainer(){return this.eContainer}isInterestedIn(type){return 2===type}getIconName(){return this.gos.get("rowDragManaged")&&this.shouldPreventRowMove()?DragAndDropService.ICON_NOT_ALLOWED:DragAndDropService.ICON_MOVE}shouldPreventRowMove(){if(this.columnModel.getRowGroupColumns().length)return!0;if(this.filterManager.isAnyFilterPresent())return!0;return!!this.sortController.isSortActive()}getRowNodes(draggingEvent){if(!this.isFromThisGrid(draggingEvent))return draggingEvent.dragItem.rowNodes||[];const currentNode=draggingEvent.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const selectedNodes=[...this.selectionService.getSelectedNodes()].sort((a,b)=>null==a.rowIndex||null==b.rowIndex?0:this.getRowIndexNumber(a)-this.getRowIndexNumber(b));if(-1!==selectedNodes.indexOf(currentNode))return selectedNodes}return[currentNode]}onDragEnter(draggingEvent){draggingEvent.dragItem.rowNodes=this.getRowNodes(draggingEvent),this.dispatchGridEvent(Events.EVENT_ROW_DRAG_ENTER,draggingEvent),this.getRowNodes(draggingEvent).forEach(rowNode=>{rowNode.setDragging(!0)}),this.onEnterOrDragging(draggingEvent)}onDragging(draggingEvent){this.onEnterOrDragging(draggingEvent)}isFromThisGrid(draggingEvent){const{dragSourceDomDataKey}=draggingEvent.dragSource;return dragSourceDomDataKey===this.gos.getDomDataKey()}isDropZoneWithinThisGrid(draggingEvent){const gridGui=this.ctrlsService.getGridBodyCtrl().getGui(),{dropZoneTarget}=draggingEvent;return!gridGui.contains(dropZoneTarget)}onEnterOrDragging(draggingEvent){this.dispatchGridEvent(Events.EVENT_ROW_DRAG_MOVE,draggingEvent),this.lastDraggingEvent=draggingEvent;const pixel=this.mouseEventService.getNormalisedPosition(draggingEvent).y;this.gos.get("rowDragManaged")&&this.doManagedDrag(draggingEvent,pixel),this.autoScrollService.check(draggingEvent.event)}doManagedDrag(draggingEvent,pixel){const isFromThisGrid=this.isFromThisGrid(draggingEvent),managedDrag=this.gos.get("rowDragManaged"),rowNodes=draggingEvent.dragItem.rowNodes;managedDrag&&this.shouldPreventRowMove()||(this.gos.get("suppressMoveWhenRowDragging")||!isFromThisGrid?this.isDropZoneWithinThisGrid(draggingEvent)||this.clientSideRowModel.highlightRowAtPixel(rowNodes[0],pixel):this.moveRows(rowNodes,pixel))}getRowIndexNumber(rowNode){return parseInt(last(rowNode.getRowIndexString().split("-")),10)}moveRowAndClearHighlight(draggingEvent){const lastHighlightedRowNode=this.clientSideRowModel.getLastHighlightedRowNode(),isBelow=lastHighlightedRowNode&&1===lastHighlightedRowNode.highlighted,pixel=this.mouseEventService.getNormalisedPosition(draggingEvent).y,rowNodes=draggingEvent.dragItem.rowNodes;let increment=isBelow?1:0;if(this.isFromThisGrid(draggingEvent))rowNodes.forEach(rowNode=>{rowNode.rowTop<pixel&&(increment-=1)}),this.moveRows(rowNodes,pixel,increment);else{const getRowIdFunc=this.gos.getCallback("getRowId");let addIndex=this.clientSideRowModel.getRowIndexAtPixel(pixel)+1;0===this.clientSideRowModel.getHighlightPosition(pixel)&&addIndex--,this.clientSideRowModel.updateRowData({add:rowNodes.map(node=>node.data).filter(data=>!this.clientSideRowModel.getRowNode(getRowIdFunc?getRowIdFunc({data,level:0}):data.id)),addIndex})}this.clearRowHighlight()}clearRowHighlight(){this.clientSideRowModel.highlightRowAtPixel(null)}moveRows(rowNodes,pixel,increment=0){var _a;this.clientSideRowModel.ensureRowsAtPixel(rowNodes,pixel,increment)&&(this.focusService.clearFocusedCell(),null==(_a=this.rangeService)||_a.removeAllCellRanges())}addRowDropZone(params){if(!params.getContainer())return void warnOnce("addRowDropZone - A container target needs to be provided");if(this.dragAndDropService.findExternalZone(params))return void console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");let processedParams={getContainer:params.getContainer};params.fromGrid?processedParams=params:(params.onDragEnter&&(processedParams.onDragEnter=e=>{params.onDragEnter(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER,e))}),params.onDragLeave&&(processedParams.onDragLeave=e=>{params.onDragLeave(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE,e))}),params.onDragging&&(processedParams.onDragging=e=>{params.onDragging(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE,e))}),params.onDragStop&&(processedParams.onDragStop=e=>{params.onDragStop(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END,e))})),this.dragAndDropService.addDropTarget(__spreadValues({isInterestedIn:type=>2===type,getIconName:()=>DragAndDropService.ICON_MOVE,external:!0},processedParams))}getRowDropZone(events){const getContainer=this.getContainer.bind(this),onDragEnter=this.onDragEnter.bind(this),onDragLeave=this.onDragLeave.bind(this),onDragging=this.onDragging.bind(this),onDragStop=this.onDragStop.bind(this);return events?{getContainer,onDragEnter:events.onDragEnter?e=>{onDragEnter(e),events.onDragEnter(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_ENTER,e))}:onDragEnter,onDragLeave:events.onDragLeave?e=>{onDragLeave(e),events.onDragLeave(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_LEAVE,e))}:onDragLeave,onDragging:events.onDragging?e=>{onDragging(e),events.onDragging(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_MOVE,e))}:onDragging,onDragStop:events.onDragStop?e=>{onDragStop(e),events.onDragStop(this.draggingToRowDragEvent(Events.EVENT_ROW_DRAG_END,e))}:onDragStop,fromGrid:!0}:{getContainer,onDragEnter,onDragLeave,onDragging,onDragStop,fromGrid:!0}}draggingToRowDragEvent(type,draggingEvent){const yNormalised=this.mouseEventService.getNormalisedPosition(draggingEvent).y;let overNode,vDirectionString,overIndex=-1;switch(yNormalised>this.paginationProxy.getCurrentPageHeight()||(overIndex=this.rowModel.getRowIndexAtPixel(yNormalised),overNode=this.rowModel.getRow(overIndex)),draggingEvent.vDirection){case 1:vDirectionString="down";break;case 0:vDirectionString="up";break;default:vDirectionString=null}return this.gos.addGridCommonParams({type,event:draggingEvent.event,node:draggingEvent.dragItem.rowNode,nodes:draggingEvent.dragItem.rowNodes,overIndex,overNode,y:yNormalised,vDirection:vDirectionString})}dispatchGridEvent(type,draggingEvent){const event=this.draggingToRowDragEvent(type,draggingEvent);this.eventService.dispatchEvent(event)}onDragLeave(draggingEvent){this.dispatchGridEvent(Events.EVENT_ROW_DRAG_LEAVE,draggingEvent),this.stopDragging(draggingEvent),this.gos.get("rowDragManaged")&&this.clearRowHighlight()}onDragStop(draggingEvent){this.dispatchGridEvent(Events.EVENT_ROW_DRAG_END,draggingEvent),this.stopDragging(draggingEvent),!this.gos.get("rowDragManaged")||!this.gos.get("suppressMoveWhenRowDragging")&&this.isFromThisGrid(draggingEvent)||this.isDropZoneWithinThisGrid(draggingEvent)||this.moveRowAndClearHighlight(draggingEvent)}stopDragging(draggingEvent){this.autoScrollService.ensureCleared(),this.getRowNodes(draggingEvent).forEach(rowNode=>{rowNode.setDragging(!1)})}};__decorateClass([Autowired("dragAndDropService")],RowDragFeature.prototype,"dragAndDropService",2),__decorateClass([Autowired("rowModel")],RowDragFeature.prototype,"rowModel",2),__decorateClass([Autowired("paginationProxy")],RowDragFeature.prototype,"paginationProxy",2),__decorateClass([Autowired("columnModel")],RowDragFeature.prototype,"columnModel",2),__decorateClass([Autowired("focusService")],RowDragFeature.prototype,"focusService",2),__decorateClass([Autowired("sortController")],RowDragFeature.prototype,"sortController",2),__decorateClass([Autowired("filterManager")],RowDragFeature.prototype,"filterManager",2),__decorateClass([Autowired("selectionService")],RowDragFeature.prototype,"selectionService",2),__decorateClass([Autowired("mouseEventService")],RowDragFeature.prototype,"mouseEventService",2),__decorateClass([Autowired("ctrlsService")],RowDragFeature.prototype,"ctrlsService",2),__decorateClass([Optional("rangeService")],RowDragFeature.prototype,"rangeService",2),__decorateClass([PostConstruct],RowDragFeature.prototype,"postConstruct",1);var DragService=class extends BeanStub{constructor(){super(...arguments),this.dragEndFunctions=[],this.dragSources=[]}removeAllListeners(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0}removeListener(dragSourceAndListener){const element=dragSourceAndListener.dragSource.eElement,mouseDownListener=dragSourceAndListener.mouseDownListener;if(element.removeEventListener("mousedown",mouseDownListener),dragSourceAndListener.touchEnabled){const touchStartListener=dragSourceAndListener.touchStartListener;element.removeEventListener("touchstart",touchStartListener,{passive:!0})}}removeDragSource(params){const dragSourceAndListener=this.dragSources.find(item=>item.dragSource===params);dragSourceAndListener&&(this.removeListener(dragSourceAndListener),removeFromArray(this.dragSources,dragSourceAndListener))}isDragging(){return this.dragging}addDragSource(params){const mouseListener=this.onMouseDown.bind(this,params),{eElement,includeTouch,stopPropagationForTouch}=params;eElement.addEventListener("mousedown",mouseListener);let touchListener=null;const suppressTouch=this.gos.get("suppressTouch");includeTouch&&!suppressTouch&&(touchListener=touchEvent=>{isFocusableFormField(touchEvent.target)||(touchEvent.cancelable&&(touchEvent.preventDefault(),stopPropagationForTouch&&touchEvent.stopPropagation()),this.onTouchStart(params,touchEvent))},eElement.addEventListener("touchstart",touchListener,{passive:!1})),this.dragSources.push({dragSource:params,mouseDownListener:mouseListener,touchStartListener:touchListener,touchEnabled:!!includeTouch})}getStartTarget(){return this.startTarget}onTouchStart(params,touchEvent){this.currentDragParams=params,this.dragging=!1;const touch=touchEvent.touches[0];this.touchLastTime=touch,this.touchStart=touch;const touchEndEvent=e=>this.onTouchUp(e,params.eElement),target=touchEvent.target,events=[{target:this.gos.getRootNode(),type:"touchmove",listener:e=>{e.cancelable&&e.preventDefault()},options:{passive:!1}},{target,type:"touchmove",listener:e=>this.onTouchMove(e,params.eElement),options:{passive:!0}},{target,type:"touchend",listener:touchEndEvent,options:{passive:!0}},{target,type:"touchcancel",listener:touchEndEvent,options:{passive:!0}}];this.addTemporaryEvents(events),0===params.dragStartPixels&&this.onCommonMove(touch,this.touchStart,params.eElement)}onMouseDown(params,mouseEvent){const e=mouseEvent;if(params.skipMouseEvent&&params.skipMouseEvent(mouseEvent))return;if(e._alreadyProcessedByDragService)return;if(e._alreadyProcessedByDragService=!0,0!==mouseEvent.button)return;this.shouldPreventMouseEvent(mouseEvent)&&mouseEvent.preventDefault(),this.currentDragParams=params,this.dragging=!1,this.mouseStartEvent=mouseEvent,this.startTarget=mouseEvent.target;const target=this.gos.getRootNode(),events=[{target,type:"mousemove",listener:event=>this.onMouseMove(event,params.eElement)},{target,type:"mouseup",listener:event=>this.onMouseUp(event,params.eElement)},{target,type:"contextmenu",listener:event=>event.preventDefault()}];this.addTemporaryEvents(events),0===params.dragStartPixels&&this.onMouseMove(mouseEvent,params.eElement)}addTemporaryEvents(events){events.forEach(currentEvent=>{const{target,type,listener,options}=currentEvent;target.addEventListener(type,listener,options)}),this.dragEndFunctions.push(()=>{events.forEach(currentEvent=>{const{target,type,listener,options}=currentEvent;target.removeEventListener(type,listener,options)})})}isEventNearStartEvent(currentEvent,startEvent){const{dragStartPixels}=this.currentDragParams;return areEventsNear(currentEvent,startEvent,exists(dragStartPixels)?dragStartPixels:4)}getFirstActiveTouch(touchList){for(let i=0;i<touchList.length;i++)if(touchList[i].identifier===this.touchStart.identifier)return touchList[i];return null}onCommonMove(currentEvent,startEvent,el){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(currentEvent,startEvent))return;this.dragging=!0;const event={type:Events.EVENT_DRAG_STARTED,target:el};this.eventService.dispatchEvent(event),this.currentDragParams.onDragStart(startEvent),this.currentDragParams.onDragging(startEvent)}this.currentDragParams.onDragging(currentEvent)}onTouchMove(touchEvent,el){const touch=this.getFirstActiveTouch(touchEvent.touches);touch&&this.onCommonMove(touch,this.touchStart,el)}onMouseMove(mouseEvent,el){var _a;if(isBrowserSafari()){null==(_a=this.gos.getDocument().getSelection())||_a.removeAllRanges()}this.shouldPreventMouseEvent(mouseEvent)&&mouseEvent.preventDefault(),this.onCommonMove(mouseEvent,this.mouseStartEvent,el)}shouldPreventMouseEvent(mouseEvent){const isEnableCellTextSelect=this.gos.get("enableCellTextSelection"),isMouseMove="mousemove"===mouseEvent.type;return isEnableCellTextSelect&&isMouseMove&&mouseEvent.cancelable&&this.mouseEventService.isEventFromThisGrid(mouseEvent)&&!this.isOverFormFieldElement(mouseEvent)}isOverFormFieldElement(mouseEvent){const el=mouseEvent.target,tagName=null==el?void 0:el.tagName.toLocaleLowerCase();return!!(null==tagName?void 0:tagName.match("^a$|textarea|input|select|button"))}onTouchUp(touchEvent,el){let touch=this.getFirstActiveTouch(touchEvent.changedTouches);touch||(touch=this.touchLastTime),this.onUpCommon(touch,el)}onMouseUp(mouseEvent,el){this.onUpCommon(mouseEvent,el)}onUpCommon(eventOrTouch,el){if(this.dragging){this.dragging=!1,this.currentDragParams.onDragStop(eventOrTouch);const event={type:Events.EVENT_DRAG_STOPPED,target:el};this.eventService.dispatchEvent(event)}this.mouseStartEvent=null,this.startTarget=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(func=>func()),this.dragEndFunctions.length=0}};__decorateClass([Autowired("mouseEventService")],DragService.prototype,"mouseEventService",2),__decorateClass([PreDestroy],DragService.prototype,"removeAllListeners",1),DragService=__decorateClass([Bean("dragService")],DragService);var LIST_ITEM_HOVERED="ag-list-item-hovered",VirtualListDragFeature=class extends BeanStub{constructor(comp,virtualList,params){super(),this.comp=comp,this.virtualList=virtualList,this.params=params,this.currentDragValue=null,this.lastHoveredListItem=null}postConstruct(){this.addManagedListener(this.params.eventSource,this.params.listItemDragStartEvent,this.listItemDragStart.bind(this)),this.addManagedListener(this.params.eventSource,this.params.listItemDragEndEvent,this.listItemDragEnd.bind(this)),this.createDropTarget(),this.createAutoScrollService()}listItemDragStart(event){this.currentDragValue=this.params.getCurrentDragValue(event),this.moveBlocked=this.params.isMoveBlocked(this.currentDragValue)}listItemDragEnd(){window.setTimeout(()=>{this.currentDragValue=null,this.moveBlocked=!1},10)}createDropTarget(){const dropTarget={isInterestedIn:type=>type===this.params.dragSourceType,getIconName:()=>this.moveBlocked?DragAndDropService.ICON_PINNED:DragAndDropService.ICON_MOVE,getContainer:()=>this.comp.getGui(),onDragging:e=>this.onDragging(e),onDragStop:()=>this.onDragStop(),onDragLeave:()=>this.onDragLeave()};this.dragAndDropService.addDropTarget(dropTarget)}createAutoScrollService(){const virtualListGui=this.virtualList.getGui();this.autoScrollService=new AutoScrollService({scrollContainer:virtualListGui,scrollAxis:"y",getVerticalPosition:()=>virtualListGui.scrollTop,setVerticalPosition:position=>virtualListGui.scrollTop=position})}onDragging(e){if(!this.currentDragValue||this.moveBlocked)return;const hoveredListItem=this.getListDragItem(e),comp=this.virtualList.getComponentAt(hoveredListItem.rowIndex);if(!comp)return;const el=comp.getGui().parentElement;this.lastHoveredListItem&&this.lastHoveredListItem.rowIndex===hoveredListItem.rowIndex&&this.lastHoveredListItem.position===hoveredListItem.position||(this.autoScrollService.check(e.event),this.clearHoveredItems(),this.lastHoveredListItem=hoveredListItem,radioCssClass(el,LIST_ITEM_HOVERED),radioCssClass(el,`ag-item-highlight-${hoveredListItem.position}`))}getListDragItem(e){const virtualListGui=this.virtualList.getGui(),paddingTop=parseFloat(window.getComputedStyle(virtualListGui).paddingTop),rowHeight=this.virtualList.getRowHeight(),scrollTop=this.virtualList.getScrollTop(),rowIndex=Math.max(0,(e.y-paddingTop+scrollTop)/rowHeight),maxLen=this.params.getNumRows(this.comp)-1,normalizedRowIndex=0|Math.min(maxLen,rowIndex);return{rowIndex:normalizedRowIndex,position:Math.round(rowIndex)>rowIndex||rowIndex>maxLen?"bottom":"top",component:this.virtualList.getComponentAt(normalizedRowIndex)}}onDragStop(){this.moveBlocked||(this.params.moveItem(this.currentDragValue,this.lastHoveredListItem),this.clearHoveredItems(),this.autoScrollService.ensureCleared())}onDragLeave(){this.clearHoveredItems(),this.autoScrollService.ensureCleared()}clearHoveredItems(){this.virtualList.getGui().querySelectorAll(`.${LIST_ITEM_HOVERED}`).forEach(el=>{[LIST_ITEM_HOVERED,"ag-item-highlight-top","ag-item-highlight-bottom"].forEach(cls=>{el.classList.remove(cls)})}),this.lastHoveredListItem=null}};function unwrapUserComp(comp){const compAsAny=comp;return null!=compAsAny&&null!=compAsAny.getFrameworkComponentInstance?compAsAny.getFrameworkComponentInstance():comp}__decorateClass([Autowired("dragAndDropService")],VirtualListDragFeature.prototype,"dragAndDropService",2),__decorateClass([PostConstruct],VirtualListDragFeature.prototype,"postConstruct",1);var GridApi=class{constructor(){this.detailGridInfoMap={},this.destroyCalled=!1}init(){switch(this.rowModel.getType()){case"clientSide":this.clientSideRowModel=this.rowModel;break;case"infinite":this.infiniteRowModel=this.rowModel;break;case"serverSide":this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady(p=>{this.gridBodyCtrl=p.gridBodyCtrl})}__getAlignedGridService(){return this.alignedGridsService}getGridId(){return this.context.getGridId()}addDetailGridInfo(id,gridInfo){this.detailGridInfoMap[id]=gridInfo}removeDetailGridInfo(id){delete this.detailGridInfoMap[id]}getDetailGridInfo(id){return this.detailGridInfoMap[id]}forEachDetailGridInfo(callback){let index=0;iterateObject(this.detailGridInfoMap,(id,gridInfo)=>{exists(gridInfo)&&(callback(gridInfo,index),index++)})}getDataAsCsv(params){if(ModuleRegistry.__assertRegistered("@ag-grid-community/csv-export","api.getDataAsCsv",this.context.getGridId()))return this.csvCreator.getDataAsCsv(params)}exportDataAsCsv(params){ModuleRegistry.__assertRegistered("@ag-grid-community/csv-export","api.exportDataAsCsv",this.context.getGridId())&&this.csvCreator.exportDataAsCsv(params)}assertNotExcelMultiSheet(method,params){return!!ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api."+method,this.context.getGridId())&&(1!==this.excelCreator.getFactoryMode()||(console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'"),!1))}getDataAsExcel(params){if(this.assertNotExcelMultiSheet("getDataAsExcel",params))return this.excelCreator.getDataAsExcel(params)}exportDataAsExcel(params){this.assertNotExcelMultiSheet("exportDataAsExcel",params)&&this.excelCreator.exportDataAsExcel(params)}getSheetDataForExcel(params){if(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api.getSheetDataForExcel",this.context.getGridId()))return this.excelCreator.setFactoryMode(1),this.excelCreator.getSheetDataForExcel(params)}getMultipleSheetsAsExcel(params){if(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api.getMultipleSheetsAsExcel",this.context.getGridId()))return this.excelCreator.getMultipleSheetsAsExcel(params)}exportMultipleSheetsAsExcel(params){ModuleRegistry.__assertRegistered("@ag-grid-enterprise/excel-export","api.exportMultipleSheetsAsExcel",this.context.getGridId())&&this.excelCreator.exportMultipleSheetsAsExcel(params)}setGridAriaProperty(property,value){if(!property)return;const eGrid=this.ctrlsService.getGridBodyCtrl().getGui(),ariaProperty=`aria-${property}`;null===value?eGrid.removeAttribute(ariaProperty):eGrid.setAttribute(ariaProperty,value)}logMissingRowModel(apiMethod,...requiredRowModels){console.error(`AG Grid: api.${apiMethod} can only be called when gridOptions.rowModelType is ${requiredRowModels.join(" or ")}`)}logDeprecation(version,apiMethod,replacement,message){warnOnce(`Since ${version} api.${apiMethod} is deprecated. Please use ${replacement} instead. ${null!=message?message:""}`)}getPinnedTopRowCount(){return this.pinnedRowModel.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.pinnedRowModel.getPinnedBottomRowCount()}getPinnedTopRow(index){return this.pinnedRowModel.getPinnedTopRow(index)}getPinnedBottomRow(index){return this.pinnedRowModel.getPinnedBottomRow(index)}expireValueCache(){this.valueCache.expire()}getVerticalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getVScrollPosition()}getHorizontalPixelRange(){return this.gridBodyCtrl.getScrollFeature().getHScrollPosition()}refreshCells(params={}){this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.refreshCells(params))}flashCells(params={}){const warning=prop=>warnOnce(`Since v31.1 api.flashCells parameter '${prop}Delay' is deprecated. Please use '${prop}Duration' instead.`);exists(params.fadeDelay)&&warning("fade"),exists(params.flashDelay)&&warning("flash"),this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.flashCells(params))}redrawRows(params={}){const rowNodes=params?params.rowNodes:void 0;this.frameworkOverrides.wrapIncoming(()=>this.rowRenderer.redrawRows(rowNodes))}refreshHeader(){this.frameworkOverrides.wrapIncoming(()=>this.ctrlsService.getHeaderRowContainerCtrls().forEach(c=>c.refresh()))}isAnyFilterPresent(){return this.filterManager.isAnyFilterPresent()}isColumnFilterPresent(){return this.filterManager.isColumnFilterPresent()||this.filterManager.isAggregateFilterPresent()}isQuickFilterPresent(){return this.filterManager.isQuickFilterPresent()}getModel(){return warnOnce("Since v31.1 getModel() is deprecated. Please use the appropriate grid API methods instead."),this.rowModel}setRowNodeExpanded(rowNode,expanded,expandParents,forceSync){this.expansionService.setRowNodeExpanded(rowNode,expanded,expandParents,forceSync)}onGroupExpandedOrCollapsed(){missing(this.clientSideRowModel)?this.logMissingRowModel("onGroupExpandedOrCollapsed","clientSide"):this.expansionService.onGroupExpandedOrCollapsed()}refreshClientSideRowModel(step){missing(this.clientSideRowModel)?this.logMissingRowModel("refreshClientSideRowModel","clientSide"):this.clientSideRowModel.refreshModel(step)}isAnimationFrameQueueEmpty(){return this.animationFrameService.isQueueEmpty()}flushAllAnimationFrames(){this.animationFrameService.flushAllFrames()}getRowNode(id){return this.rowModel.getRowNode(id)}getSizesForCurrentTheme(){return{rowHeight:this.gos.getRowHeightAsNumber(),headerHeight:this.columnModel.getHeaderHeight()}}expandAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!0):this.logMissingRowModel("expandAll","clientSide","serverSide")}collapseAll(){this.clientSideRowModel||this.serverSideRowModel?this.expansionService.expandAll(!1):this.logMissingRowModel("collapseAll","clientSide","serverSide")}addRenderedRowListener(eventName,rowIndex,callback){this.rowRenderer.addRenderedRowListener(eventName,rowIndex,callback)}getQuickFilter(){return this.gos.get("quickFilterText")}getAdvancedFilterModel(){return ModuleRegistry.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.getAdvancedFilterModel",this.context.getGridId())?this.filterManager.getAdvancedFilterModel():null}setAdvancedFilterModel(advancedFilterModel){this.filterManager.setAdvancedFilterModel(advancedFilterModel)}showAdvancedFilterBuilder(){ModuleRegistry.__assertRegistered("@ag-grid-enterprise/advanced-filter","api.setAdvancedFilterModel",this.context.getGridId())&&this.filterManager.showAdvancedFilterBuilder("api")}setNodesSelected(params){if(!params.nodes.every(node=>node.rowPinned?(console.warn("AG Grid: cannot select pinned rows"),!1):void 0!==node.id||(console.warn("AG Grid: cannot select node until id for node is known"),!1)))return;const{nodes,source,newValue}=params,nodesAsRowNode=nodes;this.selectionService.setNodesSelected({nodes:nodesAsRowNode,source:null!=source?source:"api",newValue})}selectAll(source="apiSelectAll"){this.selectionService.selectAllRowNodes({source})}deselectAll(source="apiSelectAll"){this.selectionService.deselectAllRowNodes({source})}selectAllFiltered(source="apiSelectAllFiltered"){this.selectionService.selectAllRowNodes({source,justFiltered:!0})}deselectAllFiltered(source="apiSelectAllFiltered"){this.selectionService.deselectAllRowNodes({source,justFiltered:!0})}getServerSideSelectionState(){return missing(this.serverSideRowModel)?(this.logMissingRowModel("getServerSideSelectionState","serverSide"),null):this.selectionService.getSelectionState()}setServerSideSelectionState(state){missing(this.serverSideRowModel)?this.logMissingRowModel("setServerSideSelectionState","serverSide"):this.selectionService.setSelectionState(state,"api")}selectAllOnCurrentPage(source="apiSelectAllCurrentPage"){this.selectionService.selectAllRowNodes({source,justCurrentPage:!0})}deselectAllOnCurrentPage(source="apiSelectAllCurrentPage"){this.selectionService.deselectAllRowNodes({source,justCurrentPage:!0})}showLoadingOverlay(){this.overlayService.showLoadingOverlay()}showNoRowsOverlay(){this.overlayService.showNoRowsOverlay()}hideOverlay(){this.overlayService.hideOverlay()}getSelectedNodes(){return this.selectionService.getSelectedNodes()}getSelectedRows(){return this.selectionService.getSelectedRows()}getBestCostNodeSelection(){if(!missing(this.clientSideRowModel))return this.selectionService.getBestCostNodeSelection();this.logMissingRowModel("getBestCostNodeSelection","clientSide")}getRenderedNodes(){return this.rowRenderer.getRenderedNodes()}ensureColumnVisible(key,position="auto"){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureColumnVisible(key,position),"ensureVisible")}ensureIndexVisible(index,position){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureIndexVisible(index,position),"ensureVisible")}ensureNodeVisible(nodeSelector,position=null){this.frameworkOverrides.wrapIncoming(()=>this.gridBodyCtrl.getScrollFeature().ensureNodeVisible(nodeSelector,position),"ensureVisible")}forEachLeafNode(callback){missing(this.clientSideRowModel)?this.logMissingRowModel("forEachLeafNode","clientSide"):this.clientSideRowModel.forEachLeafNode(callback)}forEachNode(callback,includeFooterNodes){this.rowModel.forEachNode(callback,includeFooterNodes)}forEachNodeAfterFilter(callback){missing(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilter","clientSide"):this.clientSideRowModel.forEachNodeAfterFilter(callback)}forEachNodeAfterFilterAndSort(callback){missing(this.clientSideRowModel)?this.logMissingRowModel("forEachNodeAfterFilterAndSort","clientSide"):this.clientSideRowModel.forEachNodeAfterFilterAndSort(callback)}getFilterInstance(key,callback){return warnOnce("'getFilterInstance' is deprecated. To get/set individual filter models, use 'getColumnFilterModel' or 'setColumnFilterModel' instead. To get hold of the filter instance, use 'getColumnFilterInstance' which returns the instance asynchronously."),this.filterManager.getFilterInstance(key,callback)}getColumnFilterInstance(key){return this.filterManager.getColumnFilterInstance(key)}destroyFilter(key){const column=this.columnModel.getPrimaryColumn(key);if(column)return this.filterManager.destroyFilter(column,"api")}getStatusPanel(key){if(!ModuleRegistry.__assertRegistered("@ag-grid-enterprise/status-bar","api.getStatusPanel",this.context.getGridId()))return;return unwrapUserComp(this.statusBarService.getStatusPanel(key))}getColumnDef(key){const column=this.columnModel.getPrimaryColumn(key);return column?column.getColDef():null}getColumnDefs(){return this.columnModel.getColumnDefs()}onFilterChanged(source="api"){this.filterManager.onFilterChanged({source})}onSortChanged(){this.sortController.onSortChanged("api")}setFilterModel(model){this.frameworkOverrides.wrapIncoming(()=>this.filterManager.setFilterModel(model))}getFilterModel(){return this.filterManager.getFilterModel()}getColumnFilterModel(column){return this.filterManager.getColumnFilterModel(column)}setColumnFilterModel(column,model){return this.filterManager.setColumnFilterModel(column,model)}getFocusedCell(){return this.focusService.getFocusedCell()}clearFocusedCell(){return this.focusService.clearFocusedCell()}setFocusedCell(rowIndex,colKey,rowPinned){this.focusService.setFocusedCell({rowIndex,column:colKey,rowPinned,forceBrowserFocus:!0})}addRowDropZone(params){this.gridBodyCtrl.getRowDragFeature().addRowDropZone(params)}removeRowDropZone(params){const activeDropTarget=this.dragAndDropService.findExternalZone(params);activeDropTarget&&this.dragAndDropService.removeDropTarget(activeDropTarget)}getRowDropZoneParams(events){return this.gridBodyCtrl.getRowDragFeature().getRowDropZone(events)}assertSideBarLoaded(apiMethod){return ModuleRegistry.__assertRegistered("@ag-grid-enterprise/side-bar","api."+apiMethod,this.context.getGridId())}isSideBarVisible(){return this.assertSideBarLoaded("isSideBarVisible")&&this.sideBarService.getSideBarComp().isDisplayed()}setSideBarVisible(show){this.assertSideBarLoaded("setSideBarVisible")&&this.sideBarService.getSideBarComp().setDisplayed(show)}setSideBarPosition(position){this.assertSideBarLoaded("setSideBarPosition")&&this.sideBarService.getSideBarComp().setSideBarPosition(position)}openToolPanel(key){this.assertSideBarLoaded("openToolPanel")&&this.sideBarService.getSideBarComp().openToolPanel(key,"api")}closeToolPanel(){this.assertSideBarLoaded("closeToolPanel")&&this.sideBarService.getSideBarComp().close("api")}getOpenedToolPanel(){return this.assertSideBarLoaded("getOpenedToolPanel")?this.sideBarService.getSideBarComp().openedItem():null}refreshToolPanel(){this.assertSideBarLoaded("refreshToolPanel")&&this.sideBarService.getSideBarComp().refresh()}isToolPanelShowing(){return this.assertSideBarLoaded("isToolPanelShowing")&&this.sideBarService.getSideBarComp().isToolPanelShowing()}getToolPanelInstance(id){if(this.assertSideBarLoaded("getToolPanelInstance")){return unwrapUserComp(this.sideBarService.getSideBarComp().getToolPanelInstance(id))}}getSideBar(){if(this.assertSideBarLoaded("getSideBar"))return this.sideBarService.getSideBarComp().getDef()}resetRowHeights(){if(exists(this.clientSideRowModel)){if(this.columnModel.isAutoRowHeightActive())return void console.warn("AG Grid: calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.");this.clientSideRowModel.resetRowHeights()}}setRowCount(rowCount,maxRowFound){if(this.serverSideRowModel)return this.columnModel.isRowGroupEmpty()?void this.serverSideRowModel.setRowCount(rowCount,maxRowFound):void console.error("AG Grid: setRowCount cannot be used while using row grouping.");this.infiniteRowModel?this.infiniteRowModel.setRowCount(rowCount,maxRowFound):this.logMissingRowModel("setRowCount","infinite","serverSide")}onRowHeightChanged(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()}getValue(colKey,rowNode){return this.logDeprecation("31.3","getValue","getCellValue"),this.getCellValue({colKey,rowNode})}getCellValue(params){var _a;const{colKey,rowNode,useFormatter}=params;let column=null!=(_a=this.columnModel.getPrimaryColumn(colKey))?_a:this.columnModel.getGridColumn(colKey);if(missing(column))return null;const value=this.valueService.getValue(column,rowNode);if(useFormatter){const formattedValue=this.valueService.formatValue(column,rowNode,value);return null!=formattedValue?formattedValue:escapeString(value,!0)}return value}addEventListener(eventType,listener){this.apiEventService.addEventListener(eventType,listener)}addGlobalListener(listener){this.apiEventService.addGlobalListener(listener)}removeEventListener(eventType,listener){this.apiEventService.removeEventListener(eventType,listener)}removeGlobalListener(listener){this.apiEventService.removeGlobalListener(listener)}dispatchEvent(event){this.eventService.dispatchEvent(event)}destroy(){var _a;const preDestroyLink=`See ${this.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}`;if(this.destroyCalled)return;const event={type:Events.EVENT_GRID_PRE_DESTROYED,state:this.getState()};this.dispatchEvent(event),this.destroyCalled=!0,null==(_a=this.ctrlsService.get("gridCtrl"))||_a.destroyGridUi(),this.context.destroy(),this.detailGridInfoMap={},removeAllReferences(this,["isDestroyed"],preDestroyLink)}isDestroyed(){return this.destroyCalled}resetQuickFilter(){this.filterManager.resetQuickFilterCache()}getCellRanges(){return this.rangeService?this.rangeService.getCellRanges():(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/range-selection","api.getCellRanges",this.context.getGridId()),null)}addCellRange(params){this.rangeService?this.rangeService.addCellRange(params):ModuleRegistry.__assertRegistered("@ag-grid-enterprise/range-selection","api.addCellRange",this.context.getGridId())}clearRangeSelection(){this.rangeService&&this.rangeService.removeAllCellRanges(),ModuleRegistry.__assertRegistered("@ag-grid-enterprise/range-selection","gridApi.clearRangeSelection",this.context.getGridId())}undoCellEditing(){this.undoRedoService.undo("api")}redoCellEditing(){this.undoRedoService.redo("api")}getCurrentUndoSize(){return this.undoRedoService.getCurrentUndoStackSize()}getCurrentRedoSize(){return this.undoRedoService.getCurrentRedoStackSize()}assertChart(methodName,func){if(ModuleRegistry.__assertRegistered("@ag-grid-enterprise/charts","api."+methodName,this.context.getGridId()))return this.frameworkOverrides.wrapIncoming(()=>func())}getChartModels(){return this.assertChart("getChartModels",()=>this.chartService.getChartModels())}getChartRef(chartId){return this.assertChart("getChartRef",()=>this.chartService.getChartRef(chartId))}getChartImageDataURL(params){return this.assertChart("getChartImageDataURL",()=>this.chartService.getChartImageDataURL(params))}downloadChart(params){return this.assertChart("downloadChart",()=>this.chartService.downloadChart(params))}openChartToolPanel(params){return this.assertChart("openChartToolPanel",()=>this.chartService.openChartToolPanel(params))}closeChartToolPanel(params){return this.assertChart("closeChartToolPanel",()=>this.chartService.closeChartToolPanel(params.chartId))}createRangeChart(params){return this.assertChart("createRangeChart",()=>this.chartService.createRangeChart(params))}createPivotChart(params){return this.assertChart("createPivotChart",()=>this.chartService.createPivotChart(params))}createCrossFilterChart(params){return this.assertChart("createCrossFilterChart",()=>this.chartService.createCrossFilterChart(params))}updateChart(params){return this.assertChart("updateChart",()=>this.chartService.updateChart(params))}restoreChart(chartModel,chartContainer){return this.assertChart("restoreChart",()=>this.chartService.restoreChart(chartModel,chartContainer))}assertClipboard(methodName,func){ModuleRegistry.__assertRegistered("@ag-grid-enterprise/clipboard","api"+methodName,this.context.getGridId())&&func()}copyToClipboard(params){this.assertClipboard("copyToClipboard",()=>this.clipboardService.copyToClipboard(params))}cutToClipboard(params){this.assertClipboard("cutToClipboard",()=>this.clipboardService.cutToClipboard(params))}copySelectedRowsToClipboard(params){this.assertClipboard("copySelectedRowsToClipboard",()=>this.clipboardService.copySelectedRowsToClipboard(params))}copySelectedRangeToClipboard(params){this.assertClipboard("copySelectedRangeToClipboard",()=>this.clipboardService.copySelectedRangeToClipboard(params))}copySelectedRangeDown(){this.assertClipboard("copySelectedRangeDown",()=>this.clipboardService.copyRangeDown())}pasteFromClipboard(){this.assertClipboard("pasteFromClipboard",()=>this.clipboardService.pasteFromClipboard())}showColumnMenuAfterButtonClick(colKey,buttonElement){warnOnce("'showColumnMenuAfterButtonClick' is deprecated. Use 'IHeaderParams.showColumnMenu' within a header component, or 'api.showColumnMenu' elsewhere.");const column=this.columnModel.getGridColumn(colKey);this.menuService.showColumnMenu({column,buttonElement,positionBy:"button"})}showColumnMenuAfterMouseClick(colKey,mouseEvent){warnOnce("'showColumnMenuAfterMouseClick' is deprecated. Use 'IHeaderParams.showColumnMenuAfterMouseClick' within a header component, or 'api.showColumnMenu' elsewhere.");let column=this.columnModel.getGridColumn(colKey);column||(column=this.columnModel.getPrimaryColumn(colKey)),column?this.menuService.showColumnMenu({column,mouseEvent,positionBy:"mouse"}):console.error(`AG Grid: column '${colKey}' not found`)}showContextMenu(params){const{rowNode,column,value,x,y}=params||{};let{x:clientX,y:clientY}=this.menuService.getContextMenuPosition(rowNode,column);null!=x&&(clientX=x),null!=y&&(clientY=y),this.menuService.showContextMenu({mouseEvent:new MouseEvent("mousedown",{clientX,clientY}),rowNode,column,value})}showColumnChooser(params){this.menuService.showColumnChooser({chooserParams:params})}showColumnFilter(colKey){const column=this.columnModel.getGridColumn(colKey);column?this.menuService.showFilterMenu({column,containerType:"columnFilter",positionBy:"auto"}):console.error(`AG Grid: column '${colKey}' not found`)}showColumnMenu(colKey){const column=this.columnModel.getGridColumn(colKey);column?this.menuService.showColumnMenu({column,positionBy:"auto"}):console.error(`AG Grid: column '${colKey}' not found`)}hidePopupMenu(){this.menuService.hidePopupMenu()}hideColumnChooser(){this.menuService.hideColumnChooser()}tabToNextCell(event){return this.navigationService.tabToNextCell(!1,event)}tabToPreviousCell(event){return this.navigationService.tabToNextCell(!0,event)}getCellRendererInstances(params={}){return this.rowRenderer.getCellRendererInstances(params).map(unwrapUserComp)}getCellEditorInstances(params={}){return this.rowRenderer.getCellEditorInstances(params).map(unwrapUserComp)}getEditingCells(){return this.rowRenderer.getEditingCells()}stopEditing(cancel=!1){this.rowRenderer.stopEditing(cancel)}startEditingCell(params){const column=this.columnModel.getGridColumn(params.colKey);if(!column)return void console.warn(`AG Grid: no column found for ${params.colKey}`);const cellPosition={rowIndex:params.rowIndex,rowPinned:params.rowPinned||null,column};null==params.rowPinned&&this.ensureIndexVisible(params.rowIndex),this.ensureColumnVisible(params.colKey);const cell=this.navigationService.getCellByPosition(cellPosition);cell&&(this.focusService.isCellFocused(cellPosition)||this.focusService.setFocusedCell(cellPosition),cell.startRowOrCellEdit(params.key))}addAggFunc(key,aggFunc){this.logDeprecation("v31.1","addAggFunc(key, func)","addAggFuncs({ key: func })"),this.aggFuncService&&this.aggFuncService.addAggFuncs({key:aggFunc})}addAggFuncs(aggFuncs){this.aggFuncService&&this.aggFuncService.addAggFuncs(aggFuncs)}clearAggFuncs(){this.aggFuncService&&this.aggFuncService.clear()}applyServerSideTransaction(transaction){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(transaction);this.logMissingRowModel("applyServerSideTransaction","serverSide")}applyServerSideTransactionAsync(transaction,callback){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(transaction,callback);this.logMissingRowModel("applyServerSideTransactionAsync","serverSide")}applyServerSideRowData(params){var _a,_b;const startRow=null!=(_a=params.startRow)?_a:0,route=null!=(_b=params.route)?_b:[];startRow<0?console.warn(`AG Grid: invalid value ${params.startRow} for startRow, the value should be >= 0`):this.serverSideRowModel?this.serverSideRowModel.applyRowData(params.successParams,startRow,route):this.logMissingRowModel("setServerSideDatasource","serverSide")}retryServerSideLoads(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():this.logMissingRowModel("retryServerSideLoads","serverSide")}flushServerSideAsyncTransactions(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();this.logMissingRowModel("flushServerSideAsyncTransactions","serverSide")}applyTransaction(rowDataTransaction){if(this.clientSideRowModel)return this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.updateRowData(rowDataTransaction));this.logMissingRowModel("applyTransaction","clientSide")}applyTransactionAsync(rowDataTransaction,callback){this.clientSideRowModel?this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.batchUpdateRowData(rowDataTransaction,callback)):this.logMissingRowModel("applyTransactionAsync","clientSide")}flushAsyncTransactions(){this.clientSideRowModel?this.frameworkOverrides.wrapIncoming(()=>this.clientSideRowModel.flushAsyncTransactions()):this.logMissingRowModel("flushAsyncTransactions","clientSide")}refreshInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():this.logMissingRowModel("refreshInfiniteCache","infinite")}purgeInfiniteCache(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():this.logMissingRowModel("purgeInfiniteCache","infinite")}refreshServerSide(params){this.serverSideRowModel?this.serverSideRowModel.refreshStore(params):this.logMissingRowModel("refreshServerSide","serverSide")}getServerSideGroupLevelState(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(this.logMissingRowModel("getServerSideGroupLevelState","serverSide"),[])}getInfiniteRowCount(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();this.logMissingRowModel("getInfiniteRowCount","infinite")}isLastRowIndexKnown(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();this.logMissingRowModel("isLastRowIndexKnown","infinite")}getCacheBlockState(){return this.rowNodeBlockLoader.getBlockState()}getFirstDisplayedRow(){return this.logDeprecation("v31.1","getFirstDisplayedRow","getFirstDisplayedRowIndex"),this.getFirstDisplayedRowIndex()}getFirstDisplayedRowIndex(){return this.rowRenderer.getFirstVirtualRenderedRow()}getLastDisplayedRow(){return this.logDeprecation("v31.1","getLastDisplayedRow","getLastDisplayedRowIndex"),this.getLastDisplayedRowIndex()}getLastDisplayedRowIndex(){return this.rowRenderer.getLastVirtualRenderedRow()}getDisplayedRowAtIndex(index){return this.rowModel.getRow(index)}getDisplayedRowCount(){return this.rowModel.getRowCount()}paginationIsLastPageFound(){return this.paginationProxy.isLastPageFound()}paginationGetPageSize(){return this.paginationProxy.getPageSize()}paginationGetCurrentPage(){return this.paginationProxy.getCurrentPage()}paginationGetTotalPages(){return this.paginationProxy.getTotalPages()}paginationGetRowCount(){return this.paginationProxy.getMasterRowCount()}paginationGoToNextPage(){this.paginationProxy.goToNextPage()}paginationGoToPreviousPage(){this.paginationProxy.goToPreviousPage()}paginationGoToFirstPage(){this.paginationProxy.goToFirstPage()}paginationGoToLastPage(){this.paginationProxy.goToLastPage()}paginationGoToPage(page){this.paginationProxy.goToPage(page)}sizeColumnsToFit(paramsOrGridWidth){"number"==typeof paramsOrGridWidth?this.columnModel.sizeColumnsToFit(paramsOrGridWidth,"api"):this.gridBodyCtrl.sizeColumnsToFit(paramsOrGridWidth)}setColumnGroupOpened(group,newValue){this.columnModel.setColumnGroupOpened(group,newValue,"api")}getColumnGroup(name,instanceId){return this.columnModel.getColumnGroup(name,instanceId)}getProvidedColumnGroup(name){return this.columnModel.getProvidedColumnGroup(name)}getDisplayNameForColumn(column,location){return this.columnModel.getDisplayNameForColumn(column,location)||""}getDisplayNameForColumnGroup(columnGroup,location){return this.columnModel.getDisplayNameForColumnGroup(columnGroup,location)||""}getColumn(key){return this.columnModel.getPrimaryColumn(key)}getColumns(){return this.columnModel.getAllPrimaryColumns()}applyColumnState(params){return this.columnModel.applyColumnState(params,"api")}getColumnState(){return this.columnModel.getColumnState()}resetColumnState(){this.columnModel.resetColumnState("api")}getColumnGroupState(){return this.columnModel.getColumnGroupState()}setColumnGroupState(stateItems){this.columnModel.setColumnGroupState(stateItems,"api")}resetColumnGroupState(){this.columnModel.resetColumnGroupState("api")}isPinning(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()}isPinningLeft(){return this.columnModel.isPinningLeft()}isPinningRight(){return this.columnModel.isPinningRight()}getDisplayedColAfter(col){return this.columnModel.getDisplayedColAfter(col)}getDisplayedColBefore(col){return this.columnModel.getDisplayedColBefore(col)}setColumnVisible(key,visible){this.logDeprecation("v31.1","setColumnVisible(key,visible)","setColumnsVisible([key],visible)"),this.columnModel.setColumnsVisible([key],visible,"api")}setColumnsVisible(keys2,visible){this.columnModel.setColumnsVisible(keys2,visible,"api")}setColumnPinned(key,pinned){this.logDeprecation("v31.1","setColumnPinned(key,pinned)","setColumnsPinned([key],pinned)"),this.columnModel.setColumnsPinned([key],pinned,"api")}setColumnsPinned(keys2,pinned){this.columnModel.setColumnsPinned(keys2,pinned,"api")}getAllGridColumns(){return this.columnModel.getAllGridColumns()}getDisplayedLeftColumns(){return this.columnModel.getDisplayedLeftColumns()}getDisplayedCenterColumns(){return this.columnModel.getDisplayedCenterColumns()}getDisplayedRightColumns(){return this.columnModel.getDisplayedRightColumns()}getAllDisplayedColumns(){return this.columnModel.getAllDisplayedColumns()}getAllDisplayedVirtualColumns(){return this.columnModel.getViewportColumns()}moveColumn(key,toIndex){this.logDeprecation("v31.1","moveColumn(key, toIndex)","moveColumns([key], toIndex)"),this.columnModel.moveColumns([key],toIndex,"api")}moveColumnByIndex(fromIndex,toIndex){this.columnModel.moveColumnByIndex(fromIndex,toIndex,"api")}moveColumns(columnsToMoveKeys,toIndex){this.columnModel.moveColumns(columnsToMoveKeys,toIndex,"api")}moveRowGroupColumn(fromIndex,toIndex){this.columnModel.moveRowGroupColumn(fromIndex,toIndex,"api")}setColumnAggFunc(key,aggFunc){this.columnModel.setColumnAggFunc(key,aggFunc,"api")}setColumnWidth(key,newWidth,finished=!0,source="api"){this.logDeprecation("v31.1","setColumnWidth(col, width)","setColumnWidths([{key: col, newWidth: width}])"),this.columnModel.setColumnWidths([{key,newWidth}],!1,finished,source)}setColumnWidths(columnWidths,finished=!0,source="api"){this.columnModel.setColumnWidths(columnWidths,!1,finished,source)}isPivotMode(){return this.columnModel.isPivotMode()}getPivotResultColumn(pivotKeys,valueColKey){return this.columnModel.getSecondaryPivotColumn(pivotKeys,valueColKey)}setValueColumns(colKeys){this.columnModel.setValueColumns(colKeys,"api")}getValueColumns(){return this.columnModel.getValueColumns()}removeValueColumn(colKey){this.logDeprecation("v31.1","removeValueColumn(colKey)","removeValueColumns([colKey])"),this.columnModel.removeValueColumns([colKey],"api")}removeValueColumns(colKeys){this.columnModel.removeValueColumns(colKeys,"api")}addValueColumn(colKey){this.logDeprecation("v31.1","addValueColumn(colKey)","addValueColumns([colKey])"),this.columnModel.addValueColumns([colKey],"api")}addValueColumns(colKeys){this.columnModel.addValueColumns(colKeys,"api")}setRowGroupColumns(colKeys){this.columnModel.setRowGroupColumns(colKeys,"api")}removeRowGroupColumn(colKey){this.logDeprecation("v31.1","removeRowGroupColumn(colKey)","removeRowGroupColumns([colKey])"),this.columnModel.removeRowGroupColumns([colKey],"api")}removeRowGroupColumns(colKeys){this.columnModel.removeRowGroupColumns(colKeys,"api")}addRowGroupColumn(colKey){this.logDeprecation("v31.1","addRowGroupColumn(colKey)","addRowGroupColumns([colKey])"),this.columnModel.addRowGroupColumns([colKey],"api")}addRowGroupColumns(colKeys){this.columnModel.addRowGroupColumns(colKeys,"api")}getRowGroupColumns(){return this.columnModel.getRowGroupColumns()}setPivotColumns(colKeys){this.columnModel.setPivotColumns(colKeys,"api")}removePivotColumn(colKey){this.logDeprecation("v31.1","removePivotColumn(colKey)","removePivotColumns([colKey])"),this.columnModel.removePivotColumns([colKey],"api")}removePivotColumns(colKeys){this.columnModel.removePivotColumns(colKeys,"api")}addPivotColumn(colKey){this.logDeprecation("v31.1","addPivotColumn(colKey)","addPivotColumns([colKey])"),this.columnModel.addPivotColumns([colKey],"api")}addPivotColumns(colKeys){this.columnModel.addPivotColumns(colKeys,"api")}getPivotColumns(){return this.columnModel.getPivotColumns()}getLeftDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeLeft()}getCenterDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeCentre()}getRightDisplayedColumnGroups(){return this.columnModel.getDisplayedTreeRight()}getAllDisplayedColumnGroups(){return this.columnModel.getAllDisplayedTrees()}autoSizeColumn(key,skipHeader){return this.logDeprecation("v31.1","autoSizeColumn(key, skipHeader)","autoSizeColumns([key], skipHeader)"),this.columnModel.autoSizeColumns({columns:[key],skipHeader,source:"api"})}autoSizeColumns(keys2,skipHeader){this.columnModel.autoSizeColumns({columns:keys2,skipHeader,source:"api"})}autoSizeAllColumns(skipHeader){this.columnModel.autoSizeAllColumns("api",skipHeader)}setPivotResultColumns(colDefs){this.columnModel.setSecondaryColumns(colDefs,"api")}getPivotResultColumns(){return this.columnModel.getSecondaryColumns()}getState(){return this.stateService.getState()}getGridOption(key){return this.gos.get(key)}setGridOption(key,value){this.updateGridOptions({[key]:value})}updateGridOptions(options){this.gos.updateGridOptions({options})}__internalUpdateGridOptions(options,force){this.gos.updateGridOptions({options,force,source:"gridOptionsUpdated"})}deprecatedUpdateGridOption(key,value){warnOnce(`set${key.charAt(0).toUpperCase()}${key.slice(1,key.length)} is deprecated. Please use 'api.setGridOption('${key}', newValue)' or 'api.updateGridOptions({ ${key}: newValue })' instead.`),this.setGridOption(key,value)}setPivotMode(pivotMode){this.deprecatedUpdateGridOption("pivotMode",pivotMode)}setPinnedTopRowData(rows){this.deprecatedUpdateGridOption("pinnedTopRowData",rows)}setPinnedBottomRowData(rows){this.deprecatedUpdateGridOption("pinnedBottomRowData",rows)}setPopupParent(ePopupParent){this.deprecatedUpdateGridOption("popupParent",ePopupParent)}setSuppressModelUpdateAfterUpdateTransaction(value){this.deprecatedUpdateGridOption("suppressModelUpdateAfterUpdateTransaction",value)}setDataTypeDefinitions(dataTypeDefinitions){this.deprecatedUpdateGridOption("dataTypeDefinitions",dataTypeDefinitions)}setPagination(value){this.deprecatedUpdateGridOption("pagination",value)}paginationSetPageSize(size){this.deprecatedUpdateGridOption("paginationPageSize",size)}setSideBar(def){this.deprecatedUpdateGridOption("sideBar",def)}setSuppressClipboardPaste(value){this.deprecatedUpdateGridOption("suppressClipboardPaste",value)}setGroupRemoveSingleChildren(value){this.deprecatedUpdateGridOption("groupRemoveSingleChildren",value)}setGroupRemoveLowestSingleChildren(value){this.deprecatedUpdateGridOption("groupRemoveLowestSingleChildren",value)}setGroupDisplayType(value){this.deprecatedUpdateGridOption("groupDisplayType",value)}setGroupIncludeFooter(value){this.deprecatedUpdateGridOption("groupIncludeFooter",value)}setGroupIncludeTotalFooter(value){this.deprecatedUpdateGridOption("groupIncludeTotalFooter",value)}setRowClass(className){this.deprecatedUpdateGridOption("rowClass",className)}setDeltaSort(enable){this.deprecatedUpdateGridOption("deltaSort",enable)}setSuppressRowDrag(value){this.deprecatedUpdateGridOption("suppressRowDrag",value)}setSuppressMoveWhenRowDragging(value){this.deprecatedUpdateGridOption("suppressMoveWhenRowDragging",value)}setSuppressRowClickSelection(value){this.deprecatedUpdateGridOption("suppressRowClickSelection",value)}setEnableAdvancedFilter(enabled){this.deprecatedUpdateGridOption("enableAdvancedFilter",enabled)}setIncludeHiddenColumnsInAdvancedFilter(value){this.deprecatedUpdateGridOption("includeHiddenColumnsInAdvancedFilter",value)}setAdvancedFilterParent(advancedFilterParent){this.deprecatedUpdateGridOption("advancedFilterParent",advancedFilterParent)}setAdvancedFilterBuilderParams(params){this.deprecatedUpdateGridOption("advancedFilterBuilderParams",params)}setQuickFilter(newFilter){warnOnce("setQuickFilter is deprecated. Please use 'api.setGridOption('quickFilterText', newValue)' or 'api.updateGridOptions({ quickFilterText: newValue })' instead."),this.gos.updateGridOptions({options:{quickFilterText:newFilter}})}setExcludeHiddenColumnsFromQuickFilter(value){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",!value)}setIncludeHiddenColumnsInQuickFilter(value){this.deprecatedUpdateGridOption("includeHiddenColumnsInQuickFilter",value)}setQuickFilterParser(quickFilterParser){this.deprecatedUpdateGridOption("quickFilterParser",quickFilterParser)}setQuickFilterMatcher(quickFilterMatcher){this.deprecatedUpdateGridOption("quickFilterMatcher",quickFilterMatcher)}setAlwaysShowHorizontalScroll(show){this.deprecatedUpdateGridOption("alwaysShowHorizontalScroll",show)}setAlwaysShowVerticalScroll(show){this.deprecatedUpdateGridOption("alwaysShowVerticalScroll",show)}setFunctionsReadOnly(readOnly){this.deprecatedUpdateGridOption("functionsReadOnly",readOnly)}setColumnDefs(colDefs,source="api"){warnOnce("setColumnDefs is deprecated. Please use 'api.setGridOption('columnDefs', newValue)' or 'api.updateGridOptions({ columnDefs: newValue })' instead."),this.gos.updateGridOptions({options:{columnDefs:colDefs},source})}setAutoGroupColumnDef(colDef,source="api"){warnOnce("setAutoGroupColumnDef is deprecated. Please use 'api.setGridOption('autoGroupColumnDef', newValue)' or 'api.updateGridOptions({ autoGroupColumnDef: newValue })' instead."),this.gos.updateGridOptions({options:{autoGroupColumnDef:colDef},source})}setDefaultColDef(colDef,source="api"){warnOnce("setDefaultColDef is deprecated. Please use 'api.setGridOption('defaultColDef', newValue)' or 'api.updateGridOptions({ defaultColDef: newValue })' instead."),this.gos.updateGridOptions({options:{defaultColDef:colDef},source})}setColumnTypes(columnTypes,source="api"){warnOnce("setColumnTypes is deprecated. Please use 'api.setGridOption('columnTypes', newValue)' or 'api.updateGridOptions({ columnTypes: newValue })' instead."),this.gos.updateGridOptions({options:{columnTypes},source})}setTreeData(newTreeData){this.deprecatedUpdateGridOption("treeData",newTreeData)}setServerSideDatasource(datasource){this.deprecatedUpdateGridOption("serverSideDatasource",datasource)}setCacheBlockSize(blockSize){this.deprecatedUpdateGridOption("cacheBlockSize",blockSize)}setDatasource(datasource){this.deprecatedUpdateGridOption("datasource",datasource)}setViewportDatasource(viewportDatasource){this.deprecatedUpdateGridOption("viewportDatasource",viewportDatasource)}setRowData(rowData){this.deprecatedUpdateGridOption("rowData",rowData)}setEnableCellTextSelection(selectable){this.deprecatedUpdateGridOption("enableCellTextSelection",selectable)}setHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("headerHeight",headerHeight)}setDomLayout(domLayout){this.deprecatedUpdateGridOption("domLayout",domLayout)}setFillHandleDirection(direction){this.deprecatedUpdateGridOption("fillHandleDirection",direction)}setGroupHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("groupHeaderHeight",headerHeight)}setFloatingFiltersHeight(headerHeight){this.deprecatedUpdateGridOption("floatingFiltersHeight",headerHeight)}setPivotHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("pivotHeaderHeight",headerHeight)}setPivotGroupHeaderHeight(headerHeight){this.deprecatedUpdateGridOption("pivotGroupHeaderHeight",headerHeight)}setAnimateRows(animateRows){this.deprecatedUpdateGridOption("animateRows",animateRows)}setIsExternalFilterPresent(isExternalFilterPresentFunc){this.deprecatedUpdateGridOption("isExternalFilterPresent",isExternalFilterPresentFunc)}setDoesExternalFilterPass(doesExternalFilterPassFunc){this.deprecatedUpdateGridOption("doesExternalFilterPass",doesExternalFilterPassFunc)}setNavigateToNextCell(navigateToNextCellFunc){this.deprecatedUpdateGridOption("navigateToNextCell",navigateToNextCellFunc)}setTabToNextCell(tabToNextCellFunc){this.deprecatedUpdateGridOption("tabToNextCell",tabToNextCellFunc)}setTabToNextHeader(tabToNextHeaderFunc){this.deprecatedUpdateGridOption("tabToNextHeader",tabToNextHeaderFunc)}setNavigateToNextHeader(navigateToNextHeaderFunc){this.deprecatedUpdateGridOption("navigateToNextHeader",navigateToNextHeaderFunc)}setRowGroupPanelShow(rowGroupPanelShow){this.deprecatedUpdateGridOption("rowGroupPanelShow",rowGroupPanelShow)}setGetGroupRowAgg(getGroupRowAggFunc){this.deprecatedUpdateGridOption("getGroupRowAgg",getGroupRowAggFunc)}setGetBusinessKeyForNode(getBusinessKeyForNodeFunc){this.deprecatedUpdateGridOption("getBusinessKeyForNode",getBusinessKeyForNodeFunc)}setGetChildCount(getChildCountFunc){this.deprecatedUpdateGridOption("getChildCount",getChildCountFunc)}setProcessRowPostCreate(processRowPostCreateFunc){this.deprecatedUpdateGridOption("processRowPostCreate",processRowPostCreateFunc)}setGetRowId(getRowIdFunc){warnOnce("getRowId is a static property and can no longer be updated.")}setGetRowClass(rowClassFunc){this.deprecatedUpdateGridOption("getRowClass",rowClassFunc)}setIsFullWidthRow(isFullWidthRowFunc){this.deprecatedUpdateGridOption("isFullWidthRow",isFullWidthRowFunc)}setIsRowSelectable(isRowSelectableFunc){this.deprecatedUpdateGridOption("isRowSelectable",isRowSelectableFunc)}setIsRowMaster(isRowMasterFunc){this.deprecatedUpdateGridOption("isRowMaster",isRowMasterFunc)}setPostSortRows(postSortRowsFunc){this.deprecatedUpdateGridOption("postSortRows",postSortRowsFunc)}setGetDocument(getDocumentFunc){this.deprecatedUpdateGridOption("getDocument",getDocumentFunc)}setGetContextMenuItems(getContextMenuItemsFunc){this.deprecatedUpdateGridOption("getContextMenuItems",getContextMenuItemsFunc)}setGetMainMenuItems(getMainMenuItemsFunc){this.deprecatedUpdateGridOption("getMainMenuItems",getMainMenuItemsFunc)}setProcessCellForClipboard(processCellForClipboardFunc){this.deprecatedUpdateGridOption("processCellForClipboard",processCellForClipboardFunc)}setSendToClipboard(sendToClipboardFunc){this.deprecatedUpdateGridOption("sendToClipboard",sendToClipboardFunc)}setProcessCellFromClipboard(processCellFromClipboardFunc){this.deprecatedUpdateGridOption("processCellFromClipboard",processCellFromClipboardFunc)}setProcessPivotResultColDef(processPivotResultColDefFunc){this.deprecatedUpdateGridOption("processPivotResultColDef",processPivotResultColDefFunc)}setProcessPivotResultColGroupDef(processPivotResultColGroupDefFunc){this.deprecatedUpdateGridOption("processPivotResultColGroupDef",processPivotResultColGroupDefFunc)}setPostProcessPopup(postProcessPopupFunc){this.deprecatedUpdateGridOption("postProcessPopup",postProcessPopupFunc)}setInitialGroupOrderComparator(initialGroupOrderComparatorFunc){this.deprecatedUpdateGridOption("initialGroupOrderComparator",initialGroupOrderComparatorFunc)}setGetChartToolbarItems(getChartToolbarItemsFunc){this.deprecatedUpdateGridOption("getChartToolbarItems",getChartToolbarItemsFunc)}setPaginationNumberFormatter(paginationNumberFormatterFunc){this.deprecatedUpdateGridOption("paginationNumberFormatter",paginationNumberFormatterFunc)}setGetServerSideGroupLevelParams(getServerSideGroupLevelParamsFunc){this.deprecatedUpdateGridOption("getServerSideGroupLevelParams",getServerSideGroupLevelParamsFunc)}setIsServerSideGroupOpenByDefault(isServerSideGroupOpenByDefaultFunc){this.deprecatedUpdateGridOption("isServerSideGroupOpenByDefault",isServerSideGroupOpenByDefaultFunc)}setIsApplyServerSideTransaction(isApplyServerSideTransactionFunc){this.deprecatedUpdateGridOption("isApplyServerSideTransaction",isApplyServerSideTransactionFunc)}setIsServerSideGroup(isServerSideGroupFunc){this.deprecatedUpdateGridOption("isServerSideGroup",isServerSideGroupFunc)}setGetServerSideGroupKey(getServerSideGroupKeyFunc){this.deprecatedUpdateGridOption("getServerSideGroupKey",getServerSideGroupKeyFunc)}setGetRowStyle(rowStyleFunc){this.deprecatedUpdateGridOption("getRowStyle",rowStyleFunc)}setGetRowHeight(rowHeightFunc){this.deprecatedUpdateGridOption("getRowHeight",rowHeightFunc)}};__decorateClass([Autowired("rowRenderer")],GridApi.prototype,"rowRenderer",2),__decorateClass([Autowired("navigationService")],GridApi.prototype,"navigationService",2),__decorateClass([Autowired("filterManager")],GridApi.prototype,"filterManager",2),__decorateClass([Autowired("columnModel")],GridApi.prototype,"columnModel",2),__decorateClass([Autowired("selectionService")],GridApi.prototype,"selectionService",2),__decorateClass([Autowired("gridOptionsService")],GridApi.prototype,"gos",2),__decorateClass([Autowired("valueService")],GridApi.prototype,"valueService",2),__decorateClass([Autowired("alignedGridsService")],GridApi.prototype,"alignedGridsService",2),__decorateClass([Autowired("eventService")],GridApi.prototype,"eventService",2),__decorateClass([Autowired("pinnedRowModel")],GridApi.prototype,"pinnedRowModel",2),__decorateClass([Autowired("context")],GridApi.prototype,"context",2),__decorateClass([Autowired("rowModel")],GridApi.prototype,"rowModel",2),__decorateClass([Autowired("sortController")],GridApi.prototype,"sortController",2),__decorateClass([Autowired("paginationProxy")],GridApi.prototype,"paginationProxy",2),__decorateClass([Autowired("focusService")],GridApi.prototype,"focusService",2),__decorateClass([Autowired("dragAndDropService")],GridApi.prototype,"dragAndDropService",2),__decorateClass([Autowired("menuService")],GridApi.prototype,"menuService",2),__decorateClass([Autowired("valueCache")],GridApi.prototype,"valueCache",2),__decorateClass([Autowired("animationFrameService")],GridApi.prototype,"animationFrameService",2),__decorateClass([Autowired("ctrlsService")],GridApi.prototype,"ctrlsService",2),__decorateClass([Autowired("overlayService")],GridApi.prototype,"overlayService",2),__decorateClass([Autowired("stateService")],GridApi.prototype,"stateService",2),__decorateClass([Autowired("expansionService")],GridApi.prototype,"expansionService",2),__decorateClass([Autowired("apiEventService")],GridApi.prototype,"apiEventService",2),__decorateClass([Autowired("frameworkOverrides")],GridApi.prototype,"frameworkOverrides",2),__decorateClass([Autowired("undoRedoService")],GridApi.prototype,"undoRedoService",2),__decorateClass([Autowired("rowNodeBlockLoader")],GridApi.prototype,"rowNodeBlockLoader",2),__decorateClass([Optional("csvCreator")],GridApi.prototype,"csvCreator",2),__decorateClass([Optional("excelCreator")],GridApi.prototype,"excelCreator",2),__decorateClass([Optional("rangeService")],GridApi.prototype,"rangeService",2),__decorateClass([Optional("clipboardService")],GridApi.prototype,"clipboardService",2),__decorateClass([Optional("aggFuncService")],GridApi.prototype,"aggFuncService",2),__decorateClass([Optional("statusBarService")],GridApi.prototype,"statusBarService",2),__decorateClass([Optional("chartService")],GridApi.prototype,"chartService",2),__decorateClass([Optional("ssrmTransactionManager")],GridApi.prototype,"serverSideTransactionManager",2),__decorateClass([Optional("sideBarService")],GridApi.prototype,"sideBarService",2),__decorateClass([PostConstruct],GridApi.prototype,"init",1),GridApi=__decorateClass([Bean("gridApi")],GridApi);var QuickFilterService=class extends BeanStub{constructor(){super(...arguments),this.quickFilter=null,this.quickFilterParts=null}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.resetQuickFilterCache()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,()=>{this.gos.get("includeHiddenColumnsInQuickFilter")||this.resetQuickFilterCache()}),this.addManagedPropertyListener("quickFilterText",e=>this.setQuickFilter(e.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onQuickFilterColumnConfigChanged()),this.quickFilter=this.parseQuickFilter(this.gos.get("quickFilterText")),this.parser=this.gos.get("quickFilterParser"),this.matcher=this.gos.get("quickFilterMatcher"),this.setQuickFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setQuickFilterParserAndMatcher())}isQuickFilterPresent(){return null!==this.quickFilter}doesRowPassQuickFilter(node){const usingCache=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassQuickFilterMatcher(usingCache,node):this.quickFilterParts.every(part=>usingCache?this.doesRowPassQuickFilterCache(node,part):this.doesRowPassQuickFilterNoCache(node,part))}resetQuickFilterCache(){this.rowModel.forEachNode(node=>node.quickFilterAggregateText=null)}setQuickFilterParts(){const{quickFilter,parser}=this;this.quickFilterParts=quickFilter?parser?parser(quickFilter):quickFilter.split(" "):null}parseQuickFilter(newFilter){return exists(newFilter)?this.gos.isRowModelType("clientSide")?newFilter.toUpperCase():(console.warn("AG Grid - Quick filtering only works with the Client-Side Row Model"),null):null}setQuickFilter(newFilter){if(null!=newFilter&&"string"!=typeof newFilter)return void console.warn("AG Grid - Grid option quickFilterText only supports string inputs, received: "+typeof newFilter);const parsedFilter=this.parseQuickFilter(newFilter);this.quickFilter!==parsedFilter&&(this.quickFilter=parsedFilter,this.setQuickFilterParts(),this.dispatchEvent({type:QuickFilterService.EVENT_QUICK_FILTER_CHANGED}))}setQuickFilterParserAndMatcher(){const parser=this.gos.get("quickFilterParser"),matcher=this.gos.get("quickFilterMatcher"),hasChanged=parser!==this.parser||matcher!==this.matcher;this.parser=parser,this.matcher=matcher,hasChanged&&(this.setQuickFilterParts(),this.dispatchEvent({type:QuickFilterService.EVENT_QUICK_FILTER_CHANGED}))}onQuickFilterColumnConfigChanged(){this.columnModel.refreshQuickFilterColumns(),this.resetQuickFilterCache(),this.isQuickFilterPresent()&&this.dispatchEvent({type:QuickFilterService.EVENT_QUICK_FILTER_CHANGED})}doesRowPassQuickFilterNoCache(node,filterPart){return this.columnModel.getAllColumnsForQuickFilter().some(column=>{const part=this.getQuickFilterTextForColumn(column,node);return exists(part)&&part.indexOf(filterPart)>=0})}doesRowPassQuickFilterCache(node,filterPart){return this.checkGenerateQuickFilterAggregateText(node),node.quickFilterAggregateText.indexOf(filterPart)>=0}doesRowPassQuickFilterMatcher(usingCache,node){let quickFilterAggregateText;usingCache?(this.checkGenerateQuickFilterAggregateText(node),quickFilterAggregateText=node.quickFilterAggregateText):quickFilterAggregateText=this.getQuickFilterAggregateText(node);const{quickFilterParts,matcher}=this;return matcher(quickFilterParts,quickFilterAggregateText)}checkGenerateQuickFilterAggregateText(node){node.quickFilterAggregateText||(node.quickFilterAggregateText=this.getQuickFilterAggregateText(node))}getQuickFilterTextForColumn(column,node){let value=this.valueService.getValue(column,node,!0);const colDef=column.getColDef();if(colDef.getQuickFilterText){const params=this.gos.addGridCommonParams({value,node,data:node.data,column,colDef});value=colDef.getQuickFilterText(params)}return exists(value)?value.toString().toUpperCase():null}getQuickFilterAggregateText(node){const stringParts=[];return this.columnModel.getAllColumnsForQuickFilter().forEach(column=>{const part=this.getQuickFilterTextForColumn(column,node);exists(part)&&stringParts.push(part)}),stringParts.join(QuickFilterService.QUICK_FILTER_SEPARATOR)}};QuickFilterService.EVENT_QUICK_FILTER_CHANGED="quickFilterChanged",QuickFilterService.QUICK_FILTER_SEPARATOR="\n",__decorateClass([Autowired("valueService")],QuickFilterService.prototype,"valueService",2),__decorateClass([Autowired("columnModel")],QuickFilterService.prototype,"columnModel",2),__decorateClass([Autowired("rowModel")],QuickFilterService.prototype,"rowModel",2),__decorateClass([PostConstruct],QuickFilterService.prototype,"postConstruct",1),QuickFilterService=__decorateClass([Bean("quickFilterService")],QuickFilterService);var FilterManager=class extends BeanStub{constructor(){super(...arguments),this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue=[]}init(){var _a,_b,_c;this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,()=>this.onColumnsChanged()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.refreshFiltersForAggregations()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,()=>this.updateAdvancedFilterColumns()),this.addManagedListener(this.eventService,Events.EVENT_ROW_DATA_UPDATED,()=>this.onNewRowsLoaded("rowDataUpdated")),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.addManagedPropertyListener("advancedFilterModel",event=>this.setAdvancedFilterModel(event.currentValue)),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,({enabled})=>this.onAdvancedFilterEnabledChanged(enabled)),this.addManagedListener(this.eventService,Events.EVENT_DATA_TYPES_INFERRED,()=>this.processFilterModelUpdateQueue()),this.addManagedListener(this.quickFilterService,QuickFilterService.EVENT_QUICK_FILTER_CHANGED,()=>this.onFilterChanged({source:"quickFilter"})),this.initialFilterModel=__spreadValues({},null!=(_c=null==(_b=null==(_a=this.gos.get("initialState"))?void 0:_a.filter)?void 0:_b.filterModel)?_c:{})}isExternalFilterPresentCallback(){const isFilterPresent=this.gos.getCallback("isExternalFilterPresent");return"function"==typeof isFilterPresent&&isFilterPresent({})}doesExternalFilterPass(node){const doesFilterPass=this.gos.get("doesExternalFilterPass");return"function"==typeof doesFilterPass&&doesFilterPass(node)}setFilterModel(model,source="api"){if(this.isAdvancedFilterEnabled())return void this.warnAdvancedFilters();if(this.dataTypeService.isPendingInference())return void this.filterModelUpdateQueue.push({model,source});const allPromises=[],previousModel=this.getFilterModel();if(model){const modelKeys=convertToSet(Object.keys(model));this.allColumnFilters.forEach((filterWrapper,colId)=>{const newModel=model[colId];allPromises.push(this.setModelOnFilterWrapper(filterWrapper.filterPromise,newModel)),modelKeys.delete(colId)}),modelKeys.forEach(colId=>{const column=this.columnModel.getPrimaryColumn(colId)||this.columnModel.getGridColumn(colId);if(!column)return void console.warn("AG Grid: setFilterModel() - no column found for colId: "+colId);if(!column.isFilterAllowed())return void console.warn("AG Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+colId);const filterWrapper=this.getOrCreateFilterWrapper(column,"NO_UI");filterWrapper?allPromises.push(this.setModelOnFilterWrapper(filterWrapper.filterPromise,model[colId])):console.warn("AG-Grid: setFilterModel() - unable to fully apply model, unable to create filter for colId: "+colId)})}else this.allColumnFilters.forEach(filterWrapper=>{allPromises.push(this.setModelOnFilterWrapper(filterWrapper.filterPromise,null))});AgPromise.all(allPromises).then(()=>{const currentModel=this.getFilterModel(),columns=[];this.allColumnFilters.forEach((filterWrapper,colId)=>{const before=previousModel?previousModel[colId]:null,after=currentModel?currentModel[colId]:null;_.jsonEquals(before,after)||columns.push(filterWrapper.column)}),columns.length>0&&this.onFilterChanged({columns,source})})}setModelOnFilterWrapper(filterPromise,newModel){return new AgPromise(resolve=>{filterPromise.then(filter=>{"function"!=typeof filter.setModel&&(console.warn("AG Grid: filter missing setModel method, which is needed for setFilterModel"),resolve()),(filter.setModel(newModel)||AgPromise.resolve()).then(()=>resolve())})})}getFilterModel(){const result={};return this.allColumnFilters.forEach((filterWrapper,key)=>{const model=this.getModelFromFilterWrapper(filterWrapper);exists(model)&&(result[key]=model)}),result}getModelFromFilterWrapper(filterWrapper){var _a;const filter=filterWrapper.filterPromise.resolveNow(null,promiseFilter=>promiseFilter);return null==filter?null!=(_a=this.initialFilterModel[filterWrapper.column.getColId()])?_a:null:"function"!=typeof filter.getModel?(console.warn("AG Grid: filter API missing getModel method, which is needed for getFilterModel"),null):filter.getModel()}isColumnFilterPresent(){return this.activeColumnFilters.length>0}isAggregateFilterPresent(){return!!this.activeAggregateFilters.length}isExternalFilterPresent(){return this.externalFilterPresent}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}isAdvancedFilterPresent(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isFilterPresent()}onAdvancedFilterEnabledChanged(enabled){var _a;enabled?this.allColumnFilters.size&&(this.allColumnFilters.forEach(filterWrapper=>this.disposeFilterWrapper(filterWrapper,"advancedFilterEnabled")),this.onFilterChanged({source:"advancedFilter"})):(null==(_a=this.advancedFilterService)?void 0:_a.isFilterPresent())&&(this.advancedFilterService.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvancedFilterEnabled(){var _a;return!!(null==(_a=this.advancedFilterService)?void 0:_a.isEnabled())}isAdvancedFilterHeaderActive(){return this.isAdvancedFilterEnabled()&&this.advancedFilterService.isHeaderActive()}doAggregateFiltersPass(node,filterToSkip){return this.doColumnFiltersPass(node,filterToSkip,!0)}updateActiveFilters(){this.activeColumnFilters.length=0,this.activeAggregateFilters.length=0;const isFilterActive=filter=>!!filter&&(filter.isFilterActive?filter.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1)),groupFilterEnabled=!!this.gos.getGroupAggFiltering(),isAggFilter=column=>{if(!column.isPrimary())return!0;const isShowingPrimaryColumns=!this.columnModel.isPivotActive();return!(!column.isValueActive()||!isShowingPrimaryColumns)&&(!!this.columnModel.isPivotMode()||groupFilterEnabled)};this.allColumnFilters.forEach(filterWrapper=>{if(filterWrapper.filterPromise.resolveNow(!1,isFilterActive)){const filterComp=filterWrapper.filterPromise.resolveNow(null,filter=>filter);isAggFilter(filterWrapper.column)?this.activeAggregateFilters.push(filterComp):this.activeColumnFilters.push(filterComp)}})}updateFilterFlagInColumns(source,additionalEventAttributes){this.allColumnFilters.forEach(filterWrapper=>{const isFilterActive=filterWrapper.filterPromise.resolveNow(!1,filter=>filter.isFilterActive());filterWrapper.column.setFilterActive(isFilterActive,source,additionalEventAttributes)})}isAnyFilterPresent(){return this.isQuickFilterPresent()||this.isColumnFilterPresent()||this.isAggregateFilterPresent()||this.isExternalFilterPresent()||this.isAdvancedFilterPresent()}doColumnFiltersPass(node,filterToSkip,targetAggregates){const{data,aggData}=node,targetedFilters=targetAggregates?this.activeAggregateFilters:this.activeColumnFilters,targetedData=targetAggregates?aggData:data;for(let i=0;i<targetedFilters.length;i++){const filter=targetedFilters[i];if(null!=filter&&filter!==filterToSkip){if("function"!=typeof filter.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!filter.doesFilterPass({node,data:targetedData}))return!1}}return!0}resetQuickFilterCache(){this.quickFilterService.resetQuickFilterCache()}refreshFiltersForAggregations(){this.gos.getGroupAggFiltering()&&this.onFilterChanged()}callOnFilterChangedOutsideRenderCycle(params){const action=()=>this.onFilterChanged(params);this.rowRenderer.isRefreshInProgress()?setTimeout(action,0):action()}onFilterChanged(params={}){const{source,filterInstance,additionalEventAttributes,columns}=params;this.updateDependantFilters(),this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",additionalEventAttributes),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.allColumnFilters.forEach(filterWrapper=>{filterWrapper.filterPromise&&filterWrapper.filterPromise.then(filter=>{filter&&filter!==filterInstance&&filter.onAnyFilterChanged&&filter.onAnyFilterChanged()})});const filterChangedEvent={source,type:Events.EVENT_FILTER_CHANGED,columns:columns||[]};additionalEventAttributes&&mergeDeep(filterChangedEvent,additionalEventAttributes),this.processingFilterChange=!0,this.eventService.dispatchEvent(filterChangedEvent),this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){var _a;return!(null!=(_a=this.gos.get("allowShowChangeAfterFilter"))&&_a)&&this.processingFilterChange}isQuickFilterPresent(){return this.quickFilterService.isQuickFilterPresent()}updateAggFiltering(){this.aggFiltering=!!this.gos.getGroupAggFiltering()}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.columnModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(filterToSkip,node){return this.doesRowPassFilter({rowNode:node,filterInstanceToSkip:filterToSkip})}doesRowPassAggregateFilters(params){return!(this.isAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(params.rowNode))&&!(this.isAggregateFilterPresent()&&!this.doAggregateFiltersPass(params.rowNode,params.filterInstanceToSkip))}doesRowPassFilter(params){return!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilterService.doesRowPassQuickFilter(params.rowNode))&&(!(this.isExternalFilterPresent()&&!this.doesExternalFilterPass(params.rowNode))&&(!(this.isColumnFilterPresent()&&!this.doColumnFiltersPass(params.rowNode,params.filterInstanceToSkip))&&!(this.isAdvancedFilterPresent()&&!this.advancedFilterService.doesFilterPass(params.rowNode))))}onNewRowsLoaded(source){this.allColumnFilters.forEach(filterWrapper=>{filterWrapper.filterPromise.then(filter=>{filter.onNewRowsLoaded&&filter.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(source,{afterDataChange:!0}),this.updateActiveFilters()}createValueGetter(column){return({node})=>this.valueService.getValue(column,node,!0)}createGetValue(filterColumn){return(rowNode,column)=>{const columnToUse=column?this.columnModel.getGridColumn(column):filterColumn;return columnToUse?this.valueService.getValue(columnToUse,rowNode,!0):void 0}}getFilterComponent(column,source,createIfDoesNotExist=!0){var _a;if(createIfDoesNotExist)return(null==(_a=this.getOrCreateFilterWrapper(column,source))?void 0:_a.filterPromise)||null;const filterWrapper=this.cachedFilter(column);return filterWrapper?filterWrapper.filterPromise:null}isFilterActive(column){const filterWrapper=this.cachedFilter(column);return!!filterWrapper&&filterWrapper.filterPromise.resolveNow(!1,filter=>filter.isFilterActive())}getOrCreateFilterWrapper(column,source){if(!column.isFilterAllowed())return null;let filterWrapper=this.cachedFilter(column);return filterWrapper||(filterWrapper=this.createFilterWrapper(column,source),this.setColumnFilterWrapper(column,filterWrapper)),filterWrapper}cachedFilter(column){return this.allColumnFilters.get(column.getColId())}getDefaultFilter(column){let defaultFilter;if(ModuleRegistry.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))defaultFilter="agSetColumnFilter";else{const cellDataType=this.dataTypeService.getBaseDataType(column);defaultFilter="number"===cellDataType?"agNumberColumnFilter":"date"===cellDataType||"dateString"===cellDataType?"agDateColumnFilter":"agTextColumnFilter"}return defaultFilter}getDefaultFloatingFilter(column){let defaultFloatingFilterType;if(ModuleRegistry.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()))defaultFloatingFilterType="agSetColumnFloatingFilter";else{const cellDataType=this.dataTypeService.getBaseDataType(column);defaultFloatingFilterType="number"===cellDataType?"agNumberColumnFloatingFilter":"date"===cellDataType||"dateString"===cellDataType?"agDateColumnFloatingFilter":"agTextColumnFloatingFilter"}return defaultFloatingFilterType}createFilterInstance(column){const defaultFilter=this.getDefaultFilter(column),colDef=column.getColDef();let filterInstance;const params=__spreadProps(__spreadValues({},this.createFilterParams(column,colDef)),{filterModifiedCallback:()=>this.filterModifiedCallbackFactory(filterInstance,column)(),filterChangedCallback:additionalEventAttributes=>this.filterChangedCallbackFactory(filterInstance,column)(additionalEventAttributes),doesRowPassOtherFilter:node=>this.doesRowPassOtherFilters(filterInstance,node)}),compDetails=this.userComponentFactory.getFilterDetails(colDef,params,defaultFilter);return compDetails?{filterPromise:()=>{const filterPromise=compDetails.newAgStackInstance();return filterPromise&&filterPromise.then(r=>filterInstance=r),filterPromise},compDetails}:{filterPromise:null,compDetails:null}}createFilterParams(column,colDef){return this.gos.addGridCommonParams({column,colDef:cloneObject(colDef),rowModel:this.rowModel,filterChangedCallback:()=>{},filterModifiedCallback:()=>{},valueGetter:this.createValueGetter(column),getValue:this.createGetValue(column),doesRowPassOtherFilter:()=>!0})}createFilterWrapper(column,source){var _a;const filterWrapper={column,filterPromise:null,compiledElement:null,compDetails:null},{filterPromise,compDetails}=this.createFilterInstance(column);return filterWrapper.filterPromise=null!=(_a=null==filterPromise?void 0:filterPromise())?_a:null,filterWrapper.compDetails=compDetails,filterWrapper}onColumnsChanged(){const columns=[];this.allColumnFilters.forEach((wrapper,colId)=>{let currentColumn;currentColumn=wrapper.column.isPrimary()?this.columnModel.getPrimaryColumn(colId):this.columnModel.getGridColumn(colId),currentColumn&&currentColumn===wrapper.column||(columns.push(wrapper.column),this.disposeFilterWrapper(wrapper,"columnChanged"),this.disposeColumnListener(colId))}),columns.length>0?this.onFilterChanged({columns,source:"api"}):this.updateDependantFilters()}updateDependantFilters(){const groupColumns=this.columnModel.getGroupAutoColumns();null==groupColumns||groupColumns.forEach(groupColumn=>{"agGroupColumnFilter"===groupColumn.getColDef().filter&&this.getOrCreateFilterWrapper(groupColumn,"NO_UI")})}isFilterAllowed(column){var _a,_b;if(this.isAdvancedFilterEnabled())return!1;if(!column.isFilterAllowed())return!1;const filterWrapper=this.allColumnFilters.get(column.getColId());return null==(_b=null==(_a=null==filterWrapper?void 0:filterWrapper.filterPromise)?void 0:_a.resolveNow(!0,filter=>"function"!=typeof(null==filter?void 0:filter.isFilterAllowed)||(null==filter?void 0:filter.isFilterAllowed())))||_b}getFloatingFilterCompDetails(column,showParentFilter){const parentFilterInstance=callback=>{const filterComponent=this.getFilterComponent(column,"NO_UI");null!=filterComponent&&filterComponent.then(instance=>{callback(unwrapUserComp(instance))})},colDef=column.getColDef(),filterParams=__spreadProps(__spreadValues({},this.createFilterParams(column,colDef)),{filterChangedCallback:()=>parentFilterInstance(filterInstance=>this.filterChangedCallbackFactory(filterInstance,column)())}),finalFilterParams=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(colDef,FilterComponent,filterParams);let defaultFloatingFilterType=this.userComponentFactory.getDefaultFloatingFilterType(colDef,()=>this.getDefaultFloatingFilter(column));null==defaultFloatingFilterType&&(defaultFloatingFilterType="agReadOnlyFloatingFilter");const params={column,filterParams:finalFilterParams,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(column),parentFilterInstance,showParentFilter,suppressFilterButton:!1};return this.userComponentFactory.getFloatingFilterCompDetails(colDef,params,defaultFloatingFilterType)}getCurrentFloatingFilterParentModel(column){const filterComponent=this.getFilterComponent(column,"NO_UI",!1);return filterComponent?filterComponent.resolveNow(null,filter=>filter&&filter.getModel()):null}destroyFilter(column,source="api"){const colId=column.getColId(),filterWrapper=this.allColumnFilters.get(colId);this.disposeColumnListener(colId),delete this.initialFilterModel[colId],filterWrapper&&(this.disposeFilterWrapper(filterWrapper,source),this.onFilterChanged({columns:[column],source:"api"}))}disposeColumnListener(colId){const columnListener=this.allColumnListeners.get(colId);columnListener&&(this.allColumnListeners.delete(colId),columnListener())}disposeFilterWrapper(filterWrapper,source){filterWrapper.filterPromise.then(filter=>{this.getContext().destroyBean(filter),filterWrapper.column.setFilterActive(!1,"filterDestroyed"),this.allColumnFilters.delete(filterWrapper.column.getColId());const event={type:Events.EVENT_FILTER_DESTROYED,source,column:filterWrapper.column};this.eventService.dispatchEvent(event)})}filterModifiedCallbackFactory(filter,column){return()=>{const event={type:Events.EVENT_FILTER_MODIFIED,column,filterInstance:filter};this.eventService.dispatchEvent(event)}}filterChangedCallbackFactory(filter,column){return additionalEventAttributes=>{var _a;const source=null!=(_a=null==additionalEventAttributes?void 0:additionalEventAttributes.source)?_a:"api",params={filter,additionalEventAttributes,columns:[column],source};this.callOnFilterChangedOutsideRenderCycle(params)}}checkDestroyFilter(colId){const filterWrapper=this.allColumnFilters.get(colId);if(!filterWrapper)return;const column=filterWrapper.column,{compDetails}=column.isFilterAllowed()?this.createFilterInstance(column):{compDetails:null};if(this.areFilterCompsDifferent(filterWrapper.compDetails,compDetails))return void this.destroyFilter(column,"paramsUpdated");const newFilterParams=column.getColDef().filterParams;filterWrapper.filterPromise?filterWrapper.filterPromise.then(filter=>{!1===(!(null==filter?void 0:filter.refresh)||filter.refresh(__spreadValues(__spreadProps(__spreadValues({},this.createFilterParams(column,column.getColDef())),{filterModifiedCallback:this.filterModifiedCallbackFactory(filter,column),filterChangedCallback:this.filterChangedCallbackFactory(filter,column),doesRowPassOtherFilter:node=>this.doesRowPassOtherFilters(filter,node)}),newFilterParams)))&&this.destroyFilter(column,"paramsUpdated")}):this.destroyFilter(column,"paramsUpdated")}setColumnFilterWrapper(column,filterWrapper){const colId=column.getColId();this.allColumnFilters.set(colId,filterWrapper),this.allColumnListeners.set(colId,this.addManagedListener(column,Column.EVENT_COL_DEF_CHANGED,()=>this.checkDestroyFilter(colId)))}areFilterCompsDifferent(oldCompDetails,newCompDetails){if(!newCompDetails||!oldCompDetails)return!0;const{componentClass:oldComponentClass}=oldCompDetails,{componentClass:newComponentClass}=newCompDetails;return!(oldComponentClass===newComponentClass||(null==oldComponentClass?void 0:oldComponentClass.render)&&(null==newComponentClass?void 0:newComponentClass.render)&&oldComponentClass.render===newComponentClass.render)}getAdvancedFilterModel(){return this.isAdvancedFilterEnabled()?this.advancedFilterService.getModel():null}setAdvancedFilterModel(expression){this.isAdvancedFilterEnabled()&&(this.dataTypeService.isPendingInference()?this.advancedFilterModelUpdateQueue.push(expression):(this.advancedFilterService.setModel(null!=expression?expression:null),this.onFilterChanged({source:"advancedFilter"})))}showAdvancedFilterBuilder(source){this.isAdvancedFilterEnabled()&&this.advancedFilterService.getCtrl().toggleFilterBuilder(source,!0)}updateAdvancedFilterColumns(){this.isAdvancedFilterEnabled()&&this.advancedFilterService.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){if(this.isAdvancedFilterEnabled())return!1;return this.columnModel.getAllGridColumns().some(col=>col.getColDef().floatingFilter)}getFilterInstance(key,callback){if(this.isAdvancedFilterEnabled())return void this.warnAdvancedFilters();const res=this.getFilterInstanceImpl(key,instance=>{if(!callback)return;const unwrapped2=unwrapUserComp(instance);callback(unwrapped2)});return unwrapUserComp(res)}getColumnFilterInstance(key){return new Promise(resolve=>{this.getFilterInstance(key,filter=>{resolve(filter)})})}getFilterInstanceImpl(key,callback){const column=this.columnModel.getPrimaryColumn(key);if(!column)return;const filterPromise=this.getFilterComponent(column,"NO_UI"),currentValue=filterPromise&&filterPromise.resolveNow(null,filterComp=>filterComp);return currentValue?setTimeout(callback,0,currentValue):filterPromise&&filterPromise.then(comp=>{callback(comp)}),currentValue}warnAdvancedFilters(){warnOnce("Column Filter API methods have been disabled as Advanced Filters are enabled.")}setupAdvancedFilterHeaderComp(eCompToInsertBefore){var _a;null==(_a=this.advancedFilterService)||_a.getCtrl().setupHeaderComp(eCompToInsertBefore)}getHeaderRowCount(){return this.isAdvancedFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvancedFilterHeaderActive()?this.advancedFilterService.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){this.filterModelUpdateQueue.forEach(({model,source})=>this.setFilterModel(model,source)),this.filterModelUpdateQueue=[],this.columnFilterModelUpdateQueue.forEach(({key,model,resolve})=>{this.setColumnFilterModel(key,model).then(()=>resolve())}),this.columnFilterModelUpdateQueue=[],this.advancedFilterModelUpdateQueue.forEach(model=>this.setAdvancedFilterModel(model)),this.advancedFilterModelUpdateQueue=[]}getColumnFilterModel(key){const filterWrapper=this.getFilterWrapper(key);return filterWrapper?this.getModelFromFilterWrapper(filterWrapper):null}setColumnFilterModel(key,model){if(this.isAdvancedFilterEnabled())return this.warnAdvancedFilters(),Promise.resolve();if(this.dataTypeService.isPendingInference()){let resolve=()=>{};const promise=new Promise(res=>{resolve=res});return this.columnFilterModelUpdateQueue.push({key,model,resolve}),promise}const column=this.columnModel.getPrimaryColumn(key),filterWrapper=column?this.getOrCreateFilterWrapper(column,"NO_UI"):null;return filterWrapper?(promise=this.setModelOnFilterWrapper(filterWrapper.filterPromise,model),new Promise(resolve=>{promise.then(result=>resolve(result))})):Promise.resolve();var promise}getFilterWrapper(key){var _a;const column=this.columnModel.getPrimaryColumn(key);return column&&null!=(_a=this.cachedFilter(column))?_a:null}destroy(){super.destroy(),this.allColumnFilters.forEach(filterWrapper=>this.disposeFilterWrapper(filterWrapper,"gridDestroyed")),this.allColumnListeners.clear()}};__decorateClass([Autowired("valueService")],FilterManager.prototype,"valueService",2),__decorateClass([Autowired("columnModel")],FilterManager.prototype,"columnModel",2),__decorateClass([Autowired("rowModel")],FilterManager.prototype,"rowModel",2),__decorateClass([Autowired("userComponentFactory")],FilterManager.prototype,"userComponentFactory",2),__decorateClass([Autowired("rowRenderer")],FilterManager.prototype,"rowRenderer",2),__decorateClass([Autowired("dataTypeService")],FilterManager.prototype,"dataTypeService",2),__decorateClass([Autowired("quickFilterService")],FilterManager.prototype,"quickFilterService",2),__decorateClass([Optional("advancedFilterService")],FilterManager.prototype,"advancedFilterService",2),__decorateClass([PostConstruct],FilterManager.prototype,"init",1),FilterManager=__decorateClass([Bean("filterManager")],FilterManager);var FilterWrapperComp=class extends Component{constructor(column,source){super('<div class="ag-filter"></div>'),this.column=column,this.source=source,this.filterWrapper=null}postConstruct(){this.createFilter(!0),this.addManagedListener(this.eventService,Events.EVENT_FILTER_DESTROYED,this.onFilterDestroyed.bind(this))}hasFilter(){return!!this.filterWrapper}getFilter(){var _a,_b;return null!=(_b=null==(_a=this.filterWrapper)?void 0:_a.filterPromise)?_b:null}afterInit(){var _a,_b,_c;return null!=(_c=null==(_b=null==(_a=this.filterWrapper)?void 0:_a.filterPromise)?void 0:_b.then(()=>{}))?_c:AgPromise.resolve()}afterGuiAttached(params){var _a,_b;null==(_b=null==(_a=this.filterWrapper)?void 0:_a.filterPromise)||_b.then(filter=>{var _a2;null==(_a2=null==filter?void 0:filter.afterGuiAttached)||_a2.call(filter,params)})}afterGuiDetached(){var _a,_b;null==(_b=null==(_a=this.filterWrapper)?void 0:_a.filterPromise)||_b.then(filter=>{var _a2;null==(_a2=null==filter?void 0:filter.afterGuiDetached)||_a2.call(filter)})}createFilter(init){var _a;const{column,source}=this;this.filterWrapper=this.filterManager.getOrCreateFilterWrapper(column,source),(null==(_a=this.filterWrapper)?void 0:_a.filterPromise)&&this.filterWrapper.filterPromise.then(filter=>{let guiFromFilter=filter.getGui();if(exists(guiFromFilter)||console.warn(`AG Grid: getGui method from filter returned ${guiFromFilter}, it should be a DOM element or an HTML template string.`),"string"==typeof guiFromFilter&&(guiFromFilter=loadTemplate(guiFromFilter)),this.appendChild(guiFromFilter),init){const event={type:Events.EVENT_FILTER_OPENED,column,source,eGui:this.getGui()};this.eventService.dispatchEvent(event)}})}onFilterDestroyed(event){"api"!==event.source&&"paramsUpdated"!==event.source||event.column.getId()!==this.column.getId()||!this.columnModel.getPrimaryColumn(this.column)||(clearElement(this.getGui()),this.createFilter())}destroy(){this.filterWrapper=null,super.destroy()}};__decorateClass([Autowired("filterManager")],FilterWrapperComp.prototype,"filterManager",2),__decorateClass([Autowired("columnModel")],FilterWrapperComp.prototype,"columnModel",2),__decorateClass([PostConstruct],FilterWrapperComp.prototype,"postConstruct",1);var AbstractHeaderCellComp=class extends Component{constructor(template,ctrl){super(template),this.ctrl=ctrl}getCtrl(){return this.ctrl}},_HeaderFilterCellComp=class _HeaderFilterCellComp extends AbstractHeaderCellComp{constructor(ctrl){super(_HeaderFilterCellComp.TEMPLATE,ctrl)}postConstruct(){const eGui=this.getGui(),compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),addOrRemoveBodyCssClass:(cssClassName,on)=>this.eFloatingFilterBody.classList.toggle(cssClassName,on),setButtonWrapperDisplayed:displayed=>setDisplayed(this.eButtonWrapper,displayed),setCompDetails:compDetails=>this.setCompDetails(compDetails),getFloatingFilterComp:()=>this.compPromise,setWidth:width=>eGui.style.width=width,setMenuIcon:eIcon=>this.eButtonShowMainFilter.appendChild(eIcon)};this.ctrl.setComp(compProxy,eGui,this.eButtonShowMainFilter,this.eFloatingFilterBody)}setCompDetails(compDetails){if(!compDetails)return this.destroyFloatingFilterComp(),void(this.compPromise=null);this.compPromise=compDetails.newAgStackInstance(),this.compPromise.then(comp=>this.afterCompCreated(comp))}destroyFloatingFilterComp(){this.floatingFilterComp&&(this.eFloatingFilterBody.removeChild(this.floatingFilterComp.getGui()),this.floatingFilterComp=this.destroyBean(this.floatingFilterComp))}afterCompCreated(comp){comp&&(this.isAlive()?(this.destroyFloatingFilterComp(),this.floatingFilterComp=comp,this.eFloatingFilterBody.appendChild(comp.getGui()),comp.afterGuiAttached&&comp.afterGuiAttached()):this.destroyBean(comp))}};_HeaderFilterCellComp.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" class="ag-button ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',__decorateClass([RefSelector("eFloatingFilterBody")],_HeaderFilterCellComp.prototype,"eFloatingFilterBody",2),__decorateClass([RefSelector("eButtonWrapper")],_HeaderFilterCellComp.prototype,"eButtonWrapper",2),__decorateClass([RefSelector("eButtonShowMainFilter")],_HeaderFilterCellComp.prototype,"eButtonShowMainFilter",2),__decorateClass([PostConstruct],_HeaderFilterCellComp.prototype,"postConstruct",1),__decorateClass([PreDestroy],_HeaderFilterCellComp.prototype,"destroyFloatingFilterComp",1);var HeaderFilterCellComp=_HeaderFilterCellComp,LayoutFeature=class extends BeanStub{constructor(view){super(),this.view=view}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const domLayout=this.getDomLayout(),params={autoHeight:"autoHeight"===domLayout,normal:"normal"===domLayout,print:"print"===domLayout},cssClass=params.autoHeight?"ag-layout-auto-height":params.print?"ag-layout-print":"ag-layout-normal";this.view.updateLayoutClasses(cssClass,params)}getDomLayout(){var _a;const domLayout=null!=(_a=this.gos.get("domLayout"))?_a:"normal";return-1===["normal","print","autoHeight"].indexOf(domLayout)?(warnOnce(`${domLayout} is not valid for DOM Layout, valid values are 'normal', 'autoHeight', 'print'.`),"normal"):domLayout}};__decorateClass([PostConstruct],LayoutFeature.prototype,"postConstruct",1);var GridBodyScrollFeature=class extends BeanStub{constructor(eBodyViewport){super(),this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.eBodyViewport=eBodyViewport,this.resetLastHScrollDebounced=debounce(()=>this.lastScrollSource[1]=null,500),this.resetLastVScrollDebounced=debounce(()=>this.lastScrollSource[0]=null,500)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(p=>{this.centerRowsCtrl=p.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}addScrollListener(){const{fakeHScrollComp,fakeVScrollComp}=this.ctrlsService.getParams();this.addManagedListener(this.centerRowsCtrl.getViewportElement(),"scroll",this.onHScroll.bind(this)),fakeHScrollComp.onScrollCallback(this.onFakeHScroll.bind(this));const isDebounce=this.gos.get("debounceVerticalScrollbar"),onVScroll=isDebounce?debounce(this.onVScroll.bind(this),100):this.onVScroll.bind(this),onFakeVScroll=isDebounce?debounce(this.onFakeVScroll.bind(this),100):this.onFakeVScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",onVScroll),fakeVScrollComp.onScrollCallback(onFakeVScroll)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(scrollLeft){if(null==this.centerRowsCtrl)return;void 0===scrollLeft&&(scrollLeft=this.centerRowsCtrl.getCenterViewportScrollLeft());const offset=this.enableRtl?scrollLeft:-scrollLeft,{topCenter,stickyTopCenter,stickyBottomCenter,centerHeader,bottomCenter,fakeHScrollComp}=this.ctrlsService.getParams();centerHeader.setHorizontalScroll(-offset),bottomCenter.setContainerTranslateX(offset),topCenter.setContainerTranslateX(offset),stickyTopCenter.setContainerTranslateX(offset),stickyBottomCenter.setContainerTranslateX(offset);const centerViewport=this.centerRowsCtrl.getViewportElement(),isCenterViewportLastHorizontal=0===this.lastScrollSource[1];scrollLeft=Math.abs(scrollLeft),isCenterViewportLastHorizontal?fakeHScrollComp.setScrollPosition(scrollLeft):setScrollLeft(centerViewport,scrollLeft,this.enableRtl)}isControllingScroll(source,direction){return null==this.lastScrollSource[direction]?(this.lastScrollSource[direction]=source,!0):this.lastScrollSource[direction]===source}onFakeHScroll(){this.isControllingScroll(1,1)&&this.onHScrollCommon(1)}onHScroll(){this.isControllingScroll(0,1)&&this.onHScrollCommon(0)}onHScrollCommon(source){const centerContainerViewport=this.centerRowsCtrl.getViewportElement(),{scrollLeft}=centerContainerViewport;if(this.shouldBlockScrollUpdate(1,scrollLeft,!0))return;let newScrollLeft;newScrollLeft=0===source?getScrollLeft(centerContainerViewport,this.enableRtl):this.ctrlsService.get("fakeHScrollComp").getScrollPosition(),this.doHorizontalScroll(Math.round(newScrollLeft)),this.resetLastHScrollDebounced()}onFakeVScroll(){this.isControllingScroll(1,0)&&this.onVScrollCommon(1)}onVScroll(){this.isControllingScroll(0,0)&&this.onVScrollCommon(0)}onVScrollCommon(source){let scrollTop;scrollTop=0===source?this.eBodyViewport.scrollTop:this.ctrlsService.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,scrollTop,!0)||(this.animationFrameService.setScrollTop(scrollTop),this.nextScrollTop=scrollTop,0===source?this.ctrlsService.get("fakeVScrollComp").setScrollPosition(scrollTop):this.eBodyViewport.scrollTop=scrollTop,this.gos.get("suppressAnimationFrame")?this.scrollGridIfNeeded():this.animationFrameService.schedule(),this.resetLastVScrollDebounced())}doHorizontalScroll(scrollLeft){const fakeScrollLeft=this.ctrlsService.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===scrollLeft&&scrollLeft===fakeScrollLeft||(this.scrollLeft=scrollLeft,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(scrollLeft),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}fireScrollEvent(direction){const bodyScrollEvent={type:Events.EVENT_BODY_SCROLL,direction:1===direction?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(bodyScrollEvent),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(()=>{const bodyScrollEndEvent=__spreadProps(__spreadValues({},bodyScrollEvent),{type:Events.EVENT_BODY_SCROLL_END});this.eventService.dispatchEvent(bodyScrollEndEvent)},100)}shouldBlockScrollUpdate(direction,scrollTo,touchOnly=!1){return!(touchOnly&&!isIOSUserAgent())&&(0===direction?this.shouldBlockVerticalScroll(scrollTo):this.shouldBlockHorizontalScroll(scrollTo))}shouldBlockVerticalScroll(scrollTo){const clientHeight=getInnerHeight(this.eBodyViewport),{scrollHeight}=this.eBodyViewport;return scrollTo<0||scrollTo+clientHeight>scrollHeight}shouldBlockHorizontalScroll(scrollTo){const clientWidth=this.centerRowsCtrl.getCenterWidth(),{scrollWidth}=this.centerRowsCtrl.getViewportElement();if(this.enableRtl&&isRtlNegativeScroll()){if(scrollTo>0)return!0}else if(scrollTo<0)return!0;return Math.abs(scrollTo)+clientWidth>scrollWidth}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){this.scrollLeft!==this.centerRowsCtrl.getCenterViewportScrollLeft()&&this.onHScrollCommon(0)}scrollGridIfNeeded(){const frameNeeded=this.scrollTop!=this.nextScrollTop;return frameNeeded&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),frameNeeded}setHorizontalScrollPosition(hScrollPosition,fromAlignedGridsService=!1){const maxScrollLeft=this.centerRowsCtrl.getViewportElement().scrollWidth-this.centerRowsCtrl.getCenterWidth();!fromAlignedGridsService&&this.shouldBlockScrollUpdate(1,hScrollPosition)&&(hScrollPosition=this.enableRtl&&isRtlNegativeScroll()?hScrollPosition>0?0:maxScrollLeft:Math.min(Math.max(hScrollPosition,0),maxScrollLeft)),setScrollLeft(this.centerRowsCtrl.getViewportElement(),Math.abs(hScrollPosition),this.enableRtl),this.doHorizontalScroll(hScrollPosition)}setVerticalScrollPosition(vScrollPosition){this.eBodyViewport.scrollTop=vScrollPosition}getVScrollPosition(){this.lastScrollTop=this.eBodyViewport.scrollTop,this.lastOffsetHeight=this.eBodyViewport.offsetHeight;return{top:this.lastScrollTop,bottom:this.lastScrollTop+this.lastOffsetHeight}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.centerRowsCtrl.isHorizontalScrollShowing()}scrollHorizontally(pixels){const oldScrollPosition=this.centerRowsCtrl.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(oldScrollPosition+pixels),this.centerRowsCtrl.getViewportElement().scrollLeft-oldScrollPosition}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(comparator,position=null){const rowCount=this.rowModel.getRowCount();let indexToSelect=-1;for(let i=0;i<rowCount;i++){const node=this.rowModel.getRow(i);if("function"==typeof comparator){if(node&&comparator(node)){indexToSelect=i;break}}else if(comparator===node||comparator===node.data){indexToSelect=i;break}}indexToSelect>=0&&this.ensureIndexVisible(indexToSelect,position)}ensureIndexVisible(index,position){if(this.gos.isDomLayout("print"))return;const rowCount=this.paginationProxy.getRowCount();if("number"!=typeof index||index<0||index>=rowCount)return void console.warn("AG Grid: Invalid row index for ensureIndexVisible: "+index);const paginationPanelEnabled=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.getFrameworkOverrides().wrapIncoming(()=>{paginationPanelEnabled||this.paginationProxy.goToPageWithIndex(index);const gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),stickyTopHeight=gridBodyCtrl.getStickyTopHeight(),stickyBottomHeight=gridBodyCtrl.getStickyBottomHeight(),rowNode=this.paginationProxy.getRow(index);let rowGotShiftedDuringOperation;do{const startingRowTop=rowNode.rowTop,startingRowHeight=rowNode.rowHeight,paginationOffset=this.paginationProxy.getPixelOffset(),rowTopPixel=rowNode.rowTop-paginationOffset,rowBottomPixel=rowTopPixel+rowNode.rowHeight,scrollPosition=this.getVScrollPosition(),heightOffset=this.heightScaler.getDivStretchOffset(),vScrollTop=scrollPosition.top+heightOffset,vScrollBottom=scrollPosition.bottom+heightOffset,viewportHeight=vScrollBottom-vScrollTop,pxTop=this.heightScaler.getScrollPositionForPixel(rowTopPixel),pxBottom=this.heightScaler.getScrollPositionForPixel(rowBottomPixel-viewportHeight),pxMiddle=Math.min((pxTop+pxBottom)/2,rowTopPixel);let newScrollPosition=null;"top"===position?newScrollPosition=pxTop:"bottom"===position?newScrollPosition=pxBottom:"middle"===position?newScrollPosition=pxMiddle:vScrollTop+stickyTopHeight>rowTopPixel?newScrollPosition=pxTop-stickyTopHeight:vScrollBottom-stickyBottomHeight<rowBottomPixel&&(newScrollPosition=pxBottom+stickyBottomHeight),null!==newScrollPosition&&(this.setVerticalScrollPosition(newScrollPosition),this.rowRenderer.redraw({afterScroll:!0})),rowGotShiftedDuringOperation=startingRowTop!==rowNode.rowTop||startingRowHeight!==rowNode.rowHeight}while(rowGotShiftedDuringOperation);this.animationFrameService.flushAllFrames()})}ensureColumnVisible(key,position="auto"){const column=this.columnModel.getGridColumn(key);if(!column)return;if(column.isPinned())return;if(!this.columnModel.isColumnDisplayed(column))return;const newHorizontalScroll=this.getPositionedHorizontalScroll(column,position);this.getFrameworkOverrides().wrapIncoming(()=>{null!==newHorizontalScroll&&this.centerRowsCtrl.setCenterViewportScrollLeft(newHorizontalScroll),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()})}setScrollPosition(top,left){this.getFrameworkOverrides().wrapIncoming(()=>{this.centerRowsCtrl.setCenterViewportScrollLeft(left),this.setVerticalScrollPosition(top),this.rowRenderer.redraw({afterScroll:!0}),this.animationFrameService.flushAllFrames()})}getPositionedHorizontalScroll(column,position){const{columnBeforeStart,columnAfterEnd}=this.isColumnOutsideViewport(column),viewportTooSmallForColumn=this.centerRowsCtrl.getCenterWidth()<column.getActualWidth(),viewportWidth=this.centerRowsCtrl.getCenterWidth(),isRtl=this.enableRtl;let alignColToStart=(isRtl?columnBeforeStart:columnAfterEnd)||viewportTooSmallForColumn,alignColToEnd=isRtl?columnAfterEnd:columnBeforeStart;"auto"!==position&&(alignColToStart="start"===position,alignColToEnd="end"===position);const isMiddle="middle"===position;if(alignColToStart||alignColToEnd||isMiddle){const{colLeft,colMiddle,colRight}=this.getColumnBounds(column);return isMiddle?colMiddle-viewportWidth/2:alignColToStart?isRtl?colRight:colLeft:isRtl?colLeft-viewportWidth:colRight-viewportWidth}return null}isColumnOutsideViewport(column){const{start:viewportStart,end:viewportEnd}=this.getViewportBounds(),{colLeft,colRight}=this.getColumnBounds(column),isRtl=this.enableRtl;return{columnBeforeStart:isRtl?viewportStart>colRight:viewportEnd<colRight,columnAfterEnd:isRtl?viewportEnd<colLeft:viewportStart>colLeft}}getColumnBounds(column){const isRtl=this.enableRtl,bodyWidth=this.columnModel.getBodyContainerWidth(),colWidth=column.getActualWidth(),colLeft=column.getLeft(),multiplier=isRtl?-1:1,colLeftPixel=isRtl?bodyWidth-colLeft:colLeft;return{colLeft:colLeftPixel,colMiddle:colLeftPixel+colWidth/2*multiplier,colRight:colLeftPixel+colWidth*multiplier}}getViewportBounds(){const viewportWidth=this.centerRowsCtrl.getCenterWidth(),scrollPosition=this.centerRowsCtrl.getCenterViewportScrollLeft();return{start:scrollPosition,end:viewportWidth+scrollPosition,width:viewportWidth}}};__decorateClass([Autowired("ctrlsService")],GridBodyScrollFeature.prototype,"ctrlsService",2),__decorateClass([Autowired("animationFrameService")],GridBodyScrollFeature.prototype,"animationFrameService",2),__decorateClass([Autowired("paginationProxy")],GridBodyScrollFeature.prototype,"paginationProxy",2),__decorateClass([Autowired("rowModel")],GridBodyScrollFeature.prototype,"rowModel",2),__decorateClass([Autowired("rowContainerHeightService")],GridBodyScrollFeature.prototype,"heightScaler",2),__decorateClass([Autowired("rowRenderer")],GridBodyScrollFeature.prototype,"rowRenderer",2),__decorateClass([Autowired("columnModel")],GridBodyScrollFeature.prototype,"columnModel",2),__decorateClass([PostConstruct],GridBodyScrollFeature.prototype,"postConstruct",1);var GridBodyCtrl=class extends BeanStub{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}getScrollFeature(){return this.bodyScrollFeature}getBodyViewportElement(){return this.eBodyViewport}setComp(comp,eGridBody,eBodyViewport,eTop,eBottom,eStickyTop,eStickyBottom){this.comp=comp,this.eGridBody=eGridBody,this.eBodyViewport=eBodyViewport,this.eTop=eTop,this.eBottom=eBottom,this.eStickyTop=eStickyTop,this.eStickyBottom=eStickyBottom,this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",props=>this.setCellTextSelection(props.currentValue)),this.createManagedBean(new LayoutFeature(this.comp)),this.bodyScrollFeature=this.createManagedBean(new GridBodyScrollFeature(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([eTop,eBodyViewport,eBottom,eStickyTop,eStickyBottom]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.filterManager.setupAdvancedFilterHeaderComp(eTop),this.ctrlsService.register("gridBodyCtrl",this)}getComp(){return this.comp}addEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}addFocusListeners(elements){elements.forEach(element=>{this.addManagedListener(element,"focusin",e=>{const{target}=e,isFocusedElementNested=isElementChildOfClass(target,"ag-root",element);element.classList.toggle("ag-has-focus",!isFocusedElementNested)}),this.addManagedListener(element,"focusout",e=>{const{target,relatedTarget}=e,gridContainRelatedTarget=element.contains(relatedTarget),isNestedRelatedTarget=isElementChildOfClass(relatedTarget,"ag-root",element);isElementChildOfClass(target,"ag-root",element)||gridContainRelatedTarget&&!isNestedRelatedTarget||element.classList.remove("ag-has-focus")})})}setColumnMovingCss(moving){this.comp.setColumnMovingCss("ag-column-moving",moving)}setCellTextSelection(selectable=!1){this.comp.setCellSelectableCss("ag-selectable",selectable)}onScrollVisibilityChanged(){const visible=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(visible),this.setStickyWidth(visible),this.setStickyBottomOffsetBottom();const width=`calc(100% + ${(visible&&this.gos.getScrollbarWidth()||0)+(isInvisibleScrollbar()?16:0)}px)`;this.animationFrameService.requestAnimationFrame(()=>this.comp.setBodyViewportWidth(width))}onGridColumnsChanged(){const columns=this.columnModel.getAllGridColumns();this.comp.setColumnCount(columns.length)}disableBrowserDragging(){this.addManagedListener(this.eGridBody,"dragstart",event=>{if(event.target instanceof HTMLImageElement)return event.preventDefault(),!1})}addStopEditingWhenGridLosesFocus(){if(!this.gos.get("stopEditingWhenCellsLoseFocus"))return;const focusOutListener=event=>{const elementWithFocus=event.relatedTarget;if(null===getTabIndex(elementWithFocus))return void this.rowRenderer.stopEditing();let clickInsideGrid=viewports.some(viewport=>viewport.contains(elementWithFocus))&&this.mouseEventService.isElementInThisGrid(elementWithFocus);if(!clickInsideGrid){const popupService=this.popupService;clickInsideGrid=popupService.getActivePopups().some(popup=>popup.contains(elementWithFocus))||popupService.isElementWithinCustomPopup(elementWithFocus)}clickInsideGrid||this.rowRenderer.stopEditing()},viewports=[this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom];viewports.forEach(viewport=>this.addManagedListener(viewport,"focusout",focusOutListener))}updateRowCount(){const headerCount=this.headerNavigationService.getHeaderRowCount()+this.filterManager.getHeaderRowCount(),rowCount=this.rowModel.isLastRowIndexKnown()?this.rowModel.getRowCount():-1,total=-1===rowCount?-1:headerCount+rowCount;this.comp.setRowCount(total)}registerBodyViewportResizeListener(listener){this.comp.registerBodyViewportResizeListener(listener)}setVerticalScrollPaddingVisible(visible){const overflowY=visible?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(overflowY)}isVerticalScrollShowing(){const show=this.gos.get("alwaysShowVerticalScroll"),cssClass=show?"ag-force-vertical-scroll":null,allowVerticalScroll=this.gos.isDomLayout("normal");return this.comp.setAlwaysVerticalScrollClass(cssClass,show),show||allowVerticalScroll&&isVerticalScrollShowing(this.eBodyViewport)}setupRowAnimationCssClass(){const listener=()=>{const animateRows=this.gos.isAnimateRows()&&!this.rowContainerHeightService.isStretching(),animateRowsCssClass=animateRows?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(animateRowsCssClass,animateRows)};listener(),this.addManagedListener(this.eventService,Events.EVENT_HEIGHT_SCALE_CHANGED,listener),this.addManagedPropertyListener("animateRows",listener)}getGridBodyElement(){return this.eGridBody}addBodyViewportListener(){const listener=this.onBodyViewportContextMenu.bind(this);this.addManagedListener(this.eBodyViewport,"contextmenu",listener),this.mockContextMenuForIPad(listener),this.addManagedListener(this.eBodyViewport,"wheel",this.onBodyViewportWheel.bind(this)),this.addManagedListener(this.eStickyTop,"wheel",this.onStickyWheel.bind(this)),this.addManagedListener(this.eStickyBottom,"wheel",this.onStickyWheel.bind(this)),this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){const fullWidthContainer=this.eBodyViewport.querySelector(".ag-full-width-container"),eCenterColsViewport=this.eBodyViewport.querySelector(".ag-center-cols-viewport");fullWidthContainer&&eCenterColsViewport&&this.addManagedListener(fullWidthContainer,"wheel",e=>this.onFullWidthContainerWheel(e,eCenterColsViewport))}onFullWidthContainerWheel(e,eCenterColsViewport){!e.deltaX||Math.abs(e.deltaY)>Math.abs(e.deltaX)||!this.mouseEventService.isEventFromThisGrid(e)||(e.preventDefault(),eCenterColsViewport.scrollBy({left:e.deltaX}))}onBodyViewportContextMenu(mouseEvent,touch,touchEvent){if(!mouseEvent&&!touchEvent)return;if(this.gos.get("preventDefaultOnContextMenu")){(mouseEvent||touchEvent).preventDefault()}const{target}=mouseEvent||touch;target!==this.eBodyViewport&&target!==this.ctrlsService.get("center").getViewportElement()||this.menuService.showContextMenu({mouseEvent,touchEvent,value:null,anchorToElement:this.eGridBody})}mockContextMenuForIPad(listener){if(!isIOSUserAgent())return;const touchListener=new TouchListener(this.eBodyViewport);this.addManagedListener(touchListener,TouchListener.EVENT_LONG_TAP,event=>{listener(void 0,event.touchStart,event.touchEvent)}),this.addDestroyFunc(()=>touchListener.destroy())}onBodyViewportWheel(e){this.gos.get("suppressScrollWhenPopupsAreOpen")&&this.popupService.hasAnchoredPopup()&&e.preventDefault()}onStickyWheel(e){e.preventDefault(),e.offsetY&&this.scrollVertically(e.deltaY)}getGui(){return this.eGridBody}scrollVertically(pixels){const oldScrollPosition=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(oldScrollPosition+pixels),this.eBodyViewport.scrollTop-oldScrollPosition}addRowDragListener(){this.rowDragFeature=this.createManagedBean(new RowDragFeature(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)}getRowDragFeature(){return this.rowDragFeature}onPinnedRowDataChanged(){this.setFloatingHeights()}setFloatingHeights(){const{pinnedRowModel}=this;let floatingTopHeight=pinnedRowModel.getPinnedTopTotalHeight(),floatingBottomHeight=pinnedRowModel.getPinnedBottomTotalHeight();this.comp.setTopHeight(floatingTopHeight),this.comp.setBottomHeight(floatingBottomHeight),this.comp.setTopDisplay(floatingTopHeight?"inherit":"none"),this.comp.setBottomDisplay(floatingBottomHeight?"inherit":"none"),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(height=0){this.comp.setStickyTopHeight(`${height}px`),this.stickyTopHeight=height}getStickyTopHeight(){return this.stickyTopHeight}setStickyBottomHeight(height=0){this.comp.setStickyBottomHeight(`${height}px`),this.stickyBottomHeight=height}getStickyBottomHeight(){return this.stickyBottomHeight}setStickyWidth(vScrollVisible){if(vScrollVisible){const scrollbarWidth=this.gos.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${scrollbarWidth}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${scrollbarWidth}px)`)}else this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%")}onHeaderHeightChanged(){this.setStickyTopOffsetTop()}setStickyTopOffsetTop(){const headerHeight=this.ctrlsService.get("gridHeaderCtrl").getHeaderHeight()+this.filterManager.getHeaderHeight(),pinnedTopHeight=this.pinnedRowModel.getPinnedTopTotalHeight();let height=0;headerHeight>0&&(height+=headerHeight),pinnedTopHeight>0&&(height+=pinnedTopHeight),height>0&&(height+=1),this.comp.setStickyTopTop(`${height}px`)}setStickyBottomOffsetBottom(){const height=this.pinnedRowModel.getPinnedBottomTotalHeight()+(this.scrollVisibleService.isHorizontalScrollShowing()&&this.gos.getScrollbarWidth()||0);this.comp.setStickyBottomBottom(`${height}px`)}sizeColumnsToFit(params,nextTimeout){const scrollWidthToRemove=this.isVerticalScrollShowing()?this.gos.getScrollbarWidth():0,availableWidth=getInnerWidth(this.eGridBody)-scrollWidthToRemove;availableWidth>0?this.columnModel.sizeColumnsToFit(availableWidth,"sizeColumnsToFit",!1,params):void 0===nextTimeout?window.setTimeout(()=>{this.sizeColumnsToFit(params,100)},0):100===nextTimeout?window.setTimeout(()=>{this.sizeColumnsToFit(params,500)},100):500===nextTimeout?window.setTimeout(()=>{this.sizeColumnsToFit(params,-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")}addScrollEventListener(listener){this.eBodyViewport.addEventListener("scroll",listener,{passive:!0})}removeScrollEventListener(listener){this.eBodyViewport.removeEventListener("scroll",listener)}};__decorateClass([Autowired("animationFrameService")],GridBodyCtrl.prototype,"animationFrameService",2),__decorateClass([Autowired("rowContainerHeightService")],GridBodyCtrl.prototype,"rowContainerHeightService",2),__decorateClass([Autowired("ctrlsService")],GridBodyCtrl.prototype,"ctrlsService",2),__decorateClass([Autowired("columnModel")],GridBodyCtrl.prototype,"columnModel",2),__decorateClass([Autowired("scrollVisibleService")],GridBodyCtrl.prototype,"scrollVisibleService",2),__decorateClass([Autowired("menuService")],GridBodyCtrl.prototype,"menuService",2),__decorateClass([Autowired("headerNavigationService")],GridBodyCtrl.prototype,"headerNavigationService",2),__decorateClass([Autowired("dragAndDropService")],GridBodyCtrl.prototype,"dragAndDropService",2),__decorateClass([Autowired("pinnedRowModel")],GridBodyCtrl.prototype,"pinnedRowModel",2),__decorateClass([Autowired("rowRenderer")],GridBodyCtrl.prototype,"rowRenderer",2),__decorateClass([Autowired("popupService")],GridBodyCtrl.prototype,"popupService",2),__decorateClass([Autowired("mouseEventService")],GridBodyCtrl.prototype,"mouseEventService",2),__decorateClass([Autowired("rowModel")],GridBodyCtrl.prototype,"rowModel",2),__decorateClass([Autowired("filterManager")],GridBodyCtrl.prototype,"filterManager",2);var CellRangeFeature=class{constructor(beans,ctrl){this.beans=beans,this.rangeService=beans.rangeService,this.selectionHandleFactory=beans.selectionHandleFactory,this.cellCtrl=ctrl}setComp(cellComp,eGui){this.cellComp=cellComp,this.eGui=eGui,this.onRangeSelectionChanged()}onRangeSelectionChanged(){this.cellComp&&(this.rangeCount=this.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected",0!==this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass("ag-cell-range-selected-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),setAriaSelected(this.eGui,this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle())}updateRangeBorders(){const rangeBorders=this.getRangeBorders(),isSingleCell=this.isSingleCell(),isTop=!isSingleCell&&rangeBorders.top,isRight=!isSingleCell&&rangeBorders.right,isBottom=!isSingleCell&&rangeBorders.bottom,isLeft=!isSingleCell&&rangeBorders.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",isTop),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",isRight),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",isBottom),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",isLeft)}isSingleCell(){const{rangeService}=this.beans;return 1===this.rangeCount&&!!rangeService&&!rangeService.isMoreThanOneCell()}getHasChartRange(){const{rangeService}=this.beans;if(!this.rangeCount||!rangeService)return!1;const cellRanges=rangeService.getCellRanges();return cellRanges.length>0&&cellRanges.every(range=>includes([1,0],range.type))}updateRangeBordersIfRangeCount(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())}getRangeBorders(){const isRtl=this.beans.gos.get("enableRtl");let top=!1,right=!1,bottom=!1,left=!1;const thisCol=this.cellCtrl.getCellPosition().column,columnModel=this.beans.columnModel;let leftCol,rightCol;isRtl?(leftCol=columnModel.getDisplayedColAfter(thisCol),rightCol=columnModel.getDisplayedColBefore(thisCol)):(leftCol=columnModel.getDisplayedColBefore(thisCol),rightCol=columnModel.getDisplayedColAfter(thisCol));const ranges=this.rangeService.getCellRanges().filter(range=>this.rangeService.isCellInSpecificRange(this.cellCtrl.getCellPosition(),range));leftCol||(left=!0),rightCol||(right=!0);for(let i=0;i<ranges.length&&!(top&&right&&bottom&&left);i++){const range=ranges[i],startRow=this.rangeService.getRangeStartRow(range),endRow=this.rangeService.getRangeEndRow(range);!top&&this.beans.rowPositionUtils.sameRow(startRow,this.cellCtrl.getCellPosition())&&(top=!0),!bottom&&this.beans.rowPositionUtils.sameRow(endRow,this.cellCtrl.getCellPosition())&&(bottom=!0),!left&&leftCol&&range.columns.indexOf(leftCol)<0&&(left=!0),!right&&rightCol&&range.columns.indexOf(rightCol)<0&&(right=!0)}return{top,right,bottom,left}}refreshHandle(){if(this.beans.context.isDestroyed())return;const shouldHaveSelectionHandle=this.shouldHaveSelectionHandle();this.selectionHandle&&!shouldHaveSelectionHandle&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),shouldHaveSelectionHandle&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}shouldHaveSelectionHandle(){const gos=this.beans.gos,cellRanges=this.rangeService.getCellRanges(),rangesLen=cellRanges.length;if(this.rangeCount<1||rangesLen<1)return!1;const cellRange=last(cellRanges),cellPosition=this.cellCtrl.getCellPosition(),isFillHandleAvailable=gos.get("enableFillHandle")&&!this.cellCtrl.isSuppressFillHandle(),isRangeHandleAvailable=gos.get("enableRangeHandle");let handleIsAvailable=1===rangesLen&&!this.cellCtrl.isEditing()&&(isFillHandleAvailable||isRangeHandleAvailable);if(this.hasChartRange){const isCategoryCell=1===cellRanges[0].type&&this.rangeService.isCellInSpecificRange(cellPosition,cellRanges[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",isCategoryCell),handleIsAvailable=0===cellRange.type}return handleIsAvailable&&null!=cellRange.endRow&&this.rangeService.isContiguousRange(cellRange)&&this.rangeService.isBottomRightCell(cellRange,cellPosition)}addSelectionHandle(){const gos=this.beans.gos,cellRangeType=last(this.rangeService.getCellRanges()).type,type=gos.get("enableFillHandle")&&missing(cellRangeType)?0:1;this.selectionHandle&&this.selectionHandle.getType()!==type&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.selectionHandleFactory.createSelectionHandle(type)),this.selectionHandle.refresh(this.cellCtrl)}destroy(){this.beans.context.destroyBean(this.selectionHandle)}},CellPositionFeature=class extends BeanStub{constructor(ctrl,beans){super(),this.cellCtrl=ctrl,this.beans=beans,this.column=ctrl.getColumn(),this.rowNode=ctrl.getRowNode()}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListener(this.beans.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}setComp(eGui){this.eGui=eGui,this.setupColSpan(),this.setupRowSpan(),this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()}onNewColumnsLoaded(){const rowSpan=this.column.getRowSpan(this.rowNode);this.rowSpan!==rowSpan&&(this.rowSpan=rowSpan,this.applyRowSpan(!0))}onDisplayColumnsChanged(){const colsSpanning=this.getColSpanningList();areEqual(this.colsSpanning,colsSpanning)||(this.colsSpanning=colsSpanning,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))}onWidthChanged(){if(!this.eGui)return;const width=this.getCellWidth();this.eGui.style.width=`${width}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((width,col)=>width+col.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const colSpan=this.column.getColSpan(this.rowNode),colsSpanning=[];if(1===colSpan)colsSpanning.push(this.column);else{let pointer=this.column;const pinned=this.column.getPinned();for(let i=0;pointer&&i<colSpan&&(colsSpanning.push(pointer),pointer=this.beans.columnModel.getDisplayedColAfter(pointer),pointer&&!missing(pointer))&&pinned===pointer.getPinned();i++);}return colsSpanning}onLeftChanged(){if(!this.eGui)return;const left=this.modifyLeftForPrintLayout(this.getCellLeft());this.eGui.style.left=left+"px"}getCellLeft(){let mostLeftCol;return mostLeftCol=this.beans.gos.get("enableRtl")&&this.colsSpanning?last(this.colsSpanning):this.column,mostLeftCol.getLeft()}modifyLeftForPrintLayout(leftPosition){if(!this.cellCtrl.isPrintLayout()||"left"===this.column.getPinned())return leftPosition;const leftWidth=this.beans.columnModel.getDisplayedColumnsLeftWidth();if("right"===this.column.getPinned()){return leftWidth+this.beans.columnModel.getBodyContainerWidth()+(leftPosition||0)}return leftWidth+(leftPosition||0)}applyRowSpan(force){if(1===this.rowSpan&&!force)return;const totalRowHeight=this.beans.gos.getRowHeightAsNumber()*this.rowSpan;this.eGui.style.height=`${totalRowHeight}px`,this.eGui.style.zIndex="1"}destroy(){super.destroy()}},CellCustomStyleFeature=class extends BeanStub{constructor(ctrl,beans){super(),this.staticClasses=[],this.cellCtrl=ctrl,this.beans=beans,this.column=ctrl.getColumn(),this.rowNode=ctrl.getRowNode()}setComp(comp){this.cellComp=comp,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const colDef=this.column.getColDef(),{cellClassRules}=colDef,cellClassParams=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef,column:this.column,rowIndex:this.rowNode.rowIndex});this.beans.stylingService.processClassRules(cellClassRules===this.cellClassRules?void 0:this.cellClassRules,cellClassRules,cellClassParams,className=>this.cellComp.addOrRemoveCssClass(className,!0),className=>this.cellComp.addOrRemoveCssClass(className,!1)),this.cellClassRules=cellClassRules}applyUserStyles(){const colDef=this.column.getColDef();if(!colDef.cellStyle)return;let styles;if("function"==typeof colDef.cellStyle){const cellStyleParams=this.beans.gos.addGridCommonParams({column:this.column,value:this.cellCtrl.getValue(),colDef,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex});styles=(0,colDef.cellStyle)(cellStyleParams)}else styles=colDef.cellStyle;styles&&this.cellComp.setUserStyles(styles)}applyClassesFromColDef(){const colDef=this.column.getColDef(),cellClassParams=this.beans.gos.addGridCommonParams({value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,column:this.column,colDef,rowIndex:this.rowNode.rowIndex});this.staticClasses.length&&this.staticClasses.forEach(className=>this.cellComp.addOrRemoveCssClass(className,!1)),this.staticClasses=this.beans.stylingService.getStaticCellClasses(colDef,cellClassParams),this.staticClasses.length&&this.staticClasses.forEach(className=>this.cellComp.addOrRemoveCssClass(className,!0))}destroy(){super.destroy()}},Beans=class{postConstruct(){this.gos.isRowModelType("clientSide")&&(this.clientSideRowModel=this.rowModel),this.gos.isRowModelType("serverSide")&&(this.serverSideRowModel=this.rowModel)}};__decorateClass([Autowired("resizeObserverService")],Beans.prototype,"resizeObserverService",2),__decorateClass([Autowired("paginationProxy")],Beans.prototype,"paginationProxy",2),__decorateClass([Autowired("context")],Beans.prototype,"context",2),__decorateClass([Autowired("gridOptionsService")],Beans.prototype,"gos",2),__decorateClass([Autowired("environment")],Beans.prototype,"environment",2),__decorateClass([Autowired("rowRenderer")],Beans.prototype,"rowRenderer",2),__decorateClass([Autowired("valueService")],Beans.prototype,"valueService",2),__decorateClass([Autowired("eventService")],Beans.prototype,"eventService",2),__decorateClass([Autowired("columnModel")],Beans.prototype,"columnModel",2),__decorateClass([Autowired("headerNavigationService")],Beans.prototype,"headerNavigationService",2),__decorateClass([Autowired("navigationService")],Beans.prototype,"navigationService",2),__decorateClass([Autowired("columnAnimationService")],Beans.prototype,"columnAnimationService",2),__decorateClass([Autowired("focusService")],Beans.prototype,"focusService",2),__decorateClass([Autowired("popupService")],Beans.prototype,"popupService",2),__decorateClass([Autowired("stylingService")],Beans.prototype,"stylingService",2),__decorateClass([Autowired("columnHoverService")],Beans.prototype,"columnHoverService",2),__decorateClass([Autowired("userComponentFactory")],Beans.prototype,"userComponentFactory",2),__decorateClass([Autowired("userComponentRegistry")],Beans.prototype,"userComponentRegistry",2),__decorateClass([Autowired("animationFrameService")],Beans.prototype,"animationFrameService",2),__decorateClass([Autowired("dragService")],Beans.prototype,"dragService",2),__decorateClass([Autowired("dragAndDropService")],Beans.prototype,"dragAndDropService",2),__decorateClass([Autowired("sortController")],Beans.prototype,"sortController",2),__decorateClass([Autowired("filterManager")],Beans.prototype,"filterManager",2),__decorateClass([Autowired("rowContainerHeightService")],Beans.prototype,"rowContainerHeightService",2),__decorateClass([Autowired("frameworkOverrides")],Beans.prototype,"frameworkOverrides",2),__decorateClass([Autowired("cellPositionUtils")],Beans.prototype,"cellPositionUtils",2),__decorateClass([Autowired("rowPositionUtils")],Beans.prototype,"rowPositionUtils",2),__decorateClass([Autowired("selectionService")],Beans.prototype,"selectionService",2),__decorateClass([Autowired("rowCssClassCalculator")],Beans.prototype,"rowCssClassCalculator",2),__decorateClass([Autowired("rowModel")],Beans.prototype,"rowModel",2),__decorateClass([Autowired("ctrlsService")],Beans.prototype,"ctrlsService",2),__decorateClass([Autowired("ctrlsFactory")],Beans.prototype,"ctrlsFactory",2),__decorateClass([Autowired("agStackComponentsRegistry")],Beans.prototype,"agStackComponentsRegistry",2),__decorateClass([Autowired("valueCache")],Beans.prototype,"valueCache",2),__decorateClass([Autowired("rowNodeEventThrottle")],Beans.prototype,"rowNodeEventThrottle",2),__decorateClass([Autowired("localeService")],Beans.prototype,"localeService",2),__decorateClass([Autowired("syncService")],Beans.prototype,"syncService",2),__decorateClass([Autowired("ariaAnnouncementService")],Beans.prototype,"ariaAnnouncementService",2),__decorateClass([Optional("rangeService")],Beans.prototype,"rangeService",2),__decorateClass([Optional("selectionHandleFactory")],Beans.prototype,"selectionHandleFactory",2),__decorateClass([PostConstruct],Beans.prototype,"postConstruct",1),Beans=__decorateClass([Bean("beans")],Beans);var CellMouseListenerFeature=class extends Beans{constructor(ctrl,beans,column){super(),this.cellCtrl=ctrl,this.beans=beans,this.column=column}onMouseEvent(eventName,mouseEvent){if(!isStopPropagationForAgGrid(mouseEvent))switch(eventName){case"click":this.onCellClicked(mouseEvent);break;case"mousedown":case"touchstart":this.onMouseDown(mouseEvent);break;case"dblclick":this.onCellDoubleClicked(mouseEvent);break;case"mouseout":this.onMouseOut(mouseEvent);break;case"mouseover":this.onMouseOver(mouseEvent)}}onCellClicked(mouseEvent){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(mouseEvent),void mouseEvent.preventDefault();const{eventService,rangeService,gos}=this.beans,isMultiKey=mouseEvent.ctrlKey||mouseEvent.metaKey;rangeService&&isMultiKey&&rangeService.getCellRangeCount(this.cellCtrl.getCellPosition())>1&&rangeService.intersectLastRange(!0);const cellClickedEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_CLICKED);eventService.dispatchEvent(cellClickedEvent);const colDef=this.column.getColDef();colDef.onCellClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{colDef.onCellClicked(cellClickedEvent)})},0);!((gos.get("singleClickEdit")||colDef.singleClickEdit)&&!gos.get("suppressClickEdit"))||mouseEvent.shiftKey&&0!=(null==rangeService?void 0:rangeService.getCellRanges().length)||this.cellCtrl.startRowOrCellEdit()}isDoubleClickOnIPad(){if(!isIOSUserAgent()||isEventSupported("dblclick"))return!1;const nowMillis=(new Date).getTime(),res=nowMillis-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=nowMillis,res}onCellDoubleClicked(mouseEvent){const colDef=this.column.getColDef(),cellDoubleClickedEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(cellDoubleClickedEvent),"function"==typeof colDef.onCellDoubleClicked&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{colDef.onCellDoubleClicked(cellDoubleClickedEvent)})},0);!this.beans.gos.get("singleClickEdit")&&!this.beans.gos.get("suppressClickEdit")&&this.cellCtrl.startRowOrCellEdit(null,mouseEvent)}onMouseDown(mouseEvent){const{ctrlKey,metaKey,shiftKey}=mouseEvent,target=mouseEvent.target,{cellCtrl,beans}=this,{eventService,rangeService,focusService}=beans;if(this.isRightClickInExistingRange(mouseEvent))return;const ranges=rangeService&&0!=rangeService.getCellRanges().length;if(!shiftKey||!ranges){const forceBrowserFocus=isBrowserSafari()&&!cellCtrl.isEditing()&&!isFocusableFormField(target);cellCtrl.focusCell(forceBrowserFocus)}if(shiftKey&&ranges&&!focusService.isCellFocused(cellCtrl.getCellPosition())){mouseEvent.preventDefault();const focusedCellPosition=focusService.getFocusedCell();if(focusedCellPosition){const{column,rowIndex,rowPinned}=focusedCellPosition,focusedRowCtrl=beans.rowRenderer.getRowByPosition({rowIndex,rowPinned}),focusedCellCtrl=null==focusedRowCtrl?void 0:focusedRowCtrl.getCellCtrl(column);(null==focusedCellCtrl?void 0:focusedCellCtrl.isEditing())&&focusedCellCtrl.stopEditing(),focusService.setFocusedCell({column,rowIndex,rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}}if(!this.containsWidget(target)){if(rangeService){const thisCell=this.cellCtrl.getCellPosition();if(shiftKey)rangeService.extendLatestRangeToCell(thisCell);else{const isMultiKey=ctrlKey||metaKey;rangeService.setRangeToCell(thisCell,isMultiKey)}}eventService.dispatchEvent(this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_MOUSE_DOWN))}}isRightClickInExistingRange(mouseEvent){const{rangeService}=this.beans;if(rangeService){const cellInRange=rangeService.isCellInAnyRange(this.cellCtrl.getCellPosition()),isRightClick=2===mouseEvent.button||mouseEvent.ctrlKey&&this.beans.gos.get("allowContextMenuWithControlKey");if(cellInRange&&isRightClick)return!0}return!1}containsWidget(target){return isElementChildOfClass(target,"ag-selection-checkbox",3)}onMouseOut(mouseEvent){if(this.mouseStayingInsideCell(mouseEvent))return;const cellMouseOutEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(cellMouseOutEvent),this.beans.columnHoverService.clearMouseOver()}onMouseOver(mouseEvent){if(this.mouseStayingInsideCell(mouseEvent))return;const cellMouseOverEvent=this.cellCtrl.createEvent(mouseEvent,Events.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(cellMouseOverEvent),this.beans.columnHoverService.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const eGui=this.cellCtrl.getGui(),cellContainsTarget=eGui.contains(e.target),cellContainsRelatedTarget=eGui.contains(e.relatedTarget);return cellContainsTarget&&cellContainsRelatedTarget}destroy(){}},CellKeyboardListenerFeature=class extends BeanStub{constructor(ctrl,beans,column,rowNode,rowCtrl){super(),this.cellCtrl=ctrl,this.beans=beans,this.rowNode=rowNode,this.rowCtrl=rowCtrl}setComp(eGui){this.eGui=eGui}onKeyDown(event){const key=event.key;switch(key){case KeyCode.ENTER:this.onEnterKeyDown(event);break;case KeyCode.F2:this.onF2KeyDown(event);break;case KeyCode.ESCAPE:this.onEscapeKeyDown(event);break;case KeyCode.TAB:this.onTabKeyDown(event);break;case KeyCode.BACKSPACE:case KeyCode.DELETE:this.onBackspaceOrDeleteKeyDown(key,event);break;case KeyCode.DOWN:case KeyCode.UP:case KeyCode.RIGHT:case KeyCode.LEFT:this.onNavigationKeyDown(event,key)}}onNavigationKeyDown(event,key){this.cellCtrl.isEditing()||(event.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(event):this.beans.navigationService.navigateToNextCell(event,key,this.cellCtrl.getCellPosition(),!0),event.preventDefault())}onShiftRangeSelect(event){if(!this.beans.rangeService)return;const endCell=this.beans.rangeService.extendLatestRangeInDirection(event);endCell&&this.beans.navigationService.ensureCellVisible(endCell)}onTabKeyDown(event){this.beans.navigationService.onTabKeyDown(this.cellCtrl,event)}onBackspaceOrDeleteKeyDown(key,event){var _a;const{cellCtrl,beans,rowNode}=this,{gos,rangeService,eventService}=beans;if(!cellCtrl.isEditing()){if(eventService.dispatchEvent({type:Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START}),isDeleteKey(key,gos.get("enableCellEditingOnBackspace"))){if(rangeService&&gos.get("enableRangeSelection"))rangeService.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(cellCtrl.isCellEditable()){const column=cellCtrl.getColumn(),emptyValue=null!=(_a=this.beans.valueService.parseValue(column,rowNode,"",rowNode.getValueFromValueService(column)))?_a:null;rowNode.setDataValue(column,emptyValue,"cellClear")}}else cellCtrl.startRowOrCellEdit(key,event);eventService.dispatchEvent({type:Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END})}}onEnterKeyDown(e){if(this.cellCtrl.isEditing()||this.rowCtrl.isEditing())this.cellCtrl.stopEditingAndFocus(!1,e.shiftKey);else if(this.beans.gos.get("enterNavigatesVertically")){const key=e.shiftKey?KeyCode.UP:KeyCode.DOWN;this.beans.navigationService.navigateToNextCell(null,key,this.cellCtrl.getCellPosition(),!1)}else this.cellCtrl.startRowOrCellEdit(KeyCode.ENTER,e),this.cellCtrl.isEditing()&&e.preventDefault()}onF2KeyDown(event){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(KeyCode.F2,event)}onEscapeKeyDown(event){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))}processCharacter(event){if(event.target!==this.eGui||this.cellCtrl.isEditing())return;const key=event.key;" "===key?this.onSpaceKeyDown(event):(this.cellCtrl.startRowOrCellEdit(key,event),event.preventDefault())}onSpaceKeyDown(event){const{gos}=this.beans;if(!this.cellCtrl.isEditing()&&gos.isRowSelection()){const currentSelection=this.rowNode.isSelected(),newSelection=!currentSelection;if(newSelection||!gos.get("suppressRowDeselection")){const groupSelectsFiltered=this.beans.gos.get("groupSelectsFiltered"),updatedCount=this.rowNode.setSelectedParams({newValue:newSelection,rangeSelect:event.shiftKey,groupSelectsFiltered,event,source:"spaceKey"});void 0===currentSelection&&0===updatedCount&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:event.shiftKey,groupSelectsFiltered,event,source:"spaceKey"})}}event.preventDefault()}destroy(){super.destroy()}},DndSourceComp=class extends Component{constructor(rowNode,column,eCell){super('<div class="ag-drag-handle ag-row-drag" draggable="true"></div>'),this.rowNode=rowNode,this.column=column,this.eCell=eCell}postConstruct(){this.getGui().appendChild(createIconNoSpan("rowDrag",this.gos,null)),this.addGuiEventListener("mousedown",e=>{e.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(dragEvent){const providedOnRowDrag=this.column.getColDef().dndSourceOnRowDrag;dragEvent.dataTransfer.setDragImage(this.eCell,0,0);const defaultOnRowDrag=()=>{try{const jsonData=JSON.stringify(this.rowNode.data);dragEvent.dataTransfer.setData("application/json",jsonData),dragEvent.dataTransfer.setData("text/plain",jsonData)}catch(e){}};if(providedOnRowDrag){providedOnRowDrag(this.gos.addGridCommonParams({rowNode:this.rowNode,dragEvent}))}else defaultOnRowDrag()}checkVisibility(){const visible=this.column.isDndSource(this.rowNode);this.setDisplayed(visible)}};__decorateClass([PostConstruct],DndSourceComp.prototype,"postConstruct",1);var CssClassApplier=class{static getHeaderClassesFromColDef(abstractColDef,gos,column,columnGroup){return missing(abstractColDef)?[]:this.getColumnClassesFromCollDef(abstractColDef.headerClass,abstractColDef,gos,column,columnGroup)}static getToolPanelClassesFromColDef(abstractColDef,gos,column,columnGroup){return missing(abstractColDef)?[]:this.getColumnClassesFromCollDef(abstractColDef.toolPanelClass,abstractColDef,gos,column,columnGroup)}static refreshFirstAndLastStyles(comp,column,columnModel){comp.addOrRemoveCssClass("ag-column-first",columnModel.isColumnAtEdge(column,"first")),comp.addOrRemoveCssClass("ag-column-last",columnModel.isColumnAtEdge(column,"last"))}static getClassParams(abstractColDef,gos,column,columnGroup){return gos.addGridCommonParams({colDef:abstractColDef,column,columnGroup})}static getColumnClassesFromCollDef(classesOrFunc,abstractColDef,gos,column,columnGroup){if(missing(classesOrFunc))return[];let classToUse;if("function"==typeof classesOrFunc){classToUse=classesOrFunc(this.getClassParams(abstractColDef,gos,column,columnGroup))}else classToUse=classesOrFunc;return"string"==typeof classToUse?[classToUse]:Array.isArray(classToUse)?[...classToUse]:[]}},instanceIdSequence2=0,_CellCtrl=class _CellCtrl extends BeanStub{constructor(column,rowNode,beans,rowCtrl){super(),this.cellRangeFeature=null,this.cellPositionFeature=null,this.cellCustomStyleFeature=null,this.tooltipFeature=null,this.cellMouseListenerFeature=null,this.cellKeyboardListenerFeature=null,this.suppressRefreshCell=!1,this.onCellCompAttachedFuncs=[],this.column=column,this.rowNode=rowNode,this.beans=beans,this.rowCtrl=rowCtrl,this.instanceId=column.getId()+"-"+instanceIdSequence2++,this.colIdSanitised=escapeString(this.column.getId()),beans.gos.get("suppressCellFocus")||(this.tabIndex=-1),this.createCellPosition(),this.addFeatures(),this.updateAndFormatValue(!1)}shouldRestoreFocus(){return this.beans.focusService.shouldRestoreFocus(this.cellPosition)}addFeatures(){this.cellPositionFeature=new CellPositionFeature(this,this.beans),this.addDestroyFunc(()=>{var _a;null==(_a=this.cellPositionFeature)||_a.destroy(),this.cellPositionFeature=null}),this.cellCustomStyleFeature=new CellCustomStyleFeature(this,this.beans),this.addDestroyFunc(()=>{var _a;null==(_a=this.cellCustomStyleFeature)||_a.destroy(),this.cellCustomStyleFeature=null}),this.cellMouseListenerFeature=new CellMouseListenerFeature(this,this.beans,this.column),this.addDestroyFunc(()=>{var _a;null==(_a=this.cellMouseListenerFeature)||_a.destroy(),this.cellMouseListenerFeature=null}),this.cellKeyboardListenerFeature=new CellKeyboardListenerFeature(this,this.beans,this.column,this.rowNode,this.rowCtrl),this.addDestroyFunc(()=>{var _a;null==(_a=this.cellKeyboardListenerFeature)||_a.destroy(),this.cellKeyboardListenerFeature=null}),this.column.isTooltipEnabled()&&(this.enableTooltipFeature(),this.addDestroyFunc(()=>{this.disableTooltipFeature()}));this.beans.rangeService&&this.beans.gos.get("enableRangeSelection")&&(this.cellRangeFeature=new CellRangeFeature(this.beans,this),this.addDestroyFunc(()=>{var _a;null==(_a=this.cellRangeFeature)||_a.destroy(),this.cellRangeFeature=null}))}enableTooltipFeature(value,shouldDisplayTooltip){const isTooltipWhenTruncated="whenTruncated"===this.beans.gos.get("tooltipShowMode");shouldDisplayTooltip||!isTooltipWhenTruncated||this.isCellRenderer()||(shouldDisplayTooltip=()=>{const eGui=this.getGui(),textEl=0===eGui.children.length?eGui:eGui.querySelector(".ag-cell-value");return!textEl||textEl.scrollWidth>textEl.clientWidth});const tooltipCtrl={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getRowIndex:()=>this.cellPosition.rowIndex,getRowNode:()=>this.rowNode,getGui:()=>this.getGui(),getLocation:()=>"cell",getTooltipValue:null!=value?()=>value:()=>{const colDef=this.column.getColDef(),data=this.rowNode.data;if(colDef.tooltipField&&exists(data))return getValueUsingField(data,colDef.tooltipField,this.column.isTooltipFieldContainsDots());const valueGetter=colDef.tooltipValueGetter;return valueGetter?valueGetter(this.beans.gos.addGridCommonParams({location:"cell",colDef:this.column.getColDef(),column:this.column,rowIndex:this.cellPosition.rowIndex,node:this.rowNode,data:this.rowNode.data,value:this.value,valueFormatted:this.valueFormatted})):null},getValueFormatted:()=>this.valueFormatted,shouldDisplayTooltip};this.tooltipFeature=new TooltipFeature(tooltipCtrl,this.beans)}disableTooltipFeature(){this.tooltipFeature&&(this.tooltipFeature.destroy(),this.tooltipFeature=null)}setComp(comp,eGui,eCellWrapper,printLayout,startEditing){var _a,_b,_c,_d;this.cellComp=comp,this.eGui=eGui,this.printLayout=printLayout,this.addDomData(),this.onCellFocused(this.focusEventToRestore),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(eCellWrapper),this.refreshFirstAndLastStyles(),this.refreshAriaColIndex(),null==(_a=this.cellPositionFeature)||_a.setComp(eGui),null==(_b=this.cellCustomStyleFeature)||_b.setComp(comp),null==(_c=this.tooltipFeature)||_c.refreshToolTip(),null==(_d=this.cellKeyboardListenerFeature)||_d.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(comp,eGui),startEditing&&this.isCellEditable()?this.startEditing():this.showValue(),this.onCellCompAttachedFuncs.length&&(this.onCellCompAttachedFuncs.forEach(func=>func()),this.onCellCompAttachedFuncs=[])}setupAutoHeight(eCellWrapper){if(this.isAutoHeight=this.column.isAutoHeight(),!this.isAutoHeight||!eCellWrapper)return;const eParentCell=eCellWrapper.parentElement,minRowHeight=this.beans.gos.getRowHeightForNode(this.rowNode).height,measureHeight=timesCalled=>{if(this.editing)return;if(!this.isAlive())return;const{paddingTop,paddingBottom,borderBottomWidth,borderTopWidth}=getElementSize(eParentCell),extraHeight=paddingTop+paddingBottom+borderBottomWidth+borderTopWidth,autoHeight=eCellWrapper.offsetHeight+extraHeight;if(timesCalled<5){const doc=this.beans.gos.getDocument();if(!doc||!doc.contains(eCellWrapper)||0==autoHeight)return void window.setTimeout(()=>measureHeight(timesCalled+1),0)}const newHeight=Math.max(autoHeight,minRowHeight);this.rowNode.setRowAutoHeight(newHeight,this.column)},listener=()=>measureHeight(0);listener();const destroyResizeObserver=this.beans.resizeObserverService.observeResize(eCellWrapper,listener);this.addDestroyFunc(()=>{destroyResizeObserver(),this.rowNode.setRowAutoHeight(void 0,this.column)})}getCellAriaRole(){var _a;return null!=(_a=this.column.getColDef().cellAriaRole)?_a:"gridcell"}getInstanceId(){return this.instanceId}getColumnIdSanitised(){return this.colIdSanitised}getTabIndex(){return this.tabIndex}isCellRenderer(){const colDef=this.column.getColDef();return null!=colDef.cellRenderer||null!=colDef.cellRendererSelector}getValueToDisplay(){var _a;return null!=(_a=this.valueFormatted)?_a:this.value}showValue(forceNewCellRendererInstance=!1){var _a;const valueToDisplay=this.getValueToDisplay();let compDetails;if(this.rowNode.stub){const params=this.createCellRendererParams();compDetails=this.beans.userComponentFactory.getLoadingCellRendererDetails(this.column.getColDef(),params)}else if(this.isCellRenderer()){const params=this.createCellRendererParams();compDetails=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),params)}this.cellComp.setRenderDetails(compDetails,valueToDisplay,forceNewCellRendererInstance),null==(_a=this.cellRangeFeature)||_a.refreshHandle()}setupControlComps(){const colDef=this.column.getColDef();this.includeSelection=this.isIncludeControl(colDef.checkboxSelection),this.includeRowDrag=this.isIncludeControl(colDef.rowDrag),this.includeDndSource=this.isIncludeControl(colDef.dndSource),this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}isIncludeControl(value){return!(null!=this.rowNode.rowPinned)&&("function"==typeof value||!0===value)}refreshShouldDestroy(){const colDef=this.column.getColDef(),selectionChanged=this.includeSelection!=this.isIncludeControl(colDef.checkboxSelection),rowDragChanged=this.includeRowDrag!=this.isIncludeControl(colDef.rowDrag),dndSourceChanged=this.includeDndSource!=this.isIncludeControl(colDef.dndSource),autoHeightChanged=this.isAutoHeight!=this.column.isAutoHeight();return selectionChanged||rowDragChanged||dndSourceChanged||autoHeightChanged}startEditing(key=null,cellStartedEdit=!1,event=null){if(!this.isCellEditable()||this.editing)return;if(!this.cellComp)return void this.onCellCompAttachedFuncs.push(()=>{this.startEditing(key,cellStartedEdit,event)});const editorParams=this.createCellEditorParams(key,cellStartedEdit),colDef=this.column.getColDef(),compDetails=this.beans.userComponentFactory.getCellEditorDetails(colDef,editorParams);this.editCompDetails=compDetails;const popup=null!=(null==compDetails?void 0:compDetails.popupFromSelector)?compDetails.popupFromSelector:!!colDef.cellEditorPopup,position=null!=(null==compDetails?void 0:compDetails.popupPositionFromSelector)?compDetails.popupPositionFromSelector:colDef.cellEditorPopupPosition;this.setEditing(!0),this.cellComp.setEditDetails(compDetails,popup,position,this.beans.gos.get("reactiveCustomComponents"));const e=this.createEvent(event,Events.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(e)}setEditing(editing){var _a;this.editing!==editing&&(this.editing=editing,null==(_a=this.cellRangeFeature)||_a.refreshHandle())}stopRowOrCellEdit(cancel=!1){"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.stopEditing(cancel):this.stopEditing(cancel)}onPopupEditorClosed(){this.isEditing()&&this.stopEditingAndFocus()}takeValueFromCellEditor(cancel){const noValueResult={newValueExists:!1};if(cancel)return noValueResult;const cellEditor=this.cellComp.getCellEditor();if(!cellEditor)return noValueResult;if(cellEditor.isCancelAfterEnd&&cellEditor.isCancelAfterEnd())return noValueResult;return{newValue:cellEditor.getValue(),newValueExists:!0}}saveNewValue(oldValue,newValue){if(newValue===oldValue)return!1;this.suppressRefreshCell=!0;const valueChanged=this.rowNode.setDataValue(this.column,newValue,"edit");return this.suppressRefreshCell=!1,valueChanged}stopEditing(cancel=!1){if(!this.editing)return!1;const{newValue,newValueExists}=this.takeValueFromCellEditor(cancel),oldValue=this.rowNode.getValueFromValueService(this.column);let valueChanged=!1;return newValueExists&&(valueChanged=this.saveNewValue(oldValue,newValue)),this.setEditing(!1),this.cellComp.setEditDetails(),this.editCompDetails=void 0,this.updateAndFormatValue(!1),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(oldValue,newValue,!cancel&&!!valueChanged),valueChanged}dispatchEditingStoppedEvent(oldValue,newValue,valueChanged){const editingStoppedEvent=__spreadProps(__spreadValues({},this.createEvent(null,Events.EVENT_CELL_EDITING_STOPPED)),{oldValue,newValue,valueChanged});this.beans.eventService.dispatchEvent(editingStoppedEvent)}createCellEditorParams(key,cellStartedEdit){return this.beans.gos.addGridCommonParams({value:this.rowNode.getValueFromValueService(this.column),eventKey:key,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,cellStartedEdit,onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)})}createCellRendererParams(){return this.beans.gos.addGridCommonParams({value:this.value,valueFormatted:this.valueFormatted,getValue:()=>this.rowNode.getValueFromValueService(this.column),setValue:value=>this.beans.valueService.setValue(this.rowNode,this.column,value),formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,pinned:this.column.getPinned(),colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:(rowDraggerElement,dragStartPixels,value,suppressVisibilityChange)=>this.registerRowDragger(rowDraggerElement,dragStartPixels,suppressVisibilityChange),setTooltip:(value,shouldDisplayTooltip)=>{var _a;this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(value,shouldDisplayTooltip),null==(_a=this.tooltipFeature)||_a.refreshToolTip()}})}parseValue(newValue){return this.beans.valueService.parseValue(this.column,this.rowNode,newValue,this.getValue())}setFocusOutOnEditor(){if(!this.editing)return;const cellEditor=this.cellComp.getCellEditor();cellEditor&&cellEditor.focusOut&&cellEditor.focusOut()}setFocusInOnEditor(){if(!this.editing)return;const cellEditor=this.cellComp.getCellEditor();cellEditor&&cellEditor.focusIn?cellEditor.focusIn():this.focusCell(!0)}onCellChanged(event){event.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(params){var _a;this.refreshShouldDestroy()?null==(_a=this.rowCtrl)||_a.recreateCell(this):this.refreshCell(params)}refreshCell(params){var _a,_b,_c,_d;if(this.suppressRefreshCell||this.editing)return;const colDef=this.column.getColDef(),newData=null!=params&&!!params.newData,suppressFlash=null!=params&&!!params.suppressFlash||!!colDef.suppressCellFlash,noValueProvided=null==colDef.field&&null==colDef.valueGetter&&null==colDef.showRowGroup,forceRefresh=params&&params.forceRefresh||noValueProvided||newData,isCellCompReady=!!this.cellComp,valuesDifferent=this.updateAndFormatValue(isCellCompReady);if(isCellCompReady){if(forceRefresh||valuesDifferent){this.showValue(newData);const processingFilterChange=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!suppressFlash&&!processingFilterChange&&(this.beans.gos.get("enableCellChangeFlash")||colDef.enableCellChangeFlash)&&this.flashCell(),null==(_a=this.cellCustomStyleFeature)||_a.applyUserStyles(),null==(_b=this.cellCustomStyleFeature)||_b.applyClassesFromColDef()}null==(_c=this.tooltipFeature)||_c.refreshToolTip(),null==(_d=this.cellCustomStyleFeature)||_d.applyCellClassRules()}}stopEditingAndFocus(suppressNavigateAfterEdit=!1,shiftKey=!1){this.stopRowOrCellEdit(),this.focusCell(!0),suppressNavigateAfterEdit||this.navigateAfterEdit(shiftKey)}navigateAfterEdit(shiftKey){if(this.beans.gos.get("enterNavigatesVerticallyAfterEdit")){const key=shiftKey?KeyCode.UP:KeyCode.DOWN;this.beans.navigationService.navigateToNextCell(null,key,this.getCellPosition(),!1)}}flashCell(delays){var _a,_b;const flashDuration=null!=(_a=null==delays?void 0:delays.flashDuration)?_a:null==delays?void 0:delays.flashDelay,fadeDuration=null!=(_b=null==delays?void 0:delays.fadeDuration)?_b:null==delays?void 0:delays.fadeDelay;this.animateCell("data-changed",flashDuration,fadeDuration)}animateCell(cssName,flashDuration,fadeDuration){if(!this.cellComp)return;const fullName=`ag-cell-${cssName}`,animationFullName=`ag-cell-${cssName}-animation`,{gos}=this.beans;flashDuration||(flashDuration=gos.get("cellFlashDuration")),exists(fadeDuration)||(fadeDuration=gos.get("cellFadeDuration")),this.cellComp.addOrRemoveCssClass(fullName,!0),this.cellComp.addOrRemoveCssClass(animationFullName,!1),this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(fullName,!1),this.cellComp.addOrRemoveCssClass(animationFullName,!0),this.eGui.style.transition=`background-color ${fadeDuration}ms`,window.setTimeout(()=>{this.isAlive()&&(this.cellComp.addOrRemoveCssClass(animationFullName,!1),this.eGui.style.transition="")},fadeDuration))},flashDuration)})}onFlashCells(event){if(!this.cellComp)return;const cellId=this.beans.cellPositionUtils.createId(this.getCellPosition());event.cells[cellId]&&this.animateCell("highlight")}isCellEditable(){return this.column.isCellEditable(this.rowNode)}isSuppressFillHandle(){return this.column.isSuppressFillHandle()}formatValue(value){var _a;return null!=(_a=this.callValueFormatter(value))?_a:value}callValueFormatter(value){return this.beans.valueService.formatValue(this.column,this.rowNode,value)}updateAndFormatValue(compareValues){const oldValue=this.value,oldValueFormatted=this.valueFormatted;return this.value=this.rowNode.getValueFromValueService(this.column),this.valueFormatted=this.callValueFormatter(this.value),!compareValues||(!this.valuesAreEqual(oldValue,this.value)||this.valueFormatted!=oldValueFormatted)}valuesAreEqual(val1,val2){const colDef=this.column.getColDef();return colDef.equals?colDef.equals(val1,val2):val1===val2}getComp(){return this.cellComp}getValue(){return this.value}addDomData(){const element=this.getGui();this.beans.gos.setDomData(element,_CellCtrl.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(()=>this.beans.gos.setDomData(element,_CellCtrl.DOM_DATA_KEY_CELL_CTRL,null))}createEvent(domEvent,eventType){return this.beans.gos.addGridCommonParams({type:eventType,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),rowPinned:this.rowNode.rowPinned,event:domEvent,rowIndex:this.rowNode.rowIndex})}processCharacter(event){var _a;null==(_a=this.cellKeyboardListenerFeature)||_a.processCharacter(event)}onKeyDown(event){var _a;null==(_a=this.cellKeyboardListenerFeature)||_a.onKeyDown(event)}onMouseEvent(eventName,mouseEvent){var _a;null==(_a=this.cellMouseListenerFeature)||_a.onMouseEvent(eventName,mouseEvent)}getGui(){return this.eGui}getColSpanningList(){return this.cellPositionFeature.getColSpanningList()}onLeftChanged(){var _a;this.cellComp&&(null==(_a=this.cellPositionFeature)||_a.onLeftChanged())}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{cellComp,column,beans}=this;CssClassApplier.refreshFirstAndLastStyles(cellComp,column,beans.columnModel)}refreshAriaColIndex(){const colIdx=this.beans.columnModel.getAriaColumnIndex(this.column);setAriaColIndex(this.getGui(),colIdx)}isSuppressNavigable(){return this.column.isSuppressNavigable(this.rowNode)}onWidthChanged(){var _a;return null==(_a=this.cellPositionFeature)?void 0:_a.onWidthChanged()}getColumn(){return this.column}getRowNode(){return this.rowNode}isPrintLayout(){return this.printLayout}getCellPosition(){return this.cellPosition}isEditing(){return this.editing}startRowOrCellEdit(key,event=null){this.cellComp?"fullRow"===this.beans.gos.get("editType")?this.rowCtrl.startRowEditing(key,this):this.startEditing(key,!0,event):this.onCellCompAttachedFuncs.push(()=>{this.startRowOrCellEdit(key,event)})}getRowCtrl(){return this.rowCtrl}getRowPosition(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}}updateRangeBordersIfRangeCount(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()}onRangeSelectionChanged(){this.cellComp&&this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}isRangeSelectionEnabled(){return null!=this.cellRangeFeature}focusCell(forceBrowserFocus=!1){this.beans.focusService.setFocusedCell({rowIndex:this.getCellPosition().rowIndex,column:this.column,rowPinned:this.rowNode.rowPinned,forceBrowserFocus})}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()}onFirstRightPinnedChanged(){if(!this.cellComp)return;const firstRightPinned=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",firstRightPinned)}onLastLeftPinnedChanged(){if(!this.cellComp)return;const lastLeftPinned=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",lastLeftPinned)}onCellFocused(event){if(this.beans.gos.get("suppressCellFocus"))return;const cellFocused=this.beans.focusService.isCellFocused(this.cellPosition);if(!this.cellComp)return void(cellFocused&&(null==event?void 0:event.forceBrowserFocus)&&(this.focusEventToRestore=event));if(this.focusEventToRestore=void 0,this.cellComp.addOrRemoveCssClass("ag-cell-focus",cellFocused),cellFocused&&event&&event.forceBrowserFocus){this.cellComp.getFocusableElement().focus({preventScroll:!!event.preventScrollOnBrowserFocus})}const fullRowEdit="fullRow"===this.beans.gos.get("editType");cellFocused||fullRowEdit||!this.editing||this.stopRowOrCellEdit(),cellFocused&&this.rowCtrl.announceDescription()}createCellPosition(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:makeNull(this.rowNode.rowPinned),column:this.column}}applyStaticCssClasses(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass("ag-cell-not-inline-editing",!0);const autoHeight=1==this.column.isAutoHeight();this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",autoHeight),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!autoHeight)}onColumnHover(){if(!this.cellComp)return;if(!this.beans.gos.get("columnHoverHighlight"))return;const isHovered=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",isHovered)}onColDefChanged(){if(!this.cellComp)return;if(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editing){const cellEditor=this.getCellEditor();if(null==cellEditor?void 0:cellEditor.refresh){const{eventKey,cellStartedEdit}=this.editCompDetails.params,editorParams=this.createCellEditorParams(eventKey,cellStartedEdit),colDef=this.column.getColDef(),compDetails=this.beans.userComponentFactory.getCellEditorDetails(colDef,editorParams);cellEditor.refresh(compDetails.params)}}else this.refreshOrDestroyCell({forceRefresh:!0,suppressFlash:!0})}setWrapText(){const value=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",value)}dispatchCellContextMenuEvent(event){const colDef=this.column.getColDef(),cellContextMenuEvent=this.createEvent(event,Events.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(cellContextMenuEvent),colDef.onCellContextMenu&&window.setTimeout(()=>{this.beans.frameworkOverrides.wrapOutgoing(()=>{colDef.onCellContextMenu(cellContextMenuEvent)})},0)}getCellRenderer(){return this.cellComp?this.cellComp.getCellRenderer():null}getCellEditor(){return this.cellComp?this.cellComp.getCellEditor():null}destroy(){this.onCellCompAttachedFuncs=[],super.destroy()}createSelectionCheckbox(){const cbSelectionComponent=new CheckboxSelectionComponent;return this.beans.context.createBean(cbSelectionComponent),cbSelectionComponent.init({rowNode:this.rowNode,column:this.column}),cbSelectionComponent}createDndSource(){const dndSourceComp=new DndSourceComp(this.rowNode,this.column,this.eGui);return this.beans.context.createBean(dndSourceComp),dndSourceComp}registerRowDragger(customElement,dragStartPixels,suppressVisibilityChange){if(this.customRowDragComp)return void this.customRowDragComp.setDragElement(customElement,dragStartPixels);const newComp=this.createRowDragComp(customElement,dragStartPixels,suppressVisibilityChange);newComp&&(this.customRowDragComp=newComp,this.addDestroyFunc(()=>{this.beans.context.destroyBean(newComp),this.customRowDragComp=null}))}createRowDragComp(customElement,dragStartPixels,suppressVisibilityChange){const pagination=this.beans.gos.get("pagination"),rowDragManaged=this.beans.gos.get("rowDragManaged"),clientSideRowModelActive=this.beans.gos.isRowModelType("clientSide");if(rowDragManaged){if(!clientSideRowModelActive)return void warnOnce("managed row dragging is only allowed in the Client Side Row Model");if(pagination)return void warnOnce("managed row dragging is not possible when doing pagination")}const rowDragComp=new RowDragComp(()=>this.value,this.rowNode,this.column,customElement,dragStartPixels,suppressVisibilityChange);return this.beans.context.createBean(rowDragComp),rowDragComp}};_CellCtrl.DOM_DATA_KEY_CELL_CTRL="cellCtrl";var CellCtrl=_CellCtrl,instanceIdSequence3=0,_RowCtrl=class _RowCtrl extends BeanStub{constructor(rowNode,beans,animateIn,useAnimationFrameForCreate,printLayout){super(),this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKeySanitised=null,this.beans=beans,this.gos=beans.gos,this.rowNode=rowNode,this.paginationPage=beans.paginationProxy.getCurrentPage(),this.useAnimationFrameForCreate=useAnimationFrameForCreate,this.printLayout=printLayout,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=rowNode.id+"-"+instanceIdSequence3++,this.rowId=escapeString(rowNode.id),this.initRowBusinessKey(),this.rowFocused=beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=beans.rowCssClassCalculator.calculateRowLevel(this.rowNode),this.setRowType(),this.setAnimateFlags(animateIn),this.rowStyles=this.processStylesFromGridOptions(),this.isFullWidth()&&!this.gos.get("suppressCellFocus")&&(this.tabIndex=-1),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if("function"!=typeof this.businessKeyForNodeFunc)return;const businessKey=this.businessKeyForNodeFunc(this.rowNode);this.businessKeySanitised=escapeString(businessKey)}getRowId(){return this.rowId}getRowStyles(){return this.rowStyles}getTabIndex(){return this.tabIndex}isSticky(){return this.rowNode.sticky}getInstanceId(){return this.instanceId}setComp(rowComp,element,containerType){const gui={rowComp,element,containerType};this.allRowGuis.push(gui),"left"===containerType?this.leftGui=gui:"right"===containerType?this.rightGui=gui:"fullWidth"===containerType?this.fullWidthGui=gui:this.centerGui=gui,this.initialiseRowComp(gui),"FullWidthLoading"===this.rowType||this.rowNode.rowPinned||this.beans.rowRenderer.dispatchFirstDataRenderedEvent()}unsetComp(containerType){switch(this.allRowGuis=this.allRowGuis.filter(rowGui=>rowGui.containerType!==containerType),containerType){case"left":this.leftGui=void 0;break;case"right":this.rightGui=void 0;break;case"fullWidth":this.fullWidthGui=void 0;break;case"center":this.centerGui=void 0}}isCacheable(){return"FullWidthDetail"===this.rowType&&this.gos.get("keepDetailRows")}setCached(cached){const displayValue=cached?"none":"";this.allRowGuis.forEach(rg=>rg.element.style.display=displayValue)}initialiseRowComp(gui){const gos=this.gos;this.listenOnDomOrder(gui),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights(),this.onRowHeightChanged(gui),this.updateRowIndexes(gui),this.setFocusedClasses(gui),this.setStylesFromGridOptions(!1,gui),gos.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(gui),this.updateColumnLists(!this.useAnimationFrameForCreate);const comp=gui.rowComp;this.getInitialRowClasses(gui.containerType).forEach(name=>comp.addOrRemoveCssClass(name,!0)),this.executeSlideAndFadeAnimations(gui),this.rowNode.group&&setAriaExpanded(gui.element,1==this.rowNode.expanded),this.setRowCompRowId(comp),this.setRowCompRowBusinessKey(comp),gos.setDomData(gui.element,_RowCtrl.DOM_DATA_KEY_ROW_CTRL,this),this.addDestroyFunc(()=>gos.setDomData(gui.element,_RowCtrl.DOM_DATA_KEY_ROW_CTRL,null)),this.useAnimationFrameForCreate?this.beans.animationFrameService.createTask(this.addHoverFunctionality.bind(this,gui.element),this.rowNode.rowIndex,"createTasksP2"):this.addHoverFunctionality(gui.element),this.isFullWidth()&&this.setupFullWidth(gui),gos.get("rowDragEntireRow")&&this.addRowDraggerToRow(gui),this.useAnimationFrameForCreate&&this.beans.animationFrameService.addDestroyTask(()=>{this.isAlive()&&gui.rowComp.addOrRemoveCssClass("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(comp){null!=this.businessKeySanitised&&comp.setRowBusinessKey(this.businessKeySanitised)}getBusinessKey(){return this.businessKeySanitised}setRowCompRowId(comp){this.rowId=escapeString(this.rowNode.id),null!=this.rowId&&comp.setRowId(this.rowId)}executeSlideAndFadeAnimations(gui){const{containerType}=gui;this.slideInAnimation[containerType]&&(executeNextVMTurn(()=>{this.onTopChanged()}),this.slideInAnimation[containerType]=!1);this.fadeInAnimation[containerType]&&(executeNextVMTurn(()=>{gui.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)}),this.fadeInAnimation[containerType]=!1)}addRowDraggerToRow(gui){if(this.gos.get("enableRangeSelection"))return void warnOnce("Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`");const translate=this.beans.localeService.getLocaleTextFunc(),rowDragComp=new RowDragComp(()=>`1 ${translate("rowDragRow","row")}`,this.rowNode,void 0,gui.element,void 0,!0),rowDragBean=this.createBean(rowDragComp,this.beans.context);this.rowDragComps.push(rowDragBean)}setupFullWidth(gui){const pinned=this.getPinnedForContainer(gui.containerType);if("FullWidthDetail"==this.rowType&&!ModuleRegistry.__assertRegistered("@ag-grid-enterprise/master-detail","cell renderer 'agDetailCellRenderer' (for master detail)",this.beans.context.getGridId()))return;const compDetails=this.createFullWidthCompDetails(gui.element,pinned);gui.rowComp.showFullWidth(compDetails)}isPrintLayout(){return this.printLayout}getFullWidthCellRenderers(){var _a,_b;return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(gui=>{var _a2;return null==(_a2=null==gui?void 0:gui.rowComp)?void 0:_a2.getFullWidthCellRenderer()}):[null==(_b=null==(_a=this.fullWidthGui)?void 0:_a.rowComp)?void 0:_b.getFullWidthCellRenderer()]}getCellElement(column){const cellCtrl=this.getCellCtrl(column);return cellCtrl?cellCtrl.getGui():null}executeProcessRowPostCreateFunc(){const func=this.gos.getCallback("processRowPostCreate");if(!func||!this.areAllContainersReady())return;func({eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)})}areAllContainersReady(){const isLeftReady=!!this.leftGui||!this.beans.columnModel.isPinningLeft(),isCenterReady=!!this.centerGui,isRightReady=!!this.rightGui||!this.beans.columnModel.isPinningRight();return isLeftReady&&isCenterReady&&isRightReady}setRowType(){const isStub=this.rowNode.stub&&!this.gos.get("suppressServerSideFullWidthLoadingRow"),isFullWidthCell=this.rowNode.isFullWidthCell(),isDetailCell=this.gos.get("masterDetail")&&this.rowNode.detail,pivotMode=this.beans.columnModel.isPivotMode(),isFullWidthGroup=!!this.rowNode.group&&!this.rowNode.footer&&this.gos.isGroupUseEntireRow(pivotMode);this.rowType=isStub?"FullWidthLoading":isDetailCell?"FullWidthDetail":isFullWidthCell?"FullWidth":isFullWidthGroup?"FullWidthGroup":"Normal"}updateColumnLists(suppressAnimationFrame=!1,useFlushSync=!1){if(this.isFullWidth())return;suppressAnimationFrame||this.gos.get("suppressAnimationFrame")||this.printLayout?this.updateColumnListsImpl(useFlushSync):this.updateColumnListsPending||(this.beans.animationFrameService.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}createCellCtrls(prev,cols,pinned=null){const res={list:[],map:{}},addCell=(colInstanceId,cellCtrl)=>{res.list.push(cellCtrl),res.map[colInstanceId]=cellCtrl};return cols.forEach(col=>{const colInstanceId=col.getInstanceId();let cellCtrl=prev.map[colInstanceId];cellCtrl||(cellCtrl=new CellCtrl(col,this.rowNode,this.beans,this)),addCell(colInstanceId,cellCtrl)}),prev.list.forEach(prevCellCtrl=>{if(null!=res.map[prevCellCtrl.getColumn().getInstanceId()])return;this.isCellEligibleToBeRemoved(prevCellCtrl,pinned)?prevCellCtrl.destroy():addCell(prevCellCtrl.getColumn().getInstanceId(),prevCellCtrl)}),res}updateColumnListsImpl(useFlushSync){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(useFlushSync)}setCellCtrls(useFlushSync){this.allRowGuis.forEach(item=>{const cellControls=this.getCellCtrlsForContainer(item.containerType);item.rowComp.setCellCtrls(cellControls,useFlushSync)})}getCellCtrlsForContainer(containerType){switch(containerType){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list;default:throw new Error(`Unhandled case: ${containerType}`)}}createAllCellCtrls(){const columnModel=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,columnModel.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const centerCols=columnModel.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,centerCols);const leftCols=columnModel.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,leftCols,"left");const rightCols=columnModel.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,rightCols,"right")}}isCellEligibleToBeRemoved(cellCtrl,nextContainerPinned){if(cellCtrl.getColumn().getPinned()!=nextContainerPinned)return true;const editing=cellCtrl.isEditing(),focused=this.beans.focusService.isCellFocused(cellCtrl.getCellPosition());if(editing||focused){const column2=cellCtrl.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(column2)>=0)}return true}getDomOrder(){return this.gos.get("ensureDomOrder")||this.gos.isDomLayout("print")}listenOnDomOrder(gui){const listener=()=>{gui.rowComp.setDomOrder(this.getDomOrder())};this.addManagedPropertyListener("domLayout",listener),this.addManagedPropertyListener("ensureDomOrder",listener)}setAnimateFlags(animateIn){if(this.isSticky()||!animateIn)return;const oldRowTopExists=exists(this.rowNode.oldRowTop),pinningLeft=this.beans.columnModel.isPinningLeft(),pinningRight=this.beans.columnModel.isPinningRight();if(oldRowTopExists){if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.slideInAnimation.fullWidth=!0);this.slideInAnimation.center=!0,this.slideInAnimation.left=pinningLeft,this.slideInAnimation.right=pinningRight}else{if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows"))return void(this.fadeInAnimation.fullWidth=!0);this.fadeInAnimation.center=!0,this.fadeInAnimation.left=pinningLeft,this.fadeInAnimation.right=pinningRight}}isEditing(){return this.editingRow}isFullWidth(){return"Normal"!==this.rowType}refreshFullWidth(){const tryRefresh=(gui,pinned)=>!gui||gui.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(gui.element,pinned).params),fullWidthSuccess=tryRefresh(this.fullWidthGui,null),centerSuccess=tryRefresh(this.centerGui,null),leftSuccess=tryRefresh(this.leftGui,"left"),rightSuccess=tryRefresh(this.rightGui,"right");return fullWidthSuccess&&centerSuccess&&leftSuccess&&rightSuccess}addListeners(){this.addManagedListener(this.rowNode,RowNode.EVENT_HEIGHT_CHANGED,()=>this.onRowHeightChanged()),this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_SELECTED,()=>this.onRowSelected()),this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.rowNode.detail&&this.addManagedListener(this.rowNode.parent,RowNode.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,this.postProcessCss.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_DRAGGING_CHANGED,this.postProcessRowDragging.bind(this)),this.addManagedListener(this.rowNode,RowNode.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));const eventService=this.beans.eventService;this.addManagedListener(eventService,Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_CELL_FOCUS_CLEARED,this.onCellFocusChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(eventService,Events.EVENT_MODEL_UPDATED,this.refreshFirstAndLastRowStyles.bind(this)),this.addManagedListener(eventService,Events.EVENT_COLUMN_MOVED,this.updateColumnLists.bind(this)),this.addDestroyFunc(()=>{this.destroyBeans(this.rowDragComps,this.beans.context),this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature,this.beans.context))}),this.addManagedPropertyListeners(["rowDragEntireRow"],()=>{this.gos.get("rowDragEntireRow")?this.allRowGuis.forEach(gui=>{this.addRowDraggerToRow(gui)}):(this.destroyBeans(this.rowDragComps,this.beans.context),this.rowDragComps=[])}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListener(this.rowNode,RowNode.EVENT_ROW_INDEX_CHANGED,()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onRowIndexChanged())}),this.addManagedListener(this.rowNode,RowNode.EVENT_CELL_CHANGED,event=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onCellChanged(event))})}onRowNodeDataChanged(event){if(this.isFullWidth()!==!!this.rowNode.isFullWidthCell())this.beans.rowRenderer.redrawRow(this.rowNode);else{if(this.isFullWidth()){return void(this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode))}this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.refreshCell({suppressFlash:!event.update,newData:!event.update})),this.allRowGuis.forEach(gui=>{this.setRowCompRowId(gui.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(gui.rowComp)}),this.onRowSelected(),this.postProcessCss()}}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const highlighted=this.rowNode.highlighted;this.allRowGuis.forEach(gui=>{const aboveOn=0===highlighted,belowOn=1===highlighted;gui.rowComp.addOrRemoveCssClass("ag-row-highlight-above",aboveOn),gui.rowComp.addOrRemoveCssClass("ag-row-highlight-below",belowOn)})}postProcessRowDragging(){const dragging=this.rowNode.dragging;this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-dragging",dragging))}updateExpandedCss(){const expandable=this.rowNode.isExpandable(),expanded=1==this.rowNode.expanded;this.allRowGuis.forEach(gui=>{gui.rowComp.addOrRemoveCssClass("ag-row-group",expandable),gui.rowComp.addOrRemoveCssClass("ag-row-group-expanded",expandable&&expanded),gui.rowComp.addOrRemoveCssClass("ag-row-group-contracted",expandable&&!expanded),setAriaExpanded(gui.element,expandable&&expanded)})}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:makeNull(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(keyboardEvent){const currentFullWidthComp=this.allRowGuis.find(c=>c.element.contains(keyboardEvent.target));if(!((currentFullWidthComp?currentFullWidthComp.element:null)===keyboardEvent.target))return;const node=this.rowNode,lastFocusedCell=this.beans.focusService.getFocusedCell(),cellPosition={rowIndex:node.rowIndex,rowPinned:node.rowPinned,column:lastFocusedCell&&lastFocusedCell.column};this.beans.navigationService.navigateToNextCell(keyboardEvent,keyboardEvent.key,cellPosition,!0),keyboardEvent.preventDefault()}onTabKeyDown(keyboardEvent){if(keyboardEvent.defaultPrevented||isStopPropagationForAgGrid(keyboardEvent))return;const currentFullWidthComp=this.allRowGuis.find(c=>c.element.contains(keyboardEvent.target)),currentFullWidthContainer=currentFullWidthComp?currentFullWidthComp.element:null,isFullWidthContainerFocused=currentFullWidthContainer===keyboardEvent.target;let nextEl=null;isFullWidthContainerFocused||(nextEl=this.beans.focusService.findNextFocusableElement(currentFullWidthContainer,!1,keyboardEvent.shiftKey)),(this.isFullWidth()&&isFullWidthContainerFocused||!nextEl)&&this.beans.navigationService.onTabKeyDown(this,keyboardEvent)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){var _a;const displayedEl=null==(_a=this.allRowGuis.find(el=>isVisible(el.element)))?void 0:_a.element;return displayedEl?displayedEl.getBoundingClientRect().top:0}onFullWidthRowFocused(event){var _a;const node=this.rowNode,isFocused=!!event&&(this.isFullWidth()&&event.rowIndex===node.rowIndex&&event.rowPinned==node.rowPinned),element=this.fullWidthGui?this.fullWidthGui.element:null==(_a=this.centerGui)?void 0:_a.element;element&&(element.classList.toggle("ag-full-width-focus",isFocused),isFocused&&element.focus({preventScroll:!0}))}recreateCell(cellCtrl){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,cellCtrl),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,cellCtrl),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,cellCtrl),cellCtrl.destroy(),this.updateColumnLists()}removeCellCtrl(prev,cellCtrlToRemove){const res={list:[],map:{}};return prev.list.forEach(cellCtrl=>{cellCtrl!==cellCtrlToRemove&&(res.list.push(cellCtrl),res.map[cellCtrl.getColumn().getInstanceId()]=cellCtrl)}),res}onMouseEvent(eventName,mouseEvent){switch(eventName){case"dblclick":this.onRowDblClick(mouseEvent);break;case"click":this.onRowClick(mouseEvent);break;case"touchstart":case"mousedown":this.onRowMouseDown(mouseEvent)}}createRowEvent(type,domEvent){return this.gos.addGridCommonParams({type,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,event:domEvent})}createRowEventWithSource(type,domEvent){const event=this.createRowEvent(type,domEvent);return event.source=this,event}onRowDblClick(mouseEvent){if(isStopPropagationForAgGrid(mouseEvent))return;const agEvent=this.createRowEventWithSource(Events.EVENT_ROW_DOUBLE_CLICKED,mouseEvent);this.beans.eventService.dispatchEvent(agEvent)}onRowMouseDown(mouseEvent){if(this.lastMouseDownOnDragger=isElementChildOfClass(mouseEvent.target,"ag-row-drag",3),!this.isFullWidth())return;const node=this.rowNode,columnModel=this.beans.columnModel;this.beans.rangeService&&this.beans.rangeService.removeAllCellRanges(),this.beans.focusService.setFocusedCell({rowIndex:node.rowIndex,column:columnModel.getAllDisplayedColumns()[0],rowPinned:node.rowPinned,forceBrowserFocus:!0})}onRowClick(mouseEvent){if(isStopPropagationForAgGrid(mouseEvent)||this.lastMouseDownOnDragger)return;const agEvent=this.createRowEventWithSource(Events.EVENT_ROW_CLICKED,mouseEvent);this.beans.eventService.dispatchEvent(agEvent);const isMultiKey=mouseEvent.ctrlKey||mouseEvent.metaKey,isShiftKey=mouseEvent.shiftKey;if(this.gos.get("groupSelectsChildren")&&this.rowNode.group||this.isRowSelectionBlocked()||this.gos.get("suppressRowClickSelection"))return;const multiSelectOnClick=this.gos.get("rowMultiSelectWithClick"),rowDeselectionWithCtrl=!this.gos.get("suppressRowDeselection"),source="rowClicked";if(this.rowNode.isSelected())multiSelectOnClick?this.rowNode.setSelectedParams({newValue:!1,event:mouseEvent,source}):isMultiKey?rowDeselectionWithCtrl&&this.rowNode.setSelectedParams({newValue:!1,event:mouseEvent,source}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!isShiftKey,rangeSelect:isShiftKey,event:mouseEvent,source});else{const clearSelection=!multiSelectOnClick&&!isMultiKey;this.rowNode.setSelectedParams({newValue:!0,clearSelection,rangeSelect:isShiftKey,event:mouseEvent,source})}}isRowSelectionBlocked(){return!this.rowNode.selectable||!!this.rowNode.rowPinned||!this.gos.isRowSelection()}setupDetailRowAutoHeight(eDetailGui){if("FullWidthDetail"!==this.rowType)return;if(!this.gos.get("detailRowAutoHeight"))return;const checkRowSizeFunc=()=>{const clientHeight=eDetailGui.clientHeight;if(null!=clientHeight&&clientHeight>0){const updateRowHeightFunc=()=>{this.rowNode.setRowHeight(clientHeight),this.beans.clientSideRowModel?this.beans.clientSideRowModel.onRowHeightChanged():this.beans.serverSideRowModel&&this.beans.serverSideRowModel.onRowHeightChanged()};window.setTimeout(updateRowHeightFunc,0)}},resizeObserverDestroyFunc=this.beans.resizeObserverService.observeResize(eDetailGui,checkRowSizeFunc);this.addDestroyFunc(resizeObserverDestroyFunc),checkRowSizeFunc()}createFullWidthCompDetails(eRow,pinned){const params=this.gos.addGridCommonParams({fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,rowIndex:this.rowNode.rowIndex,eGridCell:eRow,eParentOfValue:eRow,pinned,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(rowDraggerElement,dragStartPixels,value,suppressVisibilityChange)=>this.addFullWidthRowDragging(rowDraggerElement,dragStartPixels,value,suppressVisibilityChange),setTooltip:(value,shouldDisplayTooltip)=>this.refreshRowTooltip(value,shouldDisplayTooltip)});switch(this.rowType){case"FullWidthDetail":return this.beans.userComponentFactory.getFullWidthDetailCellRendererDetails(params);case"FullWidthGroup":return this.beans.userComponentFactory.getFullWidthGroupCellRendererDetails(params);case"FullWidthLoading":return this.beans.userComponentFactory.getFullWidthLoadingCellRendererDetails(params);default:return this.beans.userComponentFactory.getFullWidthCellRendererDetails(params)}}refreshRowTooltip(value,shouldDisplayTooltip){if(!this.fullWidthGui)return;const tooltipParams={getGui:()=>this.fullWidthGui.element,getTooltipValue:()=>value,getLocation:()=>"fullWidthRow",shouldDisplayTooltip};this.tooltipFeature&&this.destroyBean(this.tooltipFeature,this.beans.context),this.tooltipFeature=this.createBean(new TooltipFeature(tooltipParams,this.beans))}addFullWidthRowDragging(rowDraggerElement,dragStartPixels,value="",suppressVisibilityChange){if(!this.isFullWidth())return;const rowDragComp=new RowDragComp(()=>value,this.rowNode,void 0,rowDraggerElement,dragStartPixels,suppressVisibilityChange);this.createBean(rowDragComp,this.beans.context),this.addDestroyFunc(()=>{this.destroyBean(rowDragComp,this.beans.context)})}onUiLevelChanged(){const newLevel=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=newLevel){const classToAdd="ag-row-level-"+newLevel,classToRemove="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(gui=>{gui.rowComp.addOrRemoveCssClass(classToAdd,!0),gui.rowComp.addOrRemoveCssClass(classToRemove,!1)})}this.rowLevel=newLevel}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()}refreshFirstAndLastRowStyles(){const newFirst=this.isFirstRowOnPage(),newLast=this.isLastRowOnPage();this.firstRowOnPage!==newFirst&&(this.firstRowOnPage=newFirst,this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-first",newFirst))),this.lastRowOnPage!==newLast&&(this.lastRowOnPage=newLast,this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-last",newLast)))}stopEditing(cancel=!1){if(this.stoppingRowEdit)return;const cellControls=this.getAllCellCtrls(),isRowEdit=this.editingRow;this.stoppingRowEdit=!0;let fireRowEditEvent=!1;for(const ctrl of cellControls){const valueChanged=ctrl.stopEditing(cancel);isRowEdit&&!cancel&&!fireRowEditEvent&&valueChanged&&(fireRowEditEvent=!0)}if(fireRowEditEvent){const event=this.createRowEvent(Events.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(event)}isRowEdit&&this.setEditingRow(!1),this.stoppingRowEdit=!1}setInlineEditingCss(editing){this.allRowGuis.forEach(gui=>{gui.rowComp.addOrRemoveCssClass("ag-row-inline-editing",editing),gui.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!editing)})}setEditingRow(value){this.editingRow=value,this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-row-editing",value));const event=value?this.createRowEvent(Events.EVENT_ROW_EDITING_STARTED):this.createRowEvent(Events.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(event)}startRowEditing(key=null,sourceRenderedCell=null,event=null){if(this.editingRow)return;this.getAllCellCtrls().reduce((prev,cellCtrl)=>{const cellStartedEdit=cellCtrl===sourceRenderedCell;return cellStartedEdit?cellCtrl.startEditing(key,cellStartedEdit,event):cellCtrl.startEditing(null,cellStartedEdit,event),!!prev||cellCtrl.isEditing()},!1)&&this.setEditingRow(!0)}getAllCellCtrls(){if(0===this.leftCellCtrls.list.length&&0===this.rightCellCtrls.list.length)return this.centerCellCtrls.list;return[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const cssClasses=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode);cssClasses&&cssClasses.length&&cssClasses.forEach(classStr=>{this.allRowGuis.forEach(c=>c.rowComp.addOrRemoveCssClass(classStr,!0))})}postProcessRowClassRules(){this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,className=>{this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass(className,!0))},className=>{this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass(className,!1))})}setStylesFromGridOptions(updateStyles,gui){updateStyles&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(gui,gui2=>gui2.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(rowContainerType){return"left"===rowContainerType?"left":"right"===rowContainerType?"right":null}getInitialRowClasses(rowContainerType){const pinned=this.getPinnedForContainer(rowContainerType),params={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeInAnimation[rowContainerType],rowIsEven:this.rowNode.rowIndex%2==0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),pinned};return this.beans.rowCssClassCalculator.getInitialRowClasses(params)}processStylesFromGridOptions(){const rowStyle=this.gos.get("rowStyle");if(rowStyle&&"function"==typeof rowStyle)return void console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead");const rowStyleFunc=this.gos.getCallback("getRowStyle");let rowStyleFuncResult;if(rowStyleFunc){rowStyleFuncResult=rowStyleFunc({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex})}return rowStyleFuncResult||rowStyle?Object.assign({},rowStyle,rowStyleFuncResult):this.emptyStyle}onRowSelected(gui){const selected=!!this.rowNode.isSelected();this.forEachGui(gui,gui2=>{gui2.rowComp.addOrRemoveCssClass("ag-row-selected",selected),setAriaSelected(gui2.element,selected);!gui2.element.contains(this.beans.gos.getActiveDomElement())||gui2!==this.centerGui&&gui2!==this.fullWidthGui||this.announceDescription()})}announceDescription(){if(this.isRowSelectionBlocked())return;const selected=this.rowNode.isSelected();if(selected&&this.beans.gos.get("suppressRowDeselection"))return;const label=this.beans.localeService.getLocaleTextFunc()(selected?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${selected?"deselect":"select"} this row.`);this.beans.ariaAnnouncementService.announceValue(label)}addHoverFunctionality(eRow){this.active&&(this.addManagedListener(eRow,"mouseenter",()=>this.rowNode.onMouseEnter()),this.addManagedListener(eRow,"mouseleave",()=>this.rowNode.onMouseLeave()),this.addManagedListener(this.rowNode,RowNode.EVENT_MOUSE_ENTER,()=>{this.beans.dragService.isDragging()||this.gos.get("suppressRowHoverHighlight")||(eRow.classList.add("ag-row-hover"),this.rowNode.setHovered(!0))}),this.addManagedListener(this.rowNode,RowNode.EVENT_MOUSE_LEAVE,()=>{eRow.classList.remove("ag-row-hover"),this.rowNode.setHovered(!1)}))}roundRowTopToBounds(rowTop){const range=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getApproximateVScollPosition(),minPixel=this.applyPaginationOffset(range.top,!0)-100,maxPixel=this.applyPaginationOffset(range.bottom,!0)+100;return Math.min(Math.max(minPixel,rowTop),maxPixel)}getFrameworkOverrides(){return this.beans.frameworkOverrides}forEachGui(gui,callback){gui?callback(gui):this.allRowGuis.forEach(callback)}onRowHeightChanged(gui){if(null==this.rowNode.rowHeight)return;const rowHeight=this.rowNode.rowHeight,defaultRowHeight=this.beans.environment.getDefaultRowHeight(),heightFromFunc=this.gos.isGetRowHeightFunction()?this.gos.getRowHeightForNode(this.rowNode).height:void 0,lineHeight=heightFromFunc?Math.min(defaultRowHeight,heightFromFunc)-2+"px":void 0;this.forEachGui(gui,gui2=>{gui2.element.style.height=`${rowHeight}px`,lineHeight&&gui2.element.style.setProperty("--ag-line-height",lineHeight)})}addEventListener(eventType,listener){super.addEventListener(eventType,listener)}removeEventListener(eventType,listener){super.removeEventListener(eventType,listener)}destroyFirstPass(suppressAnimation=!1){if(this.active=!1,!suppressAnimation&&this.gos.isAnimateRows()&&!this.isSticky()){if(null!=this.rowNode.rowTop){const rowTop=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(rowTop)}else this.allRowGuis.forEach(gui=>gui.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0))}this.rowNode.setHovered(!1);const event=this.createRowEvent(Events.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(event),this.beans.eventService.dispatchEvent(event),super.destroy()}destroySecondPass(){this.allRowGuis.length=0,this.stopEditing();const destroyCellCtrls=ctrls=>(ctrls.list.forEach(c=>c.destroy()),{list:[],map:{}});this.centerCellCtrls=destroyCellCtrls(this.centerCellCtrls),this.leftCellCtrls=destroyCellCtrls(this.leftCellCtrls),this.rightCellCtrls=destroyCellCtrls(this.rightCellCtrls)}setFocusedClasses(gui){this.forEachGui(gui,gui2=>{gui2.rowComp.addOrRemoveCssClass("ag-row-focus",this.rowFocused),gui2.rowComp.addOrRemoveCssClass("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const rowFocused=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);rowFocused!==this.rowFocused&&(this.rowFocused=rowFocused,this.setFocusedClasses()),!rowFocused&&this.editingRow&&this.stopEditing(!1)}onPaginationChanged(){const currentPage=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==currentPage&&(this.paginationPage=currentPage,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(topPx,reverse=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return topPx;return topPx+this.beans.paginationProxy.getPixelOffset()*(reverse?1:-1)}setRowTop(pixels){if(!this.printLayout&&exists(pixels)){const afterPaginationPixels=this.applyPaginationOffset(pixels),topPx=`${this.rowNode.isRowPinned()||this.rowNode.sticky?afterPaginationPixels:this.beans.rowContainerHeightService.getRealPixelPosition(afterPaginationPixels)}px`;this.setRowTopStyle(topPx)}}getInitialRowTop(rowContainerType){return this.suppressRowTransform?this.getInitialRowTopShared(rowContainerType):void 0}getInitialTransform(rowContainerType){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(rowContainerType)})`}getInitialRowTopShared(rowContainerType){if(this.printLayout)return"";let rowTop;if(this.isSticky())rowTop=this.rowNode.stickyRowTop;else{const pixels=this.slideInAnimation[rowContainerType]?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,afterPaginationPixels=this.applyPaginationOffset(pixels);rowTop=this.rowNode.isRowPinned()?afterPaginationPixels:this.beans.rowContainerHeightService.getRealPixelPosition(afterPaginationPixels)}return rowTop+"px"}setRowTopStyle(topPx){this.allRowGuis.forEach(gui=>this.suppressRowTransform?gui.rowComp.setTop(topPx):gui.rowComp.setTransform(`translateY(${topPx})`))}getRowNode(){return this.rowNode}getCellCtrl(column){let res=null;return this.getAllCellCtrls().forEach(cellCtrl=>{cellCtrl.getColumn()==column&&(res=cellCtrl)}),null!=res||this.getAllCellCtrls().forEach(cellCtrl=>{cellCtrl.getColSpanningList().indexOf(column)>=0&&(res=cellCtrl)}),res}onRowIndexChanged(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}getRowIndex(){return this.rowNode.getRowIndexString()}updateRowIndexes(gui){const rowIndexStr=this.rowNode.getRowIndexString(),headerRowCount=this.beans.headerNavigationService.getHeaderRowCount()+this.beans.filterManager.getHeaderRowCount(),rowIsEven=this.rowNode.rowIndex%2==0,ariaRowIndex=headerRowCount+this.rowNode.rowIndex+1;this.forEachGui(gui,c=>{c.rowComp.setRowIndex(rowIndexStr),c.rowComp.addOrRemoveCssClass("ag-row-even",rowIsEven),c.rowComp.addOrRemoveCssClass("ag-row-odd",!rowIsEven),setAriaRowIndex(c.element,ariaRowIndex)})}};_RowCtrl.DOM_DATA_KEY_ROW_CTRL="renderedRow";var RowCtrl=_RowCtrl,RowContainerEventsFeature=class extends BeanStub{constructor(element){super(),this.element=element}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.mockContextMenuForIPad()}addKeyboardListeners(){const listener=this.processKeyboardEvent.bind(this,"keydown");this.addManagedListener(this.element,"keydown",listener)}addMouseListeners(){["dblclick","contextmenu","mouseover","mouseout","click",isEventSupported("touchstart")?"touchstart":"mousedown"].forEach(eventName=>{const listener=this.processMouseEvent.bind(this,eventName);this.addManagedListener(this.element,eventName,listener)})}processMouseEvent(eventName,mouseEvent){if(!this.mouseEventService.isEventFromThisGrid(mouseEvent)||isStopPropagationForAgGrid(mouseEvent))return;const rowComp=this.getRowForEvent(mouseEvent),cellCtrl=this.mouseEventService.getRenderedCellForEvent(mouseEvent);"contextmenu"===eventName?this.handleContextMenuMouseEvent(mouseEvent,void 0,rowComp,cellCtrl):(cellCtrl&&cellCtrl.onMouseEvent(eventName,mouseEvent),rowComp&&rowComp.onMouseEvent(eventName,mouseEvent))}mockContextMenuForIPad(){if(!isIOSUserAgent())return;const touchListener=new TouchListener(this.element);this.addManagedListener(touchListener,TouchListener.EVENT_LONG_TAP,event=>{const rowComp=this.getRowForEvent(event.touchEvent),cellComp=this.mouseEventService.getRenderedCellForEvent(event.touchEvent);this.handleContextMenuMouseEvent(void 0,event.touchEvent,rowComp,cellComp)}),this.addDestroyFunc(()=>touchListener.destroy())}getRowForEvent(event){let sourceElement=event.target;for(;sourceElement;){const rowCon=this.gos.getDomData(sourceElement,RowCtrl.DOM_DATA_KEY_ROW_CTRL);if(rowCon)return rowCon;sourceElement=sourceElement.parentElement}return null}handleContextMenuMouseEvent(mouseEvent,touchEvent,rowComp,cellCtrl){const rowNode=rowComp?rowComp.getRowNode():null,column=cellCtrl?cellCtrl.getColumn():null;let value=null;if(column){const event=mouseEvent||touchEvent;cellCtrl.dispatchCellContextMenuEvent(null!=event?event:null),value=this.valueService.getValue(column,rowNode)}const gridBodyCon=this.ctrlsService.getGridBodyCtrl(),anchorToElement=cellCtrl?cellCtrl.getGui():gridBodyCon.getGridBodyElement();this.menuService.showContextMenu({mouseEvent,touchEvent,rowNode,column,value,anchorToElement})}getControlsForEventTarget(target){return{cellCtrl:getCtrlForEventTarget(this.gos,target,CellCtrl.DOM_DATA_KEY_CELL_CTRL),rowCtrl:getCtrlForEventTarget(this.gos,target,RowCtrl.DOM_DATA_KEY_ROW_CTRL)}}processKeyboardEvent(eventName,keyboardEvent){const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(keyboardEvent.target);keyboardEvent.defaultPrevented||(cellCtrl?this.processCellKeyboardEvent(cellCtrl,eventName,keyboardEvent):rowCtrl&&rowCtrl.isFullWidth()&&this.processFullWidthRowKeyboardEvent(rowCtrl,eventName,keyboardEvent))}processCellKeyboardEvent(cellCtrl,eventName,keyboardEvent){const rowNode=cellCtrl.getRowNode(),column=cellCtrl.getColumn(),editing=cellCtrl.isEditing();if(!isUserSuppressingKeyboardEvent(this.gos,keyboardEvent,rowNode,column,editing)&&"keydown"===eventName){!editing&&this.navigationService.handlePageScrollingKey(keyboardEvent)||cellCtrl.onKeyDown(keyboardEvent),this.doGridOperations(keyboardEvent,cellCtrl.isEditing()),isEventFromPrintableCharacter(keyboardEvent)&&cellCtrl.processCharacter(keyboardEvent)}if("keydown"===eventName){const cellKeyDownEvent=cellCtrl.createEvent(keyboardEvent,Events.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(cellKeyDownEvent)}}processFullWidthRowKeyboardEvent(rowComp,eventName,keyboardEvent){const rowNode=rowComp.getRowNode(),focusedCell=this.focusService.getFocusedCell(),column=focusedCell&&focusedCell.column;if(!isUserSuppressingKeyboardEvent(this.gos,keyboardEvent,rowNode,column,!1)){const key=keyboardEvent.key;if("keydown"===eventName)switch(key){case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:case KeyCode.PAGE_UP:case KeyCode.PAGE_DOWN:this.navigationService.handlePageScrollingKey(keyboardEvent,!0);break;case KeyCode.UP:case KeyCode.DOWN:rowComp.onKeyboardNavigate(keyboardEvent);break;case KeyCode.TAB:rowComp.onTabKeyDown(keyboardEvent)}}if("keydown"===eventName){const cellKeyDownEvent=rowComp.createRowEvent(Events.EVENT_CELL_KEY_DOWN,keyboardEvent);this.eventService.dispatchEvent(cellKeyDownEvent)}}doGridOperations(keyboardEvent,editing){if(!keyboardEvent.ctrlKey&&!keyboardEvent.metaKey)return;if(editing)return;if(!this.mouseEventService.isEventFromThisGrid(keyboardEvent))return;const keyCode=normaliseQwertyAzerty(keyboardEvent);return keyCode===KeyCode.A?this.onCtrlAndA(keyboardEvent):keyCode===KeyCode.C?this.onCtrlAndC(keyboardEvent):keyCode===KeyCode.D?this.onCtrlAndD(keyboardEvent):keyCode===KeyCode.V?this.onCtrlAndV(keyboardEvent):keyCode===KeyCode.X?this.onCtrlAndX(keyboardEvent):keyCode===KeyCode.Y?this.onCtrlAndY():keyCode===KeyCode.Z?this.onCtrlAndZ(keyboardEvent):void 0}onCtrlAndA(event){const{pinnedRowModel,paginationProxy,rangeService}=this;if(rangeService&&paginationProxy.isRowsToRender()){const[isEmptyPinnedTop,isEmptyPinnedBottom]=[pinnedRowModel.isEmpty("top"),pinnedRowModel.isEmpty("bottom")],floatingStart=isEmptyPinnedTop?null:"top";let floatingEnd,rowEnd;isEmptyPinnedBottom?(floatingEnd=null,rowEnd=this.paginationProxy.getRowCount()-1):(floatingEnd="bottom",rowEnd=pinnedRowModel.getPinnedBottomRowData().length-1);const allDisplayedColumns=this.columnModel.getAllDisplayedColumns();if(missingOrEmpty(allDisplayedColumns))return;rangeService.setCellRange({rowStartIndex:0,rowStartPinned:floatingStart,rowEndIndex:rowEnd,rowEndPinned:floatingEnd,columnStart:allDisplayedColumns[0],columnEnd:last(allDisplayedColumns)})}event.preventDefault()}onCtrlAndC(event){if(!this.clipboardService||this.gos.get("enableCellTextSelection"))return;const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(event.target);(null==cellCtrl?void 0:cellCtrl.isEditing())||(null==rowCtrl?void 0:rowCtrl.isEditing())||(event.preventDefault(),this.clipboardService.copyToClipboard())}onCtrlAndX(event){if(!this.clipboardService||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(event.target);(null==cellCtrl?void 0:cellCtrl.isEditing())||(null==rowCtrl?void 0:rowCtrl.isEditing())||(event.preventDefault(),this.clipboardService.cutToClipboard(void 0,"ui"))}onCtrlAndV(event){const{cellCtrl,rowCtrl}=this.getControlsForEventTarget(event.target);(null==cellCtrl?void 0:cellCtrl.isEditing())||(null==rowCtrl?void 0:rowCtrl.isEditing())||this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.pasteFromClipboard()}onCtrlAndD(event){this.clipboardService&&!this.gos.get("suppressClipboardPaste")&&this.clipboardService.copyRangeDown(),event.preventDefault()}onCtrlAndZ(event){this.gos.get("undoRedoCellEditing")&&(event.preventDefault(),event.shiftKey?this.undoRedoService.redo("ui"):this.undoRedoService.undo("ui"))}onCtrlAndY(){this.undoRedoService.redo("ui")}};__decorateClass([Autowired("mouseEventService")],RowContainerEventsFeature.prototype,"mouseEventService",2),__decorateClass([Autowired("valueService")],RowContainerEventsFeature.prototype,"valueService",2),__decorateClass([Autowired("menuService")],RowContainerEventsFeature.prototype,"menuService",2),__decorateClass([Autowired("ctrlsService")],RowContainerEventsFeature.prototype,"ctrlsService",2),__decorateClass([Autowired("navigationService")],RowContainerEventsFeature.prototype,"navigationService",2),__decorateClass([Autowired("focusService")],RowContainerEventsFeature.prototype,"focusService",2),__decorateClass([Autowired("undoRedoService")],RowContainerEventsFeature.prototype,"undoRedoService",2),__decorateClass([Autowired("columnModel")],RowContainerEventsFeature.prototype,"columnModel",2),__decorateClass([Autowired("paginationProxy")],RowContainerEventsFeature.prototype,"paginationProxy",2),__decorateClass([Autowired("pinnedRowModel")],RowContainerEventsFeature.prototype,"pinnedRowModel",2),__decorateClass([Optional("rangeService")],RowContainerEventsFeature.prototype,"rangeService",2),__decorateClass([Optional("clipboardService")],RowContainerEventsFeature.prototype,"clipboardService",2),__decorateClass([PostConstruct],RowContainerEventsFeature.prototype,"postConstruct",1);var ViewportSizeFeature=class extends BeanStub{constructor(centerContainerCtrl){super(),this.centerContainerCtrl=centerContainerCtrl}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridBodyCtrl=p.gridBodyCtrl,this.listenForResize()}),this.addManagedListener(this.eventService,Events.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this)),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const listener=()=>this.onCenterViewportResized();this.centerContainerCtrl.registerViewportResizeListener(listener),this.gridBodyCtrl.registerBodyViewportResizeListener(listener)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.centerContainerCtrl.isViewportInTheDOMTree()){this.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const newWidth=this.centerContainerCtrl.getCenterWidth();newWidth!==this.centerWidth&&(this.centerWidth=newWidth,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}keepPinnedColumnsNarrowerThanViewport(){const bodyWidth=getInnerWidth(this.gridBodyCtrl.getBodyViewportElement());if(bodyWidth<=50)return;let columnsToRemove=this.getPinnedColumnsOverflowingViewport(bodyWidth-50);const processUnpinnedColumns=this.gos.getCallback("processUnpinnedColumns");if(columnsToRemove.length){if(processUnpinnedColumns){columnsToRemove=processUnpinnedColumns({columns:columnsToRemove,viewportWidth:bodyWidth})}this.columnModel.setColumnsPinned(columnsToRemove,null,"viewportSizeFeature")}}getPinnedColumnsOverflowingViewport(viewportWidth){const totalPinnedWidth=this.pinnedWidthService.getPinnedRightWidth()+this.pinnedWidthService.getPinnedLeftWidth();if(totalPinnedWidth<viewportWidth)return[];const pinnedLeftColumns=[...this.columnModel.getDisplayedLeftColumns()],pinnedRightColumns=[...this.columnModel.getDisplayedRightColumns()];let indexRight=0,indexLeft=0;const columnsToRemove=[];let spaceNecessary=totalPinnedWidth-0-viewportWidth;for(;(indexLeft<pinnedLeftColumns.length||indexRight<pinnedRightColumns.length)&&spaceNecessary>0;){if(indexRight<pinnedRightColumns.length){const currentColumn=pinnedRightColumns[indexRight++];spaceNecessary-=currentColumn.getActualWidth(),columnsToRemove.push(currentColumn)}if(indexLeft<pinnedLeftColumns.length&&spaceNecessary>0){const currentColumn=pinnedLeftColumns[indexLeft++];spaceNecessary-=currentColumn.getActualWidth(),columnsToRemove.push(currentColumn)}}return columnsToRemove}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.getScrollFeature().checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const bodyHeight=getInnerHeight(this.gridBodyCtrl.getBodyViewportElement());if(this.bodyHeight!==bodyHeight){this.bodyHeight=bodyHeight;const event={type:Events.EVENT_BODY_HEIGHT_CHANGED};this.eventService.dispatchEvent(event)}}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){const params={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(params)}isHorizontalScrollShowing(){return this.centerContainerCtrl.isHorizontalScrollShowing()}onHorizontalViewportChanged(){const scrollWidth=this.centerContainerCtrl.getCenterWidth(),scrollPosition=this.centerContainerCtrl.getViewportScrollLeft();this.columnModel.setViewportPosition(scrollWidth,scrollPosition)}};__decorateClass([Autowired("ctrlsService")],ViewportSizeFeature.prototype,"ctrlsService",2),__decorateClass([Autowired("pinnedWidthService")],ViewportSizeFeature.prototype,"pinnedWidthService",2),__decorateClass([Autowired("columnModel")],ViewportSizeFeature.prototype,"columnModel",2),__decorateClass([Autowired("scrollVisibleService")],ViewportSizeFeature.prototype,"scrollVisibleService",2),__decorateClass([PostConstruct],ViewportSizeFeature.prototype,"postConstruct",1);var SetPinnedLeftWidthFeature=class extends BeanStub{constructor(element){super(),this.element=element}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))}onPinnedLeftWidthChanged(){const leftWidth=this.pinnedWidthService.getPinnedLeftWidth(),displayed=leftWidth>0;setDisplayed(this.element,displayed),setFixedWidth(this.element,leftWidth)}getWidth(){return this.pinnedWidthService.getPinnedLeftWidth()}};__decorateClass([Autowired("pinnedWidthService")],SetPinnedLeftWidthFeature.prototype,"pinnedWidthService",2),__decorateClass([PostConstruct],SetPinnedLeftWidthFeature.prototype,"postConstruct",1);var SetPinnedRightWidthFeature=class extends BeanStub{constructor(element){super(),this.element=element}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))}onPinnedRightWidthChanged(){const rightWidth=this.pinnedWidthService.getPinnedRightWidth(),displayed=rightWidth>0;setDisplayed(this.element,displayed),setFixedWidth(this.element,rightWidth)}getWidth(){return this.pinnedWidthService.getPinnedRightWidth()}};__decorateClass([Autowired("pinnedWidthService")],SetPinnedRightWidthFeature.prototype,"pinnedWidthService",2),__decorateClass([PostConstruct],SetPinnedRightWidthFeature.prototype,"postConstruct",1);var SetHeightFeature=class extends BeanStub{constructor(eContainer,eViewport){super(),this.eContainer=eContainer,this.eViewport=eViewport}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))}onHeightChanged(){const height=this.maxDivHeightScaler.getUiContainerHeight(),heightString=null!=height?`${height}px`:"";this.eContainer.style.height=heightString,this.eViewport&&(this.eViewport.style.height=heightString)}};__decorateClass([Autowired("rowContainerHeightService")],SetHeightFeature.prototype,"maxDivHeightScaler",2),__decorateClass([PostConstruct],SetHeightFeature.prototype,"postConstruct",1);var DragListenerFeature=class extends BeanStub{constructor(eContainer){super(),this.eContainer=eContainer}postConstruct(){if(!this.rangeService)return;this.params={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)},this.addManagedPropertyListener("enableRangeSelection",props=>{props.currentValue?this.enableFeature():this.disableFeature()}),this.addDestroyFunc(()=>this.disableFeature());this.gos.get("enableRangeSelection")&&this.enableFeature()}enableFeature(){this.dragService.addDragSource(this.params)}disableFeature(){this.dragService.removeDragSource(this.params)}};__decorateClass([Autowired("dragService")],DragListenerFeature.prototype,"dragService",2),__decorateClass([Optional("rangeService")],DragListenerFeature.prototype,"rangeService",2),__decorateClass([PostConstruct],DragListenerFeature.prototype,"postConstruct",1);var CenterWidthFeature=class extends BeanStub{constructor(callback,addSpacer=!1){super(),this.callback=callback,this.addSpacer=addSpacer}postConstruct(){const listener=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",listener),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_CONTAINER_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,listener),this.addSpacer&&(this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLLBAR_WIDTH_CHANGED,listener)),this.setWidth()}setWidth(){const{columnModel}=this,printLayout=this.gos.isDomLayout("print"),centerWidth=columnModel.getBodyContainerWidth(),leftWidth=columnModel.getDisplayedColumnsLeftWidth(),rightWidth=columnModel.getDisplayedColumnsRightWidth();let totalWidth;if(printLayout)totalWidth=centerWidth+leftWidth+rightWidth;else if(totalWidth=centerWidth,this.addSpacer){0===(this.gos.get("enableRtl")?leftWidth:rightWidth)&&this.scrollVisibleService.isVerticalScrollShowing()&&(totalWidth+=this.gos.getScrollbarWidth())}this.callback(totalWidth)}};__decorateClass([Autowired("columnModel")],CenterWidthFeature.prototype,"columnModel",2),__decorateClass([Autowired("scrollVisibleService")],CenterWidthFeature.prototype,"scrollVisibleService",2),__decorateClass([PostConstruct],CenterWidthFeature.prototype,"postConstruct",1);var ContainerCssClasses=convertToMap([["center","ag-center-cols-container"],["left","ag-pinned-left-cols-container"],["right","ag-pinned-right-cols-container"],["fullWidth","ag-full-width-container"],["topCenter","ag-floating-top-container"],["topLeft","ag-pinned-left-floating-top"],["topRight","ag-pinned-right-floating-top"],["topFullWidth","ag-floating-top-full-width-container"],["stickyTopCenter","ag-sticky-top-container"],["stickyTopLeft","ag-pinned-left-sticky-top"],["stickyTopRight","ag-pinned-right-sticky-top"],["stickyTopFullWidth","ag-sticky-top-full-width-container"],["stickyBottomCenter","ag-sticky-bottom-container"],["stickyBottomLeft","ag-pinned-left-sticky-bottom"],["stickyBottomRight","ag-pinned-right-sticky-bottom"],["stickyBottomFullWidth","ag-sticky-bottom-full-width-container"],["bottomCenter","ag-floating-bottom-container"],["bottomLeft","ag-pinned-left-floating-bottom"],["bottomRight","ag-pinned-right-floating-bottom"],["bottomFullWidth","ag-floating-bottom-full-width-container"]]),ViewportCssClasses=convertToMap([["center","ag-center-cols-viewport"],["topCenter","ag-floating-top-viewport"],["stickyTopCenter","ag-sticky-top-viewport"],["bottomCenter","ag-floating-bottom-viewport"],["stickyBottomCenter","ag-sticky-bottom-viewport"]]),_RowContainerCtrl=class _RowContainerCtrl extends BeanStub{constructor(name){super(),this.visible=!0,this.EMPTY_CTRLS=[],this.name=name,this.isFullWithContainer="topFullWidth"===this.name||"stickyTopFullWidth"===this.name||"stickyBottomFullWidth"===this.name||"bottomFullWidth"===this.name||"fullWidth"===this.name}static getRowContainerCssClasses(name){return{container:ContainerCssClasses.get(name),viewport:ViewportCssClasses.get(name)}}static getPinned(name){switch(name){case"bottomLeft":case"topLeft":case"stickyTopLeft":case"stickyBottomLeft":case"left":return"left";case"bottomRight":case"topRight":case"stickyTopRight":case"stickyBottomRight":case"right":return"right";default:return null}}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>this.viewportSizeFeature=this.createManagedBean(new ViewportSizeFeature(this)))}registerWithCtrlsService(){switch(this.name){case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return;default:this.ctrlsService.register(this.name,this)}}forContainers(names,callback){names.indexOf(this.name)>=0&&callback()}getContainerElement(){return this.eContainer}getViewportSizeFeature(){return this.viewportSizeFeature}setComp(view,eContainer,eViewport){this.comp=view,this.eContainer=eContainer,this.eViewport=eViewport,this.createManagedBean(new RowContainerEventsFeature(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();const allNoFW=["topCenter","topLeft","topRight","bottomCenter","bottomLeft","bottomRight","center","left","right","stickyTopCenter","stickyTopLeft","stickyTopRight","stickyBottomCenter","stickyBottomLeft","stickyBottomRight"];this.forContainers(["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],()=>{this.pinnedWidthFeature=this.createManagedBean(new SetPinnedLeftWidthFeature(this.eContainer)),this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],()=>{this.pinnedWidthFeature=this.createManagedBean(new SetPinnedRightWidthFeature(this.eContainer)),this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,()=>this.onPinnedWidthChanged())}),this.forContainers(["center","left","right","fullWidth"],()=>this.createManagedBean(new SetHeightFeature(this.eContainer,"center"===this.name?eViewport:void 0))),this.forContainers(allNoFW,()=>this.createManagedBean(new DragListenerFeature(this.eContainer))),this.forContainers(["center","topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],()=>this.createManagedBean(new CenterWidthFeature(width=>this.comp.setContainerWidth(`${width}px`)))),this.addListeners(),this.registerWithCtrlsService()}addListeners(){this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>this.onDisplayedColumnsChanged()),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>this.onDisplayedColumnsWidthChanged()),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_ROWS_CHANGED,params=>this.onDisplayedRowsChanged(params.afterScroll)),this.onDisplayedColumnsChanged(),this.onDisplayedColumnsWidthChanged(),this.onDisplayedRowsChanged()}listenOnDomOrder(){if(["stickyTopCenter","stickyTopLeft","stickyTopRight","stickyTopFullWidth","stickyBottomCenter","stickyBottomLeft","stickyBottomRight","stickyBottomFullWidth"].indexOf(this.name)>=0)return void this.comp.setDomOrder(!0);const listener=()=>{const isEnsureDomOrder=this.gos.get("ensureDomOrder"),isPrintLayout=this.gos.isDomLayout("print");this.comp.setDomOrder(isEnsureDomOrder||isPrintLayout)};this.addManagedPropertyListener("domLayout",listener),listener()}stopHScrollOnPinnedRows(){this.forContainers(["topCenter","stickyTopCenter","bottomCenter","stickyBottomCenter"],()=>{this.addManagedListener(this.eViewport,"scroll",()=>this.eViewport.scrollLeft=0)})}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}onDisplayedColumnsWidthChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const preventScroll=e=>{this.dragService.isDragging()&&e.cancelable&&e.preventDefault()};this.eContainer.addEventListener("touchmove",preventScroll,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",preventScroll))}onHorizontalViewportChanged(afterScroll=!1){const scrollWidth=this.getCenterWidth(),scrollPosition=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(scrollWidth,scrollPosition,afterScroll)}getCenterWidth(){return getInnerWidth(this.eViewport)}getCenterViewportScrollLeft(){return getScrollLeft(this.eViewport,this.enableRtl)}registerViewportResizeListener(listener){const unsubscribeFromResize=this.resizeObserverService.observeResize(this.eViewport,listener);this.addDestroyFunc(()=>unsubscribeFromResize())}isViewportInTheDOMTree(){return isInDOM(this.eViewport)}getViewportScrollLeft(){return getScrollLeft(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||isHorizontalScrollShowing(this.eViewport)}getViewportElement(){return this.eViewport}setContainerTranslateX(amount){this.eContainer.style.transform=`translateX(${amount}px)`}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(value){setScrollLeft(this.eViewport,value,this.enableRtl)}isContainerVisible(){return!_RowContainerCtrl.getPinned(this.name)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const visible=this.isContainerVisible();this.visible!=visible&&(this.visible=visible,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(afterScroll=!1){const rows=this.getRowCtrls();if(!this.visible||0===rows.length)return void this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});const printLayout=this.gos.isDomLayout("print"),embedFW=this.gos.get("embedFullWidthRows")||printLayout,rowsThisContainer=rows.filter(rowCtrl=>{const fullWidthRow=rowCtrl.isFullWidth();return this.isFullWithContainer?!embedFW&&fullWidthRow:embedFW||!fullWidthRow});this.comp.setRowCtrls({rowCtrls:rowsThisContainer,useFlushSync:afterScroll})}getRowCtrls(){switch(this.name){case"topCenter":case"topLeft":case"topRight":case"topFullWidth":return this.rowRenderer.getTopRowCtrls();case"stickyTopCenter":case"stickyTopLeft":case"stickyTopRight":case"stickyTopFullWidth":return this.rowRenderer.getStickyTopRowCtrls();case"stickyBottomCenter":case"stickyBottomLeft":case"stickyBottomRight":case"stickyBottomFullWidth":return this.rowRenderer.getStickyBottomRowCtrls();case"bottomCenter":case"bottomLeft":case"bottomRight":case"bottomFullWidth":return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getCentreRowCtrls()}}};__decorateClass([Autowired("dragService")],_RowContainerCtrl.prototype,"dragService",2),__decorateClass([Autowired("ctrlsService")],_RowContainerCtrl.prototype,"ctrlsService",2),__decorateClass([Autowired("columnModel")],_RowContainerCtrl.prototype,"columnModel",2),__decorateClass([Autowired("resizeObserverService")],_RowContainerCtrl.prototype,"resizeObserverService",2),__decorateClass([Autowired("rowRenderer")],_RowContainerCtrl.prototype,"rowRenderer",2),__decorateClass([PostConstruct],_RowContainerCtrl.prototype,"postConstruct",1);var RowContainerCtrl=_RowContainerCtrl,GridBodyComp=class extends Component{constructor(){super('<div class="ag-root ag-unselectable" role="treegrid">\n        <ag-header-root ref="gridHeader"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation">\n            <ag-row-container ref="topLeftContainer" name="topLeft"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="topCenter"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="topRight"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="topFullWidth"></ag-row-container>\n        </div>\n        <div class="ag-body" ref="eBody" role="presentation">\n            <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n                <ag-row-container ref="leftContainer" name="left"></ag-row-container>\n                <ag-row-container ref="centerContainer" name="center"></ag-row-container>\n                <ag-row-container ref="rightContainer" name="right"></ag-row-container>\n                <ag-row-container ref="fullWidthContainer" name="fullWidth"></ag-row-container>\n            </div>\n            <ag-fake-vertical-scroll></ag-fake-vertical-scroll>\n        </div>\n        <div class="ag-sticky-top" ref="eStickyTop" role="presentation">\n            <ag-row-container ref="stickyTopLeftContainer" name="stickyTopLeft"></ag-row-container>\n            <ag-row-container ref="stickyTopCenterContainer" name="stickyTopCenter"></ag-row-container>\n            <ag-row-container ref="stickyTopRightContainer" name="stickyTopRight"></ag-row-container>\n            <ag-row-container ref="stickyTopFullWidthContainer" name="stickyTopFullWidth"></ag-row-container>\n        </div>\n        <div class="ag-sticky-bottom" ref="eStickyBottom" role="presentation">\n            <ag-row-container ref="stickyBottomLeftContainer" name="stickyBottomLeft"></ag-row-container>\n            <ag-row-container ref="stickyBottomCenterContainer" name="stickyBottomCenter"></ag-row-container>\n            <ag-row-container ref="stickyBottomRightContainer" name="stickyBottomRight"></ag-row-container>\n            <ag-row-container ref="stickyBottomFullWidthContainer" name="stickyBottomFullWidth"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation">\n            <ag-row-container ref="bottomLeftContainer" name="bottomLeft"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="bottomCenter"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="bottomRight"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="bottomFullWidth"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>')}init(){const setHeight=(height,element)=>{const heightString=`${height}px`;element.style.minHeight=heightString,element.style.height=heightString},compProxy={setRowAnimationCssOnBodyViewport:(cssClass,animate)=>this.setRowAnimationCssOnBodyViewport(cssClass,animate),setColumnCount:count=>setAriaColCount(this.getGui(),count),setRowCount:count=>setAriaRowCount(this.getGui(),count),setTopHeight:height=>setHeight(height,this.eTop),setBottomHeight:height=>setHeight(height,this.eBottom),setTopDisplay:display=>this.eTop.style.display=display,setBottomDisplay:display=>this.eBottom.style.display=display,setStickyTopHeight:height=>this.eStickyTop.style.height=height,setStickyTopTop:top=>this.eStickyTop.style.top=top,setStickyTopWidth:width=>this.eStickyTop.style.width=width,setStickyBottomHeight:height=>this.eStickyBottom.style.height=height,setStickyBottomBottom:bottom=>this.eStickyBottom.style.bottom=bottom,setStickyBottomWidth:width=>this.eStickyBottom.style.width=width,setColumnMovingCss:(cssClass,flag)=>this.addOrRemoveCssClass(cssClass,flag),updateLayoutClasses:(cssClass,params)=>{[this.eBodyViewport.classList,this.eBody.classList].forEach(classList=>{classList.toggle("ag-layout-auto-height",params.autoHeight),classList.toggle("ag-layout-normal",params.normal),classList.toggle("ag-layout-print",params.print)}),this.addOrRemoveCssClass("ag-layout-auto-height",params.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",params.normal),this.addOrRemoveCssClass("ag-layout-print",params.print)},setAlwaysVerticalScrollClass:(cssClass,on)=>this.eBodyViewport.classList.toggle("ag-force-vertical-scroll",on),registerBodyViewportResizeListener:listener=>{const unsubscribeFromResize=this.resizeObserverService.observeResize(this.eBodyViewport,listener);this.addDestroyFunc(()=>unsubscribeFromResize())},setPinnedTopBottomOverflowY:overflow=>this.eTop.style.overflowY=this.eBottom.style.overflowY=overflow,setCellSelectableCss:(cssClass,selectable)=>{[this.eTop,this.eBodyViewport,this.eBottom].forEach(ct=>ct.classList.toggle(cssClass,selectable))},setBodyViewportWidth:width=>this.eBodyViewport.style.width=width};this.ctrl=this.createManagedBean(new GridBodyCtrl),this.ctrl.setComp(compProxy,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom,this.eStickyTop,this.eStickyBottom),(this.rangeService&&this.gos.get("enableRangeSelection")||"multiple"===this.gos.get("rowSelection"))&&setAriaMultiSelectable(this.getGui(),!0)}setRowAnimationCssOnBodyViewport(cssClass,animateRows){const bodyViewportClassList=this.eBodyViewport.classList;bodyViewportClassList.toggle("ag-row-animation",animateRows),bodyViewportClassList.toggle("ag-row-no-animation",!animateRows)}getFloatingTopBottom(){return[this.eTop,this.eBottom]}};__decorateClass([Autowired("resizeObserverService")],GridBodyComp.prototype,"resizeObserverService",2),__decorateClass([Optional("rangeService")],GridBodyComp.prototype,"rangeService",2),__decorateClass([RefSelector("eBodyViewport")],GridBodyComp.prototype,"eBodyViewport",2),__decorateClass([RefSelector("eStickyTop")],GridBodyComp.prototype,"eStickyTop",2),__decorateClass([RefSelector("eStickyBottom")],GridBodyComp.prototype,"eStickyBottom",2),__decorateClass([RefSelector("eTop")],GridBodyComp.prototype,"eTop",2),__decorateClass([RefSelector("eBottom")],GridBodyComp.prototype,"eBottom",2),__decorateClass([RefSelector("gridHeader")],GridBodyComp.prototype,"headerRootComp",2),__decorateClass([RefSelector("eBody")],GridBodyComp.prototype,"eBody",2),__decorateClass([PostConstruct],GridBodyComp.prototype,"init",1);var ScrollVisibleService=class extends BeanStub{postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))}onDisplayedColumnsChanged(){this.update()}onDisplayedColumnsWidthChanged(){this.update()}update(){this.columnAnimationService.isActive()?this.columnAnimationService.executeLaterVMTurn(()=>{this.columnAnimationService.executeLaterVMTurn(()=>this.updateImpl())}):this.updateImpl()}updateImpl(){const centerRowCtrl=this.ctrlsService.get("center");if(!centerRowCtrl||this.columnAnimationService.isActive())return;const params={horizontalScrollShowing:centerRowCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(params)}setScrollsVisible(params){if(this.horizontalScrollShowing!==params.horizontalScrollShowing||this.verticalScrollShowing!==params.verticalScrollShowing){this.horizontalScrollShowing=params.horizontalScrollShowing,this.verticalScrollShowing=params.verticalScrollShowing;const event={type:Events.EVENT_SCROLL_VISIBILITY_CHANGED};this.eventService.dispatchEvent(event)}}isHorizontalScrollShowing(){return this.horizontalScrollShowing}isVerticalScrollShowing(){return this.verticalScrollShowing}};__decorateClass([Autowired("ctrlsService")],ScrollVisibleService.prototype,"ctrlsService",2),__decorateClass([Autowired("columnAnimationService")],ScrollVisibleService.prototype,"columnAnimationService",2),__decorateClass([PostConstruct],ScrollVisibleService.prototype,"postConstruct",1),ScrollVisibleService=__decorateClass([Bean("scrollVisibleService")],ScrollVisibleService);var MouseEventService=class extends BeanStub{constructor(){super(...arguments),this.gridInstanceId=MouseEventService.gridInstanceSequence.next()}stampTopLevelGridCompWithGridInstance(eGridDiv){eGridDiv[MouseEventService.GRID_DOM_KEY]=this.gridInstanceId}getRenderedCellForEvent(event){return getCtrlForEventTarget(this.gos,event.target,CellCtrl.DOM_DATA_KEY_CELL_CTRL)}isEventFromThisGrid(event){return this.isElementInThisGrid(event.target)}isElementInThisGrid(element){let pointer=element;for(;pointer;){const instanceId=pointer[MouseEventService.GRID_DOM_KEY];if(exists(instanceId)){return instanceId===this.gridInstanceId}pointer=pointer.parentElement}return!1}getCellPositionForEvent(event){const cellComp=this.getRenderedCellForEvent(event);return cellComp?cellComp.getCellPosition():null}getNormalisedPosition(event){const gridPanelHasScrolls=this.gos.isDomLayout("normal"),e=event;let x,y;if(null!=e.clientX||null!=e.clientY?(x=e.clientX,y=e.clientY):(x=e.x,y=e.y),gridPanelHasScrolls){const gridBodyCon=this.ctrlsService.getGridBodyCtrl(),vRange=gridBodyCon.getScrollFeature().getVScrollPosition();x+=gridBodyCon.getScrollFeature().getHScrollPosition().left,y+=vRange.top}return{x,y}}};MouseEventService.gridInstanceSequence=new NumberSequence,MouseEventService.GRID_DOM_KEY="__ag_grid_instance",__decorateClass([Autowired("ctrlsService")],MouseEventService.prototype,"ctrlsService",2),MouseEventService=__decorateClass([Bean("mouseEventService")],MouseEventService);var NavigationService=class extends BeanStub{constructor(){super(),this.onPageDown=throttle(this.onPageDown,100),this.onPageUp=throttle(this.onPageUp,100)}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridBodyCon=p.gridBodyCtrl})}handlePageScrollingKey(event,fromFullWidth=!1){const key=event.key,alt=event.altKey,ctrl=event.ctrlKey||event.metaKey,rangeServiceShouldHandleShift=!!this.rangeService&&event.shiftKey,currentCell=this.mouseEventService.getCellPositionForEvent(event);let processed=!1;switch(key){case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:ctrl||alt||(this.onHomeOrEndKey(key),processed=!0);break;case KeyCode.LEFT:case KeyCode.RIGHT:case KeyCode.UP:case KeyCode.DOWN:if(!currentCell)return!1;!ctrl||alt||rangeServiceShouldHandleShift||(this.onCtrlUpDownLeftRight(key,currentCell),processed=!0);break;case KeyCode.PAGE_DOWN:case KeyCode.PAGE_UP:ctrl||alt||(processed=this.handlePageUpDown(key,currentCell,fromFullWidth))}return processed&&event.preventDefault(),processed}handlePageUpDown(key,currentCell,fromFullWidth){return fromFullWidth&&(currentCell=this.focusService.getFocusedCell()),!!currentCell&&(key===KeyCode.PAGE_UP?this.onPageUp(currentCell):this.onPageDown(currentCell),!0)}navigateTo(navigateParams){var _a;const{scrollIndex,scrollType,scrollColumn,focusIndex,focusColumn}=navigateParams;exists(scrollColumn)&&!scrollColumn.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(scrollColumn),exists(scrollIndex)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(scrollIndex,scrollType),navigateParams.isAsync||this.gridBodyCon.getScrollFeature().ensureIndexVisible(focusIndex),this.focusService.setFocusedCell({rowIndex:focusIndex,column:focusColumn,rowPinned:null,forceBrowserFocus:!0}),null==(_a=this.rangeService)||_a.setRangeToCell({rowIndex:focusIndex,rowPinned:null,column:focusColumn})}onPageDown(gridCell){const scrollPosition=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),pixelsInOnePage=this.getViewportHeight(),pagingPixelOffset=this.paginationProxy.getPixelOffset(),currentPageBottomPixel=scrollPosition.top+pixelsInOnePage,currentPageBottomRow=this.paginationProxy.getRowIndexAtPixel(currentPageBottomPixel+pagingPixelOffset);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(gridCell,currentPageBottomRow):this.navigateToNextPage(gridCell,currentPageBottomRow)}onPageUp(gridCell){const scrollPosition=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),pagingPixelOffset=this.paginationProxy.getPixelOffset(),currentPageTopPixel=scrollPosition.top,currentPageTopRow=this.paginationProxy.getRowIndexAtPixel(currentPageTopPixel+pagingPixelOffset);this.columnModel.isAutoRowHeightActive()?this.navigateToNextPageWithAutoHeight(gridCell,currentPageTopRow,!0):this.navigateToNextPage(gridCell,currentPageTopRow,!0)}navigateToNextPage(gridCell,scrollIndex,up=!1){const pixelsInOnePage=this.getViewportHeight(),firstRow=this.paginationProxy.getPageFirstRow(),lastRow=this.paginationProxy.getPageLastRow(),pagingPixelOffset=this.paginationProxy.getPixelOffset(),currentRowNode=this.paginationProxy.getRow(gridCell.rowIndex),rowPixelDiff=up?(null==currentRowNode?void 0:currentRowNode.rowHeight)-pixelsInOnePage-pagingPixelOffset:pixelsInOnePage-pagingPixelOffset,nextCellPixel=(null==currentRowNode?void 0:currentRowNode.rowTop)+rowPixelDiff;let scrollType,focusIndex=this.paginationProxy.getRowIndexAtPixel(nextCellPixel+pagingPixelOffset);if(focusIndex===gridCell.rowIndex){const diff=up?-1:1;scrollIndex=focusIndex=gridCell.rowIndex+diff}up?(scrollType="bottom",focusIndex<firstRow&&(focusIndex=firstRow),scrollIndex<firstRow&&(scrollIndex=firstRow)):(scrollType="top",focusIndex>lastRow&&(focusIndex=lastRow),scrollIndex>lastRow&&(scrollIndex=lastRow)),this.isRowTallerThanView(focusIndex)&&(scrollIndex=focusIndex,scrollType="top"),this.navigateTo({scrollIndex,scrollType,scrollColumn:null,focusIndex,focusColumn:gridCell.column})}navigateToNextPageWithAutoHeight(gridCell,scrollIndex,up=!1){this.navigateTo({scrollIndex,scrollType:up?"bottom":"top",scrollColumn:null,focusIndex:scrollIndex,focusColumn:gridCell.column}),setTimeout(()=>{const focusIndex=this.getNextFocusIndexForAutoHeight(gridCell,up);this.navigateTo({scrollIndex,scrollType:up?"bottom":"top",scrollColumn:null,focusIndex,focusColumn:gridCell.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(gridCell,up=!1){var _a;const step=up?-1:1,pixelsInOnePage=this.getViewportHeight(),lastRowIndex=this.paginationProxy.getPageLastRow();let pixelSum=0,currentIndex=gridCell.rowIndex;for(;currentIndex>=0&&currentIndex<=lastRowIndex;){const currentCell=this.paginationProxy.getRow(currentIndex);if(currentCell){const currentCellHeight=null!=(_a=currentCell.rowHeight)?_a:0;if(pixelSum+currentCellHeight>pixelsInOnePage)break;pixelSum+=currentCellHeight}currentIndex+=step}return Math.max(0,Math.min(currentIndex,lastRowIndex))}getViewportHeight(){const{gridBodyCtrl,center}=this.ctrlsService.getParams(),scrollPosition=gridBodyCtrl.getScrollFeature().getVScrollPosition(),scrollbarWidth=this.gos.getScrollbarWidth();let pixelsInOnePage=scrollPosition.bottom-scrollPosition.top;return center.isHorizontalScrollShowing()&&(pixelsInOnePage-=scrollbarWidth),pixelsInOnePage}isRowTallerThanView(rowIndex){const rowNode=this.paginationProxy.getRow(rowIndex);if(!rowNode)return!1;const rowHeight=rowNode.rowHeight;return"number"==typeof rowHeight&&rowHeight>this.getViewportHeight()}onCtrlUpDownLeftRight(key,gridCell){const cellToFocus=this.cellNavigationService.getNextCellToFocus(key,gridCell,!0),{rowIndex,column}=cellToFocus;this.navigateTo({scrollIndex:rowIndex,scrollType:null,scrollColumn:column,focusIndex:rowIndex,focusColumn:column})}onHomeOrEndKey(key){const homeKey=key===KeyCode.PAGE_HOME,allColumns=this.columnModel.getAllDisplayedColumns(),columnToSelect=homeKey?allColumns[0]:last(allColumns),scrollIndex=homeKey?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex,scrollType:null,scrollColumn:columnToSelect,focusIndex:scrollIndex,focusColumn:columnToSelect})}onTabKeyDown(previous,keyboardEvent){const backwards=keyboardEvent.shiftKey,movedToNextCell=this.tabToNextCellCommon(previous,backwards,keyboardEvent);if(!1===movedToNextCell)if(backwards){const{rowIndex,rowPinned}=previous.getRowPosition();(rowPinned?0===rowIndex:rowIndex===this.paginationProxy.getPageFirstRow())&&(0===this.gos.get("headerHeight")||this.gos.get("suppressHeaderFocus")?this.focusService.focusNextGridCoreContainer(!0,!0):(keyboardEvent.preventDefault(),this.focusService.focusPreviousFromFirstCell(keyboardEvent)))}else previous instanceof CellCtrl&&previous.focusCell(!0),this.focusService.focusNextGridCoreContainer(backwards)&&keyboardEvent.preventDefault();else movedToNextCell&&keyboardEvent.preventDefault()}tabToNextCell(backwards,event){const focusedCell=this.focusService.getFocusedCell();if(!focusedCell)return!1;let cellOrRow=this.getCellByPosition(focusedCell);return!!(cellOrRow||(cellOrRow=this.rowRenderer.getRowByPosition(focusedCell),cellOrRow&&cellOrRow.isFullWidth()))&&!!this.tabToNextCellCommon(cellOrRow,backwards,event)}tabToNextCellCommon(previous,backwards,event){let res,editing=previous.isEditing();if(!editing&&previous instanceof CellCtrl){const row=previous.getRowCtrl();row&&(editing=row.isEditing())}return res=editing?"fullRow"===this.gos.get("editType")?this.moveToNextEditingRow(previous,backwards,event):this.moveToNextEditingCell(previous,backwards,event):this.moveToNextCellNotEditing(previous,backwards),null===res?res:res||!!this.focusService.getFocusedHeader()}moveToNextEditingCell(previousCell,backwards,event=null){const previousPos=previousCell.getCellPosition();previousCell.getGui().focus(),previousCell.stopEditing();const nextCell=this.findNextCellToFocusOn(previousPos,backwards,!0);return!1===nextCell?null:null!=nextCell&&(nextCell.startEditing(null,!0,event),nextCell.focusCell(!1),!0)}moveToNextEditingRow(previousCell,backwards,event=null){const previousPos=previousCell.getCellPosition(),nextCell=this.findNextCellToFocusOn(previousPos,backwards,!0);if(!1===nextCell)return null;if(null==nextCell)return!1;const nextPos=nextCell.getCellPosition(),previousEditable=this.isCellEditable(previousPos),nextEditable=this.isCellEditable(nextPos),rowsMatch=nextPos&&previousPos.rowIndex===nextPos.rowIndex&&previousPos.rowPinned===nextPos.rowPinned;if(previousEditable&&previousCell.setFocusOutOnEditor(),!rowsMatch){previousCell.getRowCtrl().stopEditing();nextCell.getRowCtrl().startRowEditing(void 0,void 0,event)}return nextEditable?(nextCell.setFocusInOnEditor(),nextCell.focusCell()):nextCell.focusCell(!0),!0}moveToNextCellNotEditing(previousCell,backwards){const displayedColumns=this.columnModel.getAllDisplayedColumns();let cellPos;cellPos=previousCell instanceof RowCtrl?__spreadProps(__spreadValues({},previousCell.getRowPosition()),{column:backwards?displayedColumns[0]:last(displayedColumns)}):previousCell.getCellPosition();const nextCell=this.findNextCellToFocusOn(cellPos,backwards,!1);if(!1===nextCell)return null;if(nextCell instanceof CellCtrl)nextCell.focusCell(!0);else if(nextCell)return this.tryToFocusFullWidthRow(nextCell.getRowPosition(),backwards);return exists(nextCell)}findNextCellToFocusOn(previousPosition,backwards,startEditing){var _a;let nextPosition=previousPosition;for(;;){previousPosition!==nextPosition&&(previousPosition=nextPosition),backwards||(nextPosition=this.getLastCellOfColSpan(nextPosition)),nextPosition=this.cellNavigationService.getNextTabbedCell(nextPosition,backwards);const userFunc=this.gos.getCallback("tabToNextCell");if(exists(userFunc)){const userResult=userFunc({backwards,editing:startEditing,previousCellPosition:previousPosition,nextCellPosition:nextPosition||null});if(!0===userResult||null===userResult)null===userResult&&warnOnce("Returning `null` from tabToNextCell is deprecated. Return `true` to stay on the current cell, or `false` to let the browser handle the tab behaviour."),nextPosition=previousPosition;else{if(!1===userResult)return!1;userResult.floating&&(warnOnce("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),userResult.rowPinned=userResult.floating),nextPosition={rowIndex:userResult.rowIndex,column:userResult.column,rowPinned:userResult.rowPinned}}}if(!nextPosition)return null;if(nextPosition.rowIndex<0){const headerLen=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:headerLen+nextPosition.rowIndex,column:nextPosition.column},fromCell:!0}),null}const fullRowEdit="fullRow"===this.gos.get("editType");if(startEditing&&!fullRowEdit){if(!this.isCellEditable(nextPosition))continue}this.ensureCellVisible(nextPosition);const nextCell=this.getCellByPosition(nextPosition);if(!nextCell){const row=this.rowRenderer.getRowByPosition(nextPosition);if(!row||!row.isFullWidth()||startEditing)continue;return row}if(!nextCell.isSuppressNavigable())return null==(_a=this.rangeService)||_a.setRangeToCell(nextPosition),nextCell}}isCellEditable(cell){const rowNode=this.lookupRowNodeForCell(cell);return!!rowNode&&cell.column.isCellEditable(rowNode)}getCellByPosition(cellPosition){const rowCtrl=this.rowRenderer.getRowByPosition(cellPosition);return rowCtrl?rowCtrl.getCellCtrl(cellPosition.column):null}lookupRowNodeForCell(cell){return"top"===cell.rowPinned?this.pinnedRowModel.getPinnedTopRow(cell.rowIndex):"bottom"===cell.rowPinned?this.pinnedRowModel.getPinnedBottomRow(cell.rowIndex):this.paginationProxy.getRow(cell.rowIndex)}navigateToNextCell(event,key,currentCell,allowUserOverride){let nextCell=currentCell,hitEdgeOfGrid=!1;for(;nextCell&&(nextCell===currentCell||!this.isValidNavigateCell(nextCell));)this.gos.get("enableRtl")?key===KeyCode.LEFT&&(nextCell=this.getLastCellOfColSpan(nextCell)):key===KeyCode.RIGHT&&(nextCell=this.getLastCellOfColSpan(nextCell)),nextCell=this.cellNavigationService.getNextCellToFocus(key,nextCell),hitEdgeOfGrid=missing(nextCell);if(hitEdgeOfGrid&&event&&event.key===KeyCode.UP&&(nextCell={rowIndex:-1,rowPinned:null,column:currentCell.column}),allowUserOverride){const userFunc=this.gos.getCallback("navigateToNextCell");if(exists(userFunc)){const userCell=userFunc({key,previousCellPosition:currentCell,nextCellPosition:nextCell||null,event});exists(userCell)?(userCell.floating&&(warnOnce("tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?"),userCell.rowPinned=userCell.floating),nextCell={rowPinned:userCell.rowPinned,rowIndex:userCell.rowIndex,column:userCell.column}):nextCell=null}}if(!nextCell)return;if(nextCell.rowIndex<0){const headerLen=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:headerLen+nextCell.rowIndex,column:currentCell.column},event:event||void 0,fromCell:!0})}const normalisedPosition=this.getNormalisedPosition(nextCell);normalisedPosition?this.focusPosition(normalisedPosition):this.tryToFocusFullWidthRow(nextCell)}getNormalisedPosition(cellPosition){this.ensureCellVisible(cellPosition);const cellCtrl=this.getCellByPosition(cellPosition);return cellCtrl?(cellPosition=cellCtrl.getCellPosition(),this.ensureCellVisible(cellPosition),cellPosition):null}tryToFocusFullWidthRow(position,backwards=!1){const displayedColumns=this.columnModel.getAllDisplayedColumns(),rowComp=this.rowRenderer.getRowByPosition(position);if(!rowComp||!rowComp.isFullWidth())return!1;const currentCellFocused=this.focusService.getFocusedCell(),cellPosition={rowIndex:position.rowIndex,rowPinned:position.rowPinned,column:position.column||(backwards?last(displayedColumns):displayedColumns[0])};this.focusPosition(cellPosition);const fromBelow=null!=currentCellFocused&&this.rowPositionUtils.before(cellPosition,currentCellFocused),focusEvent={type:Events.EVENT_FULL_WIDTH_ROW_FOCUSED,rowIndex:cellPosition.rowIndex,rowPinned:cellPosition.rowPinned,column:cellPosition.column,isFullWidthCell:!0,floating:cellPosition.rowPinned,fromBelow};return this.eventService.dispatchEvent(focusEvent),!0}focusPosition(cellPosition){var _a;this.focusService.setFocusedCell({rowIndex:cellPosition.rowIndex,column:cellPosition.column,rowPinned:cellPosition.rowPinned,forceBrowserFocus:!0}),null==(_a=this.rangeService)||_a.setRangeToCell(cellPosition)}isValidNavigateCell(cell){return!!this.rowPositionUtils.getRowNode(cell)}getLastCellOfColSpan(cell){const cellCtrl=this.getCellByPosition(cell);if(!cellCtrl)return cell;const colSpanningList=cellCtrl.getColSpanningList();return 1===colSpanningList.length?cell:{rowIndex:cell.rowIndex,column:last(colSpanningList),rowPinned:cell.rowPinned}}ensureCellVisible(gridCell){const isGroupStickyEnabled=this.gos.isGroupRowsSticky(),rowNode=this.rowModel.getRow(gridCell.rowIndex);!(isGroupStickyEnabled&&(null==rowNode?void 0:rowNode.sticky))&&missing(gridCell.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(gridCell.rowIndex),gridCell.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(gridCell.column)}};__decorateClass([Autowired("mouseEventService")],NavigationService.prototype,"mouseEventService",2),__decorateClass([Autowired("paginationProxy")],NavigationService.prototype,"paginationProxy",2),__decorateClass([Autowired("focusService")],NavigationService.prototype,"focusService",2),__decorateClass([Autowired("columnModel")],NavigationService.prototype,"columnModel",2),__decorateClass([Autowired("rowModel")],NavigationService.prototype,"rowModel",2),__decorateClass([Autowired("ctrlsService")],NavigationService.prototype,"ctrlsService",2),__decorateClass([Autowired("rowRenderer")],NavigationService.prototype,"rowRenderer",2),__decorateClass([Autowired("headerNavigationService")],NavigationService.prototype,"headerNavigationService",2),__decorateClass([Autowired("rowPositionUtils")],NavigationService.prototype,"rowPositionUtils",2),__decorateClass([Autowired("cellNavigationService")],NavigationService.prototype,"cellNavigationService",2),__decorateClass([Autowired("pinnedRowModel")],NavigationService.prototype,"pinnedRowModel",2),__decorateClass([Optional("rangeService")],NavigationService.prototype,"rangeService",2),__decorateClass([PostConstruct],NavigationService.prototype,"postConstruct",1),NavigationService=__decorateClass([Bean("navigationService")],NavigationService);var _PopupEditorWrapper=class _PopupEditorWrapper extends PopupComponent{constructor(params){super('<div class="ag-popup-editor" tabindex="-1"/>'),this.params=params}postConstruct(){this.gos.setDomData(this.getGui(),_PopupEditorWrapper.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()}addKeyDownListener(){const eGui=this.getGui(),params=this.params;this.addManagedListener(eGui,"keydown",event=>{isUserSuppressingKeyboardEvent(this.gos,event,params.node,params.column,!0)||params.onKeyDown(event)})}};_PopupEditorWrapper.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",__decorateClass([PostConstruct],_PopupEditorWrapper.prototype,"postConstruct",1);var PopupEditorWrapper=_PopupEditorWrapper,CellComp=class extends Component{constructor(beans,cellCtrl,printLayout,eRow,editingRow){super(),this.rendererVersion=0,this.editorVersion=0,this.beans=beans,this.column=cellCtrl.getColumn(),this.rowNode=cellCtrl.getRowNode(),this.rowCtrl=cellCtrl.getRowCtrl(),this.eRow=eRow,this.cellCtrl=cellCtrl;const cellDiv=document.createElement("div");cellDiv.setAttribute("comp-id",`${this.getCompId()}`),this.setTemplateFromElement(cellDiv);const eGui=this.getGui();this.forceWrapper=cellCtrl.isForceWrapper(),this.refreshWrapper(!1);const setAttribute=(name,value)=>{null!=value&&""!=value?eGui.setAttribute(name,value):eGui.removeAttribute(name)};setAriaRole(eGui,cellCtrl.getCellAriaRole()),setAttribute("col-id",cellCtrl.getColumnIdSanitised());const tabIndex=cellCtrl.getTabIndex();void 0!==tabIndex&&setAttribute("tabindex",tabIndex.toString());const compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setUserStyles:styles=>addStylesToElement(eGui,styles),getFocusableElement:()=>this.getFocusableElement(),setIncludeSelection:include=>this.includeSelection=include,setIncludeRowDrag:include=>this.includeRowDrag=include,setIncludeDndSource:include=>this.includeDndSource=include,setRenderDetails:(compDetails,valueToDisplay,force)=>this.setRenderDetails(compDetails,valueToDisplay,force),setEditDetails:(compDetails,popup,position)=>this.setEditDetails(compDetails,popup,position),getCellEditor:()=>this.cellEditor||null,getCellRenderer:()=>this.cellRenderer||null,getParentOfValue:()=>this.getParentOfValue()};cellCtrl.setComp(compProxy,this.getGui(),this.eCellWrapper,printLayout,editingRow)}getParentOfValue(){return this.eCellValue?this.eCellValue:this.eCellWrapper?this.eCellWrapper:this.getGui()}setRenderDetails(compDetails,valueToDisplay,forceNewCellRendererInstance){if(this.cellEditor&&!this.cellEditorPopupWrapper)return;this.firstRender=null==this.firstRender;const controlWrapperChanged=this.refreshWrapper(!1);if(this.refreshEditStyles(!1),compDetails){!(forceNewCellRendererInstance||controlWrapperChanged)&&this.refreshCellRenderer(compDetails)||(this.destroyRenderer(),this.createCellRendererInstance(compDetails))}else this.destroyRenderer(),this.insertValueWithoutCellRenderer(valueToDisplay)}setEditDetails(compDetails,popup,position){compDetails?this.createCellEditorInstance(compDetails,popup,position):this.destroyEditor()}removeControls(){this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)}refreshWrapper(editing){const providingControls=this.includeRowDrag||this.includeDndSource||this.includeSelection,usingWrapper=providingControls||this.forceWrapper,putWrapperIn=usingWrapper&&null==this.eCellWrapper;if(putWrapperIn){const wrapperDiv=document.createElement("div");wrapperDiv.setAttribute("role","presentation"),wrapperDiv.setAttribute("class","ag-cell-wrapper"),this.eCellWrapper=wrapperDiv,this.getGui().appendChild(this.eCellWrapper)}const takeWrapperOut=!usingWrapper&&null!=this.eCellWrapper;takeWrapperOut&&(removeFromParent(this.eCellWrapper),this.eCellWrapper=void 0),this.addOrRemoveCssClass("ag-cell-value",!usingWrapper);const usingCellValue=!editing&&usingWrapper,putCellValueIn=usingCellValue&&null==this.eCellValue;if(putCellValueIn){const cellSpan=document.createElement("span");cellSpan.setAttribute("role","presentation"),cellSpan.setAttribute("class","ag-cell-value"),this.eCellValue=cellSpan,this.eCellWrapper.appendChild(this.eCellValue)}const takeCellValueOut=!usingCellValue&&null!=this.eCellValue;takeCellValueOut&&(removeFromParent(this.eCellValue),this.eCellValue=void 0);const templateChanged=putWrapperIn||takeWrapperOut||putCellValueIn||takeCellValueOut;return templateChanged&&this.removeControls(),editing||providingControls&&this.addControls(),templateChanged}addControls(){this.includeRowDrag&&null==this.rowDraggingComp&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&null==this.dndSourceComp&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&null==this.checkboxSelectionComp&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue))}createCellEditorInstance(compDetails,popup,position){const versionCopy=this.editorVersion,cellEditorPromise=compDetails.newAgStackInstance();if(!cellEditorPromise)return;const{params}=compDetails;cellEditorPromise.then(c=>this.afterCellEditorCreated(versionCopy,c,params,popup,position));missing(this.cellEditor)&&params.cellStartedEdit&&this.cellCtrl.focusCell(!0)}insertValueWithoutCellRenderer(valueToDisplay){const eParent=this.getParentOfValue();clearElement(eParent);const escapedValue=null!=valueToDisplay?escapeString(valueToDisplay,!0):null;null!=escapedValue&&(eParent.textContent=escapedValue)}destroyEditorAndRenderer(){this.destroyRenderer(),this.destroyEditor()}destroyRenderer(){const{context}=this.beans;this.cellRenderer=context.destroyBean(this.cellRenderer),removeFromParent(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++}destroyEditor(){const{context}=this.beans;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=context.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=context.destroyBean(this.cellEditorPopupWrapper),removeFromParent(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++}refreshCellRenderer(compClassAndParams){if(null==this.cellRenderer||null==this.cellRenderer.refresh)return!1;if(this.cellRendererClass!==compClassAndParams.componentClass)return!1;const result=this.cellRenderer.refresh(compClassAndParams.params);return!0===result||void 0===result}createCellRendererInstance(compDetails){const useTaskService=!this.beans.gos.get("suppressAnimationFrame"),displayComponentVersionCopy=this.rendererVersion,{componentClass}=compDetails,createCellRendererFunc=()=>{if(this.rendererVersion!==displayComponentVersionCopy||!this.isAlive())return;const componentPromise=compDetails.newAgStackInstance(),callback=this.afterCellRendererCreated.bind(this,displayComponentVersionCopy,componentClass);componentPromise&&componentPromise.then(callback)};useTaskService&&this.firstRender?this.beans.animationFrameService.createTask(createCellRendererFunc,this.rowNode.rowIndex,"createTasksP2"):createCellRendererFunc()}getCtrl(){return this.cellCtrl}getRowCtrl(){return this.rowCtrl}getCellRenderer(){return this.cellRenderer}getCellEditor(){return this.cellEditor}afterCellRendererCreated(cellRendererVersion,cellRendererClass,cellRenderer){if(!this.isAlive()||cellRendererVersion!==this.rendererVersion)this.beans.context.destroyBean(cellRenderer);else if(this.cellRenderer=cellRenderer,this.cellRendererClass=cellRendererClass,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui){const eParent=this.getParentOfValue();clearElement(eParent),eParent.appendChild(this.cellRendererGui)}}afterCellEditorCreated(requestVersion,cellEditor,params,popup,position){if(requestVersion!==this.editorVersion)return void this.beans.context.destroyBean(cellEditor);if(cellEditor.isCancelBeforeStart&&cellEditor.isCancelBeforeStart())return this.beans.context.destroyBean(cellEditor),void this.cellCtrl.stopEditing(!0);if(!cellEditor.getGui)return console.warn(`AG Grid: cellEditor for column ${this.column.getId()} is missing getGui() method`),void this.beans.context.destroyBean(cellEditor);this.cellEditor=cellEditor,this.cellEditorGui=cellEditor.getGui();const cellEditorInPopup=popup||void 0!==cellEditor.isPopup&&cellEditor.isPopup();cellEditorInPopup?this.addPopupCellEditor(params,position):this.addInCellEditor(),this.refreshEditStyles(!0,cellEditorInPopup),cellEditor.afterGuiAttached&&cellEditor.afterGuiAttached()}refreshEditStyles(editing,isPopup){var _a;this.addOrRemoveCssClass("ag-cell-inline-editing",editing&&!isPopup),this.addOrRemoveCssClass("ag-cell-popup-editing",editing&&!!isPopup),this.addOrRemoveCssClass("ag-cell-not-inline-editing",!editing||!!isPopup),null==(_a=this.rowCtrl)||_a.setInlineEditingCss(editing)}addInCellEditor(){const eGui=this.getGui();if(eGui.contains(this.beans.gos.getActiveDomElement())&&eGui.focus(),this.destroyRenderer(),this.refreshWrapper(!0),this.clearParentOfValue(),this.cellEditorGui){this.getParentOfValue().appendChild(this.cellEditorGui)}}addPopupCellEditor(params,position){"fullRow"===this.beans.gos.get("editType")&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");const cellEditor=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new PopupEditorWrapper(params));const ePopupGui=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&ePopupGui.appendChild(this.cellEditorGui);const popupService=this.beans.popupService,useModelPopup=this.beans.gos.get("stopEditingWhenCellsLoseFocus"),positionToUse=null!=position?position:cellEditor.getPopupPosition?cellEditor.getPopupPosition():"over",isRtl=this.beans.gos.get("enableRtl"),positionParams={ePopup:ePopupGui,column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),position:positionToUse,alignSide:isRtl?"right":"left",keepWithinBounds:!0},positionCallback=popupService.positionPopupByComponent.bind(popupService,positionParams),translate=this.beans.localeService.getLocaleTextFunc(),addPopupRes=popupService.addPopup({modal:useModelPopup,eChild:ePopupGui,closeOnEsc:!0,closedCallback:()=>{this.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback,ariaLabel:translate("ariaLabelCellEditor","Cell Editor")});addPopupRes&&(this.hideEditorPopup=addPopupRes.hideFunc)}detach(){this.eRow.removeChild(this.getGui())}destroy(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControls(),super.destroy()}clearParentOfValue(){const eGui=this.getGui();eGui.contains(this.beans.gos.getActiveDomElement())&&browserSupportsPreventScroll()&&eGui.focus({preventScroll:!0}),clearElement(this.getParentOfValue())}},RowComp=class extends Component{constructor(ctrl,beans,containerType){super(),this.cellComps={},this.beans=beans,this.rowCtrl=ctrl;const rowDiv=document.createElement("div");rowDiv.setAttribute("comp-id",`${this.getCompId()}`),rowDiv.setAttribute("style",this.getInitialStyle(containerType)),this.setTemplateFromElement(rowDiv);const eGui=this.getGui(),style=eGui.style;this.domOrder=this.rowCtrl.getDomOrder(),setAriaRole(eGui,"row");const tabIndex=this.rowCtrl.getTabIndex();null!=tabIndex&&eGui.setAttribute("tabindex",tabIndex.toString());const compProxy={setDomOrder:domOrder=>this.domOrder=domOrder,setCellCtrls:cellCtrls=>this.setCellCtrls(cellCtrls),showFullWidth:compDetails=>this.showFullWidth(compDetails),getFullWidthCellRenderer:()=>this.getFullWidthCellRenderer(),addOrRemoveCssClass:(name,on)=>this.addOrRemoveCssClass(name,on),setUserStyles:styles=>addStylesToElement(eGui,styles),setTop:top=>style.top=top,setTransform:transform=>style.transform=transform,setRowIndex:rowIndex=>eGui.setAttribute("row-index",rowIndex),setRowId:rowId=>eGui.setAttribute("row-id",rowId),setRowBusinessKey:businessKey=>eGui.setAttribute("row-business-key",businessKey),refreshFullWidth:getUpdatedParams=>this.refreshFullWidth(getUpdatedParams)};ctrl.setComp(compProxy,this.getGui(),containerType),this.addDestroyFunc(()=>{ctrl.unsetComp(containerType)})}getInitialStyle(containerType){const transform=this.rowCtrl.getInitialTransform(containerType);return transform?`transform: ${transform}`:`top: ${this.rowCtrl.getInitialRowTop(containerType)}`}showFullWidth(compDetails){const res=compDetails.newAgStackInstance();res&&res.then(cellRenderer=>{if(this.isAlive()){const eGui=cellRenderer.getGui();this.getGui().appendChild(eGui),this.rowCtrl.setupDetailRowAutoHeight(eGui),this.setFullWidthRowComp(cellRenderer)}else this.beans.context.destroyBean(cellRenderer)})}setCellCtrls(cellCtrls){const cellsToRemove=Object.assign({},this.cellComps);cellCtrls.forEach(cellCtrl=>{const key=cellCtrl.getInstanceId();null==this.cellComps[key]?this.newCellComp(cellCtrl):cellsToRemove[key]=null});const cellCompsToRemove=getAllValuesInObject(cellsToRemove).filter(cellComp=>null!=cellComp);this.destroyCells(cellCompsToRemove),this.ensureDomOrder(cellCtrls)}ensureDomOrder(cellCtrls){if(!this.domOrder)return;const elementsInOrder=[];cellCtrls.forEach(cellCtrl=>{const cellComp=this.cellComps[cellCtrl.getInstanceId()];cellComp&&elementsInOrder.push(cellComp.getGui())}),setDomChildOrder(this.getGui(),elementsInOrder)}newCellComp(cellCtrl){const cellComp=new CellComp(this.beans,cellCtrl,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[cellCtrl.getInstanceId()]=cellComp,this.getGui().appendChild(cellComp.getGui())}destroy(){super.destroy(),this.destroyAllCells()}destroyAllCells(){const cellsToDestroy=getAllValuesInObject(this.cellComps).filter(cp=>null!=cp);this.destroyCells(cellsToDestroy)}setFullWidthRowComp(fullWidthRowComponent){this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=fullWidthRowComponent,this.addDestroyFunc(()=>{this.fullWidthCellRenderer=this.beans.context.destroyBean(this.fullWidthCellRenderer)})}getFullWidthCellRenderer(){return this.fullWidthCellRenderer}destroyCells(cellComps){cellComps.forEach(cellComp=>{if(!cellComp)return;const instanceId=cellComp.getCtrl().getInstanceId();this.cellComps[instanceId]===cellComp&&(cellComp.detach(),cellComp.destroy(),this.cellComps[instanceId]=null)})}refreshFullWidth(getUpdatedParams){const{fullWidthCellRenderer}=this;if(!fullWidthCellRenderer||!fullWidthCellRenderer.refresh)return!1;const params=getUpdatedParams();return fullWidthCellRenderer.refresh(params)}};var RowContainerComp=class extends Component{constructor(){super(function templateFactory(){const name=Component.elementGettingCreated.getAttribute("name"),cssClasses=RowContainerCtrl.getRowContainerCssClasses(name);let res;return res="center"===name||"topCenter"===name||"stickyTopCenter"===name||"bottomCenter"===name||"stickyBottomCenter"===name?`<div class="${cssClasses.viewport}" ref="eViewport" role="presentation">\n                <div class="${cssClasses.container}" ref="eContainer"></div>\n            </div>`:`<div class="${cssClasses.container}" ref="eContainer"></div>`,res}()),this.rowComps={},this.name=Component.elementGettingCreated.getAttribute("name"),this.type=function getRowContainerTypeForName(name){switch(name){case"center":case"topCenter":case"stickyTopCenter":case"bottomCenter":case"stickyBottomCenter":return"center";case"left":case"topLeft":case"stickyTopLeft":case"bottomLeft":case"stickyBottomLeft":return"left";case"right":case"topRight":case"stickyTopRight":case"bottomRight":case"stickyBottomRight":return"right";case"fullWidth":case"topFullWidth":case"stickyTopFullWidth":case"bottomFullWidth":case"stickyBottomFullWidth":return"fullWidth";default:throw Error("Invalid Row Container Type")}}(this.name)}postConstruct(){const compProxy={setViewportHeight:height=>this.eViewport.style.height=height,setRowCtrls:({rowCtrls})=>this.setRowCtrls(rowCtrls),setDomOrder:domOrder=>{this.domOrder=domOrder},setContainerWidth:width=>this.eContainer.style.width=width};this.createManagedBean(new RowContainerCtrl(this.name)).setComp(compProxy,this.eContainer,this.eViewport)}preDestroy(){this.setRowCtrls([])}setRowCtrls(rowCtrls){const oldRows=__spreadValues({},this.rowComps);this.rowComps={},this.lastPlacedElement=null;rowCtrls.forEach(rowCon=>{const instanceId=rowCon.getInstanceId(),existingRowComp=oldRows[instanceId];if(existingRowComp)this.rowComps[instanceId]=existingRowComp,delete oldRows[instanceId],this.ensureDomOrder(existingRowComp.getGui());else{if(!rowCon.getRowNode().displayed)return;const rowComp=new RowComp(rowCon,this.beans,this.type);this.rowComps[instanceId]=rowComp,this.appendRow(rowComp.getGui())}}),getAllValuesInObject(oldRows).forEach(oldRowComp=>{this.eContainer.removeChild(oldRowComp.getGui()),oldRowComp.destroy()}),setAriaRole(this.eContainer,"rowgroup")}appendRow(element){this.domOrder?insertWithDomOrder(this.eContainer,element,this.lastPlacedElement):this.eContainer.appendChild(element),this.lastPlacedElement=element}ensureDomOrder(eRow){this.domOrder&&(ensureDomOrder(this.eContainer,eRow,this.lastPlacedElement),this.lastPlacedElement=eRow)}};__decorateClass([Autowired("beans")],RowContainerComp.prototype,"beans",2),__decorateClass([RefSelector("eViewport")],RowContainerComp.prototype,"eViewport",2),__decorateClass([RefSelector("eContainer")],RowContainerComp.prototype,"eContainer",2),__decorateClass([PostConstruct],RowContainerComp.prototype,"postConstruct",1),__decorateClass([PreDestroy],RowContainerComp.prototype,"preDestroy",1);var BodyDropPivotTarget=class{constructor(pinned){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=pinned}onDragEnter(draggingEvent){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const dragColumns=draggingEvent.dragItem.columns;dragColumns&&dragColumns.forEach(column=>{column.isPrimary()&&(column.isAnyFunctionActive()||(column.isAllowValue()?this.columnsToAggregate.push(column):column.isAllowRowGroup()?this.columnsToGroup.push(column):column.isAllowPivot()&&this.columnsToPivot.push(column)))})}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?DragAndDropService.ICON_PINNED:DragAndDropService.ICON_MOVE:null}onDragLeave(draggingEvent){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(draggingEvent){}onDragStop(draggingEvent){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")}};__decorateClass([Autowired("columnModel")],BodyDropPivotTarget.prototype,"columnModel",2),__decorateClass([Autowired("gridOptionsService")],BodyDropPivotTarget.prototype,"gos",2);var ColumnMoveHelper=class{static attemptMoveColumns(params){const{isFromHeader,hDirection,xPosition,fromEnter,fakeEvent,pinned,gos,columnModel}=params,draggingLeft=0===hDirection,draggingRight=1===hDirection;let{allMovingColumns}=params;if(isFromHeader){let newCols=[];allMovingColumns.forEach(col=>{var _a;let movingGroup=null,parent=col.getParent();for(;null!=parent&&1===parent.getDisplayedLeafColumns().length;)movingGroup=parent,parent=parent.getParent();if(null!=movingGroup){(!!(null==(_a=movingGroup.getColGroupDef())?void 0:_a.marryChildren)?movingGroup.getProvidedColumnGroup().getLeafColumns():movingGroup.getLeafColumns()).forEach(newCol=>{newCols.includes(newCol)||newCols.push(newCol)})}else newCols.includes(col)||newCols.push(col)}),allMovingColumns=newCols}const allMovingColumnsOrdered=allMovingColumns.slice();columnModel.sortColumnsLikeGridColumns(allMovingColumnsOrdered);const validMoves=this.calculateValidMoves({movingCols:allMovingColumnsOrdered,draggingRight,xPosition,pinned,gos,columnModel}),oldIndex=this.calculateOldIndex(allMovingColumnsOrdered,columnModel);if(0===validMoves.length)return;const firstValidMove=validMoves[0];let constrainDirection=null!==oldIndex&&!fromEnter;if(isFromHeader&&(constrainDirection=null!==oldIndex),constrainDirection&&!fakeEvent){if(draggingLeft&&firstValidMove>=oldIndex)return;if(draggingRight&&firstValidMove<=oldIndex)return}const displayedCols=columnModel.getAllDisplayedColumns();let potentialMoves=[],targetOrder=null;for(let i=0;i<validMoves.length;i++){const move=validMoves[i],order=columnModel.getProposedColumnOrder(allMovingColumnsOrdered,move);if(!columnModel.doesOrderPassRules(order))continue;const displayedOrder=order.filter(col=>displayedCols.includes(col));if(null===targetOrder)targetOrder=displayedOrder;else if(!areEqual(displayedOrder,targetOrder))break;const fragCount=this.groupFragCount(order);potentialMoves.push({move,fragCount})}return 0!==potentialMoves.length?(potentialMoves.sort((a,b)=>a.fragCount-b.fragCount),this.moveColumns(allMovingColumns,potentialMoves[0].move,"uiColumnMoved",!1,columnModel)):void 0}static moveColumns(columns,toIndex,source,finished,columnModel){return columnModel.moveColumns(columns,toIndex,source,finished),finished?null:{columns,toIndex}}static calculateOldIndex(movingCols,columnModel){const gridCols=columnModel.getAllGridColumns(),indexes=sortNumerically(movingCols.map(col=>gridCols.indexOf(col))),firstIndex=indexes[0];return last(indexes)-firstIndex!==indexes.length-1?null:firstIndex}static groupFragCount(columns){function parents(col){let result=[],parent=col.getOriginalParent();for(;null!=parent;)result.push(parent),parent=parent.getOriginalParent();return result}let count=0;for(let i=0;i<columns.length-1;i++){let a=parents(columns[i]),b=parents(columns[i+1]);[a,b]=a.length>b.length?[a,b]:[b,a],a.forEach(parent=>{-1===b.indexOf(parent)&&count++})}return count}static getDisplayedColumns(columnModel,type){switch(type){case"left":return columnModel.getDisplayedLeftColumns();case"right":return columnModel.getDisplayedRightColumns();default:return columnModel.getDisplayedCenterColumns()}}static calculateValidMoves(params){const{movingCols,draggingRight,xPosition,pinned,gos,columnModel}=params;if(gos.get("suppressMovableColumns")||movingCols.some(col=>col.getColDef().suppressMovable))return[];const allDisplayedCols=this.getDisplayedColumns(columnModel,pinned),allGridCols=columnModel.getAllGridColumns(),movingDisplayedCols=allDisplayedCols.filter(col=>includes(movingCols,col)),otherDisplayedCols=allDisplayedCols.filter(col=>!includes(movingCols,col)),otherGridCols=allGridCols.filter(col=>!includes(movingCols,col));let firstValidMove,displayIndex=0,availableWidth=xPosition;if(draggingRight){let widthOfMovingDisplayedCols=0;movingDisplayedCols.forEach(col=>widthOfMovingDisplayedCols+=col.getActualWidth()),availableWidth-=widthOfMovingDisplayedCols}if(availableWidth>0){for(let i=0;i<otherDisplayedCols.length;i++){if(availableWidth-=otherDisplayedCols[i].getActualWidth(),availableWidth<0)break;displayIndex++}draggingRight&&displayIndex++}if(displayIndex>0){const leftColumn=otherDisplayedCols[displayIndex-1];firstValidMove=otherGridCols.indexOf(leftColumn)+1}else firstValidMove=otherGridCols.indexOf(otherDisplayedCols[0]),-1===firstValidMove&&(firstValidMove=0);const validMoves=[firstValidMove],numberComparator=(a,b)=>a-b;if(draggingRight){let pointer=firstValidMove+1;const lastIndex=allGridCols.length-1;for(;pointer<=lastIndex;)validMoves.push(pointer),pointer++;validMoves.sort(numberComparator)}else{let pointer=firstValidMove;const lastIndex=allGridCols.length-1;let displacedCol=allGridCols[pointer];for(;pointer<=lastIndex&&allDisplayedCols.indexOf(displacedCol)<0;)pointer++,validMoves.push(pointer),displacedCol=allGridCols[pointer];pointer=firstValidMove-1;const firstDisplayIndex=0;for(;pointer>=firstDisplayIndex;)validMoves.push(pointer),pointer--;validMoves.sort(numberComparator).reverse()}return validMoves}static normaliseX(x,pinned,fromKeyboard,gos,ctrlsService){const eViewport=ctrlsService.getHeaderRowContainerCtrl(pinned).getViewport();if(fromKeyboard&&(x-=eViewport.getBoundingClientRect().left),gos.get("enableRtl")){x=eViewport.clientWidth-x}return null==pinned&&(x+=ctrlsService.get("center").getCenterViewportScrollLeft()),x}},MoveColumnFeature=class{constructor(pinned){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.pinned=pinned,this.isCenterContainer=!exists(pinned)}init(){this.ctrlsService.whenReady(p=>{this.gridBodyCon=p.gridBodyCtrl})}getIconName(){return this.pinned?DragAndDropService.ICON_PINNED:DragAndDropService.ICON_MOVE}onDragEnter(draggingEvent){const columns=draggingEvent.dragItem.columns;if(0===draggingEvent.dragSource.type)this.setColumnsVisible(columns,!0,"uiColumnDragged");else{const visibleState=draggingEvent.dragItem.visibleState,visibleColumns=(columns||[]).filter(column=>visibleState[column.getId()]);this.setColumnsVisible(visibleColumns,!0,"uiColumnDragged")}this.setColumnsPinned(columns,this.pinned,"uiColumnDragged"),this.onDragging(draggingEvent,!0,!0)}onDragLeave(){this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(columns,visible,source){if(columns){const allowedCols=columns.filter(c=>!c.getColDef().lockVisible);this.columnModel.setColumnsVisible(allowedCols,visible,source)}}setColumnsPinned(columns,pinned,source){if(columns){const allowedCols=columns.filter(c=>!c.getColDef().lockPinned);this.columnModel.setColumnsPinned(allowedCols,pinned,source)}}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}checkCenterForScrolling(xAdjustedForScroll){if(this.isCenterContainer){const centerCtrl=this.ctrlsService.get("center"),firstVisiblePixel=centerCtrl.getCenterViewportScrollLeft(),lastVisiblePixel=firstVisiblePixel+centerCtrl.getCenterWidth();this.gos.get("enableRtl")?(this.needToMoveRight=xAdjustedForScroll<firstVisiblePixel+50,this.needToMoveLeft=xAdjustedForScroll>lastVisiblePixel-50):(this.needToMoveLeft=xAdjustedForScroll<firstVisiblePixel+50,this.needToMoveRight=xAdjustedForScroll>lastVisiblePixel-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}}onDragging(draggingEvent=this.lastDraggingEvent,fromEnter=!1,fakeEvent=!1,finished=!1){var _a;if(finished){if(this.lastMovedInfo){const{columns,toIndex}=this.lastMovedInfo;ColumnMoveHelper.moveColumns(columns,toIndex,"uiColumnMoved",!0,this.columnModel)}return}if(this.lastDraggingEvent=draggingEvent,missing(draggingEvent.hDirection))return;const mouseX=ColumnMoveHelper.normaliseX(draggingEvent.x,this.pinned,!1,this.gos,this.ctrlsService);fromEnter||this.checkCenterForScrolling(mouseX);const hDirection=this.normaliseDirection(draggingEvent.hDirection),dragSourceType=draggingEvent.dragSource.type,allMovingColumns=(null==(_a=draggingEvent.dragSource.getDragItem().columns)?void 0:_a.filter(col=>!col.getColDef().lockPinned||col.getPinned()==this.pinned))||[],lastMovedInfo=ColumnMoveHelper.attemptMoveColumns({allMovingColumns,isFromHeader:1===dragSourceType,hDirection,xPosition:mouseX,pinned:this.pinned,fromEnter,fakeEvent,gos:this.gos,columnModel:this.columnModel});lastMovedInfo&&(this.lastMovedInfo=lastMovedInfo)}normaliseDirection(hDirection){if(!this.gos.get("enableRtl"))return hDirection;switch(hDirection){case 0:return 1;case 1:return 0;default:console.error(`AG Grid: Unknown direction ${hDirection}`)}}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.needToMoveLeft?this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_LEFT,!0):this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_RIGHT,!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_MOVE))}moveInterval(){let pixelsToMove;this.intervalCount++,pixelsToMove=10+5*this.intervalCount,pixelsToMove>100&&(pixelsToMove=100);let pixelsMoved=null;const scrollFeature=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?pixelsMoved=scrollFeature.scrollHorizontally(-pixelsToMove):this.needToMoveRight&&(pixelsMoved=scrollFeature.scrollHorizontally(pixelsToMove)),0!==pixelsMoved)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const columnsThatCanPin=this.lastDraggingEvent.dragItem.columns.filter(c=>!c.getColDef().lockPinned);if(columnsThatCanPin.length>0&&(this.dragAndDropService.setGhostIcon(DragAndDropService.ICON_PINNED),this.failedMoveAttempts>7)){const pinType=this.needToMoveLeft?"left":"right";this.setColumnsPinned(columnsThatCanPin,pinType,"uiColumnDragged"),this.dragAndDropService.nudge()}}}};__decorateClass([Autowired("columnModel")],MoveColumnFeature.prototype,"columnModel",2),__decorateClass([Autowired("dragAndDropService")],MoveColumnFeature.prototype,"dragAndDropService",2),__decorateClass([Autowired("gridOptionsService")],MoveColumnFeature.prototype,"gos",2),__decorateClass([Autowired("ctrlsService")],MoveColumnFeature.prototype,"ctrlsService",2),__decorateClass([PostConstruct],MoveColumnFeature.prototype,"init",1);var BodyDropTarget=class extends BeanStub{constructor(pinned,eContainer){super(),this.pinned=pinned,this.eContainer=eContainer}postConstruct(){this.ctrlsService.whenReady(p=>{switch(this.pinned){case"left":this.eSecondaryContainers=[[p.gridBodyCtrl.getBodyViewportElement(),p.left.getContainerElement()],[p.bottomLeft.getContainerElement()],[p.topLeft.getContainerElement()]];break;case"right":this.eSecondaryContainers=[[p.gridBodyCtrl.getBodyViewportElement(),p.right.getContainerElement()],[p.bottomRight.getContainerElement()],[p.topRight.getContainerElement()]];break;default:this.eSecondaryContainers=[[p.gridBodyCtrl.getBodyViewportElement(),p.center.getViewportElement()],[p.bottomCenter.getViewportElement()],[p.topCenter.getViewportElement()]]}})}isInterestedIn(type){return 1===type||0===type&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}init(){this.moveColumnFeature=this.createManagedBean(new MoveColumnFeature(this.pinned)),this.bodyDropPivotTarget=this.createManagedBean(new BodyDropPivotTarget(this.pinned)),this.dragAndDropService.addDropTarget(this)}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(draggingEvent){return this.columnModel.isPivotMode()&&0===draggingEvent.dragSource.type}onDragEnter(draggingEvent){this.currentDropListener=this.isDropColumnInPivotMode(draggingEvent)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(draggingEvent)}onDragLeave(params){this.currentDropListener.onDragLeave(params)}onDragging(params){this.currentDropListener.onDragging(params)}onDragStop(params){this.currentDropListener.onDragStop(params)}};__decorateClass([Autowired("dragAndDropService")],BodyDropTarget.prototype,"dragAndDropService",2),__decorateClass([Autowired("columnModel")],BodyDropTarget.prototype,"columnModel",2),__decorateClass([Autowired("ctrlsService")],BodyDropTarget.prototype,"ctrlsService",2),__decorateClass([PostConstruct],BodyDropTarget.prototype,"postConstruct",1),__decorateClass([PostConstruct],BodyDropTarget.prototype,"init",1);var _HeaderCellComp=class _HeaderCellComp extends AbstractHeaderCellComp{constructor(ctrl){super(_HeaderCellComp.TEMPLATE,ctrl),this.headerCompVersion=0,this.column=ctrl.getColumnGroupChild(),this.pinned=ctrl.getPinned()}postConstruct(){const eGui=this.getGui();var name,value;name="col-id",null!=(value=this.column.getColId())&&""!=value?eGui.setAttribute(name,value):eGui.removeAttribute(name);const compProxy={setWidth:width=>eGui.style.width=width,addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setAriaSort:sort=>sort?setAriaSort(eGui,sort):removeAriaSort(eGui),setUserCompDetails:compDetails=>this.setUserCompDetails(compDetails),getUserCompInstance:()=>this.headerComp};this.ctrl.setComp(compProxy,this.getGui(),this.eResize,this.eHeaderCompWrapper);const selectAllGui=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",selectAllGui)}destroyHeaderComp(){this.headerComp&&(this.eHeaderCompWrapper.removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)}setUserCompDetails(compDetails){this.headerCompVersion++;const versionCopy=this.headerCompVersion;compDetails.newAgStackInstance().then(comp=>this.afterCompCreated(versionCopy,comp))}afterCompCreated(version,headerComp){version==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=headerComp,this.headerCompGui=headerComp.getGui(),this.eHeaderCompWrapper.appendChild(this.headerCompGui),this.ctrl.setDragSource(this.getGui())):this.destroyBean(headerComp)}};_HeaderCellComp.TEMPLATE='<div class="ag-header-cell" role="columnheader">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n            <div ref="eHeaderCompWrapper" class="ag-header-cell-comp-wrapper" role="presentation"></div>\n        </div>',__decorateClass([RefSelector("eResize")],_HeaderCellComp.prototype,"eResize",2),__decorateClass([RefSelector("eHeaderCompWrapper")],_HeaderCellComp.prototype,"eHeaderCompWrapper",2),__decorateClass([PostConstruct],_HeaderCellComp.prototype,"postConstruct",1),__decorateClass([PreDestroy],_HeaderCellComp.prototype,"destroyHeaderComp",1);var HeaderCellComp=_HeaderCellComp,_HeaderGroupCellComp=class _HeaderGroupCellComp extends AbstractHeaderCellComp{constructor(ctrl){super(_HeaderGroupCellComp.TEMPLATE,ctrl)}postConstruct(){const eGui=this.getGui();eGui.setAttribute("col-id",this.ctrl.getColId());const compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setResizableDisplayed:displayed=>setDisplayed(this.eResize,displayed),setWidth:width=>eGui.style.width=width,setAriaExpanded:expanded=>{return key="aria-expanded",null!=(value=expanded)?eGui.setAttribute(key,value):eGui.removeAttribute(key);var key,value},setUserCompDetails:details=>this.setUserCompDetails(details),getUserCompInstance:()=>this.headerGroupComp};this.ctrl.setComp(compProxy,eGui,this.eResize)}setUserCompDetails(details){details.newAgStackInstance().then(comp=>this.afterHeaderCompCreated(comp))}afterHeaderCompCreated(headerGroupComp){const destroyFunc=()=>this.destroyBean(headerGroupComp);if(!this.isAlive())return void destroyFunc();const eGui=this.getGui(),eHeaderGroupGui=headerGroupComp.getGui();eGui.appendChild(eHeaderGroupGui),this.addDestroyFunc(destroyFunc),this.headerGroupComp=headerGroupComp,this.ctrl.setDragSource(eGui)}};_HeaderGroupCellComp.TEMPLATE='<div class="ag-header-group-cell" role="columnheader">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',__decorateClass([RefSelector("eResize")],_HeaderGroupCellComp.prototype,"eResize",2),__decorateClass([PostConstruct],_HeaderGroupCellComp.prototype,"postConstruct",1);var HeaderGroupCellComp=_HeaderGroupCellComp,HeaderRowComp=class extends Component{constructor(ctrl){super(),this.headerComps={},this.ctrl=ctrl,this.setTemplate(`<div class="${this.ctrl.getHeaderRowClass()}" role="row"></div>`)}init(){setAriaRowIndex(this.getGui(),this.ctrl.getAriaRowIndex());const compProxy={setHeight:height=>this.getGui().style.height=height,setTop:top=>this.getGui().style.top=top,setHeaderCtrls:(ctrls,forceOrder)=>this.setHeaderCtrls(ctrls,forceOrder),setWidth:width=>this.getGui().style.width=width};this.ctrl.setComp(compProxy)}destroyHeaderCtrls(){this.setHeaderCtrls([],!1)}setHeaderCtrls(ctrls,forceOrder){if(!this.isAlive())return;const oldComps=this.headerComps;if(this.headerComps={},ctrls.forEach(ctrl=>{const id=ctrl.getInstanceId();let comp=oldComps[id];delete oldComps[id],null==comp&&(comp=this.createHeaderComp(ctrl),this.getGui().appendChild(comp.getGui())),this.headerComps[id]=comp}),iterateObject(oldComps,(id,comp)=>{this.getGui().removeChild(comp.getGui()),this.destroyBean(comp)}),forceOrder){const comps=getAllValuesInObject(this.headerComps);comps.sort((a,b)=>a.getCtrl().getColumnGroupChild().getLeft()-b.getCtrl().getColumnGroupChild().getLeft());const elementsInOrder=comps.map(c=>c.getGui());setDomChildOrder(this.getGui(),elementsInOrder)}}createHeaderComp(headerCtrl){let result;switch(this.ctrl.getType()){case"group":result=new HeaderGroupCellComp(headerCtrl);break;case"filter":result=new HeaderFilterCellComp(headerCtrl);break;default:result=new HeaderCellComp(headerCtrl)}return this.createBean(result),result.setParentComponent(this),result}};__decorateClass([PostConstruct],HeaderRowComp.prototype,"init",1),__decorateClass([PreDestroy],HeaderRowComp.prototype,"destroyHeaderCtrls",1);var instanceIdSequence4=0,_AbstractHeaderCellCtrl=class _AbstractHeaderCellCtrl extends BeanStub{constructor(columnGroupChild,beans,parentRowCtrl){super(),this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.columnGroupChild=columnGroupChild,this.parentRowCtrl=parentRowCtrl,this.beans=beans,this.instanceId=columnGroupChild.getUniqueId()+"-"+instanceIdSequence4++}postConstruct(){this.addManagedPropertyListeners(["suppressHeaderFocus"],()=>this.refreshTabIndex())}shouldStopEventPropagation(e){const{headerRowIndex,column}=this.focusService.getFocusedHeader();return isUserSuppressingHeaderKeyboardEvent(this.gos,e,headerRowIndex,column)}getWrapperHasFocus(){return this.gos.getActiveDomElement()===this.eGui}setGui(eGui){this.eGui=eGui,this.addDomData(),this.addManagedListener(this.beans.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}onDisplayedColumnsChanged(){this.comp&&this.column&&(this.refreshFirstAndLastStyles(),this.refreshAriaColIndex())}refreshFirstAndLastStyles(){const{comp,column,beans}=this;CssClassApplier.refreshFirstAndLastStyles(comp,column,beans.columnModel)}refreshAriaColIndex(){const{beans,column}=this,colIdx=beans.columnModel.getAriaColumnIndex(column);setAriaColIndex(this.eGui,colIdx)}addResizeAndMoveKeyboardListeners(){this.resizeFeature&&(this.addManagedListener(this.eGui,"keydown",this.onGuiKeyDown.bind(this)),this.addManagedListener(this.eGui,"keyup",this.onGuiKeyUp.bind(this)))}refreshTabIndex(){this.gos.get("suppressHeaderFocus")?this.eGui.removeAttribute("tabindex"):this.eGui.setAttribute("tabindex","-1")}onGuiKeyDown(e){var _a;const activeEl=this.gos.getActiveDomElement(),isLeftOrRight=e.key===KeyCode.LEFT||e.key===KeyCode.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),activeEl!==this.eGui||!e.shiftKey&&!e.altKey)return;if((this.isResizing||isLeftOrRight)&&(e.preventDefault(),e.stopImmediatePropagation()),!isLeftOrRight)return;const isLeft=e.key===KeyCode.LEFT!==this.gos.get("enableRtl"),direction=HorizontalDirection[isLeft?"Left":"Right"];if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const diff=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(diff,e.shiftKey),null==(_a=this.resizeFeature)||_a.toggleColumnResizing(!0)}else this.moveHeader(direction)}getViewportAdjustedResizeDiff(e){let diff=this.getResizeDiff(e);if(this.column.getPinned()){const leftWidth=this.pinnedWidthService.getPinnedLeftWidth(),rightWidth=this.pinnedWidthService.getPinnedRightWidth(),bodyWidth=getInnerWidth(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50;if(leftWidth+rightWidth+diff>bodyWidth){if(!(bodyWidth>leftWidth+rightWidth))return 0;diff=bodyWidth-leftWidth-rightWidth}}return diff}getResizeDiff(e){let isLeft=e.key===KeyCode.LEFT!==this.gos.get("enableRtl");const pinned=this.column.getPinned(),isRtl=this.gos.get("enableRtl");return pinned&&isRtl!==("right"===pinned)&&(isLeft=!isLeft),(isLeft?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=setTimeout(()=>{var _a;null==(_a=this.resizeFeature)||_a.toggleColumnResizing(!1)},150))}handleKeyDown(e){const wrapperHasFocus=this.getWrapperHasFocus();switch(e.key){case KeyCode.PAGE_DOWN:case KeyCode.PAGE_UP:case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:wrapperHasFocus&&e.preventDefault()}}addDomData(){const key=_AbstractHeaderCellCtrl.DOM_DATA_KEY_HEADER_CTRL;this.gos.setDomData(this.eGui,key,this),this.addDestroyFunc(()=>this.gos.setDomData(this.eGui,key,null))}getGui(){return this.eGui}focus(event){return!!this.eGui&&(this.lastFocusEvent=event||null,this.eGui.focus(),!0)}getRowIndex(){return this.parentRowCtrl.getRowIndex()}getParentRowCtrl(){return this.parentRowCtrl}getPinned(){return this.parentRowCtrl.getPinned()}getInstanceId(){return this.instanceId}getColumnGroupChild(){return this.columnGroupChild}removeDragSource(){this.dragSource&&(this.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(mouseEvent,touchEvent,column){const event=null!=mouseEvent?mouseEvent:touchEvent;this.gos.get("preventDefaultOnContextMenu")&&event.preventDefault();const columnToUse=column instanceof Column?column:void 0;this.menuService.isHeaderContextMenuEnabled(columnToUse)&&this.menuService.showHeaderContextMenu(columnToUse,mouseEvent,touchEvent),this.dispatchColumnMouseEvent(Events.EVENT_COLUMN_HEADER_CONTEXT_MENU,column)}dispatchColumnMouseEvent(eventType,column){const event={type:eventType,column};this.eventService.dispatchEvent(event)}destroy(){super.destroy(),this.removeDragSource(),this.comp=null,this.column=null,this.resizeFeature=null,this.lastFocusEvent=null,this.columnGroupChild=null,this.parentRowCtrl=null,this.eGui=null}};_AbstractHeaderCellCtrl.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",__decorateClass([Autowired("pinnedWidthService")],_AbstractHeaderCellCtrl.prototype,"pinnedWidthService",2),__decorateClass([Autowired("focusService")],_AbstractHeaderCellCtrl.prototype,"focusService",2),__decorateClass([Autowired("userComponentFactory")],_AbstractHeaderCellCtrl.prototype,"userComponentFactory",2),__decorateClass([Autowired("ctrlsService")],_AbstractHeaderCellCtrl.prototype,"ctrlsService",2),__decorateClass([Autowired("dragAndDropService")],_AbstractHeaderCellCtrl.prototype,"dragAndDropService",2),__decorateClass([Autowired("menuService")],_AbstractHeaderCellCtrl.prototype,"menuService",2),__decorateClass([PostConstruct],_AbstractHeaderCellCtrl.prototype,"postConstruct",1);var AbstractHeaderCellCtrl=_AbstractHeaderCellCtrl,SetLeftFeature=class extends BeanStub{constructor(columnOrGroup,eCell,beans,colsSpanning){super(),this.columnOrGroup=columnOrGroup,this.eCell=eCell,this.ariaEl=this.eCell.querySelector("[role=columnheader]")||this.eCell,this.colsSpanning=colsSpanning,this.beans=beans}setColsSpanning(colsSpanning){this.colsSpanning=colsSpanning,this.onLeftChanged()}getColumnOrGroup(){return this.beans.gos.get("enableRtl")&&this.colsSpanning?last(this.colsSpanning):this.columnOrGroup}postConstruct(){this.addManagedListener(this.columnOrGroup,Column.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onLeftChanged.bind(this))}setLeftFirstTime(){const suppressMoveAnimation=this.beans.gos.get("suppressColumnMoveAnimation"),oldLeftExists=exists(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&oldLeftExists&&!suppressMoveAnimation?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const colOrGroup=this.getColumnOrGroup(),left=colOrGroup.getLeft(),oldLeft=colOrGroup.getOldLeft(),oldActualLeft=this.modifyLeftForPrintLayout(colOrGroup,oldLeft),actualLeft=this.modifyLeftForPrintLayout(colOrGroup,left);this.setLeft(oldActualLeft),this.actualLeft=actualLeft,this.beans.columnAnimationService.executeNextVMTurn(()=>{this.actualLeft===actualLeft&&this.setLeft(actualLeft)})}onLeftChanged(){const colOrGroup=this.getColumnOrGroup(),left=colOrGroup.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(colOrGroup,left),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(colOrGroup,leftPosition){if(!this.beans.gos.isDomLayout("print"))return leftPosition;if("left"===colOrGroup.getPinned())return leftPosition;const leftWidth=this.beans.columnModel.getDisplayedColumnsLeftWidth();if("right"===colOrGroup.getPinned()){return leftWidth+this.beans.columnModel.getBodyContainerWidth()+leftPosition}return leftWidth+leftPosition}setLeft(value){if(exists(value)&&(this.eCell.style.left=`${value}px`),this.columnOrGroup instanceof Column);else{const children=this.columnOrGroup.getLeafColumns();if(!children.length)return;children.length>1&&setAriaColSpan(this.ariaEl,children.length)}}};__decorateClass([PostConstruct],SetLeftFeature.prototype,"postConstruct",1);var HoverFeature=class extends BeanStub{constructor(columns,element){super(),this.columns=columns,this.element=element}postConstruct(){this.gos.get("columnHoverHighlight")&&this.addMouseHoverListeners()}addMouseHoverListeners(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))}onMouseOut(){this.columnHoverService.clearMouseOver()}onMouseOver(){this.columnHoverService.setMouseOver(this.columns)}};__decorateClass([Autowired("columnHoverService")],HoverFeature.prototype,"columnHoverService",2),__decorateClass([PostConstruct],HoverFeature.prototype,"postConstruct",1);var HeaderFilterCellCtrl=class extends AbstractHeaderCellCtrl{constructor(column,beans,parentRowCtrl){super(column,beans,parentRowCtrl),this.iconCreated=!1,this.column=column}setComp(comp,eGui,eButtonShowMainFilter,eFloatingFilterBody){this.comp=comp,this.eButtonShowMainFilter=eButtonShowMainFilter,this.eFloatingFilterBody=eFloatingFilterBody,this.setGui(eGui),this.setupActive(),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this)),this.setupFilterChangedListener(),this.addManagedListener(this.column,Column.EVENT_COL_DEF_CHANGED,this.onColDefChanged.bind(this))}resizeHeader(){}moveHeader(){}setupActive(){const colDef=this.column.getColDef(),filterExists=!!colDef.filter,floatingFilterExists=!!colDef.floatingFilter;this.active=filterExists&&floatingFilterExists}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const eMenuIcon=createIconNoSpan("filter",this.gos,this.column);eMenuIcon&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(eMenuIcon))}setupFocus(){this.createManagedBean(new ManagedFocusFeature(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const localeTextFunc=this.localeService.getLocaleTextFunc();setAriaLabel(this.eButtonShowMainFilter,localeTextFunc("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){if(this.gos.getActiveDomElement()===this.eGui)return;const nextFocusableEl=this.focusService.findNextFocusableElement(this.eGui,null,e.shiftKey);if(nextFocusableEl)return this.beans.headerNavigationService.scrollToColumn(this.column),e.preventDefault(),void nextFocusableEl.focus();const nextFocusableColumn=this.findNextColumnWithFloatingFilter(e.shiftKey);nextFocusableColumn&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:this.getParentRowCtrl().getRowIndex(),column:nextFocusableColumn},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(backwards){const columnModel=this.beans.columnModel;let nextCol=this.column;do{if(nextCol=backwards?columnModel.getDisplayedColBefore(nextCol):columnModel.getDisplayedColAfter(nextCol),!nextCol)break}while(!nextCol.getColDef().filter||!nextCol.getColDef().floatingFilter);return nextCol}handleKeyDown(e){super.handleKeyDown(e);const wrapperHasFocus=this.getWrapperHasFocus();switch(e.key){case KeyCode.UP:case KeyCode.DOWN:wrapperHasFocus||e.preventDefault();case KeyCode.LEFT:case KeyCode.RIGHT:if(wrapperHasFocus)return;e.stopPropagation();case KeyCode.ENTER:wrapperHasFocus&&this.focusService.focusInto(this.eGui)&&e.preventDefault();break;case KeyCode.ESCAPE:wrapperHasFocus||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const notFromHeaderWrapper=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),fromWithinHeader=!!e.relatedTarget&&isElementChildOfClass(e.relatedTarget,"ag-floating-filter");if(notFromHeaderWrapper&&fromWithinHeader&&e.target===this.eGui){const lastFocusEvent=this.lastFocusEvent,fromTab=!(!lastFocusEvent||lastFocusEvent.key!==KeyCode.TAB);if(lastFocusEvent&&fromTab){const shouldFocusLast=lastFocusEvent.shiftKey;this.focusService.focusInto(this.eGui,shouldFocusLast)}}const rowIndex=this.getRowIndex();this.beans.focusService.setFocusedHeader(rowIndex,this.column)}setupHover(){this.createManagedBean(new HoverFeature([this.column],this.eGui));const listener=()=>{if(!this.gos.get("columnHoverHighlight"))return;const hovered=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",hovered)};this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HOVER_CHANGED,listener),listener()}setupLeft(){const setLeftFeature=new SetLeftFeature(this.column,this.eGui,this.beans);this.createManagedBean(setLeftFeature)}setupFilterButton(){this.suppressFilterButton=!this.menuService.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!this.menuService.isLegacyMenuEnabled()}setupUserComp(){if(!this.active)return;const compDetails=this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());compDetails&&this.setCompDetails(compDetails)}setCompDetails(compDetails){this.userCompDetails=compDetails,this.comp.setCompDetails(compDetails)}showParentFilter(){const eventSource=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.menuService.showFilterMenu({column:this.column,buttonElement:eventSource,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(){if(!this.active)return;const{filterManager}=this.beans,syncWithFilter=event=>{if("filterDestroyed"===(null==event?void 0:event.source)&&this.context.isDestroyed())return;const compPromise=this.comp.getFloatingFilterComp();compPromise&&compPromise.then(comp=>{var _a;if(comp){const parentModel=filterManager.getCurrentFloatingFilterParentModel(this.column);comp.onParentModelChanged(parentModel,event?this.gos.addGridCommonParams({columns:null!=(_a=event.columns)?_a:[],type:Events.EVENT_FILTER_CHANGED,source:"api"===event.source?"api":"columnFilter"}):null)}})};this.destroySyncListener=this.addManagedListener(this.column,Column.EVENT_FILTER_CHANGED,syncWithFilter),filterManager.isFilterActive(this.column)&&syncWithFilter(null)}setupWidth(){const listener=()=>{const width=`${this.column.getActualWidth()}px`;this.comp.setWidth(width)};this.addManagedListener(this.column,Column.EVENT_WIDTH_CHANGED,listener),listener()}setupFilterChangedListener(){this.active&&(this.destroyFilterChangedListener=this.addManagedListener(this.column,Column.EVENT_FILTER_CHANGED,this.updateFilterButton.bind(this)),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const isFilterAllowed=this.beans.filterManager.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(isFilterAllowed),this.highlightFilterButtonWhenActive&&isFilterAllowed&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(){var _a,_b;const wasActive=this.active;this.setupActive();const becomeActive=!wasActive&&this.active;wasActive&&!this.active&&(null==(_a=this.destroySyncListener)||_a.call(this),null==(_b=this.destroyFilterChangedListener)||_b.call(this));const newCompDetails=this.active?this.beans.filterManager.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,compPromise=this.comp.getFloatingFilterComp();compPromise&&newCompDetails?compPromise.then(compInstance=>{var _a2;!compInstance||this.beans.filterManager.areFilterCompsDifferent(null!=(_a2=this.userCompDetails)?_a2:null,newCompDetails)?this.updateCompDetails(newCompDetails,becomeActive):this.updateFloatingFilterParams(newCompDetails)}):this.updateCompDetails(newCompDetails,becomeActive)}updateCompDetails(compDetails,becomeActive){this.isAlive()&&(this.setCompDetails(compDetails),this.setupFilterButton(),this.setupUi(),becomeActive&&(this.setupSyncWithFilter(),this.setupFilterChangedListener()))}updateFloatingFilterParams(userCompDetails){var _a;if(!userCompDetails)return;const params=userCompDetails.params;null==(_a=this.comp.getFloatingFilterComp())||_a.then(floatingFilter=>{let hasRefreshed=!1;if((null==floatingFilter?void 0:floatingFilter.refresh)&&"function"==typeof floatingFilter.refresh){null!==floatingFilter.refresh(params)&&(hasRefreshed=!0)}if(!hasRefreshed&&(null==floatingFilter?void 0:floatingFilter.onParamsUpdated)&&"function"==typeof floatingFilter.onParamsUpdated){null!==floatingFilter.onParamsUpdated(params)&&warnOnce("Custom floating filter method 'onParamsUpdated' is deprecated. Use 'refresh' instead.")}})}destroy(){super.destroy(),this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.destroySyncListener=null,this.destroyFilterChangedListener=null}},ResizeFeature=class extends BeanStub{constructor(pinned,column,eResize,comp,ctrl){super(),this.pinned=pinned,this.column=column,this.eResize=eResize,this.comp=comp,this.ctrl=ctrl}postConstruct(){const destroyResizeFuncs=[];let canResize,canAutosize;const addResize=()=>{if(setDisplayed(this.eResize,canResize),!canResize)return;const finishedWithResizeFunc=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(destroyResizeFuncs.push(finishedWithResizeFunc),canAutosize){const skipHeaderOnAutoSize=this.gos.get("skipHeaderOnAutoSize"),autoSizeColListener=()=>{this.columnModel.autoSizeColumn(this.column,"uiColumnResized",skipHeaderOnAutoSize)};this.eResize.addEventListener("dblclick",autoSizeColListener);const touchListener=new TouchListener(this.eResize);touchListener.addEventListener(TouchListener.EVENT_DOUBLE_TAP,autoSizeColListener),destroyResizeFuncs.push(()=>{this.eResize.removeEventListener("dblclick",autoSizeColListener),touchListener.removeEventListener(TouchListener.EVENT_DOUBLE_TAP,autoSizeColListener),touchListener.destroy()})}},removeResize=()=>{destroyResizeFuncs.forEach(f=>f()),destroyResizeFuncs.length=0},refresh=()=>{const resize=this.column.isResizable(),autoSize=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(resize!==canResize||autoSize!==canAutosize)&&(canResize=resize,canAutosize=autoSize,removeResize(),addResize())};refresh(),this.addDestroyFunc(removeResize),this.ctrl.addRefreshFunction(refresh)}onResizing(finished,resizeAmount){const{column:key,lastResizeAmount,resizeStartWidth}=this,resizeAmountNormalised=this.normaliseResizeAmount(resizeAmount),columnWidths=[{key,newWidth:resizeStartWidth+resizeAmountNormalised}];if(this.column.getPinned()){if(this.pinnedWidthService.getPinnedLeftWidth()+this.pinnedWidthService.getPinnedRightWidth()+(resizeAmountNormalised-lastResizeAmount)>getInnerWidth(this.ctrlsService.getGridBodyCtrl().getBodyViewportElement())-50)return}this.lastResizeAmount=resizeAmountNormalised,this.columnModel.setColumnWidths(columnWidths,this.resizeWithShiftKey,finished,"uiColumnResized"),finished&&this.toggleColumnResizing(!1)}onResizeStart(shiftKey){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=shiftKey,this.toggleColumnResizing(!0)}toggleColumnResizing(resizing){this.comp.addOrRemoveCssClass("ag-column-resizing",resizing)}normaliseResizeAmount(dragChange){let result=dragChange;const notPinningLeft="left"!==this.pinned,pinningRight="right"===this.pinned;return this.gos.get("enableRtl")?notPinningLeft&&(result*=-1):pinningRight&&(result*=-1),result}};__decorateClass([Autowired("horizontalResizeService")],ResizeFeature.prototype,"horizontalResizeService",2),__decorateClass([Autowired("pinnedWidthService")],ResizeFeature.prototype,"pinnedWidthService",2),__decorateClass([Autowired("ctrlsService")],ResizeFeature.prototype,"ctrlsService",2),__decorateClass([Autowired("columnModel")],ResizeFeature.prototype,"columnModel",2),__decorateClass([PostConstruct],ResizeFeature.prototype,"postConstruct",1);var SelectAllFeature=class extends BeanStub{constructor(column){super(),this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1,this.column=column}onSpaceKeyDown(e){const checkbox=this.cbSelectAll;checkbox.isDisplayed()&&!checkbox.getGui().contains(this.gos.getActiveDomElement())&&(e.preventDefault(),checkbox.setValue(!checkbox.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(ctrl){this.headerCellCtrl=ctrl,this.cbSelectAll=this.createManagedBean(new AgCheckbox),this.cbSelectAll.addCssClass("ag-header-select-all"),setAriaRole(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,Events.EVENT_FIELD_VALUE_CHANGED,this.onCbSelectAll.bind(this)),setAriaHidden(this.cbSelectAll.getGui(),!0),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onNewColumnsLoaded(){this.showOrHideSelectAll()}onDisplayedColumnsChanged(){this.isAlive()&&this.showOrHideSelectAll()}showOrHideSelectAll(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible,{skipAriaHidden:!0}),this.cbSelectAllVisible&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel()}onModelChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}onSelectionChanged(){this.cbSelectAllVisible&&this.updateStateOfCheckbox()}updateStateOfCheckbox(){if(this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const allSelected=this.selectionService.getSelectAllState(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setValue(allSelected);const hasNodesToSelect=this.selectionService.hasNodesToSelect(this.isFilteredOnly(),this.isCurrentPageOnly());this.cbSelectAll.setDisabled(!hasNodesToSelect),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(){const translate=this.localeService.getLocaleTextFunc(),ariaStatus=this.cbSelectAll.getValue()?translate("ariaChecked","checked"):translate("ariaUnchecked","unchecked"),ariaLabel=translate("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAllVisible?this.headerCellCtrl.setAriaDescriptionProperty("selectAll",`${ariaLabel} (${ariaStatus})`):this.headerCellCtrl.setAriaDescriptionProperty("selectAll",null),this.cbSelectAll.setInputAriaLabel(`${ariaLabel} (${ariaStatus})`),this.headerCellCtrl.announceAriaDescription()}checkSelectionType(feature){return!("multiple"!==this.gos.get("rowSelection"))||(console.warn(`AG Grid: ${feature} is only available if using 'multiple' rowSelection.`),!1)}checkRightRowModelType(feature){const rowModelType=this.rowModel.getType();return!("clientSide"!==rowModelType&&"serverSide"!==rowModelType)||(console.warn(`AG Grid: ${feature} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${rowModelType}.`),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox)return;if(!this.cbSelectAllVisible)return;const value=this.cbSelectAll.getValue(),justFiltered=this.isFilteredOnly(),justCurrentPage=this.isCurrentPageOnly();let source="uiSelectAll";justCurrentPage?source="uiSelectAllCurrentPage":justFiltered&&(source="uiSelectAllFiltered");const params={source,justFiltered,justCurrentPage};value?this.selectionService.selectAllRowNodes(params):this.selectionService.deselectAllRowNodes(params)}isCheckboxSelection(){let result=this.column.getColDef().headerCheckboxSelection;if("function"==typeof result){result=result(this.gos.addGridCommonParams({column:this.column,colDef:this.column.getColDef()}))}return!!result&&(this.checkRightRowModelType("headerCheckboxSelection")&&this.checkSelectionType("headerCheckboxSelection"))}isFilteredOnly(){return!!this.column.getColDef().headerCheckboxSelectionFilteredOnly}isCurrentPageOnly(){return!!this.column.getColDef().headerCheckboxSelectionCurrentPageOnly}};__decorateClass([Autowired("rowModel")],SelectAllFeature.prototype,"rowModel",2),__decorateClass([Autowired("selectionService")],SelectAllFeature.prototype,"selectionService",2);var HeaderCellCtrl=class extends AbstractHeaderCellCtrl{constructor(column,beans,parentRowCtrl){super(column,beans,parentRowCtrl),this.refreshFunctions=[],this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map,this.column=column}setComp(comp,eGui,eResize,eHeaderCompWrapper){this.comp=comp,this.setGui(eGui),this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight(eHeaderCompWrapper),this.addColumnHoverListener(),this.setupFilterClass(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.refreshAria(),this.resizeFeature=this.createManagedBean(new ResizeFeature(this.getPinned(),this.column,eResize,comp,this)),this.createManagedBean(new HoverFeature([this.column],eGui)),this.createManagedBean(new SetLeftFeature(this.column,eGui,this.beans)),this.createManagedBean(new ManagedFocusFeature(eGui,{shouldStopEventPropagation:e=>this.shouldStopEventPropagation(e),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(),this.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader"],this.refresh.bind(this)),this.addManagedListener(this.column,Column.EVENT_COL_DEF_CHANGED,this.refresh.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_HEADER_HEIGHT_CHANGED,this.onHeaderHeightChanged.bind(this))}resizeHeader(delta,shiftKey){var _a,_b;if(!this.column.isResizable())return;const actualWidth=this.column.getActualWidth(),minWidth=null!=(_a=this.column.getMinWidth())?_a:0,maxWidth=null!=(_b=this.column.getMaxWidth())?_b:Number.MAX_SAFE_INTEGER,newWidth=Math.min(Math.max(actualWidth+delta,minWidth),maxWidth);this.beans.columnModel.setColumnWidths([{key:this.column,newWidth}],shiftKey,!0,"uiColumnResized")}moveHeader(hDirection){const{eGui,column,gos,ctrlsService}=this,pinned=this.getPinned(),left=eGui.getBoundingClientRect().left,width=column.getActualWidth(),isLeft=0===hDirection!==gos.get("enableRtl"),xPosition=ColumnMoveHelper.normaliseX(isLeft?left-20:left+width+20,pinned,!0,gos,ctrlsService);ColumnMoveHelper.attemptMoveColumns({allMovingColumns:[column],isFromHeader:!0,hDirection,xPosition,pinned,fromEnter:!1,fakeEvent:!1,gos,columnModel:this.beans.columnModel}),ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(column,"auto")}setupUserComp(){const compDetails=this.lookupUserCompDetails();this.setCompDetails(compDetails)}setCompDetails(compDetails){this.userCompDetails=compDetails,this.comp.setUserCompDetails(compDetails)}lookupUserCompDetails(){const params=this.createParams(),colDef=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(colDef,params)}createParams(){return this.gos.addGridCommonParams({column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&this.menuService.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!this.openFilterEnabled||this.menuService.isLegacyMenuEnabled(),showColumnMenu:buttonElement=>{this.menuService.showColumnMenu({column:this.column,buttonElement,positionBy:"button"})},showColumnMenuAfterMouseClick:mouseEvent=>{this.menuService.showColumnMenu({column:this.column,mouseEvent,positionBy:"mouse"})},showFilter:buttonElement=>{this.menuService.showFilterMenu({column:this.column,buttonElement,containerType:"columnFilter",positionBy:"button"})},progressSort:multiSort=>{this.beans.sortController.progressSort(this.column,!!multiSort,"uiColumnSorted")},setSort:(sort,multiSort)=>{this.beans.sortController.setSortForColumn(this.column,sort,!!multiSort,"uiColumnSorted")},eGridHeader:this.getGui(),setTooltip:(value,shouldDisplayTooltip)=>{this.setupTooltip(value,shouldDisplayTooltip)}})}setupSelectAll(){this.selectAllFeature=this.createManagedBean(new SelectAllFeature(this.column)),this.selectAllFeature.setComp(this)}getSelectAllGui(){return this.selectAllFeature.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===KeyCode.SPACE&&this.selectAllFeature.onSpaceKeyDown(e),e.key===KeyCode.ENTER&&this.onEnterKeyDown(e),e.key===KeyCode.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){if(e.ctrlKey||e.metaKey)this.showMenuOnKeyPress(e,!0);else if(this.sortable){const multiSort=e.shiftKey;this.beans.sortController.progressSort(this.column,multiSort,"uiColumnSorted")}}showMenuOnKeyPress(e,isFilterShortcut){const headerComp=this.comp.getUserCompInstance();headerComp&&headerComp instanceof HeaderComp&&headerComp.onMenuKeyboardShortcut(isFilterShortcut)&&e.preventDefault()}onFocusIn(e){if(!this.getGui().contains(e.relatedTarget)){const rowIndex=this.getRowIndex();this.focusService.setFocusedHeader(rowIndex,this.column),this.announceAriaDescription()}this.focusService.isKeyboardMode()&&this.setActiveHeader(!0)}onFocusOut(e){this.getGui().contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(value,shouldDisplayTooltip){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const isTooltipWhenTruncated="whenTruncated"===this.gos.get("tooltipShowMode"),eGui=this.eGui,colDef=this.column.getColDef();shouldDisplayTooltip||!isTooltipWhenTruncated||colDef.headerComponent||(shouldDisplayTooltip=()=>{const textEl=eGui.querySelector(".ag-header-cell-text");return!textEl||textEl.scrollWidth>textEl.clientWidth});const tooltipCtrl={getColumn:()=>this.column,getColDef:()=>this.column.getColDef(),getGui:()=>eGui,getLocation:()=>"header",getTooltipValue:()=>{if(null!=value)return value;return this.column.getColDef().headerTooltip},shouldDisplayTooltip},tooltipFeature=this.createManagedBean(new TooltipFeature(tooltipCtrl));this.refreshFunctions.push(()=>tooltipFeature.refreshToolTip())}setupClassesFromColDef(){const refreshHeaderClasses=()=>{const colDef=this.column.getColDef(),classes=CssClassApplier.getHeaderClassesFromColDef(colDef,this.gos,this.column,null),oldClasses=this.userHeaderClasses;this.userHeaderClasses=new Set(classes),classes.forEach(c=>{oldClasses.has(c)?oldClasses.delete(c):this.comp.addOrRemoveCssClass(c,!0)}),oldClasses.forEach(c=>this.comp.addOrRemoveCssClass(c,!1))};this.refreshFunctions.push(refreshHeaderClasses),refreshHeaderClasses()}setDragSource(eSource){if(this.dragSourceElement=eSource,this.removeDragSource(),!eSource||!this.draggable)return;const{column,beans,displayName,dragAndDropService,gos}=this,{columnModel}=beans;let hideColumnOnExit=!this.gos.get("suppressDragLeaveHidesColumns");const dragSource=this.dragSource={type:1,eElement:eSource,getDefaultIconName:()=>hideColumnOnExit?DragAndDropService.ICON_HIDE:DragAndDropService.ICON_NOT_ALLOWED,getDragItem:()=>this.createDragItem(column),dragItemName:displayName,onDragStarted:()=>{hideColumnOnExit=!gos.get("suppressDragLeaveHidesColumns"),column.setMoving(!0,"uiColumnMoved")},onDragStopped:()=>column.setMoving(!1,"uiColumnMoved"),onGridEnter:dragItem=>{var _a;if(hideColumnOnExit){const unlockedColumns=(null==(_a=null==dragItem?void 0:dragItem.columns)?void 0:_a.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!0,"uiColumnMoved")}},onGridExit:dragItem=>{var _a;if(hideColumnOnExit){const unlockedColumns=(null==(_a=null==dragItem?void 0:dragItem.columns)?void 0:_a.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!1,"uiColumnMoved")}}};dragAndDropService.addDragSource(dragSource,!0)}createDragItem(column){const visibleState={};return visibleState[column.getId()]=column.isVisible(),{columns:[column],visibleState}}updateState(){this.menuEnabled=this.menuService.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=this.menuService.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}addRefreshFunction(func){this.refreshFunctions.push(func)}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria(),this.refreshFunctions.forEach(f=>f())}refreshHeaderComp(){const newCompDetails=this.lookupUserCompDetails();!!(null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==newCompDetails.componentClass)&&this.attemptHeaderCompRefresh(newCompDetails.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(newCompDetails)}attemptHeaderCompRefresh(params){const headerComp=this.comp.getUserCompInstance();if(!headerComp)return!1;if(!headerComp.refresh)return!1;return headerComp.refresh(params)}calculateDisplayName(){return this.beans.columnModel.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const colDef=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!colDef.suppressMovable&&!colDef.lockPosition)||!!colDef.enableRowGroup||!!colDef.enablePivot}onColumnRowGroupChanged(){this.checkDisplayName()}onColumnPivotChanged(){this.checkDisplayName()}onColumnValueChanged(){this.checkDisplayName()}setupWidth(){const listener=()=>{const columnWidth=this.column.getActualWidth();this.comp.setWidth(`${columnWidth}px`)};this.addManagedListener(this.column,Column.EVENT_WIDTH_CHANGED,listener),listener()}setupMovingCss(){const listener=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving())};this.addManagedListener(this.column,Column.EVENT_MOVING_CHANGED,listener),listener()}setupMenuClass(){const listener=()=>{this.comp.addOrRemoveCssClass("ag-column-menu-visible",this.column.isMenuVisible())};this.addManagedListener(this.column,Column.EVENT_MENU_VISIBLE_CHANGED,listener),listener()}setupSortableClass(){const updateSortableCssClass=()=>{this.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!this.sortable)};updateSortableCssClass(),this.addRefreshFunction(updateSortableCssClass),this.addManagedListener(this.eventService,Column.EVENT_SORT_CHANGED,this.refreshAriaSort.bind(this))}setupFilterClass(){const listener=()=>{const isFilterActive=this.column.isFilterActive();this.comp.addOrRemoveCssClass("ag-header-cell-filtered",isFilterActive),this.refreshAria()};this.addManagedListener(this.column,Column.EVENT_FILTER_ACTIVE_CHANGED,listener),listener()}setupWrapTextClass(){const listener=()=>{const wrapText=!!this.column.getColDef().wrapHeaderText;this.comp.addOrRemoveCssClass("ag-header-cell-wrap-text",wrapText)};listener(),this.addRefreshFunction(listener)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui,column,comp,beans}=this;if(!column.isSpanHeaderHeight())return eGui.style.removeProperty("top"),eGui.style.removeProperty("height"),comp.addOrRemoveCssClass("ag-header-span-height",!1),void comp.addOrRemoveCssClass("ag-header-span-total",!1);const{numberOfParents,isSpanningTotal}=this.column.getColumnGroupPaddingInfo();comp.addOrRemoveCssClass("ag-header-span-height",numberOfParents>0);const{columnModel}=beans,headerHeight=columnModel.getColumnHeaderRowHeight();if(0===numberOfParents)return comp.addOrRemoveCssClass("ag-header-span-total",!1),eGui.style.setProperty("top","0px"),void eGui.style.setProperty("height",`${headerHeight}px`);comp.addOrRemoveCssClass("ag-header-span-total",isSpanningTotal);const extraHeight=numberOfParents*(columnModel.isPivotMode()?columnModel.getPivotGroupHeaderHeight():columnModel.getGroupHeaderHeight());eGui.style.setProperty("top",-extraHeight+"px"),eGui.style.setProperty("height",`${headerHeight+extraHeight}px`)}setupAutoHeight(wrapperElement){const{columnModel,resizeObserverService}=this.beans,measureHeight=timesCalled=>{if(!this.isAlive())return;const{paddingTop,paddingBottom,borderBottomWidth,borderTopWidth}=getElementSize(this.getGui()),extraHeight=paddingTop+paddingBottom+borderBottomWidth+borderTopWidth,autoHeight=wrapperElement.offsetHeight+extraHeight;if(timesCalled<5){const doc=this.beans.gos.getDocument();if(!doc||!doc.contains(wrapperElement)||0==autoHeight)return void window.setTimeout(()=>measureHeight(timesCalled+1),0)}columnModel.setColumnHeaderHeight(this.column,autoHeight)};let stopResizeObserver,isMeasuring=!1;const checkMeasuring=()=>{const newValue=this.column.isAutoHeaderHeight();newValue&&!isMeasuring&&startMeasuring(),!newValue&&isMeasuring&&stopMeasuring()},startMeasuring=()=>{isMeasuring=!0,measureHeight(0),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!0),stopResizeObserver=resizeObserverService.observeResize(wrapperElement,()=>measureHeight(0))},stopMeasuring=()=>{isMeasuring=!1,stopResizeObserver&&stopResizeObserver(),this.comp.addOrRemoveCssClass("ag-header-cell-auto-height",!1),stopResizeObserver=void 0};checkMeasuring(),this.addDestroyFunc(()=>stopMeasuring()),this.addManagedListener(this.column,Column.EVENT_WIDTH_CHANGED,()=>isMeasuring&&measureHeight(0)),this.addManagedListener(this.eventService,Column.EVENT_SORT_CHANGED,()=>{isMeasuring&&window.setTimeout(()=>measureHeight(0))}),this.addRefreshFunction(checkMeasuring)}refreshAriaSort(){if(this.sortable){const translate=this.localeService.getLocaleTextFunc(),sort=this.beans.sortController.getDisplaySortForColumn(this.column)||null;this.comp.setAriaSort(getAriaSortState(sort)),this.setAriaDescriptionProperty("sort",translate("ariaSortableColumn","Press ENTER to sort"))}else this.comp.setAriaSort(),this.setAriaDescriptionProperty("sort",null)}refreshAriaMenu(){if(this.menuEnabled){const translate=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("menu",translate("ariaMenuColumn","Press ALT DOWN to open column menu"))}else this.setAriaDescriptionProperty("menu",null)}refreshAriaFilterButton(){if(this.openFilterEnabled&&!this.menuService.isLegacyMenuEnabled()){const translate=this.localeService.getLocaleTextFunc();this.setAriaDescriptionProperty("filterButton",translate("ariaFilterColumn","Press CTRL ENTER to open filter"))}else this.setAriaDescriptionProperty("filterButton",null)}refreshAriaFiltered(){const translate=this.localeService.getLocaleTextFunc();this.column.isFilterActive()?this.setAriaDescriptionProperty("filter",translate("ariaColumnFiltered","Column Filtered")):this.setAriaDescriptionProperty("filter",null)}setAriaDescriptionProperty(property,value){null!=value?this.ariaDescriptionProperties.set(property,value):this.ariaDescriptionProperties.delete(property)}announceAriaDescription(){if(!this.eGui.contains(this.beans.gos.getActiveDomElement()))return;const ariaDescription=Array.from(this.ariaDescriptionProperties.keys()).sort((a,b)=>"filter"===a?-1:b.charCodeAt(0)-a.charCodeAt(0)).map(key=>this.ariaDescriptionProperties.get(key)).join(". ");this.beans.ariaAnnouncementService.announceValue(ariaDescription)}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered()}addColumnHoverListener(){const listener=()=>{if(!this.gos.get("columnHoverHighlight"))return;const isHovered=this.beans.columnHoverService.isHovered(this.column);this.comp.addOrRemoveCssClass("ag-column-hover",isHovered)};this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HOVER_CHANGED,listener),listener()}getColId(){return this.column.getColId()}addActiveHeaderMouseListeners(){const listener=e=>this.handleMouseOverChange("mouseenter"===e.type);this.addManagedListener(this.getGui(),"mouseenter",listener),this.addManagedListener(this.getGui(),"mouseleave",listener),this.addManagedListener(this.getGui(),"click",()=>this.dispatchColumnMouseEvent(Events.EVENT_COLUMN_HEADER_CLICKED,this.column)),this.addManagedListener(this.getGui(),"contextmenu",event=>this.handleContextMenuMouseEvent(event,void 0,this.column))}handleMouseOverChange(isMouseOver){this.setActiveHeader(isMouseOver);const event={type:isMouseOver?Events.EVENT_COLUMN_HEADER_MOUSE_OVER:Events.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column};this.eventService.dispatchEvent(event)}setActiveHeader(active){this.comp.addOrRemoveCssClass("ag-header-active",active)}getAnchorElementForMenu(isFilter){const headerComp=this.comp.getUserCompInstance();return headerComp instanceof HeaderComp?headerComp.getAnchorElementForMenu(isFilter):this.getGui()}destroy(){super.destroy(),this.refreshFunctions=null,this.selectAllFeature=null,this.dragSourceElement=null,this.userCompDetails=null,this.userHeaderClasses=null,this.ariaDescriptionProperties=null}},GroupResizeFeature=class extends BeanStub{constructor(comp,eResize,pinned,columnGroup){super(),this.eResize=eResize,this.comp=comp,this.pinned=pinned,this.columnGroup=columnGroup}postConstruct(){if(!this.columnGroup.isResizable())return void this.comp.setResizableDisplayed(!1);const finishedWithResizeFunc=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(finishedWithResizeFunc),!this.gos.get("suppressAutoSize")){const skipHeaderOnAutoSize=this.gos.get("skipHeaderOnAutoSize");this.eResize.addEventListener("dblclick",()=>{const keys2=[];this.columnGroup.getDisplayedLeafColumns().forEach(column=>{column.getColDef().suppressAutoSize||keys2.push(column.getColId())}),keys2.length>0&&this.columnModel.autoSizeColumns({columns:keys2,skipHeader:skipHeaderOnAutoSize,stopAtGroup:this.columnGroup,source:"uiColumnResized"}),this.resizeLeafColumnsToFit("uiColumnResized")})}}onResizeStart(shiftKey){const initialValues=this.getInitialValues(shiftKey);this.storeLocalValues(initialValues),this.toggleColumnResizing(!0)}onResizing(finished,resizeAmount,source="uiColumnResized"){const resizeAmountNormalised=this.normaliseDragChange(resizeAmount),width=this.resizeStartWidth+resizeAmountNormalised;this.resizeColumnsFromLocalValues(width,source,finished)}getInitialValues(shiftKey){const columnsToResize=this.getColumnsToResize(),resizeStartWidth=this.getInitialSizeOfColumns(columnsToResize),columnSizeAndRatios={columnsToResize,resizeStartWidth,resizeRatios:this.getSizeRatiosOfColumns(columnsToResize,resizeStartWidth)};let groupAfter=null;if(shiftKey&&(groupAfter=this.columnModel.getDisplayedGroupAtDirection(this.columnGroup,"After")),groupAfter){const takeFromLeafCols=groupAfter.getDisplayedLeafColumns(),groupAfterColumns=columnSizeAndRatios.groupAfterColumns=takeFromLeafCols.filter(col=>col.isResizable()),groupAfterStartWidth=columnSizeAndRatios.groupAfterStartWidth=this.getInitialSizeOfColumns(groupAfterColumns);columnSizeAndRatios.groupAfterRatios=this.getSizeRatiosOfColumns(groupAfterColumns,groupAfterStartWidth)}else columnSizeAndRatios.groupAfterColumns=void 0,columnSizeAndRatios.groupAfterStartWidth=void 0,columnSizeAndRatios.groupAfterRatios=void 0;return columnSizeAndRatios}storeLocalValues(initialValues){const{columnsToResize,resizeStartWidth,resizeRatios,groupAfterColumns,groupAfterStartWidth,groupAfterRatios}=initialValues;this.resizeCols=columnsToResize,this.resizeStartWidth=resizeStartWidth,this.resizeRatios=resizeRatios,this.resizeTakeFromCols=groupAfterColumns,this.resizeTakeFromStartWidth=groupAfterStartWidth,this.resizeTakeFromRatios=groupAfterRatios}clearLocalValues(){this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}resizeLeafColumnsToFit(source){const preferredSize=this.autoWidthCalculator.getPreferredWidthForColumnGroup(this.columnGroup),initialValues=this.getInitialValues();preferredSize>initialValues.resizeStartWidth&&this.resizeColumns(initialValues,preferredSize,source,!0)}resizeColumnsFromLocalValues(totalWidth,source,finished=!0){var _a,_b,_c;if(!this.resizeCols||!this.resizeRatios)return;const initialValues={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:null!=(_a=this.resizeTakeFromCols)?_a:void 0,groupAfterStartWidth:null!=(_b=this.resizeTakeFromStartWidth)?_b:void 0,groupAfterRatios:null!=(_c=this.resizeTakeFromRatios)?_c:void 0};this.resizeColumns(initialValues,totalWidth,source,finished)}resizeColumns(initialValues,totalWidth,source,finished=!0){const{columnsToResize,resizeStartWidth,resizeRatios,groupAfterColumns,groupAfterStartWidth,groupAfterRatios}=initialValues,resizeSets=[];if(resizeSets.push({columns:columnsToResize,ratios:resizeRatios,width:totalWidth}),groupAfterColumns){const diff=totalWidth-resizeStartWidth;resizeSets.push({columns:groupAfterColumns,ratios:groupAfterRatios,width:groupAfterStartWidth-diff})}this.columnModel.resizeColumnSets({resizeSets,finished,source}),finished&&this.toggleColumnResizing(!1)}toggleColumnResizing(resizing){this.comp.addOrRemoveCssClass("ag-column-resizing",resizing)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(col=>col.isResizable())}getInitialSizeOfColumns(columns){return columns.reduce((totalWidth,column)=>totalWidth+column.getActualWidth(),0)}getSizeRatiosOfColumns(columns,initialSizeOfColumns){return columns.map(column=>column.getActualWidth()/initialSizeOfColumns)}normaliseDragChange(dragChange){let result=dragChange;return this.gos.get("enableRtl")?"left"!==this.pinned&&(result*=-1):"right"===this.pinned&&(result*=-1),result}destroy(){super.destroy(),this.clearLocalValues()}};__decorateClass([Autowired("horizontalResizeService")],GroupResizeFeature.prototype,"horizontalResizeService",2),__decorateClass([Autowired("autoWidthCalculator")],GroupResizeFeature.prototype,"autoWidthCalculator",2),__decorateClass([Autowired("columnModel")],GroupResizeFeature.prototype,"columnModel",2),__decorateClass([PostConstruct],GroupResizeFeature.prototype,"postConstruct",1);var GroupWidthFeature=class extends BeanStub{constructor(comp,columnGroup){super(),this.removeChildListenersFuncs=[],this.columnGroup=columnGroup,this.comp=comp}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,ColumnGroup.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const widthChangedListener=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(column=>{column.addEventListener("widthChanged",widthChangedListener),column.addEventListener("visibleChanged",widthChangedListener),this.removeChildListenersFuncs.push(()=>{column.removeEventListener("widthChanged",widthChangedListener),column.removeEventListener("visibleChanged",widthChangedListener)})})}removeListenersOnChildrenColumns(){this.removeChildListenersFuncs.forEach(func=>func()),this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const columnWidth=this.columnGroup.getActualWidth();this.comp.setWidth(`${columnWidth}px`),this.comp.addOrRemoveCssClass("ag-hidden",0===columnWidth)}};__decorateClass([PostConstruct],GroupWidthFeature.prototype,"postConstruct",1);var HeaderGroupCellCtrl=class extends AbstractHeaderCellCtrl{constructor(columnGroup,beans,parentRowCtrl){super(columnGroup,beans,parentRowCtrl),this.onSuppressColMoveChange=()=>{if(!this.isAlive()||this.isSuppressMoving())this.removeDragSource();else if(!this.dragSource){const eGui=this.getGui();this.setDragSource(eGui)}},this.column=columnGroup}setComp(comp,eGui,eResize){this.comp=comp,this.setGui(eGui),this.displayName=this.beans.columnModel.getDisplayNameForColumnGroup(this.column,"header"),this.addClasses(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.addDestroyFunc(()=>{this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature))}),this.setupUserComp(),this.addHeaderMouseListeners();const pinned=this.getParentRowCtrl().getPinned(),leafCols=this.column.getProvidedColumnGroup().getLeafColumns();this.createManagedBean(new HoverFeature(leafCols,eGui)),this.createManagedBean(new SetLeftFeature(this.column,eGui,this.beans)),this.createManagedBean(new GroupWidthFeature(comp,this.column)),this.resizeFeature=this.createManagedBean(new GroupResizeFeature(comp,eResize,pinned,this.column)),this.createManagedBean(new ManagedFocusFeature(eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addManagedPropertyListener(Events.EVENT_SUPPRESS_COLUMN_MOVE_CHANGED,this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners()}resizeHeader(delta,shiftKey){if(!this.resizeFeature)return;const initialValues=this.resizeFeature.getInitialValues(shiftKey);this.resizeFeature.resizeColumns(initialValues,initialValues.resizeStartWidth+delta,"uiColumnResized",!0)}moveHeader(hDirection){const{beans,eGui,column,gos,ctrlsService}=this,isRtl=gos.get("enableRtl"),isLeft=0===hDirection,pinned=this.getPinned(),rect=eGui.getBoundingClientRect(),left=rect.left,width=rect.width,xPosition=ColumnMoveHelper.normaliseX(isLeft!==isRtl?left-20:left+width+20,pinned,!0,gos,ctrlsService),id=column.getGroupId(),headerPosition=this.focusService.getFocusedHeader();ColumnMoveHelper.attemptMoveColumns({allMovingColumns:this.column.getLeafColumns(),isFromHeader:!0,hDirection,xPosition,pinned,fromEnter:!1,fakeEvent:!1,gos,columnModel:beans.columnModel});const displayedLeafColumns=column.getDisplayedLeafColumns(),targetColumn=isLeft?displayedLeafColumns[0]:last(displayedLeafColumns);this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(targetColumn,"auto"),!this.isAlive()&&headerPosition&&this.restoreFocus(id,column,headerPosition)}restoreFocus(groupId,previousColumnGroup,previousPosition){const leafCols=previousColumnGroup.getLeafColumns();if(!leafCols.length)return;const parent=leafCols[0].getParent();if(!parent)return;const newColumnGroup=this.findGroupWidthId(parent,groupId);newColumnGroup&&this.focusService.focusHeaderPosition({headerPosition:__spreadProps(__spreadValues({},previousPosition),{column:newColumnGroup})})}findGroupWidthId(columnGroup,id){for(;columnGroup;){if(columnGroup.getGroupId()===id)return columnGroup;columnGroup=columnGroup.getParent()}return null}resizeLeafColumnsToFit(source){this.resizeFeature&&this.resizeFeature.resizeLeafColumnsToFit(source)}setupUserComp(){const params=this.gos.addGridCommonParams({displayName:this.displayName,columnGroup:this.column,setExpanded:expanded=>{this.beans.columnModel.setColumnGroupOpened(this.column.getProvidedColumnGroup(),expanded,"gridInitializing")},setTooltip:(value,shouldDisplayTooltip)=>{this.setupTooltip(value,shouldDisplayTooltip)}}),compDetails=this.userComponentFactory.getHeaderGroupCompDetails(params);this.comp.setUserCompDetails(compDetails)}addHeaderMouseListeners(){const listener=e=>this.handleMouseOverChange("mouseenter"===e.type);this.addManagedListener(this.getGui(),"mouseenter",listener),this.addManagedListener(this.getGui(),"mouseleave",listener),this.addManagedListener(this.getGui(),"click",()=>this.dispatchColumnMouseEvent(Events.EVENT_COLUMN_HEADER_CLICKED,this.column.getProvidedColumnGroup())),this.addManagedListener(this.getGui(),"contextmenu",event=>this.handleContextMenuMouseEvent(event,void 0,this.column.getProvidedColumnGroup()))}handleMouseOverChange(isMouseOver){const event={type:isMouseOver?Events.EVENT_COLUMN_HEADER_MOUSE_OVER:Events.EVENT_COLUMN_HEADER_MOUSE_LEAVE,column:this.column.getProvidedColumnGroup()};this.eventService.dispatchEvent(event)}setupTooltip(value,shouldDisplayTooltip){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature));const colGroupDef=this.column.getColGroupDef(),isTooltipWhenTruncated="whenTruncated"===this.gos.get("tooltipShowMode"),eGui=this.eGui;shouldDisplayTooltip||!isTooltipWhenTruncated||(null==colGroupDef?void 0:colGroupDef.headerGroupComponent)||(shouldDisplayTooltip=()=>{const textEl=eGui.querySelector(".ag-header-group-text");return!textEl||textEl.scrollWidth>textEl.clientWidth});const tooltipCtrl={getColumn:()=>this.column,getGui:()=>eGui,getLocation:()=>"headerGroup",getTooltipValue:()=>null!=value?value:colGroupDef&&colGroupDef.headerTooltip,shouldDisplayTooltip};colGroupDef&&(tooltipCtrl.getColDef=()=>colGroupDef),this.createBean(new TooltipFeature(tooltipCtrl))}setupExpandable(){const providedColGroup=this.column.getProvidedColumnGroup();this.refreshExpanded(),this.addManagedListener(providedColGroup,ProvidedColumnGroup.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(providedColGroup,ProvidedColumnGroup.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))}refreshExpanded(){const column=this.column;this.expandable=column.isExpandable();const expanded=column.isExpanded();this.expandable?this.comp.setAriaExpanded(expanded?"true":"false"):this.comp.setAriaExpanded(void 0)}getColId(){return this.column.getUniqueId()}addClasses(){const colGroupDef=this.column.getColGroupDef(),classes=CssClassApplier.getHeaderClassesFromColDef(colGroupDef,this.gos,null,this.column);if(this.column.isPadding()){classes.push("ag-header-group-cell-no-group");this.column.getLeafColumns().every(col=>col.isSpanHeaderHeight())&&classes.push("ag-header-span-height")}else classes.push("ag-header-group-cell-with-group");classes.forEach(c=>this.comp.addOrRemoveCssClass(c,!0))}setupMovingCss(){const leafColumns=this.column.getProvidedColumnGroup().getLeafColumns(),listener=()=>this.comp.addOrRemoveCssClass("ag-header-cell-moving",this.column.isMoving());leafColumns.forEach(col=>{this.addManagedListener(col,Column.EVENT_MOVING_CHANGED,listener)}),listener()}onFocusIn(e){if(!this.eGui.contains(e.relatedTarget)){const rowIndex=this.getRowIndex();this.beans.focusService.setFocusedHeader(rowIndex,this.column)}}handleKeyDown(e){super.handleKeyDown(e);const wrapperHasFocus=this.getWrapperHasFocus();if(this.expandable&&wrapperHasFocus&&e.key===KeyCode.ENTER){const column=this.column,newExpandedValue=!column.isExpanded();this.beans.columnModel.setColumnGroupOpened(column.getProvidedColumnGroup(),newExpandedValue,"uiColumnExpanded")}}setDragSource(eHeaderGroup){if(!this.isAlive()||this.isSuppressMoving())return;if(this.removeDragSource(),!eHeaderGroup)return;const{beans,column,displayName,gos,dragAndDropService}=this,{columnModel}=beans,allLeafColumns=column.getProvidedColumnGroup().getLeafColumns();let hideColumnOnExit=!gos.get("suppressDragLeaveHidesColumns");const dragSource=this.dragSource={type:1,eElement:eHeaderGroup,getDefaultIconName:()=>hideColumnOnExit?DragAndDropService.ICON_HIDE:DragAndDropService.ICON_NOT_ALLOWED,dragItemName:displayName,getDragItem:()=>this.getDragItemForGroup(column),onDragStarted:()=>{hideColumnOnExit=!gos.get("suppressDragLeaveHidesColumns"),allLeafColumns.forEach(col=>col.setMoving(!0,"uiColumnDragged"))},onDragStopped:()=>allLeafColumns.forEach(col=>col.setMoving(!1,"uiColumnDragged")),onGridEnter:dragItem=>{var _a;if(hideColumnOnExit){const unlockedColumns=(null==(_a=null==dragItem?void 0:dragItem.columns)?void 0:_a.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!0,"uiColumnMoved")}},onGridExit:dragItem=>{var _a;if(hideColumnOnExit){const unlockedColumns=(null==(_a=null==dragItem?void 0:dragItem.columns)?void 0:_a.filter(col=>!col.getColDef().lockVisible))||[];columnModel.setColumnsVisible(unlockedColumns,!1,"uiColumnMoved")}}};dragAndDropService.addDragSource(dragSource,!0)}getDragItemForGroup(columnGroup){const allColumnsOriginalOrder=columnGroup.getProvidedColumnGroup().getLeafColumns(),visibleState={};allColumnsOriginalOrder.forEach(column=>visibleState[column.getId()]=column.isVisible());const allColumnsCurrentOrder=[];return this.beans.columnModel.getAllDisplayedColumns().forEach(column=>{allColumnsOriginalOrder.indexOf(column)>=0&&(allColumnsCurrentOrder.push(column),removeFromArray(allColumnsOriginalOrder,column))}),allColumnsOriginalOrder.forEach(column=>allColumnsCurrentOrder.push(column)),{columns:allColumnsCurrentOrder,visibleState}}isSuppressMoving(){let childSuppressesMoving=!1;this.column.getLeafColumns().forEach(column=>{(column.getColDef().suppressMovable||column.getColDef().lockPosition)&&(childSuppressesMoving=!0)});return childSuppressesMoving||this.gos.get("suppressMovableColumns")}},instanceIdSequence5=0,HeaderRowCtrl=class extends BeanStub{constructor(rowIndex,pinned,type){super(),this.instanceId=instanceIdSequence5++,this.rowIndex=rowIndex,this.pinned=pinned,this.type=type;const typeClass="group"==type?"ag-header-row-column-group":"filter"==type?"ag-header-row-column-filter":"ag-header-row-column";this.headerRowClass=`ag-header-row ${typeClass}`}postConstruct(){this.isPrintLayout=this.gos.isDomLayout("print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}getInstanceId(){return this.instanceId}setComp(comp,initCompState=!0){this.comp=comp,initCompState&&(this.onRowHeightChanged(),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners()}getHeaderRowClass(){return this.headerRowClass}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_VIRTUAL_COLUMNS_CHANGED,params=>this.onVirtualColumnsChanged(params.afterScroll)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("domLayout",this.onDisplayedColumnsChanged.bind(this)),this.addManagedPropertyListener("ensureDomOrder",e=>this.isEnsureDomOrder=e.currentValue),this.addManagedPropertyListener("headerHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("groupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("pivotGroupHeaderHeight",this.onRowHeightChanged.bind(this)),this.addManagedPropertyListener("floatingFiltersHeight",this.onRowHeightChanged.bind(this))}getHeaderCellCtrl(column){if(this.headerCellCtrls)return values(this.headerCellCtrls).find(cellCtrl=>cellCtrl.getColumnGroupChild()===column)}onDisplayedColumnsChanged(){this.isPrintLayout=this.gos.isDomLayout("print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}getType(){return this.type}onColumnResized(){this.setWidth()}setWidth(){const width=this.getWidthForRow();this.comp.setWidth(`${width}px`)}getWidthForRow(){const{columnModel}=this.beans;if(this.isPrintLayout){return null!=this.pinned?0:columnModel.getContainerWidth("right")+columnModel.getContainerWidth("left")+columnModel.getContainerWidth(null)}return columnModel.getContainerWidth(this.pinned)}onRowHeightChanged(){var{topOffset,rowHeight}=this.getTopAndHeight();this.comp.setTop(topOffset+"px"),this.comp.setHeight(rowHeight+"px")}getTopAndHeight(){const{columnModel,filterManager}=this.beans;let headerRowCount=columnModel.getHeaderRowCount();const sizes=[];let numberOfFloating=0;filterManager.hasFloatingFilters()&&(headerRowCount++,numberOfFloating=1);const groupHeight=columnModel.getColumnGroupHeaderRowHeight(),headerHeight=columnModel.getColumnHeaderRowHeight(),numberOfGroups=headerRowCount-(1+numberOfFloating);for(let i=0;i<numberOfGroups;i++)sizes.push(groupHeight);sizes.push(headerHeight);for(let i=0;i<numberOfFloating;i++)sizes.push(columnModel.getFloatingFiltersHeight());let topOffset=0;for(let i=0;i<this.rowIndex;i++)topOffset+=sizes[i];return{topOffset,rowHeight:sizes[this.rowIndex]}}getPinned(){return this.pinned}getRowIndex(){return this.rowIndex}onVirtualColumnsChanged(afterScroll=!1){const ctrlsToDisplay=this.getHeaderCtrls(),forceOrder=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(ctrlsToDisplay,forceOrder,afterScroll)}getHeaderCtrls(){const oldCtrls=this.headerCellCtrls;this.headerCellCtrls=new Map;const columns=this.getColumnsInViewport();for(const child of columns)this.recycleAndCreateHeaderCtrls(child,oldCtrls);const isFocusedAndDisplayed=ctrl=>{const{focusService,columnModel}=this.beans;if(!focusService.isHeaderWrapperFocused(ctrl))return!1;return columnModel.isDisplayed(ctrl.getColumnGroupChild())};if(oldCtrls)for(const[id,oldCtrl]of oldCtrls){isFocusedAndDisplayed(oldCtrl)?this.headerCellCtrls.set(id,oldCtrl):this.destroyBean(oldCtrl)}return Array.from(this.headerCellCtrls.values())}recycleAndCreateHeaderCtrls(headerColumn,oldCtrls){if(!this.headerCellCtrls)return;if(headerColumn.isEmptyGroup())return;const idOfChild=headerColumn.getUniqueId();let headerCtrl;oldCtrls&&(headerCtrl=oldCtrls.get(idOfChild),oldCtrls.delete(idOfChild));if(headerCtrl&&headerCtrl.getColumnGroupChild()!=headerColumn&&(this.destroyBean(headerCtrl),headerCtrl=void 0),null==headerCtrl)switch(this.type){case"filter":headerCtrl=this.createBean(new HeaderFilterCellCtrl(headerColumn,this.beans,this));break;case"group":headerCtrl=this.createBean(new HeaderGroupCellCtrl(headerColumn,this.beans,this));break;default:headerCtrl=this.createBean(new HeaderCellCtrl(headerColumn,this.beans,this))}this.headerCellCtrls.set(idOfChild,headerCtrl)}getColumnsInViewport(){return this.isPrintLayout?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()}getColumnsInViewportPrintLayout(){if(null!=this.pinned)return[];let viewportColumns=[];const actualDepth=this.getActualDepth(),{columnModel}=this.beans;return["left",null,"right"].forEach(pinned=>{const items=columnModel.getVirtualHeaderGroupRow(pinned,actualDepth);viewportColumns=viewportColumns.concat(items)}),viewportColumns}getActualDepth(){return"filter"==this.type?this.rowIndex-1:this.rowIndex}getColumnsInViewportNormalLayout(){return this.beans.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())}focusHeader(column,event){if(!this.headerCellCtrls)return!1;const ctrl=Array.from(this.headerCellCtrls.values()).find(ctrl2=>ctrl2.getColumnGroupChild()==column);return!!ctrl&&ctrl.focus(event)}destroy(){this.headerCellCtrls&&this.headerCellCtrls.forEach(ctrl=>{this.destroyBean(ctrl)}),this.headerCellCtrls=void 0,super.destroy()}};__decorateClass([Autowired("beans")],HeaderRowCtrl.prototype,"beans",2),__decorateClass([PostConstruct],HeaderRowCtrl.prototype,"postConstruct",1);var HeaderRowContainerCtrl=class extends BeanStub{constructor(pinned){super(),this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[],this.pinned=pinned}setComp(comp,eGui){this.comp=comp,this.eViewport=eGui,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(this.eViewport),this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()}setupDragAndDrop(dropContainer){const bodyDropTarget=new BodyDropTarget(this.pinned,dropContainer);this.createManagedBean(bodyDropTarget)}refresh(keepColumns=!1){const sequence=new NumberSequence,focusedHeaderPosition=this.focusService.getFocusHeaderToUseAfterRefresh();(()=>{const groupRowCount=this.columnModel.getHeaderRowCount()-1;this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls);for(let i=0;i<groupRowCount;i++){const ctrl=this.createBean(new HeaderRowCtrl(sequence.next(),this.pinned,"group"));this.groupsRowCtrls.push(ctrl)}})(),(()=>{const rowIndex=sequence.next(),needNewInstance=!(this.hidden||null!=this.columnsRowCtrl&&keepColumns&&this.columnsRowCtrl.getRowIndex()===rowIndex);(needNewInstance||this.hidden)&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),needNewInstance&&(this.columnsRowCtrl=this.createBean(new HeaderRowCtrl(rowIndex,this.pinned,"column")))})(),(()=>{this.includeFloatingFilter=this.filterManager.hasFloatingFilters()&&!this.hidden;const destroyPreviousComp=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter)return void destroyPreviousComp();const rowIndex=sequence.next();if(this.filtersRowCtrl){const rowIndexMismatch=this.filtersRowCtrl.getRowIndex()!==rowIndex;keepColumns&&!rowIndexMismatch||destroyPreviousComp()}this.filtersRowCtrl||(this.filtersRowCtrl=this.createBean(new HeaderRowCtrl(rowIndex,this.pinned,"filter")))})();const allCtrls=this.getAllCtrls();this.comp.setCtrls(allCtrls),this.restoreFocusOnHeader(focusedHeaderPosition)}restoreFocusOnHeader(position){null!=position&&position.column.getPinned()==this.pinned&&this.focusService.focusHeaderPosition({headerPosition:position})}getAllCtrls(){const res=[...this.groupsRowCtrls];return this.columnsRowCtrl&&res.push(this.columnsRowCtrl),this.filtersRowCtrl&&res.push(this.filtersRowCtrl),res}onGridColumnsChanged(){this.refresh(!0)}onDisplayedColumnsChanged(){const includeFloatingFilter=this.filterManager.hasFloatingFilters()&&!this.hidden;this.includeFloatingFilter!==includeFloatingFilter&&this.refresh(!0)}setupCenterWidth(){null==this.pinned&&this.createManagedBean(new CenterWidthFeature(width=>this.comp.setCenterWidth(`${width}px`),!0))}setHorizontalScroll(offset){this.comp.setViewportScrollLeft(offset)}setupPinnedWidth(){if(null==this.pinned)return;const pinningLeft="left"===this.pinned,pinningRight="right"===this.pinned;this.hidden=!0;const listener=()=>{const width=pinningLeft?this.pinnedWidthService.getPinnedLeftWidth():this.pinnedWidthService.getPinnedRightWidth();if(null==width)return;const hidden=0==width,hiddenChanged=this.hidden!==hidden,isRtl=this.gos.get("enableRtl"),scrollbarWidth=this.gos.getScrollbarWidth(),widthWithPadding=this.scrollVisibleService.isVerticalScrollShowing()&&(isRtl&&pinningLeft||!isRtl&&pinningRight)?width+scrollbarWidth:width;this.comp.setPinnedContainerWidth(`${widthWithPadding}px`),this.comp.setDisplayed(!hidden),hiddenChanged&&(this.hidden=hidden,this.refresh())};this.addManagedListener(this.eventService,Events.EVENT_LEFT_PINNED_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_SCROLLBAR_WIDTH_CHANGED,listener)}getHeaderCtrlForColumn(column){if(column instanceof Column){if(!this.columnsRowCtrl)return;return this.columnsRowCtrl.getHeaderCellCtrl(column)}if(0!==this.groupsRowCtrls.length)for(let i=0;i<this.groupsRowCtrls.length;i++){const ctrl=this.groupsRowCtrls[i].getHeaderCellCtrl(column);if(ctrl)return ctrl}}getHtmlElementForColumnHeader(column){const cellCtrl=this.getHeaderCtrlForColumn(column);return cellCtrl?cellCtrl.getGui():null}getRowType(rowIndex){const ctrl=this.getAllCtrls()[rowIndex];return ctrl?ctrl.getType():void 0}focusHeader(rowIndex,column,event){const ctrl=this.getAllCtrls()[rowIndex];return!!ctrl&&ctrl.focusHeader(column,event)}getViewport(){return this.eViewport}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}destroy(){this.filtersRowCtrl&&(this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)),this.columnsRowCtrl&&(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl)),this.groupsRowCtrls&&this.groupsRowCtrls.length&&(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls)),super.destroy()}};__decorateClass([Autowired("ctrlsService")],HeaderRowContainerCtrl.prototype,"ctrlsService",2),__decorateClass([Autowired("scrollVisibleService")],HeaderRowContainerCtrl.prototype,"scrollVisibleService",2),__decorateClass([Autowired("pinnedWidthService")],HeaderRowContainerCtrl.prototype,"pinnedWidthService",2),__decorateClass([Autowired("columnModel")],HeaderRowContainerCtrl.prototype,"columnModel",2),__decorateClass([Autowired("focusService")],HeaderRowContainerCtrl.prototype,"focusService",2),__decorateClass([Autowired("filterManager")],HeaderRowContainerCtrl.prototype,"filterManager",2);var _HeaderRowContainerComp=class _HeaderRowContainerComp extends Component{constructor(pinned){super(),this.headerRowComps={},this.rowCompsList=[],this.pinned=pinned}init(){this.selectAndSetTemplate();const compProxy={setDisplayed:displayed=>this.setDisplayed(displayed),setCtrls:ctrls=>this.setCtrls(ctrls),setCenterWidth:width=>this.eCenterContainer.style.width=width,setViewportScrollLeft:left=>this.getGui().scrollLeft=left,setPinnedContainerWidth:width=>{const eGui=this.getGui();eGui.style.width=width,eGui.style.maxWidth=width,eGui.style.minWidth=width}};this.createManagedBean(new HeaderRowContainerCtrl(this.pinned)).setComp(compProxy,this.getGui())}selectAndSetTemplate(){const pinnedLeft="left"==this.pinned,pinnedRight="right"==this.pinned,template=pinnedLeft?_HeaderRowContainerComp.PINNED_LEFT_TEMPLATE:pinnedRight?_HeaderRowContainerComp.PINNED_RIGHT_TEMPLATE:_HeaderRowContainerComp.CENTER_TEMPLATE;this.setTemplate(template),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()}destroyRowComps(){this.setCtrls([])}destroyRowComp(rowComp){this.destroyBean(rowComp),this.eRowContainer.removeChild(rowComp.getGui())}setCtrls(ctrls){const oldRowComps=this.headerRowComps;let prevGui;this.headerRowComps={},this.rowCompsList=[];const appendEnsuringDomOrder=rowComp=>{const eGui=rowComp.getGui();eGui.parentElement!=this.eRowContainer&&this.eRowContainer.appendChild(eGui),prevGui&&ensureDomOrder(this.eRowContainer,eGui,prevGui),prevGui=eGui};ctrls.forEach(ctrl=>{const ctrlId=ctrl.getInstanceId(),existingComp=oldRowComps[ctrlId];delete oldRowComps[ctrlId];const rowComp=existingComp||this.createBean(new HeaderRowComp(ctrl));this.headerRowComps[ctrlId]=rowComp,this.rowCompsList.push(rowComp),appendEnsuringDomOrder(rowComp)}),getAllValuesInObject(oldRowComps).forEach(c=>this.destroyRowComp(c))}};_HeaderRowContainerComp.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="rowgroup"></div>',_HeaderRowContainerComp.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="rowgroup"></div>',_HeaderRowContainerComp.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',__decorateClass([RefSelector("eCenterContainer")],_HeaderRowContainerComp.prototype,"eCenterContainer",2),__decorateClass([PostConstruct],_HeaderRowContainerComp.prototype,"init",1),__decorateClass([PreDestroy],_HeaderRowContainerComp.prototype,"destroyRowComps",1);var HeaderRowContainerComp=_HeaderRowContainerComp,HeaderNavigationService=class extends BeanStub{constructor(){super(...arguments),this.currentHeaderRowWithoutSpan=-1}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridBodyCon=p.gridBodyCtrl});const eDocument=this.gos.getDocument();this.addManagedListener(eDocument,"mousedown",()=>this.setCurrentHeaderRowWithoutSpan(-1))}getHeaderRowCount(){const centerHeaderContainer=this.ctrlsService.getHeaderRowContainerCtrl();return centerHeaderContainer?centerHeaderContainer.getRowCount():0}navigateVertically(direction,fromHeader,event){if(fromHeader||(fromHeader=this.focusService.getFocusedHeader()),!fromHeader)return!1;const{headerRowIndex,column}=fromHeader,rowLen=this.getHeaderRowCount(),isUp=0===direction;let{headerRowIndex:nextRow,column:nextFocusColumn,headerRowIndexWithoutSpan}=isUp?this.headerPositionUtils.getColumnVisibleParent(column,headerRowIndex):this.headerPositionUtils.getColumnVisibleChild(column,headerRowIndex),skipColumn=!1;return nextRow<0&&(nextRow=0,nextFocusColumn=column,skipColumn=!0),nextRow>=rowLen?(nextRow=-1,this.setCurrentHeaderRowWithoutSpan(-1)):void 0!==headerRowIndexWithoutSpan&&(this.currentHeaderRowWithoutSpan=headerRowIndexWithoutSpan),!(!skipColumn&&!nextFocusColumn)&&this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:nextRow,column:nextFocusColumn},allowUserOverride:!0,event})}setCurrentHeaderRowWithoutSpan(row){this.currentHeaderRowWithoutSpan=row}navigateHorizontally(direction,fromTab=!1,event){const focusedHeader=this.focusService.getFocusedHeader(),isLeft=2===direction,isRtl=this.gos.get("enableRtl");let nextHeader,normalisedDirection;if(-1!==this.currentHeaderRowWithoutSpan?focusedHeader.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=focusedHeader.headerRowIndex,isLeft!==isRtl?(normalisedDirection="Before",nextHeader=this.headerPositionUtils.findHeader(focusedHeader,normalisedDirection)):(normalisedDirection="After",nextHeader=this.headerPositionUtils.findHeader(focusedHeader,normalisedDirection)),nextHeader||!fromTab)return this.focusService.focusHeaderPosition({headerPosition:nextHeader,direction:normalisedDirection,fromTab,allowUserOverride:!0,event});if(fromTab){const userFunc=this.gos.getCallback("tabToNextHeader");if(userFunc)return this.focusService.focusHeaderPositionFromUserFunc({userFunc,headerPosition:nextHeader,direction:normalisedDirection})}return this.focusNextHeaderRow(focusedHeader,normalisedDirection,event)}focusNextHeaderRow(focusedHeader,direction,event){const currentIndex=focusedHeader.headerRowIndex;let nextRowIndex,nextPosition=null;if("Before"===direction?currentIndex>0&&(nextRowIndex=currentIndex-1,this.currentHeaderRowWithoutSpan-=1,nextPosition=this.headerPositionUtils.findColAtEdgeForHeaderRow(nextRowIndex,"end")):(nextRowIndex=currentIndex+1,this.currentHeaderRowWithoutSpan<this.getHeaderRowCount()?this.currentHeaderRowWithoutSpan+=1:this.setCurrentHeaderRowWithoutSpan(-1),nextPosition=this.headerPositionUtils.findColAtEdgeForHeaderRow(nextRowIndex,"start")),!nextPosition)return!1;const{column,headerRowIndex}=this.headerPositionUtils.getHeaderIndexToFocus(nextPosition.column,null==nextPosition?void 0:nextPosition.headerRowIndex);return this.focusService.focusHeaderPosition({headerPosition:{column,headerRowIndex},direction,fromTab:!0,allowUserOverride:!0,event})}scrollToColumn(column,direction="After"){if(column.getPinned())return;let columnToScrollTo;if(column instanceof ColumnGroup){const columns=column.getDisplayedLeafColumns();columnToScrollTo="Before"===direction?last(columns):columns[0]}else columnToScrollTo=column;this.gridBodyCon.getScrollFeature().ensureColumnVisible(columnToScrollTo)}};__decorateClass([Autowired("focusService")],HeaderNavigationService.prototype,"focusService",2),__decorateClass([Autowired("headerPositionUtils")],HeaderNavigationService.prototype,"headerPositionUtils",2),__decorateClass([Autowired("ctrlsService")],HeaderNavigationService.prototype,"ctrlsService",2),__decorateClass([PostConstruct],HeaderNavigationService.prototype,"postConstruct",1),HeaderNavigationService=__decorateClass([Bean("headerNavigationService")],HeaderNavigationService);var GridHeaderCtrl=class extends BeanStub{setComp(comp,eGui,eFocusableElement){this.comp=comp,this.eGui=eGui,this.createManagedBean(new ManagedFocusFeature(eFocusableElement,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight();const listener=this.onHeaderContextMenu.bind(this);this.addManagedListener(this.eGui,"contextmenu",listener),this.mockContextMenuForIPad(listener),this.ctrlsService.register("gridHeaderCtrl",this)}setupHeaderHeight(){const listener=this.setHeaderHeight.bind(this);listener(),this.addManagedPropertyListener("headerHeight",listener),this.addManagedPropertyListener("pivotHeaderHeight",listener),this.addManagedPropertyListener("groupHeaderHeight",listener),this.addManagedPropertyListener("pivotGroupHeaderHeight",listener),this.addManagedPropertyListener("floatingFiltersHeight",listener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HEADER_HEIGHT_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_ADVANCED_FILTER_ENABLED_CHANGED,listener)}getHeaderHeight(){return this.headerHeight}setHeaderHeight(){const{columnModel}=this;let totalHeaderHeight,numberOfFloating=0,headerRowCount=columnModel.getHeaderRowCount();this.filterManager.hasFloatingFilters()&&(headerRowCount++,numberOfFloating=1);const groupHeight=this.columnModel.getColumnGroupHeaderRowHeight(),headerHeight=this.columnModel.getColumnHeaderRowHeight(),numberOfGroups=headerRowCount-(1+numberOfFloating);if(totalHeaderHeight=numberOfFloating*columnModel.getFloatingFiltersHeight(),totalHeaderHeight+=numberOfGroups*groupHeight,totalHeaderHeight+=headerHeight,this.headerHeight===totalHeaderHeight)return;this.headerHeight=totalHeaderHeight;const px=`${totalHeaderHeight+1}px`;this.comp.setHeightAndMinHeight(px),this.eventService.dispatchEvent({type:Events.EVENT_HEADER_HEIGHT_CHANGED})}onPivotModeChanged(){const pivotMode=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",pivotMode),this.comp.addOrRemoveCssClass("ag-pivot-off",!pivotMode)}onDisplayedColumnsChanged(){const shouldAllowOverflow=this.columnModel.getAllDisplayedColumns().some(col=>col.isSpanHeaderHeight());this.comp.addOrRemoveCssClass("ag-header-allow-overflow",shouldAllowOverflow)}onTabKeyDown(e){const isRtl=this.gos.get("enableRtl"),direction=e.shiftKey!==isRtl?2:3;(this.headerNavigationService.navigateHorizontally(direction,!0,e)||this.focusService.focusNextGridCoreContainer(e.shiftKey))&&e.preventDefault()}handleKeyDown(e){let direction=null;switch(e.key){case KeyCode.LEFT:direction=2;case KeyCode.RIGHT:exists(direction)||(direction=3),this.headerNavigationService.navigateHorizontally(direction,!1,e);break;case KeyCode.UP:direction=0;case KeyCode.DOWN:exists(direction)||(direction=1),this.headerNavigationService.navigateVertically(direction,null,e)&&e.preventDefault();break;default:return}}onFocusOut(e){const{relatedTarget}=e;!relatedTarget&&this.eGui.contains(this.gos.getActiveDomElement())||this.eGui.contains(relatedTarget)||this.focusService.clearFocusedHeader()}onHeaderContextMenu(mouseEvent,touch,touchEvent){if(!mouseEvent&&!touchEvent||!this.menuService.isHeaderContextMenuEnabled())return;const{target}=null!=mouseEvent?mouseEvent:touch;target!==this.eGui&&target!==this.ctrlsService.getHeaderRowContainerCtrl().getViewport()||this.menuService.showHeaderContextMenu(void 0,mouseEvent,touchEvent)}mockContextMenuForIPad(listener){if(!isIOSUserAgent())return;const touchListener=new TouchListener(this.eGui);this.addManagedListener(touchListener,TouchListener.EVENT_LONG_TAP,event=>{listener(void 0,event.touchStart,event.touchEvent)}),this.addDestroyFunc(()=>touchListener.destroy())}};__decorateClass([Autowired("headerNavigationService")],GridHeaderCtrl.prototype,"headerNavigationService",2),__decorateClass([Autowired("focusService")],GridHeaderCtrl.prototype,"focusService",2),__decorateClass([Autowired("columnModel")],GridHeaderCtrl.prototype,"columnModel",2),__decorateClass([Autowired("ctrlsService")],GridHeaderCtrl.prototype,"ctrlsService",2),__decorateClass([Autowired("filterManager")],GridHeaderCtrl.prototype,"filterManager",2),__decorateClass([Autowired("menuService")],GridHeaderCtrl.prototype,"menuService",2);var _GridHeaderComp=class _GridHeaderComp extends Component{constructor(){super(_GridHeaderComp.TEMPLATE)}postConstruct(){const compProxy={addOrRemoveCssClass:(cssClassName,on)=>this.addOrRemoveCssClass(cssClassName,on),setHeightAndMinHeight:height=>{this.getGui().style.height=height,this.getGui().style.minHeight=height}};this.createManagedBean(new GridHeaderCtrl).setComp(compProxy,this.getGui(),this.getFocusableElement());const addContainer=container=>{this.createManagedBean(container),this.appendChild(container)};addContainer(new HeaderRowContainerComp("left")),addContainer(new HeaderRowContainerComp(null)),addContainer(new HeaderRowContainerComp("right"))}};_GridHeaderComp.TEMPLATE='<div class="ag-header" role="presentation"/>',__decorateClass([PostConstruct],_GridHeaderComp.prototype,"postConstruct",1);var GridHeaderComp=_GridHeaderComp,HorizontalResizeService=class extends BeanStub{addResizeBar(params){const dragSource={dragStartPixels:params.dragStartPixels||0,eElement:params.eResizeBar,onDragStart:this.onDragStart.bind(this,params),onDragStop:this.onDragStop.bind(this,params),onDragging:this.onDragging.bind(this,params),includeTouch:!0,stopPropagationForTouch:!0};this.dragService.addDragSource(dragSource);return()=>this.dragService.removeDragSource(dragSource)}onDragStart(params,mouseEvent){this.dragStartX=mouseEvent.clientX,this.setResizeIcons();const shiftKey=mouseEvent instanceof MouseEvent&&!0===mouseEvent.shiftKey;params.onResizeStart(shiftKey)}setResizeIcons(){const ctrl=this.ctrlsService.get("gridCtrl");ctrl.setResizeCursor(!0),ctrl.disableUserSelect(!0)}onDragStop(params,mouseEvent){params.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const ctrl=this.ctrlsService.get("gridCtrl");ctrl.setResizeCursor(!1),ctrl.disableUserSelect(!1)}onDragging(params,mouseEvent){this.resizeAmount=mouseEvent.clientX-this.dragStartX,params.onResizing(this.resizeAmount)}};__decorateClass([Autowired("dragService")],HorizontalResizeService.prototype,"dragService",2),__decorateClass([Autowired("ctrlsService")],HorizontalResizeService.prototype,"ctrlsService",2),HorizontalResizeService=__decorateClass([Bean("horizontalResizeService")],HorizontalResizeService);var StandardMenuFactory=class extends BeanStub{hideActiveMenu(){this.hidePopup&&this.hidePopup()}showMenuAfterMouseEvent(column,mouseEvent,containerType){this.showPopup(column,eMenu=>{this.popupService.positionPopupUnderMouseEvent({column,type:containerType,mouseEvent,ePopup:eMenu})},containerType,mouseEvent.target,this.menuService.isLegacyMenuEnabled())}showMenuAfterButtonClick(column,eventSource,containerType){let multiplier=-1,alignSide="left";const isLegacyMenuEnabled=this.menuService.isLegacyMenuEnabled();!isLegacyMenuEnabled&&this.gos.get("enableRtl")&&(multiplier=1,alignSide="right");let nudgeX=isLegacyMenuEnabled?void 0:4*multiplier,nudgeY=isLegacyMenuEnabled?void 0:4;this.showPopup(column,eMenu=>{this.popupService.positionPopupByComponent({type:containerType,eventSource,ePopup:eMenu,nudgeX,nudgeY,alignSide,keepWithinBounds:!0,position:"under",column})},containerType,eventSource,isLegacyMenuEnabled)}showPopup(column,positionCallback,containerType,eventSource,isLegacyMenuEnabled){const comp=column?this.createBean(new FilterWrapperComp(column,"COLUMN_MENU")):void 0;if(this.activeMenu=comp,!(null==comp?void 0:comp.hasFilter())||!column)throw new Error("AG Grid - unable to show popup filter, filter instantiation failed");const eMenu=document.createElement("div");let hidePopup;setAriaRole(eMenu,"presentation"),eMenu.classList.add("ag-menu"),isLegacyMenuEnabled||eMenu.classList.add("ag-filter-menu"),this.tabListener=this.addManagedListener(eMenu,"keydown",e=>this.trapFocusWithin(e,eMenu)),eMenu.appendChild(null==comp?void 0:comp.getGui());const anchorToElement=this.menuService.isColumnMenuAnchoringEnabled()?null!=eventSource?eventSource:this.ctrlsService.getGridBodyCtrl().getGui():void 0,translate=this.localeService.getLocaleTextFunc(),ariaLabel=isLegacyMenuEnabled&&"columnFilter"!==containerType?translate("ariaLabelColumnMenu","Column Menu"):translate("ariaLabelColumnFilter","Column Filter"),addPopupRes=this.popupService.addPopup({modal:!0,eChild:eMenu,closeOnEsc:!0,closedCallback:e=>{column.setMenuVisible(!1,"contextMenu");const isKeyboardEvent=e instanceof KeyboardEvent;if(this.tabListener&&(this.tabListener=this.tabListener()),isKeyboardEvent&&eventSource&&isVisible(eventSource)){const focusableEl=this.focusService.findTabbableParent(eventSource);focusableEl&&focusableEl.focus()}null==comp||comp.afterGuiDetached(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,containerType,column)},positionCallback:()=>positionCallback(eMenu),anchorToElement,ariaLabel});addPopupRes&&(this.hidePopup=hidePopup=addPopupRes.hideFunc),comp.afterInit().then(()=>{positionCallback(eMenu),comp.afterGuiAttached({container:containerType,hidePopup})}),column.setMenuVisible(!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,containerType,column)}trapFocusWithin(e,menu){e.key!==KeyCode.TAB||e.defaultPrevented||this.focusService.findNextFocusableElement(menu,!1,e.shiftKey)||(e.preventDefault(),this.focusService.focusInto(menu,e.shiftKey))}dispatchVisibleChangedEvent(visible,containerType,column){const displayedEvent={type:Events.EVENT_COLUMN_MENU_VISIBLE_CHANGED,visible,switchingTab:!1,key:containerType,column:null!=column?column:null};this.eventService.dispatchEvent(displayedEvent)}isMenuEnabled(column){var _a;return column.isFilterAllowed()&&(null!=(_a=column.getColDef().menuTabs)?_a:["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}};__decorateClass([Autowired("filterManager")],StandardMenuFactory.prototype,"filterManager",2),__decorateClass([Autowired("popupService")],StandardMenuFactory.prototype,"popupService",2),__decorateClass([Autowired("focusService")],StandardMenuFactory.prototype,"focusService",2),__decorateClass([Autowired("ctrlsService")],StandardMenuFactory.prototype,"ctrlsService",2),__decorateClass([Autowired("menuService")],StandardMenuFactory.prototype,"menuService",2),StandardMenuFactory=__decorateClass([Bean("filterMenuFactory")],StandardMenuFactory);var TabGuardCtrl=class extends BeanStub{constructor(params){super(),this.skipTabGuardFocus=!1,this.forcingFocusOut=!1;const{comp,eTopGuard,eBottomGuard,focusTrapActive,forceFocusOutWhenTabGuardsAreEmpty,focusInnerElement,onFocusIn,onFocusOut,shouldStopEventPropagation,onTabKeyDown,handleKeyDown,eFocusableElement}=params;this.comp=comp,this.eTopGuard=eTopGuard,this.eBottomGuard=eBottomGuard,this.providedFocusInnerElement=focusInnerElement,this.eFocusableElement=eFocusableElement,this.focusTrapActive=!!focusTrapActive,this.forceFocusOutWhenTabGuardsAreEmpty=!!forceFocusOutWhenTabGuardsAreEmpty,this.providedFocusIn=onFocusIn,this.providedFocusOut=onFocusOut,this.providedShouldStopEventPropagation=shouldStopEventPropagation,this.providedOnTabKeyDown=onTabKeyDown,this.providedHandleKeyDown=handleKeyDown}postConstruct(){this.createManagedBean(new ManagedFocusFeature(this.eFocusableElement,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(guard=>this.addManagedListener(guard,"focus",this.onFocus.bind(this)))}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()}activateTabGuards(){if(this.forcingFocusOut)return;const tabIndex=this.gos.get("tabIndex");this.comp.setTabIndex(tabIndex.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.skipTabGuardFocus)return void(this.skipTabGuardFocus=!1);if(this.forceFocusOutWhenTabGuardsAreEmpty){if(0===this.focusService.findFocusableElements(this.eFocusableElement,".ag-tab-guard").length)return void this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}const fromBottom=e.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(fromBottom):this.focusInnerElement(fromBottom)}findNextElementOutsideAndFocus(up){const eDocument=this.gos.getDocument(),focusableEls=this.focusService.findFocusableElements(eDocument.body,null,!0),index=focusableEls.indexOf(up?this.eTopGuard:this.eBottomGuard);if(-1===index)return;let start,end;up?(start=0,end=index):(start=index+1,end=focusableEls.length);const focusableRange=focusableEls.slice(start,end),targetTabIndex=this.gos.get("tabIndex");focusableRange.sort((a,b)=>{const indexA=parseInt(a.getAttribute("tabindex")||"0"),indexB=parseInt(b.getAttribute("tabindex")||"0");return indexB===targetTabIndex?1:indexA===targetTabIndex?-1:0===indexA?1:0===indexB?-1:indexA-indexB}),focusableRange[up?focusableRange.length-1:0].focus()}onFocusIn(e){this.focusTrapActive||(this.providedFocusIn&&this.providedFocusIn(e),this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown)return void this.providedOnTabKeyDown(e);if(this.focusTrapActive)return;if(e.defaultPrevented)return;const tabGuardsAreActive=this.tabGuardsAreActive();tabGuardsAreActive&&this.deactivateTabGuards();const nextRoot=this.getNextFocusableElement(e.shiftKey);tabGuardsAreActive&&setTimeout(()=>this.activateTabGuards(),0),nextRoot&&(nextRoot.focus(),e.preventDefault())}focusInnerElement(fromBottom=!1){const focusable=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(focusable.splice(0,1),focusable.splice(focusable.length-1,1)),focusable.length&&focusable[fromBottom?focusable.length-1:0].focus({preventScroll:!0})}getNextFocusableElement(backwards){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,backwards)}forceFocusOutOfContainer(up=!1){if(this.forcingFocusOut)return;const tabGuardToFocus=up?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,tabGuardToFocus.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(element){return element===this.eTopGuard||element===this.eBottomGuard}};__decorateClass([Autowired("focusService")],TabGuardCtrl.prototype,"focusService",2),__decorateClass([PostConstruct],TabGuardCtrl.prototype,"postConstruct",1);var TabGuardComp=class extends Component{initialiseTabGuard(params){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();const tabGuards=[this.eTopGuard,this.eBottomGuard],compProxy={setTabIndex:tabIndex=>{tabGuards.forEach(tabGuard=>null!=tabIndex?tabGuard.setAttribute("tabindex",tabIndex):tabGuard.removeAttribute("tabindex"))}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new TabGuardCtrl({comp:compProxy,focusTrapActive:!!params.focusTrapActive,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:params.onFocusIn,onFocusOut:params.onFocusOut,focusInnerElement:params.focusInnerElement,handleKeyDown:params.handleKeyDown,onTabKeyDown:params.onTabKeyDown,shouldStopEventPropagation:params.shouldStopEventPropagation,forceFocusOutWhenTabGuardsAreEmpty:params.forceFocusOutWhenTabGuardsAreEmpty}))}createTabGuard(side){const tabGuard=document.createElement("div"),cls="top"===side?"ag-tab-guard-top":"ag-tab-guard-bottom";return tabGuard.classList.add("ag-tab-guard",cls),setAriaRole(tabGuard,"presentation"),tabGuard}addTabGuards(topTabGuard,bottomTabGuard){this.eFocusableElement.insertAdjacentElement("afterbegin",topTabGuard),this.eFocusableElement.insertAdjacentElement("beforeend",bottomTabGuard)}removeAllChildrenExceptTabGuards(){const tabGuards=[this.eTopGuard,this.eBottomGuard];clearElement(this.getFocusableElement()),this.addTabGuards(...tabGuards)}forceFocusOutOfContainer(up=!1){this.tabGuardCtrl.forceFocusOutOfContainer(up)}appendChild(newChild,container){isNodeOrElement(newChild)||(newChild=newChild.getGui());const{eBottomGuard:bottomTabGuard}=this;bottomTabGuard?bottomTabGuard.insertAdjacentElement("beforebegin",newChild):super.appendChild(newChild,container)}},_TabbedLayout=class _TabbedLayout extends TabGuardComp{constructor(params){super(_TabbedLayout.getTemplate(params.cssClass)),this.items=[],this.tabbedItemScrollMap=new Map,this.params=params}postConstruct(){this.setupHeader(),this.params.items&&this.params.items.forEach(item=>this.addItem(item)),this.initialiseTabGuard({onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),focusInnerElement:this.focusInnerElement.bind(this),focusTrapActive:!0}),this.addDestroyFunc(()=>{var _a,_b,_c;return null==(_c=null==(_b=null==(_a=this.activeItem)?void 0:_a.tabbedItem)?void 0:_b.afterDetachedCallback)?void 0:_c.call(_b)})}static getTemplate(cssClass){return`<div class="ag-tabs ${cssClass}">\n            <div ref="eHeader"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body ${cssClass?`${cssClass}-body`:""}"></div>\n        </div>`}setupHeader(){const{enableCloseButton,cssClass}=this.params,addCssClasses=(el,suffix)=>{el.classList.add(`ag-tabs-${suffix}`),cssClass&&el.classList.add(`${cssClass}-${suffix}`)};enableCloseButton?(this.setupCloseButton(addCssClasses),this.eTabHeader=this.gos.getDocument().createElement("div"),addCssClasses(this.eHeader,"header-wrapper"),setAriaRole(this.eHeader,"presentation"),this.eHeader.appendChild(this.eTabHeader)):this.eTabHeader=this.eHeader,setAriaRole(this.eTabHeader,"tablist"),addCssClasses(this.eTabHeader,"header")}setupCloseButton(addCssClasses){const eDocument=this.gos.getDocument(),eCloseButton=eDocument.createElement("button");addCssClasses(eCloseButton,"close-button");const eIcon=createIconNoSpan("close",this.gos,void 0,!0);setAriaLabel(eCloseButton,this.params.closeButtonAriaLabel),eCloseButton.appendChild(eIcon),this.addManagedListener(eCloseButton,"click",()=>{var _a,_b;return null==(_b=(_a=this.params).onCloseClicked)?void 0:_b.call(_a)});const eCloseButtonWrapper=eDocument.createElement("div");addCssClasses(eCloseButtonWrapper,"close-button-wrapper"),setAriaRole(eCloseButtonWrapper,"presentation"),eCloseButtonWrapper.appendChild(eCloseButton),this.eHeader.appendChild(eCloseButtonWrapper),this.eCloseButton=eCloseButton}handleKeyDown(e){switch(e.key){case KeyCode.RIGHT:case KeyCode.LEFT:if(!this.eTabHeader.contains(this.gos.getActiveDomElement()))return;const isRightKey=e.key===KeyCode.RIGHT,isRtl=this.gos.get("enableRtl"),currentPosition=this.items.indexOf(this.activeItem),nextPosition=isRightKey!==isRtl?Math.min(currentPosition+1,this.items.length-1):Math.max(currentPosition-1,0);if(currentPosition===nextPosition)return;e.preventDefault();const nextItem=this.items[nextPosition];this.showItemWrapper(nextItem),nextItem.eHeaderButton.focus();break;case KeyCode.UP:case KeyCode.DOWN:e.stopPropagation()}}onTabKeyDown(e){var _a,_b,_c,_d;if(e.defaultPrevented)return;const{focusService,eHeader,eBody,activeItem,params}=this,{suppressTrapFocus,enableCloseButton}=params,activeElement=this.gos.getActiveDomElement(),target=e.target,backwards=e.shiftKey;if(eHeader.contains(activeElement))return e.preventDefault(),void(enableCloseButton&&backwards&&!(null==(_a=this.eCloseButton)?void 0:_a.contains(activeElement))?null==(_b=this.eCloseButton)||_b.focus():suppressTrapFocus&&backwards?null==(_c=this.focusService.findFocusableElementBeforeTabGuard(this.gos.getDocument().body,target))||_c.focus():this.focusBody(e.shiftKey));let nextEl=null;if(focusService.isTargetUnderManagedComponent(eBody,target)&&(backwards&&(nextEl=this.focusService.findFocusableElementBeforeTabGuard(eBody,target)),nextEl||suppressTrapFocus||(nextEl=activeItem.eHeaderButton)),!nextEl&&eBody.contains(activeElement)&&(nextEl=focusService.findNextFocusableElement(eBody,!1,backwards),!nextEl))return e.preventDefault(),void(suppressTrapFocus&&!backwards?this.forceFocusOutOfContainer(backwards):enableCloseButton&&!backwards?null==(_d=this.eCloseButton)||_d.focus():this.focusHeader());nextEl&&(e.preventDefault(),nextEl.focus())}focusInnerElement(fromBottom){fromBottom?this.focusHeader():this.focusBody(!0)}focusHeader(preventScroll){this.activeItem.eHeaderButton.focus({preventScroll})}focusBody(fromBottom){this.focusService.focusInto(this.eBody,fromBottom)}setAfterAttachedParams(params){this.afterAttachedParams=params}showFirstItem(){this.items.length>0&&this.showItemWrapper(this.items[0])}addItem(item){const eHeaderButton=document.createElement("span");setAriaRole(eHeaderButton,"tab"),eHeaderButton.setAttribute("tabindex","-1"),eHeaderButton.appendChild(item.title),eHeaderButton.classList.add("ag-tab"),this.eTabHeader.appendChild(eHeaderButton),setAriaLabel(eHeaderButton,item.titleLabel);const wrapper={tabbedItem:item,eHeaderButton};this.items.push(wrapper),eHeaderButton.addEventListener("click",this.showItemWrapper.bind(this,wrapper))}showItem(tabbedItem){const itemWrapper=this.items.find(wrapper=>wrapper.tabbedItem===tabbedItem);itemWrapper&&this.showItemWrapper(itemWrapper)}showItemWrapper(wrapper){var _a,_b,_c,_d,_e,_f;const{tabbedItem,eHeaderButton}=wrapper;null==(_b=(_a=this.params).onItemClicked)||_b.call(_a,{item:tabbedItem}),this.activeItem!==wrapper?(this.lastScrollListener&&(this.lastScrollListener=this.lastScrollListener()),clearElement(this.eBody),tabbedItem.bodyPromise.then(body=>{this.eBody.appendChild(body);const onlyUnmanaged=!this.focusService.isKeyboardMode();if(this.params.suppressFocusBodyOnOpen||this.focusService.focusInto(this.eBody,!1,onlyUnmanaged),tabbedItem.afterAttachedCallback&&tabbedItem.afterAttachedCallback(this.afterAttachedParams),this.params.keepScrollPosition){const scrollableContainer=tabbedItem.getScrollableContainer&&tabbedItem.getScrollableContainer()||body;this.lastScrollListener=this.addManagedListener(scrollableContainer,"scroll",()=>{this.tabbedItemScrollMap.set(tabbedItem.name,scrollableContainer.scrollTop)});const scrollPosition=this.tabbedItemScrollMap.get(tabbedItem.name);void 0!==scrollPosition&&setTimeout(()=>{scrollableContainer.scrollTop=scrollPosition},0)}}),this.activeItem&&(this.activeItem.eHeaderButton.classList.remove("ag-tab-selected"),null==(_f=(_e=this.activeItem.tabbedItem).afterDetachedCallback)||_f.call(_e)),eHeaderButton.classList.add("ag-tab-selected"),this.activeItem=wrapper):null==(_d=(_c=this.params).onActiveItemClicked)||_d.call(_c)}};__decorateClass([Autowired("focusService")],_TabbedLayout.prototype,"focusService",2),__decorateClass([RefSelector("eHeader")],_TabbedLayout.prototype,"eHeader",2),__decorateClass([RefSelector("eBody")],_TabbedLayout.prototype,"eBody",2),__decorateClass([PostConstruct],_TabbedLayout.prototype,"postConstruct",1);var ResizeObserverService=class extends BeanStub{constructor(){super(...arguments),this.polyfillFunctions=[]}observeResize(element,callback){const win=this.gos.getWindow(),usePolyfill=()=>{var _a,_b;let widthLastTime=null!=(_a=null==element?void 0:element.clientWidth)?_a:0,heightLastTime=null!=(_b=null==element?void 0:element.clientHeight)?_b:0,running=!0;const periodicallyCheckWidthAndHeight=()=>{var _a2,_b2;if(running){const newWidth=null!=(_a2=null==element?void 0:element.clientWidth)?_a2:0,newHeight=null!=(_b2=null==element?void 0:element.clientHeight)?_b2:0;(newWidth!==widthLastTime||newHeight!==heightLastTime)&&(widthLastTime=newWidth,heightLastTime=newHeight,callback()),this.doNextPolyfillTurn(periodicallyCheckWidthAndHeight)}};return periodicallyCheckWidthAndHeight(),()=>running=!1},suppressResize=this.gos.get("suppressBrowserResizeObserver");return!!win.ResizeObserver&&!suppressResize?(()=>{const resizeObserver=new win.ResizeObserver(callback);return resizeObserver.observe(element),()=>resizeObserver.disconnect()})():this.getFrameworkOverrides().wrapIncoming(()=>usePolyfill(),"resize-observer")}doNextPolyfillTurn(func){this.polyfillFunctions.push(func),this.schedulePolyfill()}schedulePolyfill(){if(this.polyfillScheduled)return;this.polyfillScheduled=!0,window.setTimeout(()=>{const funcs=this.polyfillFunctions;this.polyfillScheduled=!1,this.polyfillFunctions=[],funcs.forEach(f=>f())},50)}};ResizeObserverService=__decorateClass([Bean("resizeObserverService")],ResizeObserverService);var AnimationFrameService=class extends BeanStub{constructor(){super(...arguments),this.createTasksP1={list:[],sorted:!1},this.createTasksP2={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastPage=0,this.lastScrollTop=0,this.taskCount=0,this.cancelledTasks=new Set}setScrollTop(scrollTop){const isPaginationActive=this.gos.get("pagination");if(this.scrollGoingDown=scrollTop>=this.lastScrollTop,isPaginationActive&&0===scrollTop){const currentPage=this.paginationProxy.getCurrentPage();currentPage!==this.lastPage&&(this.lastPage=currentPage,this.scrollGoingDown=!0)}this.lastScrollTop=scrollTop}init(){this.useAnimationFrame=!this.gos.get("suppressAnimationFrame")}isOn(){return this.useAnimationFrame}verifyAnimationFrameOn(methodName){!1===this.useAnimationFrame&&console.warn(`AG Grid: AnimationFrameService.${methodName} called but animation frames are off`)}createTask(task,index,list){this.verifyAnimationFrameOn(list);const taskItem={task,index,createOrder:++this.taskCount};this.addTaskToList(this[list],taskItem),this.schedule()}cancelTask(task){this.cancelledTasks.add(task)}addTaskToList(taskList,task){taskList.list.push(task),taskList.sorted=!1}sortTaskList(taskList){if(taskList.sorted)return;const sortDirection=this.scrollGoingDown?1:-1;taskList.list.sort((a,b)=>a.index!==b.index?sortDirection*(b.index-a.index):b.createOrder-a.createOrder),taskList.sorted=!0}addDestroyTask(task){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(task),this.schedule()}executeFrame(millis){this.verifyAnimationFrameOn("executeFrame");const p1TaskList=this.createTasksP1,p1Tasks=p1TaskList.list,p2TaskList=this.createTasksP2,p2Tasks=p2TaskList.list,destroyTasks=this.destroyTasks,frameStart=(new Date).getTime();let duration=(new Date).getTime()-frameStart;const noMaxMillis=millis<=0,gridBodyCon=this.ctrlsService.getGridBodyCtrl();for(;noMaxMillis||duration<millis;){if(!gridBodyCon.getScrollFeature().scrollGridIfNeeded()){let task;if(p1Tasks.length)this.sortTaskList(p1TaskList),task=p1Tasks.pop().task;else if(p2Tasks.length)this.sortTaskList(p2TaskList),task=p2Tasks.pop().task;else{if(!destroyTasks.length){this.cancelledTasks.clear();break}task=destroyTasks.pop()}this.cancelledTasks.has(task)||task()}duration=(new Date).getTime()-frameStart}p1Tasks.length||p2Tasks.length||destroyTasks.length?this.requestFrame():this.stopTicking()}stopTicking(){this.ticking=!1}flushAllFrames(){this.useAnimationFrame&&this.executeFrame(-1)}schedule(){this.useAnimationFrame&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const callback=this.executeFrame.bind(this,60);this.requestAnimationFrame(callback)}requestAnimationFrame(callback){const win=this.gos.getWindow();win.requestAnimationFrame?win.requestAnimationFrame(callback):win.webkitRequestAnimationFrame?win.webkitRequestAnimationFrame(callback):win.setTimeout(callback,0)}isQueueEmpty(){return!this.ticking}debounce(func){let pending=!1;return()=>{this.isOn()?pending||(pending=!0,this.addDestroyTask(()=>{pending=!1,func()})):window.setTimeout(func,0)}}};__decorateClass([Autowired("ctrlsService")],AnimationFrameService.prototype,"ctrlsService",2),__decorateClass([Autowired("paginationProxy")],AnimationFrameService.prototype,"paginationProxy",2),__decorateClass([PostConstruct],AnimationFrameService.prototype,"init",1),AnimationFrameService=__decorateClass([Bean("animationFrameService")],AnimationFrameService);var ExpansionService=class extends BeanStub{postConstruct(){this.isClientSideRowModel="clientSide"===this.rowModel.getType()}expandRows(rowIds){if(!this.isClientSideRowModel)return;const rowIdSet=new Set(rowIds);this.rowModel.forEachNode(node=>{node.id&&rowIdSet.has(node.id)&&(node.expanded=!0)}),this.onGroupExpandedOrCollapsed()}getExpandedRows(){const expandedRows=[];return this.rowModel.forEachNode(({expanded,id})=>{expanded&&id&&expandedRows.push(id)}),expandedRows}expandAll(value){this.isClientSideRowModel&&this.rowModel.expandOrCollapseAll(value)}setRowNodeExpanded(rowNode,expanded,expandParents,forceSync){rowNode&&(expandParents&&rowNode.parent&&-1!==rowNode.parent.level&&this.setRowNodeExpanded(rowNode.parent,expanded,expandParents,forceSync),rowNode.setExpanded(expanded,void 0,forceSync))}onGroupExpandedOrCollapsed(){this.isClientSideRowModel&&this.rowModel.refreshModel({step:"map"})}};__decorateClass([Autowired("rowModel")],ExpansionService.prototype,"rowModel",2),__decorateClass([PostConstruct],ExpansionService.prototype,"postConstruct",1),ExpansionService=__decorateClass([Bean("expansionService")],ExpansionService);var MenuService=class extends BeanStub{postConstruct(){var _a;this.activeMenuFactory=null!=(_a=this.enterpriseMenuFactory)?_a:this.filterMenuFactory}showColumnMenu(params){this.showColumnMenuCommon(this.activeMenuFactory,params,"columnMenu")}showFilterMenu(params){const menuFactory=this.enterpriseMenuFactory&&this.isLegacyMenuEnabled()?this.enterpriseMenuFactory:this.filterMenuFactory;this.showColumnMenuCommon(menuFactory,params,params.containerType,!0)}showHeaderContextMenu(column,mouseEvent,touchEvent){this.activeMenuFactory.showMenuAfterContextMenuEvent(column,mouseEvent,touchEvent)}getContextMenuPosition(rowNode,column){const rowCtrl=this.getRowCtrl(rowNode),eGui=this.getCellGui(rowCtrl,column);if(!eGui)return rowCtrl?{x:0,y:rowCtrl.getRowYPosition()}:{x:0,y:0};const rect=eGui.getBoundingClientRect();return{x:rect.x+rect.width/2,y:rect.y+rect.height/2}}showContextMenu(params){var _a,_b,_c;const{column,rowNode}=params;let{anchorToElement,value}=params;rowNode&&column&&null==value&&(value=rowNode.getValueFromValueService(column)),null==anchorToElement&&(anchorToElement=this.getContextMenuAnchorElement(rowNode,column)),null==(_c=this.contextMenuFactory)||_c.onContextMenu(null!=(_a=params.mouseEvent)?_a:null,null!=(_b=params.touchEvent)?_b:null,null!=rowNode?rowNode:null,null!=column?column:null,value,anchorToElement)}showColumnChooser(params){var _a;null==(_a=this.columnChooserFactory)||_a.showColumnChooser(params)}hidePopupMenu(){var _a;null==(_a=this.contextMenuFactory)||_a.hideActiveMenu(),this.activeMenuFactory.hideActiveMenu()}hideColumnChooser(){var _a;null==(_a=this.columnChooserFactory)||_a.hideActiveColumnChooser()}isColumnMenuInHeaderEnabled(column){const{suppressMenu,suppressHeaderMenuButton}=column.getColDef();return!(null!=suppressHeaderMenuButton?suppressHeaderMenuButton:suppressMenu)&&this.activeMenuFactory.isMenuEnabled(column)&&(this.isLegacyMenuEnabled()||!!this.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(column){return!column.getColDef().suppressHeaderFilterButton&&this.filterManager.isFilterAllowed(column)}isHeaderContextMenuEnabled(column){return!(null==column?void 0:column.getColDef().suppressHeaderContextMenu)&&"new"===this.getColumnMenuType()}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const menuHides=!this.isSuppressMenuHide();return!(isIOSUserAgent()&&menuHides)}isHeaderFilterButtonEnabled(column){return this.isFilterMenuInHeaderEnabled(column)&&!this.isLegacyMenuEnabled()&&!this.isFloatingFilterButtonDisplayed(column)}isFilterMenuItemEnabled(column){return this.filterManager.isFilterAllowed(column)&&!this.isLegacyMenuEnabled()&&!this.isFilterMenuInHeaderEnabled(column)&&!this.isFloatingFilterButtonDisplayed(column)}isColumnMenuAnchoringEnabled(){return!this.isLegacyMenuEnabled()}areAdditionalColumnMenuItemsEnabled(){return"new"===this.getColumnMenuType()}isLegacyMenuEnabled(){return"legacy"===this.getColumnMenuType()}isFloatingFilterButtonEnabled(column){var _a;const colDef=column.getColDef(),legacySuppressFilterButton=null==(_a=colDef.floatingFilterComponentParams)?void 0:_a.suppressFilterButton;return null!=legacySuppressFilterButton&&warnOnce("As of v31.1, 'colDef.floatingFilterComponentParams.suppressFilterButton' is deprecated. Use 'colDef.suppressFloatingFilterButton' instead."),null==colDef.suppressFloatingFilterButton?!legacySuppressFilterButton:!colDef.suppressFloatingFilterButton}getColumnMenuType(){var _a;return null!=(_a=this.gos.get("columnMenu"))?_a:"legacy"}isFloatingFilterButtonDisplayed(column){return!!column.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(column)}isSuppressMenuHide(){const suppressMenuHide=this.gos.get("suppressMenuHide");return this.isLegacyMenuEnabled()?suppressMenuHide:!this.gos.exists("suppressMenuHide")||suppressMenuHide}showColumnMenuCommon(menuFactory,params,containerType,filtersOnly){const{column,positionBy}=params;if("button"===positionBy){const{buttonElement}=params;menuFactory.showMenuAfterButtonClick(column,buttonElement,containerType,filtersOnly)}else if("mouse"===positionBy){const{mouseEvent}=params;menuFactory.showMenuAfterMouseEvent(column,mouseEvent,containerType,filtersOnly)}else column&&(this.ctrlsService.getGridBodyCtrl().getScrollFeature().ensureColumnVisible(column,"auto"),this.animationFrameService.requestAnimationFrame(()=>{const headerCellCtrl=this.ctrlsService.getHeaderRowContainerCtrl(column.getPinned()).getHeaderCtrlForColumn(column);menuFactory.showMenuAfterButtonClick(column,headerCellCtrl.getAnchorElementForMenu(filtersOnly),containerType,!0)}))}getRowCtrl(rowNode){const{rowIndex,rowPinned}=rowNode||{};if(null!=rowIndex)return this.rowRenderer.getRowByPosition({rowIndex,rowPinned})||void 0}getCellGui(rowCtrl,column){if(!rowCtrl||!column)return;const cellCtrl=rowCtrl.getCellCtrl(column);return(null==cellCtrl?void 0:cellCtrl.getGui())||void 0}getContextMenuAnchorElement(rowNode,column){const gridBodyEl=this.ctrlsService.getGridBodyCtrl().getGridBodyElement(),rowCtrl=this.getRowCtrl(rowNode);if(!rowCtrl)return gridBodyEl;const cellGui=this.getCellGui(rowCtrl,column);return cellGui||(rowCtrl.isFullWidth()?rowCtrl.getFullWidthElement():gridBodyEl)}};__decorateClass([Autowired("filterMenuFactory")],MenuService.prototype,"filterMenuFactory",2),__decorateClass([Autowired("ctrlsService")],MenuService.prototype,"ctrlsService",2),__decorateClass([Autowired("animationFrameService")],MenuService.prototype,"animationFrameService",2),__decorateClass([Autowired("filterManager")],MenuService.prototype,"filterManager",2),__decorateClass([Autowired("rowRenderer")],MenuService.prototype,"rowRenderer",2),__decorateClass([Optional("columnChooserFactory")],MenuService.prototype,"columnChooserFactory",2),__decorateClass([Optional("contextMenuFactory")],MenuService.prototype,"contextMenuFactory",2),__decorateClass([Optional("enterpriseMenuFactory")],MenuService.prototype,"enterpriseMenuFactory",2),__decorateClass([PostConstruct],MenuService.prototype,"postConstruct",1),MenuService=__decorateClass([Bean("menuService")],MenuService);var AutoWidthCalculator=class extends BeanStub{postConstruct(){this.ctrlsService.whenReady(p=>{this.centerRowContainerCtrl=p.center})}getPreferredWidthForColumn(column,skipHeader){const eHeaderCell=this.getHeaderCellForColumn(column);if(!eHeaderCell)return-1;const elements=this.rowRenderer.getAllCellsForColumn(column);return skipHeader||elements.push(eHeaderCell),this.addElementsToContainerAndGetWidth(elements)}getPreferredWidthForColumnGroup(columnGroup){const eHeaderCell=this.getHeaderCellForColumn(columnGroup);return eHeaderCell?this.addElementsToContainerAndGetWidth([eHeaderCell]):-1}addElementsToContainerAndGetWidth(elements){const eDummyContainer=document.createElement("form");eDummyContainer.style.position="fixed";const eBodyContainer=this.centerRowContainerCtrl.getContainerElement();elements.forEach(el=>this.cloneItemIntoDummy(el,eDummyContainer)),eBodyContainer.appendChild(eDummyContainer);const dummyContainerWidth=eDummyContainer.offsetWidth;eBodyContainer.removeChild(eDummyContainer);return dummyContainerWidth+this.getAutoSizePadding()}getAutoSizePadding(){return this.gos.get("autoSizePadding")}getHeaderCellForColumn(column){let element=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(container=>{const res=container.getHtmlElementForColumnHeader(column);null!=res&&(element=res)}),element}cloneItemIntoDummy(eCell,eDummyContainer){const eCellClone=eCell.cloneNode(!0);eCellClone.style.width="",eCellClone.style.position="static",eCellClone.style.left="";const eCloneParent=document.createElement("div"),eCloneParentClassList=eCloneParent.classList;["ag-header-cell","ag-header-group-cell"].some(cls=>eCellClone.classList.contains(cls))?(eCloneParentClassList.add("ag-header","ag-header-row"),eCloneParent.style.position="static"):eCloneParentClassList.add("ag-row");let pointer=eCell.parentElement;for(;pointer;){if(["ag-header-row","ag-row"].some(cls=>pointer.classList.contains(cls))){for(let i=0;i<pointer.classList.length;i++){const item=pointer.classList[i];"ag-row-position-absolute"!=item&&eCloneParentClassList.add(item)}break}pointer=pointer.parentElement}eCloneParent.appendChild(eCellClone),eDummyContainer.appendChild(eCloneParent)}};__decorateClass([Autowired("rowRenderer")],AutoWidthCalculator.prototype,"rowRenderer",2),__decorateClass([Autowired("ctrlsService")],AutoWidthCalculator.prototype,"ctrlsService",2),__decorateClass([Autowired("rowCssClassCalculator")],AutoWidthCalculator.prototype,"rowCssClassCalculator",2),__decorateClass([PostConstruct],AutoWidthCalculator.prototype,"postConstruct",1),AutoWidthCalculator=__decorateClass([Bean("autoWidthCalculator")],AutoWidthCalculator);var StickyRowFeature=class extends BeanStub{constructor(createRowCon,destroyRowCtrls){super(),this.createRowCon=createRowCon,this.destroyRowCtrls=destroyRowCtrls,this.stickyTopRowCtrls=[],this.stickyBottomRowCtrls=[],this.topContainerHeight=0,this.bottomContainerHeight=0}postConstruct(){this.isClientSide="clientSide"===this.rowModel.getType(),this.ctrlsService.whenReady(params=>{this.gridBodyCtrl=params.gridBodyCtrl})}getStickyTopRowCtrls(){return this.stickyTopRowCtrls}getStickyBottomRowCtrls(){return this.stickyBottomRowCtrls}getLastPixelOfGroup(row){return this.isClientSide?this.getClientSideLastPixelOfGroup(row):this.getServerSideLastPixelOfGroup(row)}getFirstPixelOfGroup(row){return row.footer?row.sibling.rowTop+row.sibling.rowHeight-1:row.hasChildren()?row.rowTop-1:0}getServerSideLastPixelOfGroup(row){var _a,_b,_c,_d;if(this.isClientSide)throw new Error("This func should only be called in server side row model.");if(row.isExpandable()||row.footer){if(row.master)return row.detailNode.rowTop+row.detailNode.rowHeight;if(!row.sibling||1===Math.abs(row.sibling.rowIndex-row.rowIndex)){let storeBounds=null==(_a=row.childStore)?void 0:_a.getStoreBounds();return row.footer&&(storeBounds=null==(_b=row.sibling.childStore)?void 0:_b.getStoreBounds()),(null!=(_c=null==storeBounds?void 0:storeBounds.heightPx)?_c:0)+(null!=(_d=null==storeBounds?void 0:storeBounds.topPx)?_d:0)}return row.footer?row.rowTop+row.rowHeight:row.sibling.rowTop+row.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}getClientSideLastPixelOfGroup(row){if(!this.isClientSide)throw new Error("This func should only be called in client side row model.");if(row.isExpandable()||row.footer){const grandTotalAtTop=row.footer&&0===row.rowIndex,noOrContiguousSiblings=!row.sibling||1===Math.abs(row.sibling.rowIndex-row.rowIndex);if(grandTotalAtTop||noOrContiguousSiblings){let lastAncestor=row.footer?row.sibling:row;for(;lastAncestor.isExpandable()&&lastAncestor.expanded;)if(lastAncestor.master)lastAncestor=lastAncestor.detailNode;else if(lastAncestor.childrenAfterSort){if(0===lastAncestor.childrenAfterSort.length)break;lastAncestor=last(lastAncestor.childrenAfterSort)}return lastAncestor.rowTop+lastAncestor.rowHeight}return row.footer?row.rowTop+row.rowHeight:row.sibling.rowTop+row.sibling.rowHeight}return Number.MAX_SAFE_INTEGER}updateStickyRows(container){const isTop="top"===container;let newStickyContainerHeight=0;if(!this.canRowsBeSticky())return this.refreshNodesAndContainerHeight(container,new Set,newStickyContainerHeight);const pixelAtContainerBoundary=isTop?this.rowRenderer.getFirstVisibleVerticalPixel():this.rowRenderer.getLastVisibleVerticalPixel(),newStickyRows=new Set,addStickyRow=stickyRow=>{if(newStickyRows.add(stickyRow),isTop){const lastChildBottom=this.getLastPixelOfGroup(stickyRow),stickRowBottom=pixelAtContainerBoundary+newStickyContainerHeight+stickyRow.rowHeight;stickyRow.stickyRowTop=lastChildBottom<stickRowBottom?newStickyContainerHeight+(lastChildBottom-stickRowBottom):newStickyContainerHeight}else{const lastChildBottom=this.getFirstPixelOfGroup(stickyRow),stickRowTop=pixelAtContainerBoundary-(newStickyContainerHeight+stickyRow.rowHeight);stickyRow.stickyRowTop=lastChildBottom>stickRowTop?newStickyContainerHeight-(lastChildBottom-stickRowTop):newStickyContainerHeight}newStickyContainerHeight=0,newStickyRows.forEach(rowNode=>{const thisRowLastPx=rowNode.stickyRowTop+rowNode.rowHeight;newStickyContainerHeight<thisRowLastPx&&(newStickyContainerHeight=thisRowLastPx)})},suppressFootersSticky=this.areFooterRowsStickySuppressed(),suppressGroupsSticky=this.gos.get("suppressGroupRowsSticky"),isRowSticky=row=>{if(!row.displayed)return!1;if(row.footer){if(!0===suppressFootersSticky)return!1;if("grand"===suppressFootersSticky&&-1===row.level)return!1;if("group"===suppressFootersSticky&&row.level>-1)return!1;return!newStickyRows.has(row)}if(row.isExpandable()){if(!0===suppressGroupsSticky)return!1;return!newStickyRows.has(row)&&row.expanded}return!1};for(let i=0;i<100;i++){let firstPixelAfterStickyRows=pixelAtContainerBoundary+newStickyContainerHeight;isTop||(firstPixelAfterStickyRows=pixelAtContainerBoundary-newStickyContainerHeight);const firstIndex=this.rowModel.getRowIndexAtPixel(firstPixelAfterStickyRows),firstRow=this.rowModel.getRow(firstIndex);if(null==firstRow)break;const firstMissingParent=this.getStickyAncestors(firstRow).find(parent=>(isTop?parent.rowIndex<firstIndex:parent.rowIndex>firstIndex)&&isRowSticky(parent));if(firstMissingParent){addStickyRow(firstMissingParent);continue}if(!(isTop?firstRow.rowTop<firstPixelAfterStickyRows:firstRow.rowTop+firstRow.rowHeight>firstPixelAfterStickyRows)||!isRowSticky(firstRow))break;addStickyRow(firstRow)}return isTop||newStickyRows.forEach(rowNode=>{rowNode.stickyRowTop=newStickyContainerHeight-(rowNode.stickyRowTop+rowNode.rowHeight)}),this.refreshNodesAndContainerHeight(container,newStickyRows,newStickyContainerHeight)}areFooterRowsStickySuppressed(){const suppressFootersSticky=this.gos.get("suppressStickyTotalRow");if(!0===suppressFootersSticky)return!0;const suppressGroupRows=!!this.gos.get("groupIncludeFooter")||"group"===suppressFootersSticky,suppressGrandRows=!!this.gos.get("groupIncludeTotalFooter")||"grand"===suppressFootersSticky;return!(!suppressGroupRows||!suppressGrandRows)||(suppressGrandRows?"grand":!!suppressGroupRows&&"group")}canRowsBeSticky(){const isStickyEnabled=this.gos.isGroupRowsSticky(),suppressFootersSticky=this.areFooterRowsStickySuppressed(),suppressGroupsSticky=this.gos.get("suppressGroupRowsSticky");return isStickyEnabled&&(!suppressFootersSticky||!suppressGroupsSticky)}getStickyAncestors(rowNode){const ancestors=[];let p=rowNode.footer?rowNode.sibling:rowNode.parent;for(;p;)p.sibling&&ancestors.push(p.sibling),ancestors.push(p),p=p.parent;return ancestors.reverse()}checkStickyRows(){const hasTopUpdated=this.updateStickyRows("top"),hasBottomUpdated=this.updateStickyRows("bottom");return hasTopUpdated||hasBottomUpdated}destroyStickyCtrls(){this.refreshNodesAndContainerHeight("top",new Set,0),this.refreshNodesAndContainerHeight("bottom",new Set,0)}refreshStickyNode(stickRowNode){const allStickyNodes=new Set;if(this.stickyTopRowCtrls.some(ctrl=>ctrl.getRowNode()===stickRowNode)){for(let i=0;i<this.stickyTopRowCtrls.length;i++){const currentNode=this.stickyTopRowCtrls[i].getRowNode();currentNode!==stickRowNode&&allStickyNodes.add(currentNode)}this.refreshNodesAndContainerHeight("top",allStickyNodes,this.topContainerHeight)&&this.checkStickyRows()}else{for(let i=0;i<this.stickyBottomRowCtrls.length;i++){const currentNode=this.stickyBottomRowCtrls[i].getRowNode();currentNode!==stickRowNode&&allStickyNodes.add(currentNode)}this.refreshNodesAndContainerHeight("bottom",allStickyNodes,this.bottomContainerHeight)&&this.checkStickyRows()}}refreshNodesAndContainerHeight(container,newStickyNodes,height){const isTop="top"===container,previousCtrls=isTop?this.stickyTopRowCtrls:this.stickyBottomRowCtrls,removedCtrlsMap={},remainingCtrls=[];for(let i=0;i<previousCtrls.length;i++){const node=previousCtrls[i].getRowNode();!newStickyNodes.has(node)?(removedCtrlsMap[node.id]=previousCtrls[i],node.sticky=!1):remainingCtrls.push(previousCtrls[i])}const existingNodes=new Set;for(let i=0;i<remainingCtrls.length;i++)existingNodes.add(remainingCtrls[i].getRowNode());const newCtrls=[];newStickyNodes.forEach(node=>{existingNodes.has(node)||(node.sticky=!0,newCtrls.push(this.createRowCon(node,!1,!1)))});let hasSomethingChanged=!!newCtrls.length||remainingCtrls.length!==previousCtrls.length;isTop?this.topContainerHeight!==height&&(this.topContainerHeight=height,this.gridBodyCtrl.setStickyTopHeight(height),hasSomethingChanged=!0):this.bottomContainerHeight!==height&&(this.bottomContainerHeight=height,this.gridBodyCtrl.setStickyBottomHeight(height),hasSomethingChanged=!0),this.destroyRowCtrls(removedCtrlsMap,!1);const newCtrlsList=[...remainingCtrls,...newCtrls];return newCtrlsList.sort((a,b)=>b.getRowNode().rowIndex-a.getRowNode().rowIndex),isTop||newCtrlsList.reverse(),newCtrlsList.forEach(ctrl=>ctrl.setRowTop(ctrl.getRowNode().stickyRowTop)),!!hasSomethingChanged&&(isTop?this.stickyTopRowCtrls=newCtrlsList:this.stickyBottomRowCtrls=newCtrlsList,!0)}};__decorateClass([Autowired("rowModel")],StickyRowFeature.prototype,"rowModel",2),__decorateClass([Autowired("rowRenderer")],StickyRowFeature.prototype,"rowRenderer",2),__decorateClass([Autowired("ctrlsService")],StickyRowFeature.prototype,"ctrlsService",2),__decorateClass([PostConstruct],StickyRowFeature.prototype,"postConstruct",1);var RowRenderer=class extends BeanStub{constructor(){super(...arguments),this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const onRangeSelectionChanged=()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onRangeSelectionChanged())},onColumnMovedPinnedVisible=()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.updateRangeBordersIfRangeCount())},addRangeSelectionListeners=()=>{this.eventService.addEventListener(Events.EVENT_RANGE_SELECTION_CHANGED,onRangeSelectionChanged),this.eventService.addEventListener(Events.EVENT_COLUMN_MOVED,onColumnMovedPinnedVisible),this.eventService.addEventListener(Events.EVENT_COLUMN_PINNED,onColumnMovedPinnedVisible),this.eventService.addEventListener(Events.EVENT_COLUMN_VISIBLE,onColumnMovedPinnedVisible)},removeRangeSelectionListeners=()=>{this.eventService.removeEventListener(Events.EVENT_RANGE_SELECTION_CHANGED,onRangeSelectionChanged),this.eventService.removeEventListener(Events.EVENT_COLUMN_MOVED,onColumnMovedPinnedVisible),this.eventService.removeEventListener(Events.EVENT_COLUMN_PINNED,onColumnMovedPinnedVisible),this.eventService.removeEventListener(Events.EVENT_COLUMN_VISIBLE,onColumnMovedPinnedVisible)};this.addDestroyFunc(()=>removeRangeSelectionListeners()),this.addManagedPropertyListener("enableRangeSelection",params=>{params.currentValue?addRangeSelectionListeners():removeRangeSelectionListeners()});this.gos.get("enableRangeSelection")&&addRangeSelectionListeners()}}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridBodyCtrl=p.gridBodyCtrl,this.initialise()})}initialise(){if(this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,this.onBodyScroll.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_BODY_HEIGHT_CHANGED,this.redraw.bind(this)),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListeners(["suppressCellFocus","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.gos.isGroupRowsSticky()){const rowModelType=this.rowModel.getType();"clientSide"!==rowModelType&&"serverSide"!==rowModelType||(this.stickyRowFeature=this.createManagedBean(new StickyRowFeature(this.createRowCon.bind(this),this.destroyRowCtrls.bind(this))))}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gos.isDomLayout("print"),this.embedFullWidthRows=this.printLayout||this.gos.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const countProp=this.getKeepDetailRowsCount(),count=null!=countProp?countProp:3;this.cachedRowCtrls=new RowCtrlCache(count)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyTopRowCtrls():[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?this.stickyRowFeature.getStickyBottomRowCtrls():[]}updateAllRowCtrls(){const liveList=getAllValuesInObject(this.rowCtrlsByRowIndex),zombieList=getAllValuesInObject(this.zombieRowCtrls),cachedList=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];zombieList.length>0||cachedList.length>0?this.allRowCtrls=[...liveList,...zombieList,...cachedList]:this.allRowCtrls=liveList}onCellFocusChanged(event){this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onCellFocused(event)),this.getFullWidthRowCtrls().forEach(rowCtrl=>rowCtrl.onFullWidthRowFocused(event))}registerCellEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_CELL_FOCUSED,event=>{this.onCellFocusChanged(event)}),this.addManagedListener(this.eventService,Events.EVENT_CELL_FOCUS_CLEARED,()=>{this.onCellFocusChanged()}),this.addManagedListener(this.eventService,Events.EVENT_FLASH_CELLS,event=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onFlashCells(event))}),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_HOVER_CHANGED,()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onColumnHover())}),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,()=>{this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onDisplayedColumnsChanged())}),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,()=>{this.printLayout&&this.getAllCellCtrls().forEach(cellCtrl=>cellCtrl.onLeftChanged())}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,Events.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){this.destroyFuncsForColumnListeners.forEach(func=>func()),this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();this.columnModel.getAllGridColumns().forEach(col=>{const forEachCellWithThisCol=callback=>{this.getAllCellCtrls().forEach(cellCtrl=>{cellCtrl.getColumn()===col&&callback(cellCtrl)})},leftChangedListener=()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onLeftChanged())},widthChangedListener=()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onWidthChanged())},firstRightPinnedChangedListener=()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onFirstRightPinnedChanged())},lastLeftPinnedChangedListener=()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onLastLeftPinnedChanged())},colDefChangedListener=()=>{forEachCellWithThisCol(cellCtrl=>cellCtrl.onColDefChanged())};col.addEventListener("leftChanged",leftChangedListener),col.addEventListener("widthChanged",widthChangedListener),col.addEventListener("firstRightPinnedChanged",firstRightPinnedChangedListener),col.addEventListener("lastLeftPinnedChanged",lastLeftPinnedChangedListener),col.addEventListener("colDefChanged",colDefChangedListener),this.destroyFuncsForColumnListeners.push(()=>{col.removeEventListener("leftChanged",leftChangedListener),col.removeEventListener("widthChanged",widthChangedListener),col.removeEventListener("firstRightPinnedChanged",firstRightPinnedChangedListener),col.removeEventListener("lastLeftPinnedChanged",lastLeftPinnedChangedListener),col.removeEventListener("colDefChanged",colDefChangedListener)})})}onDomLayoutChanged(){const printLayout=this.gos.isDomLayout("print"),embedFullWidthRows=printLayout||this.gos.get("embedFullWidthRows"),destroyRows=embedFullWidthRows!==this.embedFullWidthRows||this.printLayout!==printLayout;this.printLayout=printLayout,this.embedFullWidthRows=embedFullWidthRows,destroyRows&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const rowIndexesToRemove=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(rowIndexesToRemove)}onPageLoaded(event){const params={recycleRows:event.keepRenderedRows,animate:event.animate,newData:event.newData,newPage:event.newPage,onlyBody:!0};this.redrawAfterModelUpdate(params)}getAllCellsForColumn(column){const res=[];return this.getAllRowCtrls().forEach(rowCtrl=>{const eCell=rowCtrl.getCellElement(column);eCell&&res.push(eCell)}),res}refreshFloatingRowComps(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())}getTopRowCtrls(){return this.topRowCtrls}getCentreRowCtrls(){return this.allRowCtrls}getBottomRowCtrls(){return this.bottomRowCtrls}refreshFloatingRows(rowComps,rowNodes){rowComps.forEach(row=>{row.destroyFirstPass(),row.destroySecondPass()}),rowComps.length=0,rowNodes&&rowNodes.forEach(rowNode=>{const rowCtrl=new RowCtrl(rowNode,this.beans,!1,!1,this.printLayout);rowComps.push(rowCtrl)})}onPinnedRowDataChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(rowNode,suppressEvent=!1){var _a;if(rowNode.sticky)this.stickyRowFeature.refreshStickyNode(rowNode);else{if(null==(_a=this.cachedRowCtrls)?void 0:_a.has(rowNode))return void this.cachedRowCtrls.removeRow(rowNode);{const destroyAndRecreateCtrl=dataStruct=>{const ctrl=dataStruct[rowNode.rowIndex];ctrl&&ctrl.getRowNode()===rowNode&&(ctrl.destroyFirstPass(),ctrl.destroySecondPass(),dataStruct[rowNode.rowIndex]=this.createRowCon(rowNode,!1,!1))};switch(rowNode.rowPinned){case"top":destroyAndRecreateCtrl(this.topRowCtrls);break;case"bottom":destroyAndRecreateCtrl(this.bottomRowCtrls);break;default:destroyAndRecreateCtrl(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}}suppressEvent||this.dispatchDisplayedRowsChanged(!1)}redrawRows(rowNodes){if(null!=rowNodes)return null==rowNodes||rowNodes.forEach(node=>this.redrawRow(node,!0)),void this.dispatchDisplayedRowsChanged(!1);this.redrawAfterModelUpdate()}getCellToRestoreFocusToAfterRefresh(params){const focusedCell=(null==params?void 0:params.suppressKeepFocus)?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==focusedCell)return null;const activeElement=this.gos.getActiveDomElement(),cellDomData=this.gos.getDomData(activeElement,CellCtrl.DOM_DATA_KEY_CELL_CTRL),rowDomData=this.gos.getDomData(activeElement,RowCtrl.DOM_DATA_KEY_ROW_CTRL);return cellDomData||rowDomData?focusedCell:null}redrawAfterModelUpdate(params={}){this.getLockOnRefresh();const focusedCell=this.getCellToRestoreFocusToAfterRefresh(params);this.updateContainerHeights(),this.scrollToTopIfNewData(params);const recycleRows=!params.domLayoutChanged&&!!params.recycleRows,animate=params.animate&&this.gos.isAnimateRows(),rowsToRecycle=recycleRows?this.getRowsToRecycle():null;recycleRows||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender(),this.stickyRowFeature&&this.stickyRowFeature.checkStickyRows(),this.recycleRows(rowsToRecycle,animate),this.gridBodyCtrl.updateRowCount(),params.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),null!=focusedCell&&this.restoreFocusedCell(focusedCell),this.releaseLockOnRefresh()}scrollToTopIfNewData(params){const scrollToTop=params.newData||params.newPage,suppressScrollToTop=this.gos.get("suppressScrollOnNewData");scrollToTop&&!suppressScrollToTop&&this.gridBodyCtrl.getScrollFeature().scrollToTop()}updateContainerHeights(){if(this.printLayout)return void this.rowContainerHeightService.setModelHeight(null);let containerHeight=this.paginationProxy.getCurrentPageHeight();0===containerHeight&&(containerHeight=1),this.rowContainerHeightService.setModelHeight(containerHeight)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0}releaseLockOnRefresh(){this.refreshInProgress=!1}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(cellPosition){cellPosition&&(this.focusService.setRestoreFocusedCell(cellPosition),this.onCellFocusChanged(this.beans.gos.addGridCommonParams({rowIndex:cellPosition.rowIndex,column:cellPosition.column,rowPinned:cellPosition.rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"mock"})))}stopEditing(cancel=!1){this.getAllRowCtrls().forEach(rowCtrl=>{rowCtrl.stopEditing(cancel)})}getAllCellCtrls(){const res=[],rowCtrls=this.getAllRowCtrls(),rowCtrlsLength=rowCtrls.length;for(let i=0;i<rowCtrlsLength;i++){const cellCtrls=rowCtrls[i].getAllCellCtrls(),cellCtrlsLength=cellCtrls.length;for(let j=0;j<cellCtrlsLength;j++)res.push(cellCtrls[j])}return res}getAllRowCtrls(){const stickyTopRowCtrls=this.stickyRowFeature&&this.stickyRowFeature.getStickyTopRowCtrls()||[],stickyBottomRowCtrls=this.stickyRowFeature&&this.stickyRowFeature.getStickyBottomRowCtrls()||[],res=[...this.topRowCtrls,...this.bottomRowCtrls,...stickyTopRowCtrls,...stickyBottomRowCtrls];for(const key in this.rowCtrlsByRowIndex)res.push(this.rowCtrlsByRowIndex[key]);return res}addRenderedRowListener(eventName,rowIndex,callback){const rowComp=this.rowCtrlsByRowIndex[rowIndex];rowComp&&rowComp.addEventListener(eventName,callback)}flashCells(params={}){this.getCellCtrls(params.rowNodes,params.columns).forEach(cellCtrl=>cellCtrl.flashCell(params))}refreshCells(params={}){const refreshCellParams={forceRefresh:params.force,newData:!1,suppressFlash:params.suppressFlash};this.getCellCtrls(params.rowNodes,params.columns).forEach(cellCtrl=>cellCtrl.refreshOrDestroyCell(refreshCellParams)),params.rowNodes&&(this.getRowCtrls(params.rowNodes).forEach(rowCtrl=>{if(!rowCtrl.isFullWidth())return;rowCtrl.refreshFullWidth()||this.redrawRow(rowCtrl.getRowNode(),!0)}),this.dispatchDisplayedRowsChanged(!1))}getCellRendererInstances(params){var _a;const cellRenderers=this.getCellCtrls(params.rowNodes,params.columns).map(cellCtrl=>cellCtrl.getCellRenderer()).filter(renderer=>null!=renderer);if(null==(_a=params.columns)?void 0:_a.length)return cellRenderers;const fullWidthRenderers=[],rowIdMap=this.mapRowNodes(params.rowNodes);return this.getAllRowCtrls().forEach(rowCtrl=>{if(rowIdMap&&!this.isRowInMap(rowCtrl.getRowNode(),rowIdMap))return;if(!rowCtrl.isFullWidth())return;const renderers=rowCtrl.getFullWidthCellRenderers();for(let i=0;i<renderers.length;i++){const renderer=renderers[i];null!=renderer&&fullWidthRenderers.push(renderer)}}),[...fullWidthRenderers,...cellRenderers]}getCellEditorInstances(params){const res=[];return this.getCellCtrls(params.rowNodes,params.columns).forEach(cellCtrl=>{const cellEditor=cellCtrl.getCellEditor();cellEditor&&res.push(cellEditor)}),res}getEditingCells(){const res=[];return this.getAllCellCtrls().forEach(cellCtrl=>{if(cellCtrl.isEditing()){const cellPosition=cellCtrl.getCellPosition();res.push(cellPosition)}}),res}mapRowNodes(rowNodes){if(!rowNodes)return;const res={top:{},bottom:{},normal:{}};return rowNodes.forEach(rowNode=>{const id=rowNode.id;switch(rowNode.rowPinned){case"top":res.top[id]=rowNode;break;case"bottom":res.bottom[id]=rowNode;break;default:res.normal[id]=rowNode}}),res}isRowInMap(rowNode,rowIdsMap){const id=rowNode.id;switch(rowNode.rowPinned){case"top":return null!=rowIdsMap.top[id];case"bottom":return null!=rowIdsMap.bottom[id];default:return null!=rowIdsMap.normal[id]}}getRowCtrls(rowNodes){const rowIdsMap=this.mapRowNodes(rowNodes),allRowCtrls=this.getAllRowCtrls();return rowNodes&&rowIdsMap?allRowCtrls.filter(rowCtrl=>{const rowNode=rowCtrl.getRowNode();return this.isRowInMap(rowNode,rowIdsMap)}):allRowCtrls}getCellCtrls(rowNodes,columns){let colIdsMap;exists(columns)&&(colIdsMap={},columns.forEach(colKey=>{const column=this.columnModel.getGridColumn(colKey);exists(column)&&(colIdsMap[column.getId()]=!0)}));const res=[];return this.getRowCtrls(rowNodes).forEach(rowCtrl=>{rowCtrl.getAllCellCtrls().forEach(cellCtrl=>{const colId=cellCtrl.getColumn().getId();colIdsMap&&!colIdsMap[colId]||res.push(cellCtrl)})}),res}destroy(){this.removeAllRowComps(),super.destroy()}removeAllRowComps(){const rowIndexesToRemove=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(rowIndexesToRemove),this.stickyRowFeature&&this.stickyRowFeature.destroyStickyCtrls()}getRowsToRecycle(){const stubNodeIndexes=[];iterateObject(this.rowCtrlsByRowIndex,(index,rowCtrl)=>{null==rowCtrl.getRowNode().id&&stubNodeIndexes.push(index)}),this.removeRowCtrls(stubNodeIndexes);const ctrlsByIdMap={};return iterateObject(this.rowCtrlsByRowIndex,(index,rowCtrl)=>{const rowNode=rowCtrl.getRowNode();ctrlsByIdMap[rowNode.id]=rowCtrl}),this.rowCtrlsByRowIndex={},ctrlsByIdMap}removeRowCtrls(rowsToRemove,suppressAnimation=!1){rowsToRemove.forEach(indexToRemove=>{const rowCtrl=this.rowCtrlsByRowIndex[indexToRemove];rowCtrl&&(rowCtrl.destroyFirstPass(suppressAnimation),rowCtrl.destroySecondPass()),delete this.rowCtrlsByRowIndex[indexToRemove]})}onBodyScroll(e){"vertical"===e.direction&&this.redraw({afterScroll:!0})}redraw(params={}){const{afterScroll}=params;let cellFocused;this.stickyRowFeature&&browserSupportsPreventScroll()&&(cellFocused=this.getCellToRestoreFocusToAfterRefresh()||void 0);const oldFirstRow=this.firstRenderedRow,oldLastRow=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let hasStickyRowChanges=!1;this.stickyRowFeature&&(hasStickyRowChanges=this.stickyRowFeature.checkStickyRows());const rangeChanged=this.firstRenderedRow!==oldFirstRow||this.lastRenderedRow!==oldLastRow;if((!afterScroll||hasStickyRowChanges||rangeChanged)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,afterScroll),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(afterScroll&&!hasStickyRowChanges),null!=cellFocused)){const newFocusedCell=this.getCellToRestoreFocusToAfterRefresh();null!=cellFocused&&null==newFocusedCell&&(this.animationFrameService.flushAllFrames(),this.restoreFocusedCell(cellFocused))}}removeRowCompsNotToDraw(indexesToDraw,suppressAnimation){const indexesToDrawMap={};indexesToDraw.forEach(index=>indexesToDrawMap[index]=!0);const indexesNotToDraw=Object.keys(this.rowCtrlsByRowIndex).filter(index=>!indexesToDrawMap[index]);this.removeRowCtrls(indexesNotToDraw,suppressAnimation)}calculateIndexesToDraw(rowsToRecycle){let indexesToDraw=createArrayOfNumbers(this.firstRenderedRow,this.lastRenderedRow);const checkRowToDraw=(indexStr,rowComp)=>{const index=rowComp.getRowNode().rowIndex;null!=index&&(index<this.firstRenderedRow||index>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(rowComp)&&indexesToDraw.push(index)};iterateObject(this.rowCtrlsByRowIndex,checkRowToDraw),iterateObject(rowsToRecycle,checkRowToDraw),indexesToDraw.sort((a,b)=>a-b);const ret=[];for(let i=0;i<indexesToDraw.length;i++){const currRow=indexesToDraw[i],rowNode=this.paginationProxy.getRow(currRow);rowNode&&!rowNode.sticky&&ret.push(currRow)}return ret}recycleRows(rowsToRecycle,animate=!1,afterScroll=!1){const indexesToDraw=this.calculateIndexesToDraw(rowsToRecycle);if((this.printLayout||afterScroll)&&(animate=!1),this.removeRowCompsNotToDraw(indexesToDraw,!animate),indexesToDraw.forEach(rowIndex=>{this.createOrUpdateRowCtrl(rowIndex,rowsToRecycle,animate,afterScroll)}),rowsToRecycle){afterScroll&&!this.gos.get("suppressAnimationFrame")&&!this.printLayout?this.beans.animationFrameService.addDestroyTask(()=>{this.destroyRowCtrls(rowsToRecycle,animate),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(rowsToRecycle,animate)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(afterScroll=!1){const event={type:Events.EVENT_DISPLAYED_ROWS_CHANGED,afterScroll};this.eventService.dispatchEvent(event)}onDisplayedColumnsChanged(){const pinningLeft=this.columnModel.isPinningLeft(),pinningRight=this.columnModel.isPinningRight();(this.pinningLeft!==pinningLeft||pinningRight!==this.pinningRight)&&(this.pinningLeft=pinningLeft,this.pinningRight=pinningRight,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const rowsToRemove=[];this.getFullWidthRowCtrls().forEach(fullWidthCtrl=>{const rowIndex=fullWidthCtrl.getRowNode().rowIndex;rowsToRemove.push(rowIndex.toString())}),this.refreshFloatingRowComps(),this.removeRowCtrls(rowsToRemove),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(rowNodes){const rowNodesMap=this.mapRowNodes(rowNodes);return this.getAllRowCtrls().filter(rowCtrl=>{if(!rowCtrl.isFullWidth())return!1;const rowNode=rowCtrl.getRowNode();return!(null!=rowNodesMap&&!this.isRowInMap(rowNode,rowNodesMap))})}createOrUpdateRowCtrl(rowIndex,rowsToRecycle,animate,afterScroll){let rowNode,rowCtrl=this.rowCtrlsByRowIndex[rowIndex];rowCtrl||(rowNode=this.paginationProxy.getRow(rowIndex),exists(rowNode)&&exists(rowsToRecycle)&&rowsToRecycle[rowNode.id]&&rowNode.alreadyRendered&&(rowCtrl=rowsToRecycle[rowNode.id],rowsToRecycle[rowNode.id]=null));if(!rowCtrl){if(rowNode||(rowNode=this.paginationProxy.getRow(rowIndex)),!exists(rowNode))return;rowCtrl=this.createRowCon(rowNode,animate,afterScroll)}return rowNode&&(rowNode.alreadyRendered=!0),this.rowCtrlsByRowIndex[rowIndex]=rowCtrl,rowCtrl}destroyRowCtrls(rowCtrlsMap,animate){const executeInAWhileFuncs=[];iterateObject(rowCtrlsMap,(nodeId,rowCtrl)=>{rowCtrl&&(this.cachedRowCtrls&&rowCtrl.isCacheable()?this.cachedRowCtrls.addRow(rowCtrl):(rowCtrl.destroyFirstPass(!animate),animate?(this.zombieRowCtrls[rowCtrl.getInstanceId()]=rowCtrl,executeInAWhileFuncs.push(()=>{rowCtrl.destroySecondPass(),delete this.zombieRowCtrls[rowCtrl.getInstanceId()]})):rowCtrl.destroySecondPass()))}),animate&&(executeInAWhileFuncs.push(()=>{this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}),executeInAWhile(executeInAWhileFuncs))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){return this.getRowBuffer()*this.gos.getRowHeightAsNumber()}workOutFirstAndLastRowsToRender(){let newFirst,newLast;if(this.rowContainerHeightService.updateOffset(),this.paginationProxy.isRowsToRender())if(this.printLayout)this.environment.refreshRowHeightVariable(),newFirst=this.paginationProxy.getPageFirstRow(),newLast=this.paginationProxy.getPageLastRow();else{const bufferPixels=this.getRowBufferInPixels(),gridBodyCtrl=this.ctrlsService.getGridBodyCtrl(),suppressRowVirtualisation=this.gos.get("suppressRowVirtualisation");let firstPixel,lastPixel,rowHeightsChanged=!1;do{const paginationOffset=this.paginationProxy.getPixelOffset(),{pageFirstPixel,pageLastPixel}=this.paginationProxy.getCurrentPagePixelRange(),divStretchOffset=this.rowContainerHeightService.getDivStretchOffset(),bodyVRange=gridBodyCtrl.getScrollFeature().getVScrollPosition(),bodyTopPixel=bodyVRange.top,bodyBottomPixel=bodyVRange.bottom;suppressRowVirtualisation?(firstPixel=pageFirstPixel+divStretchOffset,lastPixel=pageLastPixel+divStretchOffset):(firstPixel=Math.max(bodyTopPixel+paginationOffset-bufferPixels,pageFirstPixel)+divStretchOffset,lastPixel=Math.min(bodyBottomPixel+paginationOffset+bufferPixels,pageLastPixel)+divStretchOffset),this.firstVisibleVPixel=Math.max(bodyTopPixel+paginationOffset,pageFirstPixel)+divStretchOffset,this.lastVisibleVPixel=Math.min(bodyBottomPixel+paginationOffset,pageLastPixel)+divStretchOffset,rowHeightsChanged=this.ensureAllRowsInRangeHaveHeightsCalculated(firstPixel,lastPixel)}while(rowHeightsChanged);let firstRowIndex=this.paginationProxy.getRowIndexAtPixel(firstPixel),lastRowIndex=this.paginationProxy.getRowIndexAtPixel(lastPixel);const pageFirstRow=this.paginationProxy.getPageFirstRow(),pageLastRow=this.paginationProxy.getPageLastRow();firstRowIndex<pageFirstRow&&(firstRowIndex=pageFirstRow),lastRowIndex>pageLastRow&&(lastRowIndex=pageLastRow),newFirst=firstRowIndex,newLast=lastRowIndex}else newFirst=0,newLast=-1;const rowLayoutNormal=this.gos.isDomLayout("normal"),suppressRowCountRestriction=this.gos.get("suppressMaxRenderedRowRestriction"),rowBufferMaxSize=Math.max(this.getRowBuffer(),500);rowLayoutNormal&&!suppressRowCountRestriction&&newLast-newFirst>rowBufferMaxSize&&(newLast=newFirst+rowBufferMaxSize);const firstDiffers=newFirst!==this.firstRenderedRow,lastDiffers=newLast!==this.lastRenderedRow;if(firstDiffers||lastDiffers){this.firstRenderedRow=newFirst,this.lastRenderedRow=newLast;const event={type:Events.EVENT_VIEWPORT_CHANGED,firstRow:newFirst,lastRow:newLast};this.eventService.dispatchEvent(event)}}dispatchFirstDataRenderedEvent(){if(this.dataFirstRenderedFired)return;this.dataFirstRenderedFired=!0;const event={type:Events.EVENT_FIRST_DATA_RENDERED,firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow};window.requestAnimationFrame(()=>{this.beans.eventService.dispatchEvent(event)})}ensureAllRowsInRangeHaveHeightsCalculated(topPixel,bottomPixel){const res=this.paginationProxy.ensureRowHeightsValid(topPixel,bottomPixel,-1,-1);return res&&this.updateContainerHeights(),res}getFirstVisibleVerticalPixel(){return this.firstVisibleVPixel}getLastVisibleVerticalPixel(){return this.lastVisibleVPixel}getFirstVirtualRenderedRow(){return this.firstRenderedRow}getLastVirtualRenderedRow(){return this.lastRenderedRow}doNotUnVirtualiseRow(rowComp){const rowNode=rowComp.getRowNode(),rowHasFocus=this.focusService.isRowNodeFocused(rowNode),rowIsEditing=rowComp.isEditing(),rowIsDetail=rowNode.detail;if(!(rowHasFocus||rowIsEditing||rowIsDetail))return false;return!!this.paginationProxy.isRowPresent(rowNode)}createRowCon(rowNode,animate,afterScroll){const rowCtrlFromCache=this.cachedRowCtrls?this.cachedRowCtrls.getRow(rowNode):null;if(rowCtrlFromCache)return rowCtrlFromCache;const suppressAnimationFrame=this.gos.get("suppressAnimationFrame"),useAnimationFrameForCreate=afterScroll&&!suppressAnimationFrame&&!this.printLayout;return new RowCtrl(rowNode,this.beans,animate,useAnimationFrameForCreate,this.printLayout)}getRenderedNodes(){const renderedRows=this.rowCtrlsByRowIndex;return Object.values(renderedRows).map(rowCtrl=>rowCtrl.getRowNode())}getRowByPosition(rowPosition){let rowCtrl;const{rowIndex}=rowPosition;switch(rowPosition.rowPinned){case"top":rowCtrl=this.topRowCtrls[rowIndex];break;case"bottom":rowCtrl=this.bottomRowCtrls[rowIndex];break;default:rowCtrl=this.rowCtrlsByRowIndex[rowIndex],rowCtrl||(rowCtrl=this.getStickyTopRowCtrls().find(ctrl=>ctrl.getRowNode().rowIndex===rowIndex)||null,rowCtrl||(rowCtrl=this.getStickyBottomRowCtrls().find(ctrl=>ctrl.getRowNode().rowIndex===rowIndex)||null))}return rowCtrl}isRangeInRenderedViewport(startIndex,endIndex){if(null==startIndex||null==endIndex)return!1;const blockAfterViewport=startIndex>this.lastRenderedRow;return!(endIndex<this.firstRenderedRow)&&!blockAfterViewport}};__decorateClass([Autowired("animationFrameService")],RowRenderer.prototype,"animationFrameService",2),__decorateClass([Autowired("paginationProxy")],RowRenderer.prototype,"paginationProxy",2),__decorateClass([Autowired("columnModel")],RowRenderer.prototype,"columnModel",2),__decorateClass([Autowired("pinnedRowModel")],RowRenderer.prototype,"pinnedRowModel",2),__decorateClass([Autowired("rowModel")],RowRenderer.prototype,"rowModel",2),__decorateClass([Autowired("focusService")],RowRenderer.prototype,"focusService",2),__decorateClass([Autowired("beans")],RowRenderer.prototype,"beans",2),__decorateClass([Autowired("rowContainerHeightService")],RowRenderer.prototype,"rowContainerHeightService",2),__decorateClass([Autowired("ctrlsService")],RowRenderer.prototype,"ctrlsService",2),__decorateClass([PostConstruct],RowRenderer.prototype,"postConstruct",1),RowRenderer=__decorateClass([Bean("rowRenderer")],RowRenderer);var RowCtrlCache=class{constructor(maxCount){this.entriesMap={},this.entriesList=[],this.maxCount=maxCount}addRow(rowCtrl){if(this.entriesMap[rowCtrl.getRowNode().id]=rowCtrl,this.entriesList.push(rowCtrl),rowCtrl.setCached(!0),this.entriesList.length>this.maxCount){const rowCtrlToDestroy=this.entriesList[0];rowCtrlToDestroy.destroyFirstPass(),rowCtrlToDestroy.destroySecondPass(),this.removeFromCache(rowCtrlToDestroy)}}getRow(rowNode){if(null==rowNode||null==rowNode.id)return null;const res=this.entriesMap[rowNode.id];if(!res)return null;this.removeFromCache(res),res.setCached(!1);return res.getRowNode()!=rowNode?null:res}has(rowNode){return null!=this.entriesMap[rowNode.id]}removeRow(rowNode){const rowNodeId=rowNode.id,ctrl=this.entriesMap[rowNodeId];delete this.entriesMap[rowNodeId],removeFromArray(this.entriesList,ctrl)}removeFromCache(rowCtrl){const rowNodeId=rowCtrl.getRowNode().id;delete this.entriesMap[rowNodeId],removeFromArray(this.entriesList,rowCtrl)}getEntries(){return this.entriesList}},PinnedRowModel=class extends BeanStub{init(){this.setPinnedTopRowData(),this.setPinnedBottomRowData(),this.addManagedPropertyListener("pinnedTopRowData",()=>this.setPinnedTopRowData()),this.addManagedPropertyListener("pinnedBottomRowData",()=>this.setPinnedBottomRowData())}isEmpty(floating){return missingOrEmpty("top"===floating?this.pinnedTopRows:this.pinnedBottomRows)}isRowsToRender(floating){return!this.isEmpty(floating)}getRowAtPixel(pixel,floating){const rows="top"===floating?this.pinnedTopRows:this.pinnedBottomRows;if(missingOrEmpty(rows))return 0;for(let i=0;i<rows.length;i++){const rowNode=rows[i];if(rowNode.rowTop+rowNode.rowHeight-1>=pixel)return i}return rows.length-1}setPinnedTopRowData(){const rowData=this.gos.get("pinnedTopRowData");this.pinnedTopRows=this.createNodesFromData(rowData,!0);const event={type:Events.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(event)}setPinnedBottomRowData(){const rowData=this.gos.get("pinnedBottomRowData");this.pinnedBottomRows=this.createNodesFromData(rowData,!1);const event={type:Events.EVENT_PINNED_ROW_DATA_CHANGED};this.eventService.dispatchEvent(event)}createNodesFromData(allData,isTop){const rowNodes=[];if(allData){let nextRowTop=0;allData.forEach((dataItem,index)=>{const rowNode=new RowNode(this.beans);rowNode.data=dataItem;const idPrefix=isTop?RowNode.ID_PREFIX_TOP_PINNED:RowNode.ID_PREFIX_BOTTOM_PINNED;rowNode.id=idPrefix+index,rowNode.rowPinned=isTop?"top":"bottom",rowNode.setRowTop(nextRowTop),rowNode.setRowHeight(this.gos.getRowHeightForNode(rowNode).height),rowNode.setRowIndex(index),nextRowTop+=rowNode.rowHeight,rowNodes.push(rowNode)})}return rowNodes}getPinnedTopRowData(){return this.pinnedTopRows}getPinnedBottomRowData(){return this.pinnedBottomRows}getPinnedTopTotalHeight(){return this.getTotalHeight(this.pinnedTopRows)}getPinnedTopRowCount(){return this.pinnedTopRows?this.pinnedTopRows.length:0}getPinnedBottomRowCount(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0}getPinnedTopRow(index){return this.pinnedTopRows[index]}getPinnedBottomRow(index){return this.pinnedBottomRows[index]}forEachPinnedTopRow(callback){missingOrEmpty(this.pinnedTopRows)||this.pinnedTopRows.forEach(callback)}forEachPinnedBottomRow(callback){missingOrEmpty(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(callback)}getPinnedBottomTotalHeight(){return this.getTotalHeight(this.pinnedBottomRows)}getTotalHeight(rowNodes){if(!rowNodes||0===rowNodes.length)return 0;const lastNode=last(rowNodes);return lastNode.rowTop+lastNode.rowHeight}};__decorateClass([Autowired("beans")],PinnedRowModel.prototype,"beans",2),__decorateClass([PostConstruct],PinnedRowModel.prototype,"init",1),PinnedRowModel=__decorateClass([Bean("pinnedRowModel")],PinnedRowModel);var ChangedPath=class{constructor(keepingColumns,rootNode){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=keepingColumns,this.pathRoot={rowNode:rootNode,children:null},this.mapToItems[rootNode.id]=this.pathRoot}setInactive(){this.active=!1}isActive(){return this.active}depthFirstSearchChangedPath(pathItem,callback){if(pathItem.children)for(let i=0;i<pathItem.children.length;i++)this.depthFirstSearchChangedPath(pathItem.children[i],callback);callback(pathItem.rowNode)}depthFirstSearchEverything(rowNode,callback,traverseEverything){if(rowNode.childrenAfterGroup)for(let i=0;i<rowNode.childrenAfterGroup.length;i++){const childNode=rowNode.childrenAfterGroup[i];childNode.childrenAfterGroup?this.depthFirstSearchEverything(rowNode.childrenAfterGroup[i],callback,traverseEverything):traverseEverything&&callback(childNode)}callback(rowNode)}forEachChangedNodeDepthFirst(callback,traverseLeafNodes=!1,includeUnchangedNodes=!1){this.active&&!includeUnchangedNodes?this.depthFirstSearchChangedPath(this.pathRoot,callback):this.depthFirstSearchEverything(this.pathRoot.rowNode,callback,traverseLeafNodes)}executeFromRootNode(callback){callback(this.pathRoot.rowNode)}createPathItems(rowNode){let pointer=rowNode,newEntryCount=0;for(;!this.mapToItems[pointer.id];){const newEntry={rowNode:pointer,children:null};this.mapToItems[pointer.id]=newEntry,newEntryCount++,pointer=pointer.parent}return newEntryCount}populateColumnsMap(rowNode,columns){if(!this.keepingColumns||!columns)return;let pointer=rowNode;for(;pointer;)this.nodeIdsToColumns[pointer.id]||(this.nodeIdsToColumns[pointer.id]={}),columns.forEach(col=>this.nodeIdsToColumns[pointer.id][col.getId()]=!0),pointer=pointer.parent}linkPathItems(rowNode,newEntryCount){let pointer=rowNode;for(let i=0;i<newEntryCount;i++){const thisItem=this.mapToItems[pointer.id],parentItem=this.mapToItems[pointer.parent.id];parentItem.children||(parentItem.children=[]),parentItem.children.push(thisItem),pointer=pointer.parent}}addParentNode(rowNode,columns){if(!rowNode||rowNode.isRowPinned())return;const newEntryCount=this.createPathItems(rowNode);this.linkPathItems(rowNode,newEntryCount),this.populateColumnsMap(rowNode,columns)}canSkip(rowNode){return this.active&&!this.mapToItems[rowNode.id]}getValueColumnsForNode(rowNode,valueColumns){if(!this.keepingColumns)return valueColumns;const colsForThisNode=this.nodeIdsToColumns[rowNode.id];return valueColumns.filter(col=>colsForThisNode[col.getId()])}getNotValueColumnsForNode(rowNode,valueColumns){if(!this.keepingColumns)return null;const colsForThisNode=this.nodeIdsToColumns[rowNode.id];return valueColumns.filter(col=>!colsForThisNode[col.getId()])}},_RowNodeBlock=class _RowNodeBlock extends BeanStub{constructor(id){super(),this.state=_RowNodeBlock.STATE_WAITING_TO_LOAD,this.version=0,this.id=id}getId(){return this.id}load(){this.state=_RowNodeBlock.STATE_LOADING,this.loadFromDatasource()}getVersion(){return this.version}setStateWaitingToLoad(){this.version++,this.state=_RowNodeBlock.STATE_WAITING_TO_LOAD}getState(){return this.state}pageLoadFailed(version){this.isRequestMostRecentAndLive(version)&&(this.state=_RowNodeBlock.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)}success(version,params){this.successCommon(version,params)}pageLoaded(version,rows,lastRow){this.successCommon(version,{rowData:rows,rowCount:lastRow})}isRequestMostRecentAndLive(version){const thisIsMostRecentRequest=version===this.version,weAreNotDestroyed=this.isAlive();return thisIsMostRecentRequest&&weAreNotDestroyed}successCommon(version,params){this.dispatchLoadCompleted();this.isRequestMostRecentAndLive(version)&&(this.state=_RowNodeBlock.STATE_LOADED,this.processServerResult(params))}dispatchLoadCompleted(success=!0){const event={type:_RowNodeBlock.EVENT_LOAD_COMPLETE,success,block:this};this.dispatchEvent(event)}};_RowNodeBlock.EVENT_LOAD_COMPLETE="loadComplete",_RowNodeBlock.STATE_WAITING_TO_LOAD="needsLoading",_RowNodeBlock.STATE_LOADING="loading",_RowNodeBlock.STATE_LOADED="loaded",_RowNodeBlock.STATE_FAILED="failed";var RowNodeBlock=_RowNodeBlock,RowNodeBlockLoader=class extends BeanStub{constructor(){super(...arguments),this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=this.getMaxConcurrentDatasourceRequests();const blockLoadDebounceMillis=this.gos.get("blockLoadDebounceMillis");blockLoadDebounceMillis&&blockLoadDebounceMillis>0&&(this.checkBlockToLoadDebounce=_.debounce(this.performCheckBlocksToLoad.bind(this),blockLoadDebounceMillis))}setBeans(loggerFactory){this.logger=loggerFactory.create("RowNodeBlockLoader")}getMaxConcurrentDatasourceRequests(){const res=this.gos.get("maxConcurrentDatasourceRequests");return null==res?2:res<=0?void 0:res}addBlock(block){this.blocks.push(block),block.addEventListener(RowNodeBlock.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(block){_.removeFromArray(this.blocks,block)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),this.dispatchEvent({type:RowNodeBlockLoader.BLOCK_LOADED_EVENT}),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:RowNodeBlockLoader.BLOCK_LOADER_FINISHED_EVENT})}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void this.logger.log("checkBlockToLoad: max loads exceeded");const loadAvailability=this.getAvailableLoadingCount(),blocksToLoad=this.blocks.filter(block=>block.getState()===RowNodeBlock.STATE_WAITING_TO_LOAD).slice(0,loadAvailability);this.registerLoads(blocksToLoad.length),blocksToLoad.forEach(block=>block.load()),this.printCacheStatus()}getBlockState(){if(this.gos.isRowModelType("serverSide")){return this.rowModel.getBlockStates()}const result={};return this.blocks.forEach(block=>{const{id,state}=block.getBlockStateJson();result[id]=state}),result}printCacheStatus(){this.logger.isLogging()&&this.logger.log(`printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}isLoading(){return this.activeBlockLoadsCount>0}registerLoads(count){this.activeBlockLoadsCount+=count}getAvailableLoadingCount(){return void 0!==this.maxConcurrentRequests?this.maxConcurrentRequests-this.activeBlockLoadsCount:void 0}};RowNodeBlockLoader.BLOCK_LOADED_EVENT="blockLoaded",RowNodeBlockLoader.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",__decorateClass([Autowired("rowModel")],RowNodeBlockLoader.prototype,"rowModel",2),__decorateClass([PostConstruct],RowNodeBlockLoader.prototype,"postConstruct",1),__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],RowNodeBlockLoader.prototype,"setBeans",1),RowNodeBlockLoader=__decorateClass([Bean("rowNodeBlockLoader")],RowNodeBlockLoader);var PaginationProxy=class extends BeanStub{constructor(){super(...arguments),this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.pixelOffset=0,this.masterRowCount=0}postConstruct(){this.active=this.gos.get("pagination"),this.pageSizeFromGridOptions=this.gos.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedListener(this.eventService,Events.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this)),this.onModelUpdated()}ensureRowHeightsValid(startPixel,endPixel,startLimitIndex,endLimitIndex){const res=this.rowModel.ensureRowHeightsValid(startPixel,endPixel,this.getPageFirstRow(),this.getPageLastRow());return res&&this.calculatePages(),res}isPaginateChildRows(){return!(!this.gos.get("groupRemoveSingleChildren")&&!this.gos.get("groupRemoveLowestSingleChildren"))||this.gos.get("paginateChildRows")}onModelUpdated(modelUpdatedEvent){this.calculatePages();const paginationChangedEvent={type:Events.EVENT_PAGINATION_CHANGED,animate:!!modelUpdatedEvent&&modelUpdatedEvent.animate,newData:!!modelUpdatedEvent&&modelUpdatedEvent.newData,newPage:!!modelUpdatedEvent&&modelUpdatedEvent.newPage,newPageSize:!!modelUpdatedEvent&&modelUpdatedEvent.newPageSize,keepRenderedRows:!!modelUpdatedEvent&&modelUpdatedEvent.keepRenderedRows};this.eventService.dispatchEvent(paginationChangedEvent)}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages();const paginationChangedEvent={type:Events.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!1,keepRenderedRows:!0};this.eventService.dispatchEvent(paginationChangedEvent)}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(page){if(!this.active||this.currentPage===page||"number"!=typeof this.currentPage)return;this.currentPage=page,this.calculatePages();const paginationChangedEvent={type:Events.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!0,newPageSize:!1,keepRenderedRows:!1};this.eventService.dispatchEvent(paginationChangedEvent)}getPixelOffset(){return this.pixelOffset}getRow(index){return this.rowModel.getRow(index)}getRowNode(id){return this.rowModel.getRowNode(id)}getRowIndexAtPixel(pixel){return this.rowModel.getRowIndexAtPixel(pixel)}getCurrentPageHeight(){return missing(this.topRowBounds)||missing(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)}getCurrentPagePixelRange(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}}isRowPresent(rowNode){if(!this.rowModel.isRowPresent(rowNode))return!1;return rowNode.rowIndex>=this.topDisplayedRowIndex&&rowNode.rowIndex<=this.bottomDisplayedRowIndex}isEmpty(){return this.rowModel.isEmpty()}isRowsToRender(){return this.rowModel.isRowsToRender()}forEachNode(callback){return this.rowModel.forEachNode(callback)}forEachNodeOnPage(callback){const firstRow=this.getPageFirstRow(),lastRow=this.getPageLastRow();for(let i=firstRow;i<=lastRow;i++){const node=this.getRow(i);node&&callback(node)}}getType(){return this.rowModel.getType()}getRowBounds(index){const res=this.rowModel.getRowBounds(index);return res.rowIndex=index,res}getPageFirstRow(){return this.topRowBounds?this.topRowBounds.rowIndex:-1}getPageLastRow(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1}getRowCount(){return this.rowModel.getRowCount()}getPageForIndex(index){return Math.floor(index/this.pageSize)}goToPageWithIndex(index){if(!this.active)return;const pageNumber=this.getPageForIndex(index);this.goToPage(pageNumber)}isRowInPage(row){if(!this.active)return!0;return this.getPageForIndex(row.rowIndex)===this.currentPage}isLastPageFound(){return this.rowModel.isLastRowIndexKnown()}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const rowCount=this.rowModel.getRowCount(),lastPage=Math.floor(rowCount/this.pageSize);this.goToPage(lastPage)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(page){this.currentPage=page}get pageSize(){return exists(this.pageSizeAutoCalculated)?this.pageSizeAutoCalculated:exists(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:exists(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:exists(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}unsetAutoCalculatedPageSize(){if(void 0===this.pageSizeAutoCalculated)return;const oldPageSize=this.pageSizeAutoCalculated;if(this.pageSizeAutoCalculated=void 0,this.pageSize===oldPageSize)return;this.calculatePages();const paginationChangedEvent={type:Events.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!1};this.eventService.dispatchEvent(paginationChangedEvent)}setPageSize(size,source){const currentSize=this.pageSize;switch(source){case"autoCalculated":this.pageSizeAutoCalculated=size;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=size,0!==this.currentPage&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=size;break;case"gridOptions":this.pageSizeFromGridOptions=size,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,0!==this.currentPage&&this.goToFirstPage()}if(currentSize!==this.pageSize){this.calculatePages();const paginationChangedEvent={type:Events.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,newPageSize:!0,keepRenderedRows:!0};this.eventService.dispatchEvent(paginationChangedEvent)}}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(exists(this.topRowBounds)?this.topRowBounds.rowTop:0)}setPixelOffset(value){this.pixelOffset!==value&&(this.pixelOffset=value,this.eventService.dispatchEvent({type:Events.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!isFinite(this.currentPage)||isNaN(this.currentPage)||this.currentPage<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)return void this.setZeroRows();const masterLastRowIndex=this.masterRowCount-1;this.totalPages=Math.floor(masterLastRowIndex/this.pageSize)+1,this.adjustCurrentPageIfInvalid();const masterPageStartIndex=this.pageSize*this.currentPage;let masterPageEndIndex=this.pageSize*(this.currentPage+1)-1;if(masterPageEndIndex>masterLastRowIndex&&(masterPageEndIndex=masterLastRowIndex),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(masterPageStartIndex),masterPageEndIndex===masterLastRowIndex)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{const firstIndexNotToShow=this.rowModel.getTopLevelRowDisplayedIndex(masterPageEndIndex+1);this.bottomDisplayedRowIndex=firstIndexNotToShow-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){if(this.masterRowCount=this.rowModel.getRowCount(),0===this.masterRowCount)return void this.setZeroRows();const maxRowIndex=this.masterRowCount-1;this.totalPages=Math.floor(maxRowIndex/this.pageSize)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>maxRowIndex&&(this.bottomDisplayedRowIndex=maxRowIndex)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1}};__decorateClass([Autowired("rowModel")],PaginationProxy.prototype,"rowModel",2),__decorateClass([PostConstruct],PaginationProxy.prototype,"postConstruct",1),PaginationProxy=__decorateClass([Bean("paginationProxy")],PaginationProxy);var StylingService=class extends BeanStub{processAllCellClasses(colDef,params,onApplicableClass,onNotApplicableClass){this.processClassRules(void 0,colDef.cellClassRules,params,onApplicableClass,onNotApplicableClass),this.processStaticCellClasses(colDef,params,onApplicableClass)}processClassRules(previousClassRules,classRules,params,onApplicableClass,onNotApplicableClass){if(null==classRules&&null==previousClassRules)return;const classesToApply={},classesToRemove={},forEachSingleClass=(className,callback)=>{className.split(" ").forEach(singleClass=>{""!=singleClass.trim()&&callback(singleClass)})};if(classRules){const classNames=Object.keys(classRules);for(let i=0;i<classNames.length;i++){const className=classNames[i],rule=classRules[className];let resultOfRule;"string"==typeof rule?resultOfRule=this.expressionService.evaluate(rule,params):"function"==typeof rule&&(resultOfRule=rule(params)),forEachSingleClass(className,singleClass=>{resultOfRule?classesToApply[singleClass]=!0:classesToRemove[singleClass]=!0})}}previousClassRules&&onNotApplicableClass&&Object.keys(previousClassRules).forEach(className=>forEachSingleClass(className,singleClass=>{classesToApply[singleClass]||(classesToRemove[singleClass]=!0)})),onNotApplicableClass&&Object.keys(classesToRemove).forEach(onNotApplicableClass),Object.keys(classesToApply).forEach(onApplicableClass)}getStaticCellClasses(colDef,params){const{cellClass}=colDef;if(!cellClass)return[];let classOrClasses;if("function"==typeof cellClass){classOrClasses=cellClass(params)}else classOrClasses=cellClass;return"string"==typeof classOrClasses&&(classOrClasses=[classOrClasses]),classOrClasses||[]}processStaticCellClasses(colDef,params,onApplicableClass){this.getStaticCellClasses(colDef,params).forEach(cssClassItem=>{onApplicableClass(cssClassItem)})}};__decorateClass([Autowired("expressionService")],StylingService.prototype,"expressionService",2),StylingService=__decorateClass([Bean("stylingService")],StylingService);var AgToggleButton=class extends AgCheckbox{constructor(config){super(config,"ag-toggle-button")}setValue(value,silent){return super.setValue(value,silent),this.addOrRemoveCssClass("ag-selected",this.getValue()),this}},AgInputTextArea=class extends AgAbstractInputField{constructor(config){super(config,"ag-text-area",null,"textarea")}setValue(value,silent){const ret=super.setValue(value,silent);return this.eInput.value=value,ret}setCols(cols){return this.eInput.cols=cols,this}setRows(rows){return this.eInput.rows=rows,this}},AgInputDateField=class extends AgInputTextField{constructor(config){super(config,"ag-date-field","date")}postConstruct(){super.postConstruct(),this.addManagedListener(this.eInput,"wheel",this.onWheel.bind(this));const usingSafari=isBrowserSafari();this.addManagedListener(this.eInput,"mousedown",()=>{this.isDisabled()||usingSafari||this.eInput.focus()}),this.eInput.step="any"}onWheel(e){this.gos.getActiveDomElement()===this.eInput&&e.preventDefault()}setMin(minDate){var _a;const min=minDate instanceof Date?null!=(_a=serialiseDate(null!=minDate?minDate:null,!1))?_a:void 0:minDate;return this.min===min||(this.min=min,addOrRemoveAttribute(this.eInput,"min",min)),this}setMax(maxDate){var _a;const max=maxDate instanceof Date?null!=(_a=serialiseDate(null!=maxDate?maxDate:null,!1))?_a:void 0:maxDate;return this.max===max||(this.max=max,addOrRemoveAttribute(this.eInput,"max",max)),this}setStep(step){return this.step===step||(this.step=step,addOrRemoveAttribute(this.eInput,"step",step)),this}getDate(){var _a;if(this.eInput.validity.valid)return null!=(_a=parseDateTimeFromString(this.getValue()))?_a:void 0}setDate(date,silent){this.setValue(serialiseDate(null!=date?date:null,!1),silent)}},AgInputRange=class extends AgAbstractInputField{constructor(config){super(config,"ag-range-field","range")}postConstruct(){super.postConstruct();const{min,max,step}=this.config;null!=min&&this.setMinValue(min),null!=max&&this.setMaxValue(max),this.setStep(step||1)}addInputListeners(){this.addManagedListener(this.eInput,"input",e=>{const value=e.target.value;this.setValue(value)})}setMinValue(value){return this.min=value,this.eInput.setAttribute("min",value.toString()),this}setMaxValue(value){return this.max=value,this.eInput.setAttribute("max",value.toString()),this}setStep(value){return this.eInput.setAttribute("step",value.toString()),this}setValue(value,silent){null!=this.min&&(value=Math.max(parseFloat(value),this.min).toString()),null!=this.max&&(value=Math.min(parseFloat(value),this.max).toString());const ret=super.setValue(value,silent);return this.eInput.value=value,ret}},RichSelectRow=class extends Component{constructor(params,wrapperEl){super('<div class="ag-rich-select-row" role="presentation"></div>'),this.params=params,this.wrapperEl=wrapperEl}postConstruct(){this.addManagedListener(this.getGui(),"click",this.onClick.bind(this))}setState(value){let formattedValue="";this.params.valueFormatter&&(formattedValue=this.params.valueFormatter(value));this.populateWithRenderer(value,formattedValue)||this.populateWithoutRenderer(value,formattedValue),this.value=value}highlightString(matchString){const{parsedValue}=this;if(this.params.cellRenderer||!exists(parsedValue))return;let hasMatch=exists(matchString);if(hasMatch){const index=null==parsedValue?void 0:parsedValue.toLocaleLowerCase().indexOf(matchString.toLocaleLowerCase());if(index>=0){const highlightEndIndex=index+matchString.length,startPart=escapeString(parsedValue.slice(0,index),!0),highlightedPart=escapeString(parsedValue.slice(index,highlightEndIndex),!0),endPart=escapeString(parsedValue.slice(highlightEndIndex));this.renderValueWithoutRenderer(`${startPart}<span class="ag-rich-select-row-text-highlight">${highlightedPart}</span>${endPart}`)}else hasMatch=!1}hasMatch||this.renderValueWithoutRenderer(parsedValue)}updateHighlighted(highlighted){var _a;const eGui=this.getGui(),parentId=`ag-rich-select-row-${this.getCompId()}`;if(null==(_a=eGui.parentElement)||_a.setAttribute("id",parentId),highlighted){setAriaActiveDescendant(this.getParentComponent().getAriaElement(),parentId),this.wrapperEl.setAttribute("data-active-option",parentId)}setAriaSelected(eGui.parentElement,highlighted),this.addOrRemoveCssClass("ag-rich-select-row-selected",highlighted)}populateWithoutRenderer(value,valueFormatted){const eDocument=this.gos.getDocument(),eGui=this.getGui(),span=eDocument.createElement("span");span.style.overflow="hidden",span.style.textOverflow="ellipsis";const parsedValue=escapeString(exists(valueFormatted)?valueFormatted:value,!0);this.parsedValue=exists(parsedValue)?parsedValue:null,eGui.appendChild(span),this.renderValueWithoutRenderer(parsedValue),this.setTooltip({newTooltipText:this.parsedValue,shouldDisplayTooltip:()=>span.scrollWidth>span.clientWidth})}renderValueWithoutRenderer(value){const span=this.getGui().querySelector("span");span&&(span.innerHTML=exists(value)?value:"&nbsp;")}populateWithRenderer(value,valueFormatted){let cellRendererPromise,userCompDetails;return this.params.cellRenderer&&(userCompDetails=this.userComponentFactory.getCellRendererDetails(this.params,{value,valueFormatted,setTooltip:(value2,shouldDisplayTooltip)=>{this.setTooltip({newTooltipText:value2,shouldDisplayTooltip})}})),userCompDetails&&(cellRendererPromise=userCompDetails.newAgStackInstance()),cellRendererPromise&&bindCellRendererToHtmlElement(cellRendererPromise,this.getGui()),!!cellRendererPromise&&(cellRendererPromise.then(childComponent=>{this.addDestroyFunc(()=>{this.getContext().destroyBean(childComponent)})}),!0)}onClick(){const parent=this.getParentComponent(),event={type:Events.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey:!1,value:this.value};null==parent||parent.dispatchEvent(event)}};__decorateClass([Autowired("userComponentFactory")],RichSelectRow.prototype,"userComponentFactory",2),__decorateClass([PostConstruct],RichSelectRow.prototype,"postConstruct",1);var _VirtualList=class _VirtualList extends TabGuardComp{constructor(params){super(_VirtualList.getTemplate((null==params?void 0:params.cssIdentifier)||"default")),this.renderedRows=new Map,this.rowHeight=20,this.pageSize=-1,this.isScrolling=!1,this.isHeightFromTheme=!0;const{cssIdentifier="default",ariaRole="listbox",listName}=params||{};this.cssIdentifier=cssIdentifier,this.ariaRole=ariaRole,this.listName=listName}postConstruct(){this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e),focusInnerElement:fromBottom=>this.focusInnerElement(fromBottom),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)}),this.setAriaProperties(),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanged.bind(this))}onGridStylesChanged(){this.rowHeight=this.getItemHeight(),this.refresh()}setAriaProperties(){const listName=this.localeService.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),ariaEl=this.eContainer;setAriaRole(ariaEl,this.ariaRole),setAriaLabel(ariaEl,listName)}addResizeObserver(){const destroyObserver=this.resizeObserverService.observeResize(this.getGui(),()=>this.animationFrameService.requestAnimationFrame(()=>this.drawVirtualRows()));this.addDestroyFunc(destroyObserver)}focusInnerElement(fromBottom){this.focusRow(fromBottom?this.model.getRowCount()-1:0)}onFocusIn(e){const target=e.target;target.classList.contains("ag-virtual-list-item")&&(this.lastFocusedRowIndex=getAriaPosInSet(target)-1)}onFocusOut(e){this.getFocusableElement().contains(e.relatedTarget)||(this.lastFocusedRowIndex=null)}handleKeyDown(e){switch(e.key){case KeyCode.UP:case KeyCode.DOWN:this.navigate(e.key===KeyCode.UP)&&e.preventDefault();break;case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:case KeyCode.PAGE_UP:case KeyCode.PAGE_DOWN:null!==this.navigateToPage(e.key)&&e.preventDefault()}}onTabKeyDown(e){this.navigate(e.shiftKey)?e.preventDefault():(stopPropagationForAgGrid(e),this.forceFocusOutOfContainer(e.shiftKey))}navigate(up){if(null==this.lastFocusedRowIndex)return!1;const nextRow=this.lastFocusedRowIndex+(up?-1:1);return!(nextRow<0||nextRow>=this.model.getRowCount())&&(this.focusRow(nextRow),!0)}navigateToPage(key,fromItem="focused"){let hasFocus=!1;"focused"===fromItem&&(fromItem=this.getLastFocusedRow(),hasFocus=!0);const rowCount=this.model.getRowCount()-1;let newIndex=-1;return key===KeyCode.PAGE_HOME?newIndex=0:key===KeyCode.PAGE_END?newIndex=rowCount:key===KeyCode.PAGE_DOWN?newIndex=Math.min(fromItem+this.pageSize,rowCount):key===KeyCode.PAGE_UP&&(newIndex=Math.max(fromItem-this.pageSize,0)),-1===newIndex?null:(hasFocus?this.focusRow(newIndex):this.ensureIndexVisible(newIndex),newIndex)}getLastFocusedRow(){return this.lastFocusedRowIndex}focusRow(rowNumber){this.isScrolling||(this.isScrolling=!0,this.ensureIndexVisible(rowNumber),this.animationFrameService.requestAnimationFrame(()=>{if(this.isScrolling=!1,!this.isAlive())return;const renderedRow=this.renderedRows.get(rowNumber);renderedRow&&renderedRow.eDiv.focus()}))}getComponentAt(rowIndex){const comp=this.renderedRows.get(rowIndex);return comp&&comp.rowComponent}forEachRenderedRow(func){this.renderedRows.forEach((value,key)=>func(value.rowComponent,key))}static getTemplate(cssIdentifier){return`<div class="ag-virtual-list-viewport ag-${cssIdentifier}-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-${cssIdentifier}-virtual-list-container" ref="eContainer"></div>\n            </div>`}getItemHeight(){return this.isHeightFromTheme?this.environment.getListItemHeight():this.rowHeight}ensureIndexVisible(index,scrollPartialIntoView=!0){const lastRow=this.model.getRowCount();if("number"!=typeof index||index<0||index>=lastRow)return console.warn("AG Grid: invalid row index for ensureIndexVisible: "+index),!1;const rowTopPixel=index*this.rowHeight,rowBottomPixel=rowTopPixel+this.rowHeight,eGui=this.getGui(),viewportTopPixel=eGui.scrollTop,viewportHeight=eGui.offsetHeight,viewportBottomPixel=viewportTopPixel+viewportHeight,diff=scrollPartialIntoView?0:this.rowHeight,viewportScrolledBeforeRow=viewportBottomPixel<rowBottomPixel-diff;if(viewportTopPixel>rowTopPixel+diff)return eGui.scrollTop=rowTopPixel,!0;if(viewportScrolledBeforeRow){const newScrollPosition=rowBottomPixel-viewportHeight;return eGui.scrollTop=newScrollPosition,!0}return!1}setComponentCreator(componentCreator){this.componentCreator=componentCreator}setComponentUpdater(componentUpdater){this.componentUpdater=componentUpdater}getRowHeight(){return this.rowHeight}getScrollTop(){return this.getGui().scrollTop}setRowHeight(rowHeight){this.isHeightFromTheme=!1,this.rowHeight=rowHeight,this.refresh()}refresh(softRefresh){if(null==this.model||!this.isAlive())return;const rowCount=this.model.getRowCount();this.eContainer.style.height=rowCount*this.rowHeight+"px",waitUntil(()=>this.eContainer.clientHeight>=rowCount*this.rowHeight,()=>{this.isAlive()&&(this.canSoftRefresh(softRefresh)?this.drawVirtualRows(!0):(this.clearVirtualRows(),this.drawVirtualRows()))})}canSoftRefresh(softRefresh){return!!(softRefresh&&this.renderedRows.size&&"function"==typeof this.model.areRowsEqual&&this.componentUpdater)}clearVirtualRows(){this.renderedRows.forEach((_2,rowIndex)=>this.removeRow(rowIndex))}drawVirtualRows(softRefresh){if(!this.isAlive()||!this.model)return;const gui=this.getGui(),topPixel=gui.scrollTop,bottomPixel=topPixel+gui.offsetHeight,firstRow=Math.floor(topPixel/this.rowHeight),lastRow=Math.floor(bottomPixel/this.rowHeight);this.pageSize=Math.floor((bottomPixel-topPixel)/this.rowHeight),this.ensureRowsRendered(firstRow,lastRow,softRefresh)}ensureRowsRendered(start,finish,softRefresh){this.renderedRows.forEach((_2,rowIndex)=>{(rowIndex<start||rowIndex>finish)&&rowIndex!==this.lastFocusedRowIndex&&this.removeRow(rowIndex)}),softRefresh&&this.refreshRows();for(let rowIndex=start;rowIndex<=finish;rowIndex++)this.renderedRows.has(rowIndex)||rowIndex<this.model.getRowCount()&&this.insertRow(rowIndex)}insertRow(rowIndex){const value=this.model.getRow(rowIndex),eDiv=document.createElement("div");eDiv.classList.add("ag-virtual-list-item",`ag-${this.cssIdentifier}-virtual-list-item`),setAriaRole(eDiv,"tree"===this.ariaRole?"treeitem":"option"),setAriaSetSize(eDiv,this.model.getRowCount()),setAriaPosInSet(eDiv,rowIndex+1),eDiv.setAttribute("tabindex","-1"),eDiv.style.height=`${this.rowHeight}px`,eDiv.style.top=this.rowHeight*rowIndex+"px";const rowComponent=this.componentCreator(value,eDiv);rowComponent.addGuiEventListener("focusin",()=>this.lastFocusedRowIndex=rowIndex),eDiv.appendChild(rowComponent.getGui()),this.renderedRows.has(rowIndex-1)?this.renderedRows.get(rowIndex-1).eDiv.insertAdjacentElement("afterend",eDiv):this.renderedRows.has(rowIndex+1)?this.renderedRows.get(rowIndex+1).eDiv.insertAdjacentElement("beforebegin",eDiv):this.eContainer.appendChild(eDiv),this.renderedRows.set(rowIndex,{rowComponent,eDiv,value})}removeRow(rowIndex){const component=this.renderedRows.get(rowIndex);this.eContainer.removeChild(component.eDiv),this.destroyBean(component.rowComponent),this.renderedRows.delete(rowIndex)}refreshRows(){const rowCount=this.model.getRowCount();this.renderedRows.forEach((row,rowIndex)=>{var _a,_b;if(rowIndex>=rowCount)this.removeRow(rowIndex);else{const newValue=this.model.getRow(rowIndex);(null==(_b=(_a=this.model).areRowsEqual)?void 0:_b.call(_a,row.value,newValue))?this.componentUpdater(newValue,row.rowComponent):this.removeRow(rowIndex)}})}addScrollListener(){this.addGuiEventListener("scroll",()=>this.drawVirtualRows(),{passive:!0})}setModel(model){this.model=model}getAriaElement(){return this.eContainer}destroy(){this.isAlive()&&(this.clearVirtualRows(),super.destroy())}};__decorateClass([Autowired("resizeObserverService")],_VirtualList.prototype,"resizeObserverService",2),__decorateClass([Autowired("animationFrameService")],_VirtualList.prototype,"animationFrameService",2),__decorateClass([RefSelector("eContainer")],_VirtualList.prototype,"eContainer",2),__decorateClass([PostConstruct],_VirtualList.prototype,"postConstruct",1);var VirtualList=_VirtualList,AgRichSelect=class extends AgPickerField{constructor(config){var _a,_b;super(__spreadProps(__spreadValues({pickerAriaLabelKey:"ariaLabelRichSelectField",pickerAriaLabelValue:"Rich Select Field",pickerType:"ag-list",className:"ag-rich-select",pickerIcon:"smallDown",ariaRole:"combobox",template:null!=(_a=null==config?void 0:config.template)?_a:'\n    <div class="ag-picker-field" role="presentation">\n        <div ref="eLabel"></div>\n            <div ref="eWrapper" class="ag-wrapper ag-picker-field-wrapper ag-rich-select-value ag-picker-collapsed">\n            <div ref="eDisplayField" class="ag-picker-field-display"></div>\n            <ag-input-text-field ref="eInput" class="ag-rich-select-field-input"></ag-input-text-field>\n            <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n        </div>\n    </div>',modalPicker:!1},config),{maxPickerHeight:null!=(_b=null==config?void 0:config.maxPickerHeight)?_b:"calc(var(--ag-row-height) * 6.5)"})),this.searchString="",this.highlightedItem=-1,this.lastRowHovered=-1,this.searchStringCreator=null;const{cellRowHeight,value,valueList,searchStringCreator}=config||{};null!=cellRowHeight&&(this.cellRowHeight=cellRowHeight),void 0!==value&&(this.value=value),null!=valueList&&(this.values=valueList),searchStringCreator&&(this.searchStringCreator=searchStringCreator)}postConstruct(){super.postConstruct(),this.createLoadingElement(),this.createListComponent();const{allowTyping,placeholder}=this.config;allowTyping?(this.eInput.setAutoComplete(!1).setInputPlaceholder(placeholder),this.eDisplayField.classList.add("ag-hidden")):this.eInput.setDisplayed(!1),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{searchDebounceDelay=300}=this.config;this.clearSearchString=debounce(this.clearSearchString,searchDebounceDelay),this.renderSelectedValue(),allowTyping&&(this.eInput.onValueChange(value=>this.searchTextFromString(value)),this.addManagedListener(this.eWrapper,"focus",this.onWrapperFocus.bind(this))),this.addManagedListener(this.eWrapper,"focusout",this.onWrapperFocusOut.bind(this))}createLoadingElement(){const eDocument=this.gos.getDocument(),translate=this.localeService.getLocaleTextFunc(),el=eDocument.createElement("div");el.classList.add("ag-loading-text"),el.innerText=translate("loadingOoo","Loading..."),this.eLoading=el}createListComponent(){this.listComponent=this.createBean(new VirtualList({cssIdentifier:"rich-select"})),this.listComponent.setComponentCreator(this.createRowComponent.bind(this));this.listComponent.setComponentUpdater((item,component)=>{}),this.listComponent.setParentComponent(this),this.addManagedListener(this.listComponent,Events.EVENT_FIELD_PICKER_VALUE_SELECTED,e=>{this.onListValueSelected(e.value,e.fromEnterKey)});const{cellRowHeight}=this;cellRowHeight&&this.listComponent.setRowHeight(cellRowHeight);const eListGui=this.listComponent.getGui(),eListAriaEl=this.listComponent.getAriaElement();this.addManagedListener(eListGui,"mousemove",this.onPickerMouseMove.bind(this)),this.addManagedListener(eListGui,"mousedown",e=>e.preventDefault()),eListGui.classList.add("ag-rich-select-list");const listId=`ag-rich-select-list-${this.listComponent.getCompId()}`;eListAriaEl.setAttribute("id",listId);setAriaLabel(eListAriaEl,this.localeService.getLocaleTextFunc()(this.config.pickerAriaLabelKey,this.config.pickerAriaLabelValue)),setAriaControls(this.eWrapper,eListAriaEl)}renderSelectedValue(){const{value,eDisplayField,config}=this,{allowTyping,initialInputValue}=this.config,valueFormatted=this.config.valueFormatter?this.config.valueFormatter(value):value;if(allowTyping)return void this.eInput.setValue(null!=initialInputValue?initialInputValue:valueFormatted);let userCompDetails,userCompDetailsPromise;if(config.cellRenderer&&(userCompDetails=this.userComponentFactory.getCellRendererDetails(this.config,{value,valueFormatted})),userCompDetails&&(userCompDetailsPromise=userCompDetails.newAgStackInstance()),userCompDetailsPromise)clearElement(eDisplayField),bindCellRendererToHtmlElement(userCompDetailsPromise,eDisplayField),userCompDetailsPromise.then(renderer=>{this.addDestroyFunc(()=>this.getContext().destroyBean(renderer))});else{if(exists(this.value))eDisplayField.innerText=valueFormatted,eDisplayField.classList.remove("ag-display-as-placeholder");else{const{placeholder}=config;exists(placeholder)?(eDisplayField.innerHTML=`${escapeString(placeholder)}`,eDisplayField.classList.add("ag-display-as-placeholder")):clearElement(eDisplayField)}this.setTooltip({newTooltipText:null!=valueFormatted?valueFormatted:null,shouldDisplayTooltip:()=>this.eDisplayField.scrollWidth>this.eDisplayField.clientWidth})}}getCurrentValueIndex(){const{currentList,value}=this;if(null==value||!currentList)return-1;for(let i=0;i<currentList.length;i++)if(currentList[i]===value)return i;return-1}highlightFilterMatch(){var _a;null==(_a=this.listComponent)||_a.forEachRenderedRow((cmp,idx)=>{cmp.highlightString(this.searchString)})}highlightSelectedValue(index){var _a;null==index&&(index=this.getCurrentValueIndex()),this.highlightedItem=index,null==(_a=this.listComponent)||_a.forEachRenderedRow((cmp,idx)=>{const highlighted=-1!==index&&this.highlightedItem===idx;cmp.updateHighlighted(highlighted)})}setRowHeight(height){height!==this.cellRowHeight&&(this.cellRowHeight=height),this.listComponent&&this.listComponent.setRowHeight(height)}createPickerComponent(){const{values:values2}=this;return values2&&this.setValueList({valueList:values2}),this.listComponent}setSearchStringCreator(searchStringFn){this.searchStringCreator=searchStringFn}setValueList(params){const{valueList,refresh}=params;this.listComponent&&this.currentList!==valueList&&(this.currentList=valueList,this.listComponent.setModel({getRowCount:()=>valueList.length,getRow:index=>valueList[index],areRowsEqual:(oldRow,newRow)=>oldRow===newRow}),refresh&&(this.values?this.listComponent.refresh(!0):(this.values=valueList,this.isPickerDisplayed&&this.showCurrentValueInPicker())))}showPicker(){super.showPicker(),this.showCurrentValueInPicker(),this.displayOrHidePicker()}showCurrentValueInPicker(){var _a,_b;if(!this.listComponent)return;if(!this.currentList)return void(this.isPickerDisplayed&&this.eLoading&&this.listComponent.appendChild(this.eLoading));(null==(_a=this.eLoading)?void 0:_a.offsetParent)&&(null==(_b=this.eLoading.parentElement)||_b.removeChild(this.eLoading));const currentValueIndex=this.getCurrentValueIndex();-1!==currentValueIndex?(this.listComponent.refresh(),this.listComponent.ensureIndexVisible(currentValueIndex),this.listComponent.refresh(!0),this.highlightSelectedValue(currentValueIndex)):this.listComponent.refresh()}beforeHidePicker(){this.highlightedItem=-1,super.beforeHidePicker()}onWrapperFocus(){if(!this.eInput)return;const focusableEl=this.eInput.getFocusableElement();focusableEl.focus(),focusableEl.select()}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}buildSearchStringFromKeyboardEvent(searchKey){let{key}=searchKey;if(key===KeyCode.BACKSPACE)this.searchString=this.searchString.slice(0,-1),key="";else if(!isEventFromPrintableCharacter(searchKey))return;searchKey.preventDefault(),this.searchTextFromCharacter(key)}searchTextFromCharacter(char){this.searchString+=char,this.runSearch(),this.clearSearchString()}searchTextFromString(str){null==str&&(str=""),this.searchString=str,this.runSearch()}buildSearchStrings(values2){const{valueFormatter=value=>value}=this.config;let searchStrings;return"number"==typeof values2[0]||"string"==typeof values2[0]?searchStrings=values2.map(v=>valueFormatter(v)):"object"==typeof values2[0]&&this.searchStringCreator&&(searchStrings=this.searchStringCreator(values2)),searchStrings}getSuggestionsAndFilteredValues(searchValue,valueList){let suggestions=[],filteredValues=[];if(!searchValue.length)return{suggestions,filteredValues};const{searchType="fuzzy",filterList}=this.config;if("fuzzy"===searchType){const fuzzySearchResult=fuzzySuggestions(this.searchString,valueList,!0);suggestions=fuzzySearchResult.values;const indices=fuzzySearchResult.indices;if(filterList&&indices.length)for(let i=0;i<indices.length;i++)filteredValues.push(this.values[indices[i]])}else suggestions=valueList.filter((val,idx)=>{const currentValue=val.toLocaleLowerCase(),valueToMatch=this.searchString.toLocaleLowerCase(),isMatch="match"===searchType?currentValue.startsWith(valueToMatch):-1!==currentValue.indexOf(valueToMatch);return filterList&&isMatch&&filteredValues.push(this.values[idx]),isMatch});return{suggestions,filteredValues}}filterListModel(filteredValues){const{filterList}=this.config;filterList&&(this.setValueList({valueList:filteredValues,refresh:!0}),this.alignPickerToComponent())}runSearch(){var _a,_b;const{values:values2}=this,searchStrings=this.buildSearchStrings(values2);if(!searchStrings)return void this.highlightSelectedValue(-1);const{suggestions,filteredValues}=this.getSuggestionsAndFilteredValues(this.searchString,searchStrings),{filterList,highlightMatch,searchType="fuzzy"}=this.config,filterValueLen=filteredValues.length,shouldFilter=!(!filterList||""===this.searchString);if(this.filterListModel(shouldFilter?filteredValues:values2),suggestions.length){const topSuggestionIndex=shouldFilter?0:searchStrings.indexOf(suggestions[0]);this.selectListItem(topSuggestionIndex)}else if(this.highlightSelectedValue(-1),!shouldFilter||filterValueLen)null==(_a=this.listComponent)||_a.ensureIndexVisible(0);else if(shouldFilter){this.getAriaElement().removeAttribute("data-active-option");const eListAriaEl=null==(_b=this.listComponent)?void 0:_b.getAriaElement();eListAriaEl&&setAriaActiveDescendant(eListAriaEl,null)}highlightMatch&&"fuzzy"!==searchType&&this.highlightFilterMatch(),this.displayOrHidePicker()}displayOrHidePicker(){var _a;const eListGui=null==(_a=this.listComponent)?void 0:_a.getGui(),toggleValue=!!this.currentList&&0===this.currentList.length;null==eListGui||eListGui.classList.toggle("ag-hidden",toggleValue)}clearSearchString(){this.searchString=""}selectListItem(index,preventUnnecessaryScroll){if(!this.isPickerDisplayed||!this.currentList||!this.listComponent||index<0||index>=this.currentList.length)return;this.listComponent.ensureIndexVisible(index,!preventUnnecessaryScroll)&&!preventUnnecessaryScroll&&this.listComponent.refresh(!0),this.highlightSelectedValue(index)}setValue(value,silent,fromPicker){const index=this.currentList?this.currentList.indexOf(value):-1;return-1===index?this:(this.value=value,fromPicker||this.selectListItem(index),this.renderSelectedValue(),super.setValue(value,silent))}createRowComponent(value){const row=new RichSelectRow(this.config,this.eWrapper);row.setParentComponent(this.listComponent),this.getContext().createBean(row),row.setState(value);const{highlightMatch,searchType="fuzzy"}=this.config;return highlightMatch&&"fuzzy"!==searchType&&row.highlightString(this.searchString),row}getRowForMouseEvent(e){const{listComponent}=this;if(!listComponent)return-1;const rect=(null==listComponent?void 0:listComponent.getGui()).getBoundingClientRect(),scrollTop=listComponent.getScrollTop(),mouseY=e.clientY-rect.top+scrollTop;return Math.floor(mouseY/listComponent.getRowHeight())}onPickerMouseMove(e){if(!this.listComponent)return;const row=this.getRowForMouseEvent(e);-1!==row&&row!=this.lastRowHovered&&(this.lastRowHovered=row,this.selectListItem(row,!0))}onNavigationKeyDown(event,key){event.preventDefault();const isDown=key===KeyCode.DOWN;if(!this.isPickerDisplayed&&isDown)return void this.showPicker();const oldIndex=this.highlightedItem,newIndex=-1===oldIndex?0:oldIndex+(isDown?1:-1);this.selectListItem(newIndex)}onPageNavigation(key){var _a;if(!this.isPickerDisplayed)return;const newIndex=null==(_a=this.listComponent)?void 0:_a.navigateToPage(key,this.highlightedItem);null!=newIndex&&this.animationFrameService.requestAnimationFrame(()=>{if(!this.isAlive())return null;this.highlightSelectedValue(newIndex)})}onEnterKeyDown(e){this.isPickerDisplayed&&(e.preventDefault(),this.currentList&&this.onListValueSelected(this.currentList[this.highlightedItem],!0))}onTabKeyDown(){this.isPickerDisplayed&&this.currentList&&this.setValue(this.currentList[this.highlightedItem],!1,!0)}onListValueSelected(value,fromEnterKey){this.setValue(value,!1,!0),this.dispatchPickerEvent(value,fromEnterKey),this.hidePicker()}dispatchPickerEvent(value,fromEnterKey){const event={type:Events.EVENT_FIELD_PICKER_VALUE_SELECTED,fromEnterKey,value};this.dispatchEvent(event)}getFocusableElement(){const{allowTyping}=this.config;return allowTyping?this.eInput.getFocusableElement():super.getFocusableElement()}onKeyDown(event){const key=event.key,{allowTyping}=this.config;switch(key){case KeyCode.LEFT:case KeyCode.RIGHT:allowTyping||event.preventDefault();break;case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:if(allowTyping){event.preventDefault();const inputEl=this.eInput.getInputElement(),target=key===KeyCode.PAGE_HOME?0:inputEl.value.length;inputEl.setSelectionRange(target,target);break}case KeyCode.PAGE_UP:case KeyCode.PAGE_DOWN:event.preventDefault(),this.onPageNavigation(key);break;case KeyCode.DOWN:case KeyCode.UP:this.onNavigationKeyDown(event,key);break;case KeyCode.ESCAPE:this.isPickerDisplayed&&(isVisible(this.listComponent.getGui())&&(event.preventDefault(),stopPropagationForAgGrid(event)),this.hidePicker());break;case KeyCode.ENTER:this.onEnterKeyDown(event);break;case KeyCode.TAB:this.onTabKeyDown();break;default:allowTyping||this.buildSearchStringFromKeyboardEvent(event)}}destroy(){this.listComponent&&(this.destroyBean(this.listComponent),this.listComponent=void 0),this.eLoading=void 0,super.destroy()}};__decorateClass([Autowired("userComponentFactory")],AgRichSelect.prototype,"userComponentFactory",2),__decorateClass([Autowired("animationFrameService")],AgRichSelect.prototype,"animationFrameService",2),__decorateClass([RefSelector("eInput")],AgRichSelect.prototype,"eInput",2);var _AgSlider=class _AgSlider extends AgAbstractLabel{constructor(config){super(config,_AgSlider.TEMPLATE),this.labelAlignment="top"}init(){this.eSlider.addCssClass("ag-slider-field");const{minValue,maxValue,textFieldWidth,step,value,onValueChange}=this.config;null!=minValue&&this.setMinValue(minValue),null!=maxValue&&this.setMaxValue(maxValue),null!=textFieldWidth&&this.setTextFieldWidth(textFieldWidth),null!=step&&this.setStep(step),null!=value&&this.setValue(value),null!=onValueChange&&this.onValueChange(onValueChange)}onValueChange(callbackFn){const eventChanged=Events.EVENT_FIELD_VALUE_CHANGED;return this.addManagedListener(this.eText,eventChanged,()=>{const textValue=parseFloat(this.eText.getValue());this.eSlider.setValue(textValue.toString(),!0),callbackFn(textValue||0)}),this.addManagedListener(this.eSlider,eventChanged,()=>{const sliderValue=this.eSlider.getValue();this.eText.setValue(sliderValue,!0),callbackFn(parseFloat(sliderValue))}),this}setSliderWidth(width){return this.eSlider.setWidth(width),this}setTextFieldWidth(width){return this.eText.setWidth(width),this}setMinValue(minValue){return this.eSlider.setMinValue(minValue),this.eText.setMin(minValue),this}setMaxValue(maxValue){return this.eSlider.setMaxValue(maxValue),this.eText.setMax(maxValue),this}getValue(){return this.eText.getValue()}setValue(value,silent){return this.getValue()===value||(this.eText.setValue(value,!0),this.eSlider.setValue(value,!0),silent||this.dispatchEvent({type:Events.EVENT_FIELD_VALUE_CHANGED})),this}setStep(step){return this.eSlider.setStep(step),this.eText.setStep(step),this}};_AgSlider.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',__decorateClass([RefSelector("eLabel")],_AgSlider.prototype,"eLabel",2),__decorateClass([RefSelector("eSlider")],_AgSlider.prototype,"eSlider",2),__decorateClass([RefSelector("eText")],_AgSlider.prototype,"eText",2),__decorateClass([PostConstruct],_AgSlider.prototype,"init",1);var AgSlider=_AgSlider,_AgGroupComponent=class _AgGroupComponent extends Component{constructor(params={}){super(_AgGroupComponent.getTemplate(params)),this.params=params,this.suppressEnabledCheckbox=!0,this.suppressToggleExpandOnEnableChange=!1;const{enabled,items,suppressEnabledCheckbox,expanded,suppressToggleExpandOnEnableChange,useToggle:toggleMode}=params;this.cssIdentifier=params.cssIdentifier||"default",this.enabled=null==enabled||enabled,this.items=items||[],this.useToggle=null!=toggleMode&&toggleMode,this.alignItems=params.alignItems||"center",this.expanded=null==expanded||expanded,null!=suppressEnabledCheckbox&&(this.suppressEnabledCheckbox=suppressEnabledCheckbox),null!=suppressToggleExpandOnEnableChange&&(this.suppressToggleExpandOnEnableChange=suppressToggleExpandOnEnableChange)}static getTemplate(params){const cssIdentifier=params.cssIdentifier||"default";return`\n            <div class="ag-group ag-${cssIdentifier}-group" role="presentation">\n                <div ref="eToolbar" class="ag-group-toolbar ag-${cssIdentifier}-group-toolbar">\n                    <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n                </div>\n                <div ref="eContainer" class="ag-group-container ag-group-container-${params.direction||"vertical"} ag-${cssIdentifier}-group-container"></div>\n            </div>\n        `}postConstruct(){if(this.setupTitleBar(),this.items.length){const initialItems=this.items;this.items=[],this.addItems(initialItems)}const localeTextFunc=this.localeService.getLocaleTextFunc();this.cbGroupEnabled.setLabel(localeTextFunc("enabled","Enabled")),this.enabled&&this.setEnabled(this.enabled,void 0,!0),this.setAlignItems(this.alignItems);const{onEnableChange,suppressOpenCloseIcons}=this.params;this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(null!=suppressOpenCloseIcons&&suppressOpenCloseIcons),this.refreshChildDisplay(),setDisplayed(this.eContainer,this.expanded),this.cbGroupEnabled.onValueChange(newSelection=>{this.setEnabled(newSelection,!0,this.suppressToggleExpandOnEnableChange),this.dispatchEnableChangeEvent(newSelection)}),null!=onEnableChange&&this.onEnableChange(onEnableChange)}refreshChildDisplay(){var _a;setDisplayed(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),null==(_a=this.eTitleBar)||_a.refreshOnExpand(this.expanded)}isExpanded(){return this.expanded}setAlignItems(alignment){this.alignItems!==alignment&&this.removeCssClass(`ag-group-item-alignment-${this.alignItems}`),this.alignItems=alignment;const newCls=`ag-group-item-alignment-${this.alignItems}`;return this.addCssClass(newCls),this}toggleGroupExpand(expanded){var _a;let silent=!1;if((null==(_a=this.eTitleBar)?void 0:_a.isSuppressCollapse())&&!this.useToggle)expanded=!0,silent=!0;else if(expanded=null!=expanded?expanded:!this.expanded,this.expanded===expanded)return this;return this.expanded=expanded,this.refreshChildDisplay(),setDisplayed(this.eContainer,expanded),silent||this.dispatchEvent({type:expanded?_AgGroupComponent.EVENT_EXPANDED:_AgGroupComponent.EVENT_COLLAPSED}),this}addItems(items){items.forEach(item=>this.addItem(item))}prependItem(item){this.insertItem(item,!0)}addItem(item){this.insertItem(item,!1)}insertItem(item,prepend){const container=this.eContainer,el=item instanceof Component?item.getGui():item;el.classList.add("ag-group-item",`ag-${this.cssIdentifier}-group-item`),prepend?(container.insertAdjacentElement("afterbegin",el),this.items.unshift(el)):(container.appendChild(el),this.items.push(el))}hideItem(hide,index){setDisplayed(this.items[index],!hide)}getItemIndex(item){const el=item instanceof Component?item.getGui():item;return this.items.indexOf(el)}setTitle(title){var _a;return null==(_a=this.eTitleBar)||_a.setTitle(title),this}addTitleBarWidget(el){var _a;return null==(_a=this.eTitleBar)||_a.addWidget(el),this}addCssClassToTitleBar(cssClass){var _a;null==(_a=this.eTitleBar)||_a.addCssClass(cssClass)}dispatchEnableChangeEvent(enabled){const event={type:_AgGroupComponent.EVENT_ENABLE_CHANGE,enabled};this.dispatchEvent(event)}setEnabled(enabled,skipToggle,skipExpand){var _a;return this.enabled=enabled,this.refreshDisabledStyles(),skipExpand||this.toggleGroupExpand(enabled),skipToggle||(this.cbGroupEnabled.setValue(enabled),null==(_a=this.eToggle)||_a.setValue(enabled)),this}isEnabled(){return this.enabled}onEnableChange(callbackFn){return this.addManagedListener(this,_AgGroupComponent.EVENT_ENABLE_CHANGE,event=>callbackFn(event.enabled)),this}hideEnabledCheckbox(hide){return this.suppressEnabledCheckbox=hide,this.refreshChildDisplay(),this.refreshDisabledStyles(),this}hideOpenCloseIcons(hide){var _a;return null==(_a=this.eTitleBar)||_a.hideOpenCloseIcons(hide),this}refreshDisabledStyles(){var _a;const disabled=!this.enabled;this.eContainer.classList.toggle("ag-disabled",disabled),null==(_a=this.eTitleBar)||_a.refreshDisabledStyles(this.suppressEnabledCheckbox&&disabled),this.eContainer.classList.toggle("ag-disabled-group-container",disabled)}setupTitleBar(){const titleBar=this.useToggle?this.createToggleTitleBar():this.createDefaultTitleBar();this.eToolbar.insertAdjacentElement("beforebegin",titleBar.getGui())}createDefaultTitleBar(){const titleBar=this.createManagedBean(new DefaultTitleBar(this.params));return this.eTitleBar=titleBar,titleBar.refreshOnExpand(this.expanded),this.addManagedListener(titleBar,DefaultTitleBar.EVENT_EXPAND_CHANGED,event=>this.toggleGroupExpand(event.expanded)),titleBar}createToggleTitleBar(){var _a;const eToggle=this.createManagedBean(new AgToggleButton({value:this.enabled,label:this.params.title,labelAlignment:"left",labelWidth:"flex",onValueChange:enabled=>{this.setEnabled(enabled,!0),this.dispatchEnableChangeEvent(enabled)}}));return eToggle.addCssClass("ag-group-title-bar"),eToggle.addCssClass(`ag-${null!=(_a=this.params.cssIdentifier)?_a:"default"}-group-title-bar ag-unselectable`),this.eToggle=eToggle,this.toggleGroupExpand(this.enabled),eToggle}};_AgGroupComponent.EVENT_EXPANDED="expanded",_AgGroupComponent.EVENT_COLLAPSED="collapsed",_AgGroupComponent.EVENT_ENABLE_CHANGE="enableChange",__decorateClass([RefSelector("eToolbar")],_AgGroupComponent.prototype,"eToolbar",2),__decorateClass([RefSelector("cbGroupEnabled")],_AgGroupComponent.prototype,"cbGroupEnabled",2),__decorateClass([RefSelector("eContainer")],_AgGroupComponent.prototype,"eContainer",2),__decorateClass([PostConstruct],_AgGroupComponent.prototype,"postConstruct",1);var AgGroupComponent=_AgGroupComponent,_DefaultTitleBar=class _DefaultTitleBar extends Component{constructor(params={}){super(_DefaultTitleBar.getTemplate(params)),this.suppressOpenCloseIcons=!1;const{title,suppressOpenCloseIcons}=params;title&&title.length>0&&(this.title=title),null!=suppressOpenCloseIcons&&(this.suppressOpenCloseIcons=suppressOpenCloseIcons)}static getTemplate(params){var _a;const cssIdentifier=null!=(_a=params.cssIdentifier)?_a:"default";return`\n            <div class="ag-group-title-bar ag-${cssIdentifier}-group-title-bar ag-unselectable" role="button">\n                <span class="ag-group-title-bar-icon ag-${cssIdentifier}-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-${cssIdentifier}-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-${cssIdentifier}-group-title"></span>\n            </div>\n        `}postConstruct(){this.setTitle(this.title),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract()}setupExpandContract(){this.eGroupClosedIcon.appendChild(createIcon("columnSelectClosed",this.gos,null)),this.eGroupOpenedIcon.appendChild(createIcon("columnSelectOpen",this.gos,null)),this.addManagedListener(this.getGui(),"click",()=>this.dispatchExpandChanged()),this.addManagedListener(this.getGui(),"keydown",e=>{switch(e.key){case KeyCode.ENTER:case KeyCode.SPACE:e.preventDefault(),this.dispatchExpandChanged();break;case KeyCode.RIGHT:case KeyCode.LEFT:e.preventDefault(),this.dispatchExpandChanged(e.key===KeyCode.RIGHT)}})}refreshOnExpand(expanded){this.refreshAriaStatus(expanded),this.refreshOpenCloseIcons(expanded)}refreshAriaStatus(expanded){this.suppressOpenCloseIcons||setAriaExpanded(this.getGui(),expanded)}refreshOpenCloseIcons(expanded){const showIcon=!this.suppressOpenCloseIcons;setDisplayed(this.eGroupOpenedIcon,showIcon&&expanded),setDisplayed(this.eGroupClosedIcon,showIcon&&!expanded)}isSuppressCollapse(){return this.suppressOpenCloseIcons}dispatchExpandChanged(expanded){const event={type:_DefaultTitleBar.EVENT_EXPAND_CHANGED,expanded};this.dispatchEvent(event)}setTitle(title){const eGui=this.getGui(),hasTitle=!!title&&title.length>0;title=hasTitle?title:void 0,this.eTitle.textContent=null!=title?title:"",setDisplayed(eGui,hasTitle),title!==this.title&&(this.title=title);const disabled=eGui.classList.contains("ag-disabled-group-title-bar");return this.refreshDisabledStyles(disabled),this}addWidget(el){return this.getGui().appendChild(el),this}hideOpenCloseIcons(hide){return this.suppressOpenCloseIcons=hide,hide&&this.dispatchExpandChanged(!0),this}refreshDisabledStyles(disabled){const eGui=this.getGui();disabled?(eGui.classList.add("ag-disabled-group-title-bar"),eGui.removeAttribute("tabindex")):(eGui.classList.remove("ag-disabled-group-title-bar"),"string"==typeof this.title?eGui.setAttribute("tabindex","0"):eGui.removeAttribute("tabindex"))}};_DefaultTitleBar.EVENT_EXPAND_CHANGED="expandedChanged",__decorateClass([RefSelector("eGroupOpenedIcon")],_DefaultTitleBar.prototype,"eGroupOpenedIcon",2),__decorateClass([RefSelector("eGroupClosedIcon")],_DefaultTitleBar.prototype,"eGroupClosedIcon",2),__decorateClass([RefSelector("eTitle")],_DefaultTitleBar.prototype,"eTitle",2),__decorateClass([PostConstruct],_DefaultTitleBar.prototype,"postConstruct",1);var DefaultTitleBar=_DefaultTitleBar,AgMenuList=class extends TabGuardComp{constructor(level=0,params){super('<div class="ag-menu-list" role="tree"></div>'),this.level=level,this.menuItems=[],this.params=null!=params?params:{column:null,node:null,value:null}}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.handleFocusIn(e),onFocusOut:e=>this.handleFocusOut(e)})}onTabKeyDown(e){const parent=this.getParentComponent(),parentGui=parent&&parent.getGui();parentGui&&parentGui.classList.contains("ag-focus-managed")||e.preventDefault(),e.shiftKey&&this.closeIfIsChild(e)}handleKeyDown(e){switch(e.key){case KeyCode.UP:case KeyCode.RIGHT:case KeyCode.DOWN:case KeyCode.LEFT:e.preventDefault(),this.handleNavKey(e.key);break;case KeyCode.ESCAPE:this.closeIfIsChild()&&stopPropagationForAgGrid(e)}}handleFocusIn(e){var _a,_b;const oldFocusedElement=e.relatedTarget;(this.tabGuardCtrl.isTabGuard(oldFocusedElement)||!this.getGui().contains(oldFocusedElement)&&!(null==(_b=null==(_a=this.activeMenuItem)?void 0:_a.getSubMenuGui())?void 0:_b.contains(oldFocusedElement)))&&(this.activeMenuItem?this.activeMenuItem.activate():this.activateFirstItem())}handleFocusOut(e){var _a;const newFocusedElement=e.relatedTarget;!this.activeMenuItem||this.getGui().contains(newFocusedElement)||(null==(_a=this.activeMenuItem.getSubMenuGui())?void 0:_a.contains(newFocusedElement))||this.activeMenuItem.isSubMenuOpening()||this.activeMenuItem.deactivate()}clearActiveItem(){this.activeMenuItem&&(this.activeMenuItem.deactivate(),this.activeMenuItem=null)}addMenuItems(menuItems){null!=menuItems&&AgPromise.all(menuItems.map(menuItemOrString=>"separator"===menuItemOrString?AgPromise.resolve({eGui:this.createSeparator()}):"string"==typeof menuItemOrString?(console.warn(`AG Grid: unrecognised menu item ${menuItemOrString}`),AgPromise.resolve({eGui:null})):this.addItem(menuItemOrString))).then(elements=>{elements.forEach(element=>{(null==element?void 0:element.eGui)&&(this.appendChild(element.eGui),element.comp&&this.menuItems.push(element.comp))})})}addItem(menuItemDef){const menuItem=this.createManagedBean(new AgMenuItemComponent);return menuItem.init({menuItemDef,isAnotherSubMenuOpen:()=>this.menuItems.some(m=>m.isSubMenuOpen()),level:this.level,contextParams:this.params}).then(()=>(menuItem.setParentComponent(this),this.addManagedListener(menuItem,AgMenuItemComponent.EVENT_CLOSE_MENU,event=>{this.dispatchEvent(event)}),this.addManagedListener(menuItem,AgMenuItemComponent.EVENT_MENU_ITEM_ACTIVATED,event=>{this.activeMenuItem&&this.activeMenuItem!==event.menuItem&&this.activeMenuItem.deactivate(),this.activeMenuItem=event.menuItem}),{comp:menuItem,eGui:menuItem.getGui()}))}activateFirstItem(){const item=this.menuItems.filter(currentItem=>!currentItem.isDisabled())[0];item&&item.activate()}createSeparator(){return loadTemplate('\n            <div class="ag-menu-separator" aria-hidden="true">\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n                <div class="ag-menu-separator-part"></div>\n            </div>')}handleNavKey(key){switch(key){case KeyCode.UP:case KeyCode.DOWN:const nextItem=this.findNextItem(key===KeyCode.UP);return void(nextItem&&nextItem!==this.activeMenuItem&&nextItem.activate())}key===(this.gos.get("enableRtl")?KeyCode.RIGHT:KeyCode.LEFT)?this.closeIfIsChild():this.openChild()}closeIfIsChild(e){const parentItem=this.getParentComponent();return!!(parentItem&&parentItem instanceof AgMenuItemComponent)&&(e&&e.preventDefault(),parentItem.closeSubMenu(),parentItem.getGui().focus(),!0)}openChild(){this.activeMenuItem&&this.activeMenuItem.openSubMenu(!0)}findNextItem(up){const items=this.menuItems.filter(item=>!item.isDisabled());if(!items.length)return;if(!this.activeMenuItem)return up?last(items):items[0];let nextItem;up&&items.reverse();let foundCurrent=!1;for(let i=0;i<items.length;i++){const item=items[i];if(foundCurrent){nextItem=item;break}item===this.activeMenuItem&&(foundCurrent=!0)}return foundCurrent&&!nextItem?items[0]:nextItem||this.activeMenuItem}destroy(){this.clearActiveItem(),super.destroy()}};__decorateClass([Autowired("focusService")],AgMenuList.prototype,"focusService",2),__decorateClass([PostConstruct],AgMenuList.prototype,"postConstruct",1);var AgMenuPanel=class extends TabGuardComp{constructor(wrappedComponent){super(),this.wrappedComponent=wrappedComponent,this.setTemplateFromElement(wrappedComponent.getGui())}postConstruct(){this.initialiseTabGuard({onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e)})}handleKeyDown(e){e.key===KeyCode.ESCAPE&&this.closePanel()}onTabKeyDown(e){e.defaultPrevented||(this.closePanel(),e.preventDefault())}closePanel(){const menuItem=this.parentComponent;menuItem.closeSubMenu(),setTimeout(()=>menuItem.getGui().focus(),0)}};__decorateClass([PostConstruct],AgMenuPanel.prototype,"postConstruct",1);var _AgMenuItemComponent=class _AgMenuItemComponent extends BeanStub{constructor(){super(...arguments),this.isActive=!1,this.subMenuIsOpen=!1,this.subMenuIsOpening=!1,this.suppressRootStyles=!0,this.suppressAria=!0,this.suppressFocus=!0}init(params){var _a,_b;const{menuItemDef,isAnotherSubMenuOpen,level,childComponent,contextParams}=params;this.params=params.menuItemDef,this.level=level,this.isAnotherSubMenuOpen=isAnotherSubMenuOpen,this.childComponent=childComponent,this.contextParams=contextParams,this.cssClassPrefix=null!=(_b=null==(_a=this.params.menuItemParams)?void 0:_a.cssClassPrefix)?_b:"ag-menu-option";return this.userComponentFactory.getMenuItemCompDetails(this.params,__spreadProps(__spreadValues({},menuItemDef),{level,isAnotherSubMenuOpen,openSubMenu:activateFirstItem=>this.openSubMenu(activateFirstItem),closeSubMenu:()=>this.closeSubMenu(),closeMenu:event=>this.closeMenu(event),updateTooltip:(tooltip,shouldDisplayTooltip)=>this.refreshTooltip(tooltip,shouldDisplayTooltip),onItemActivated:()=>this.onItemActivated()})).newAgStackInstance().then(comp=>{var _a2;this.menuItemComp=comp;const configureDefaults=null==(_a2=comp.configureDefaults)?void 0:_a2.call(comp);configureDefaults&&this.configureDefaults(!0===configureDefaults?void 0:configureDefaults)})}addListeners(eGui,params){(null==params?void 0:params.suppressClick)||this.addManagedListener(eGui,"click",e=>this.onItemSelected(e)),(null==params?void 0:params.suppressKeyboardSelect)||this.addManagedListener(eGui,"keydown",e=>{e.key!==KeyCode.ENTER&&e.key!==KeyCode.SPACE||(e.preventDefault(),this.onItemSelected(e))}),(null==params?void 0:params.suppressMouseDown)||this.addManagedListener(eGui,"mousedown",e=>{e.stopPropagation(),e.preventDefault()}),(null==params?void 0:params.suppressMouseOver)||(this.addManagedListener(eGui,"mouseenter",()=>this.onMouseEnter()),this.addManagedListener(eGui,"mouseleave",()=>this.onMouseLeave()))}isDisabled(){return!!this.params.disabled}openSubMenu(activateFirstItem=!1){var _a,_b;if(this.closeSubMenu(),!this.params.subMenu)return;this.subMenuIsOpening=!0;const ePopup=loadTemplate('<div class="ag-menu" role="presentation"></div>');let destroySubMenu;this.eSubMenuGui=ePopup;let afterGuiAttached=()=>{this.subMenuIsOpening=!1};if(this.childComponent){const menuPanel=this.createBean(new AgMenuPanel(this.childComponent));menuPanel.setParentComponent(this);const subMenuGui=menuPanel.getGui(),mouseEvent="mouseenter",mouseEnterListener=()=>this.cancelDeactivate();subMenuGui.addEventListener(mouseEvent,mouseEnterListener),destroySubMenu=()=>subMenuGui.removeEventListener(mouseEvent,mouseEnterListener),ePopup.appendChild(subMenuGui),this.childComponent.afterGuiAttached&&(afterGuiAttached=()=>{this.childComponent.afterGuiAttached(),this.subMenuIsOpening=!1})}else if(this.params.subMenu){const childMenu=this.createBean(new AgMenuList(this.level+1,this.contextParams));childMenu.setParentComponent(this),childMenu.addMenuItems(this.params.subMenu),ePopup.appendChild(childMenu.getGui()),this.addManagedListener(childMenu,_AgMenuItemComponent.EVENT_CLOSE_MENU,e=>this.dispatchEvent(e)),childMenu.addGuiEventListener("mouseenter",()=>this.cancelDeactivate()),destroySubMenu=()=>this.destroyBean(childMenu),activateFirstItem&&(afterGuiAttached=()=>{childMenu.activateFirstItem(),this.subMenuIsOpening=!1})}const positionCallback=this.popupService.positionPopupForMenu.bind(this.popupService,{eventSource:this.eGui,ePopup}),translate=this.localeService.getLocaleTextFunc(),addPopupRes=this.popupService.addPopup({modal:!0,eChild:ePopup,positionCallback,anchorToElement:this.eGui,ariaLabel:translate("ariaLabelSubMenu","SubMenu"),afterGuiAttached});this.subMenuIsOpen=!0,this.setAriaExpanded(!0),this.hideSubMenu=()=>{var _a2,_b2;addPopupRes&&addPopupRes.hideFunc(),this.subMenuIsOpen=!1,this.setAriaExpanded(!1),destroySubMenu(),null==(_b2=(_a2=this.menuItemComp).setExpanded)||_b2.call(_a2,!1),this.eSubMenuGui=void 0},null==(_b=(_a=this.menuItemComp).setExpanded)||_b.call(_a,!0)}setAriaExpanded(expanded){this.suppressAria||setAriaExpanded(this.eGui,expanded)}closeSubMenu(){this.hideSubMenu&&(this.hideSubMenu(),this.hideSubMenu=null,this.setAriaExpanded(!1))}isSubMenuOpen(){return this.subMenuIsOpen}isSubMenuOpening(){return this.subMenuIsOpening}activate(openSubMenu){var _a,_b;this.cancelActivate(),this.params.disabled||(this.isActive=!0,this.suppressRootStyles||this.eGui.classList.add(`${this.cssClassPrefix}-active`),null==(_b=(_a=this.menuItemComp).setActive)||_b.call(_a,!0),this.suppressFocus||this.eGui.focus({preventScroll:!0}),openSubMenu&&this.params.subMenu&&window.setTimeout(()=>{this.isAlive()&&this.isActive&&this.openSubMenu()},300),this.onItemActivated())}deactivate(){var _a,_b;this.cancelDeactivate(),this.suppressRootStyles||this.eGui.classList.remove(`${this.cssClassPrefix}-active`),null==(_b=(_a=this.menuItemComp).setActive)||_b.call(_a,!1),this.isActive=!1,this.subMenuIsOpen&&this.hideSubMenu()}getGui(){return this.menuItemComp.getGui()}getParentComponent(){return this.parentComponent}setParentComponent(component){this.parentComponent=component}getSubMenuGui(){return this.eSubMenuGui}onItemSelected(event){var _a,_b;null==(_b=(_a=this.menuItemComp).select)||_b.call(_a),this.params.action?this.getFrameworkOverrides().wrapOutgoing(()=>this.params.action(this.gos.addGridCommonParams(__spreadValues({},this.contextParams)))):this.openSubMenu(event&&"keydown"===event.type),this.params.subMenu&&!this.params.action||this.params.suppressCloseOnSelect||this.closeMenu(event)}closeMenu(event){const e={type:_AgMenuItemComponent.EVENT_CLOSE_MENU};event&&(event instanceof MouseEvent?e.mouseEvent=event:e.keyboardEvent=event),this.dispatchEvent(e)}onItemActivated(){const event={type:_AgMenuItemComponent.EVENT_MENU_ITEM_ACTIVATED,menuItem:this};this.dispatchEvent(event)}cancelActivate(){this.activateTimeoutId&&(window.clearTimeout(this.activateTimeoutId),this.activateTimeoutId=0)}cancelDeactivate(){this.deactivateTimeoutId&&(window.clearTimeout(this.deactivateTimeoutId),this.deactivateTimeoutId=0)}onMouseEnter(){this.cancelDeactivate(),this.isAnotherSubMenuOpen()?this.activateTimeoutId=window.setTimeout(()=>this.activate(!0),_AgMenuItemComponent.ACTIVATION_DELAY):this.activate(!0)}onMouseLeave(){this.cancelActivate(),this.isSubMenuOpen()?this.deactivateTimeoutId=window.setTimeout(()=>this.deactivate(),_AgMenuItemComponent.ACTIVATION_DELAY):this.deactivate()}configureDefaults(params){var _a,_b,_c;if(!this.menuItemComp)return void setTimeout(()=>this.configureDefaults(params));let eGui=this.menuItemComp.getGui();const rootElement=null==(_b=(_a=this.menuItemComp).getRootElement)?void 0:_b.call(_a);rootElement&&((null==params?void 0:params.suppressRootStyles)||eGui.classList.add("ag-menu-option-custom"),eGui=rootElement),this.eGui=eGui,this.suppressRootStyles=!!(null==params?void 0:params.suppressRootStyles),this.suppressRootStyles||(eGui.classList.add(this.cssClassPrefix),null==(_c=this.params.cssClasses)||_c.forEach(it=>eGui.classList.add(it)),this.params.disabled&&eGui.classList.add(`${this.cssClassPrefix}-disabled`)),(null==params?void 0:params.suppressTooltip)||this.refreshTooltip(this.params.tooltip),this.suppressAria=!!(null==params?void 0:params.suppressAria),this.suppressAria||(setAriaRole(eGui,"treeitem"),setAriaLevel(eGui,this.level+1),this.params.disabled&&setAriaDisabled(eGui,!0)),(null==params?void 0:params.suppressTabIndex)||eGui.setAttribute("tabindex","-1"),this.params.disabled||this.addListeners(eGui,params),this.suppressFocus=!!(null==params?void 0:params.suppressFocus)}refreshTooltip(tooltip,shouldDisplayTooltip){this.tooltip=tooltip,this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),tooltip&&this.menuItemComp&&(this.tooltipFeature=this.createBean(new TooltipFeature({getGui:()=>this.getGui(),getTooltipValue:()=>this.tooltip,getLocation:()=>"menu",shouldDisplayTooltip})))}destroy(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),super.destroy()}};_AgMenuItemComponent.EVENT_CLOSE_MENU="closeMenu",_AgMenuItemComponent.EVENT_MENU_ITEM_ACTIVATED="menuItemActivated",_AgMenuItemComponent.ACTIVATION_DELAY=80,__decorateClass([Autowired("popupService")],_AgMenuItemComponent.prototype,"popupService",2),__decorateClass([Autowired("userComponentFactory")],_AgMenuItemComponent.prototype,"userComponentFactory",2);var AgMenuItemComponent=_AgMenuItemComponent,_AgPanel=class _AgPanel extends Component{constructor(config){super(_AgPanel.getTemplate(config)),this.config=config,this.closable=!0}static getTemplate(config){const cssIdentifier=config.cssIdentifier||"default";return`<div class="ag-panel ag-${cssIdentifier}-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-${cssIdentifier}-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-${cssIdentifier}-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-${cssIdentifier}-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-${cssIdentifier}-panel-content-wrapper"></div>\n        </div>`}postConstruct(){const{component,closable,hideTitleBar,title,minWidth=250,width,minHeight=250,height,centered,popup,x,y}=this.config;this.positionableFeature=new PositionableFeature(this.getGui(),{minWidth,width,minHeight,height,centered,x,y,popup,calculateTopBuffer:()=>this.positionableFeature.getHeight()-this.getBodyHeight()}),this.createManagedBean(this.positionableFeature);const eGui=this.getGui();component&&this.setBodyComponent(component),hideTitleBar?setDisplayed(this.eTitleBar,!1):(title&&this.setTitle(title),this.setClosable(null!=closable?closable:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",e=>{if(eGui.contains(e.relatedTarget)||eGui.contains(this.gos.getActiveDomElement())||this.eTitleBarButtons.contains(e.target))return void e.preventDefault();const focusEl=this.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");focusEl&&focusEl.focus()}),popup&&this.positionableFeature.isPositioned()||(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")}renderComponent(){const eGui=this.getGui();eGui.focus(),this.close=()=>{eGui.parentElement.removeChild(eGui),this.destroy()}}getHeight(){return this.positionableFeature.getHeight()}setHeight(height){this.positionableFeature.setHeight(height)}getWidth(){return this.positionableFeature.getWidth()}setWidth(width){this.positionableFeature.setWidth(width)}setClosable(closable){if(closable!==this.closable&&(this.closable=closable),closable){const closeButtonComp=this.closeButtonComp=new Component(_AgPanel.CLOSE_BTN_TEMPLATE);this.getContext().createBean(closeButtonComp);const eGui=closeButtonComp.getGui(),child=createIconNoSpan("close",this.gos);child.classList.add("ag-panel-title-bar-button-icon"),eGui.appendChild(child),this.addTitleBarButton(closeButtonComp),closeButtonComp.addManagedListener(eGui,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){const eGui=this.closeButtonComp.getGui();eGui.parentElement.removeChild(eGui),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}}setBodyComponent(bodyComponent){bodyComponent.setParentComponent(this),this.eContentWrapper.appendChild(bodyComponent.getGui())}addTitleBarButton(button,position){const eTitleBarButtons=this.eTitleBarButtons,buttons=eTitleBarButtons.children,len=buttons.length;null==position&&(position=len),position=Math.max(0,Math.min(position,len)),button.addCssClass("ag-panel-title-bar-button");const eGui=button.getGui();0===position?eTitleBarButtons.insertAdjacentElement("afterbegin",eGui):position===len?eTitleBarButtons.insertAdjacentElement("beforeend",eGui):buttons[position-1].insertAdjacentElement("afterend",eGui),button.setParentComponent(this)}getBodyHeight(){return getInnerHeight(this.eContentWrapper)}getBodyWidth(){return getInnerWidth(this.eContentWrapper)}setTitle(title){this.eTitle.innerText=title}onBtClose(){this.close()}destroy(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));const eGui=this.getGui();eGui&&isVisible(eGui)&&this.close(),super.destroy()}};_AgPanel.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',__decorateClass([RefSelector("eContentWrapper")],_AgPanel.prototype,"eContentWrapper",2),__decorateClass([RefSelector("eTitleBar")],_AgPanel.prototype,"eTitleBar",2),__decorateClass([RefSelector("eTitleBarButtons")],_AgPanel.prototype,"eTitleBarButtons",2),__decorateClass([RefSelector("eTitle")],_AgPanel.prototype,"eTitle",2),__decorateClass([PostConstruct],_AgPanel.prototype,"postConstruct",1);var AgPanel=_AgPanel;__decorateClass([Autowired("popupService")],class extends AgPanel{constructor(config){super(__spreadProps(__spreadValues({},config),{popup:!0})),this.isMaximizable=!1,this.isMaximized=!1,this.maximizeListeners=[],this.resizeListenerDestroy=null,this.lastPosition={x:0,y:0,width:0,height:0}}postConstruct(){const eGui=this.getGui(),{movable,resizable,maximizable}=this.config;this.addCssClass("ag-dialog"),super.postConstruct(),this.addManagedListener(eGui,"focusin",e=>{this.popupService.bringPopupToFront(eGui)}),movable&&this.setMovable(movable),maximizable&&this.setMaximizable(maximizable),resizable&&this.setResizable(resizable)}renderComponent(){const eGui=this.getGui(),{alwaysOnTop,modal,title,afterGuiAttached}=this.config,translate=this.localeService.getLocaleTextFunc(),addPopupRes=this.popupService.addPopup({modal,eChild:eGui,closeOnEsc:!0,closedCallback:this.onClosed.bind(this),alwaysOnTop,ariaLabel:title||translate("ariaLabelDialog","Dialog"),afterGuiAttached});addPopupRes&&(this.close=addPopupRes.hideFunc)}onClosed(event){var _a,_b;this.destroy(),null==(_b=(_a=this.config).closedCallback)||_b.call(_a,event)}toggleMaximize(){const position=this.positionableFeature.getPosition();if(this.isMaximized){const{x,y,width,height}=this.lastPosition;this.setWidth(width),this.setHeight(height),this.positionableFeature.offsetElement(x,y)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=position.x,this.lastPosition.y=position.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()}refreshMaximizeIcon(){setDisplayed(this.maximizeIcon,!this.isMaximized),setDisplayed(this.minimizeIcon,this.isMaximized)}clearMaximizebleListeners(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(destroyListener=>destroyListener()),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)}destroy(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),super.destroy()}setResizable(resizable){this.positionableFeature.setResizable(resizable)}setMovable(movable){this.positionableFeature.setMovable(movable,this.eTitleBar)}setMaximizable(maximizable){if(!maximizable)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));const eTitleBar=this.eTitleBar;if(!eTitleBar||maximizable===this.isMaximizable)return;const maximizeButtonComp=this.buildMaximizeAndMinimizeElements();this.refreshMaximizeIcon(),maximizeButtonComp.addManagedListener(maximizeButtonComp.getGui(),"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(maximizeButtonComp,0),this.maximizeListeners.push(this.addManagedListener(eTitleBar,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",()=>{this.isMaximized=!1,this.refreshMaximizeIcon()})}buildMaximizeAndMinimizeElements(){const maximizeButtonComp=this.maximizeButtonComp=this.createBean(new Component('<div class="ag-dialog-button"></span>')),eGui=maximizeButtonComp.getGui();return this.maximizeIcon=createIconNoSpan("maximize",this.gos),eGui.appendChild(this.maximizeIcon),this.maximizeIcon.classList.add("ag-panel-title-bar-button-icon"),this.minimizeIcon=createIconNoSpan("minimize",this.gos),eGui.appendChild(this.minimizeIcon),this.minimizeIcon.classList.add("ag-panel-title-bar-button-icon"),maximizeButtonComp}}.prototype,"popupService",2);var instanceIdSeq=0,PopupService=class extends BeanStub{constructor(){super(...arguments),this.popupList=[]}postConstruct(){this.ctrlsService.whenReady(p=>{this.gridCtrl=p.gridCtrl}),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.handleThemeChange.bind(this))}getPopupParent(){const ePopupParent=this.gos.get("popupParent");return ePopupParent||this.gridCtrl.getGui()}positionPopupForMenu(params){const{eventSource,ePopup}=params,popupIdx=this.getPopupIndex(ePopup);if(-1!==popupIdx){this.popupList[popupIdx].alignedToElement=eventSource}const sourceRect=eventSource.getBoundingClientRect(),parentRect=this.getParentRect(),y=this.keepXYWithinBounds(ePopup,sourceRect.top-parentRect.top,0),minWidth=ePopup.clientWidth>0?ePopup.clientWidth:200;ePopup.style.minWidth=`${minWidth}px`;const maxX=parentRect.right-parentRect.left-minWidth;let x;function xRightPosition(){return sourceRect.right-parentRect.left-2}function xLeftPosition(){return sourceRect.left-parentRect.left-minWidth}this.gos.get("enableRtl")?(x=xLeftPosition(),x<0&&(x=xRightPosition(),this.setAlignedStyles(ePopup,"left")),x>maxX&&(x=0,this.setAlignedStyles(ePopup,"right"))):(x=xRightPosition(),x>maxX&&(x=xLeftPosition(),this.setAlignedStyles(ePopup,"right")),x<0&&(x=0,this.setAlignedStyles(ePopup,"left"))),ePopup.style.left=`${x}px`,ePopup.style.top=`${y}px`}positionPopupUnderMouseEvent(params){const{ePopup,nudgeX,nudgeY,skipObserver}=params;this.positionPopup({ePopup,nudgeX,nudgeY,keepWithinBounds:!0,skipObserver,updatePosition:()=>this.calculatePointerAlign(params.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(params.type,params.ePopup,null,params.mouseEvent,params.column,params.rowNode)})}calculatePointerAlign(e){const parentRect=this.getParentRect();return{x:e.clientX-parentRect.left,y:e.clientY-parentRect.top}}positionPopupByComponent(params){const{ePopup,nudgeX,nudgeY,keepWithinBounds,eventSource,alignSide="left",position="over",column,rowNode,type}=params,sourceRect=eventSource.getBoundingClientRect(),parentRect=this.getParentRect(),popupIdx=this.getPopupIndex(ePopup);if(-1!==popupIdx){this.popupList[popupIdx].alignedToElement=eventSource}this.positionPopup({ePopup,nudgeX,nudgeY,keepWithinBounds,updatePosition:()=>{let y,x=sourceRect.left-parentRect.left;if("right"===alignSide&&(x-=ePopup.offsetWidth-sourceRect.width),"over"===position)y=sourceRect.top-parentRect.top,this.setAlignedStyles(ePopup,"over");else{this.setAlignedStyles(ePopup,"under");y="under"===this.shouldRenderUnderOrAbove(ePopup,sourceRect,parentRect,params.nudgeY||0)?sourceRect.top-parentRect.top+sourceRect.height:sourceRect.top-ePopup.offsetHeight-2*(nudgeY||0)-parentRect.top}return{x,y}},postProcessCallback:()=>this.callPostProcessPopup(type,ePopup,eventSource,null,column,rowNode)})}shouldRenderUnderOrAbove(ePopup,targetCompRect,parentRect,nudgeY){const spaceAvailableUnder=parentRect.bottom-targetCompRect.bottom,spaceAvailableAbove=targetCompRect.top-parentRect.top,spaceRequired=ePopup.offsetHeight+nudgeY;return spaceAvailableUnder>spaceRequired?"under":spaceAvailableAbove>spaceRequired||spaceAvailableAbove>spaceAvailableUnder?"above":"under"}setAlignedStyles(ePopup,positioned){const popupIdx=this.getPopupIndex(ePopup);if(-1===popupIdx)return;const popup=this.popupList[popupIdx],{alignedToElement}=popup;if(!alignedToElement)return;["right","left","over","above","under"].forEach(position=>{alignedToElement.classList.remove(`ag-has-popup-positioned-${position}`),ePopup.classList.remove(`ag-popup-positioned-${position}`)}),positioned&&(alignedToElement.classList.add(`ag-has-popup-positioned-${positioned}`),ePopup.classList.add(`ag-popup-positioned-${positioned}`))}callPostProcessPopup(type,ePopup,eventSource,mouseEvent,column,rowNode){const callback=this.gos.getCallback("postProcessPopup");if(callback){callback({column,rowNode,ePopup,type,eventSource,mouseEvent})}}positionPopup(params){const{ePopup,keepWithinBounds,nudgeX,nudgeY,skipObserver,updatePosition}=params,lastSize={width:0,height:0},updatePopupPosition=(fromResizeObserver=!1)=>{let{x,y}=updatePosition();fromResizeObserver&&ePopup.clientWidth===lastSize.width&&ePopup.clientHeight===lastSize.height||(lastSize.width=ePopup.clientWidth,lastSize.height=ePopup.clientHeight,nudgeX&&(x+=nudgeX),nudgeY&&(y+=nudgeY),keepWithinBounds&&(x=this.keepXYWithinBounds(ePopup,x,1),y=this.keepXYWithinBounds(ePopup,y,0)),ePopup.style.left=`${x}px`,ePopup.style.top=`${y}px`,params.postProcessCallback&&params.postProcessCallback())};if(updatePopupPosition(),!skipObserver){const resizeObserverDestroyFunc=this.resizeObserverService.observeResize(ePopup,()=>updatePopupPosition(!0));setTimeout(()=>resizeObserverDestroyFunc(),PopupService.WAIT_FOR_POPUP_CONTENT_RESIZE)}}getActivePopups(){return this.popupList.map(popup=>popup.element)}getPopupList(){return this.popupList}getParentRect(){const eDocument=this.gos.getDocument();let popupParent=this.getPopupParent();return popupParent===eDocument.body?popupParent=eDocument.documentElement:"static"===getComputedStyle(popupParent).position&&(popupParent=popupParent.offsetParent),getElementRectWithOffset(popupParent)}keepXYWithinBounds(ePopup,position,direction){const isVertical=0===direction,sizeProperty=isVertical?"clientHeight":"clientWidth",anchorProperty=isVertical?"top":"left",offsetProperty=isVertical?"offsetHeight":"offsetWidth",scrollPositionProperty=isVertical?"scrollTop":"scrollLeft",eDocument=this.gos.getDocument(),docElement=eDocument.documentElement,popupParent=this.getPopupParent(),parentRect=popupParent.getBoundingClientRect(),documentRect=eDocument.documentElement.getBoundingClientRect(),isBody=popupParent===eDocument.body,offsetSize=ePopup[offsetProperty];let sizeOfParent=isBody?(isVertical?getAbsoluteHeight:getAbsoluteWidth)(docElement)+docElement[scrollPositionProperty]:popupParent[sizeProperty];isBody&&(sizeOfParent-=Math.abs(documentRect[anchorProperty]-parentRect[anchorProperty]));const max=sizeOfParent-offsetSize;return Math.min(Math.max(position,0),Math.abs(max))}addPopup(params){const eDocument=this.gos.getDocument(),{eChild,ariaLabel,alwaysOnTop,positionCallback,anchorToElement}=params;if(!eDocument)return console.warn("AG Grid: could not find the document, document is empty"),{hideFunc:()=>{}};const pos=this.getPopupIndex(eChild);if(-1!==pos){return{hideFunc:this.popupList[pos].hideFunc}}this.initialisePopupPosition(eChild);const wrapperEl=this.createPopupWrapper(eChild,ariaLabel,!!alwaysOnTop),removeListeners=this.addEventListenersToPopup(__spreadProps(__spreadValues({},params),{wrapperEl}));return positionCallback&&positionCallback(),this.addPopupToPopupList(eChild,wrapperEl,removeListeners,anchorToElement),{hideFunc:removeListeners}}initialisePopupPosition(element){const ePopupParentRect=this.getPopupParent().getBoundingClientRect();exists(element.style.top)||(element.style.top=-1*ePopupParentRect.top+"px"),exists(element.style.left)||(element.style.left=-1*ePopupParentRect.left+"px")}createPopupWrapper(element,ariaLabel,alwaysOnTop){const ePopupParent=this.getPopupParent(),eWrapper=document.createElement("div"),{allThemes}=this.environment.getTheme();return allThemes.length&&eWrapper.classList.add(...allThemes),eWrapper.classList.add("ag-popup"),element.classList.add(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),element.hasAttribute("role")||setAriaRole(element,"dialog"),setAriaLabel(element,ariaLabel),eWrapper.appendChild(element),ePopupParent.appendChild(eWrapper),alwaysOnTop?this.setAlwaysOnTop(element,!0):this.bringPopupToFront(element),eWrapper}handleThemeChange(){const{allThemes}=this.environment.getTheme();for(const popup of this.popupList){for(const className of Array.from(popup.wrapper.classList))className.startsWith("ag-theme-")&&popup.wrapper.classList.remove(className);allThemes.length&&popup.wrapper.classList.add(...allThemes)}}addEventListenersToPopup(params){const eDocument=this.gos.getDocument(),ePopupParent=this.getPopupParent(),{wrapperEl,eChild:popupEl,closedCallback,afterGuiAttached,closeOnEsc,modal}=params;let popupHidden=!1;const hidePopupOnKeyboardEvent=event=>{if(!wrapperEl.contains(this.gos.getActiveDomElement()))return;event.key!==KeyCode.ESCAPE||isStopPropagationForAgGrid(event)||removeListeners({keyboardEvent:event})},hidePopupOnMouseEvent=event=>removeListeners({mouseEvent:event}),hidePopupOnTouchEvent=event=>removeListeners({touchEvent:event}),removeListeners=(popupParams={})=>{const{mouseEvent,touchEvent,keyboardEvent,forceHide}=popupParams;(forceHide||!this.isEventFromCurrentPopup({mouseEvent,touchEvent},popupEl)&&!popupHidden)&&(popupHidden=!0,ePopupParent.removeChild(wrapperEl),eDocument.removeEventListener("keydown",hidePopupOnKeyboardEvent),eDocument.removeEventListener("mousedown",hidePopupOnMouseEvent),eDocument.removeEventListener("touchstart",hidePopupOnTouchEvent),eDocument.removeEventListener("contextmenu",hidePopupOnMouseEvent),this.eventService.removeEventListener(Events.EVENT_DRAG_STARTED,hidePopupOnMouseEvent),closedCallback&&closedCallback(mouseEvent||touchEvent||keyboardEvent),this.removePopupFromPopupList(popupEl))};return afterGuiAttached&&afterGuiAttached({hidePopup:removeListeners}),window.setTimeout(()=>{closeOnEsc&&eDocument.addEventListener("keydown",hidePopupOnKeyboardEvent),modal&&(eDocument.addEventListener("mousedown",hidePopupOnMouseEvent),this.eventService.addEventListener(Events.EVENT_DRAG_STARTED,hidePopupOnMouseEvent),eDocument.addEventListener("touchstart",hidePopupOnTouchEvent),eDocument.addEventListener("contextmenu",hidePopupOnMouseEvent))},0),removeListeners}addPopupToPopupList(element,wrapperEl,removeListeners,anchorToElement){this.popupList.push({element,wrapper:wrapperEl,hideFunc:removeListeners,instanceId:instanceIdSeq++,isAnchored:!!anchorToElement}),anchorToElement&&this.setPopupPositionRelatedToElement(element,anchorToElement)}getPopupIndex(el){return this.popupList.findIndex(p=>p.element===el)}setPopupPositionRelatedToElement(popupEl,relativeElement){const popupIndex=this.getPopupIndex(popupEl);if(-1===popupIndex)return;const popup=this.popupList[popupIndex];if(popup.stopAnchoringPromise&&popup.stopAnchoringPromise.then(destroyFunc=>destroyFunc&&destroyFunc()),popup.stopAnchoringPromise=void 0,popup.isAnchored=!1,!relativeElement)return;const destroyPositionTracker=this.keepPopupPositionedRelativeTo({element:relativeElement,ePopup:popupEl,hidePopup:popup.hideFunc});return popup.stopAnchoringPromise=destroyPositionTracker,popup.isAnchored=!0,destroyPositionTracker}removePopupFromPopupList(element){this.setAlignedStyles(element,null),this.setPopupPositionRelatedToElement(element,null),this.popupList=this.popupList.filter(p=>p.element!==element)}keepPopupPositionedRelativeTo(params){const eParent=this.getPopupParent(),parentRect=eParent.getBoundingClientRect(),{element,ePopup}=params,sourceRect=element.getBoundingClientRect(),initialDiffTop=parentRect.top-sourceRect.top,initialDiffLeft=parentRect.left-sourceRect.left;let lastDiffTop=initialDiffTop,lastDiffLeft=initialDiffLeft;const topPx=ePopup.style.top,top=parseInt(topPx.substring(0,topPx.length-1),10),leftPx=ePopup.style.left,left=parseInt(leftPx.substring(0,leftPx.length-1),10);return new AgPromise(resolve=>{this.getFrameworkOverrides().setInterval(()=>{const pRect=eParent.getBoundingClientRect(),sRect=element.getBoundingClientRect();if(0==sRect.top&&0==sRect.left&&0==sRect.height&&0==sRect.width)return void params.hidePopup();const currentDiffTop=pRect.top-sRect.top;if(currentDiffTop!=lastDiffTop){const newTop=this.keepXYWithinBounds(ePopup,top+initialDiffTop-currentDiffTop,0);ePopup.style.top=`${newTop}px`}lastDiffTop=currentDiffTop;const currentDiffLeft=pRect.left-sRect.left;if(currentDiffLeft!=lastDiffLeft){const newLeft=this.keepXYWithinBounds(ePopup,left+initialDiffLeft-currentDiffLeft,1);ePopup.style.left=`${newLeft}px`}lastDiffLeft=currentDiffLeft},200).then(intervalId=>{resolve(()=>{null!=intervalId&&window.clearInterval(intervalId)})})})}hasAnchoredPopup(){return this.popupList.some(popup=>popup.isAnchored)}isEventFromCurrentPopup(params,target){const{mouseEvent,touchEvent}=params,event=mouseEvent||touchEvent;if(!event)return!1;const indexOfThisChild=this.getPopupIndex(target);if(-1===indexOfThisChild)return!1;for(let i=indexOfThisChild;i<this.popupList.length;i++){if(isElementInEventPath(this.popupList[i].element,event))return!0}return this.isElementWithinCustomPopup(event.target)}isElementWithinCustomPopup(el){const eDocument=this.gos.getDocument();for(;el&&el!==eDocument.body;){if(el.classList.contains("ag-custom-component-popup")||null===el.parentElement)return!0;el=el.parentElement}return!1}getWrapper(ePopup){for(;!ePopup.classList.contains("ag-popup")&&ePopup.parentElement;)ePopup=ePopup.parentElement;return ePopup.classList.contains("ag-popup")?ePopup:null}setAlwaysOnTop(ePopup,alwaysOnTop){const eWrapper=this.getWrapper(ePopup);eWrapper&&(eWrapper.classList.toggle("ag-always-on-top",!!alwaysOnTop),alwaysOnTop&&this.bringPopupToFront(eWrapper))}bringPopupToFront(ePopup){const parent=this.getPopupParent(),popupList=Array.prototype.slice.call(parent.querySelectorAll(".ag-popup")),popupLen=popupList.length,alwaysOnTopList=Array.prototype.slice.call(parent.querySelectorAll(".ag-popup.ag-always-on-top")),onTopLength=alwaysOnTopList.length,eWrapper=this.getWrapper(ePopup);if(!eWrapper||popupLen<=1||!parent.contains(ePopup))return;const pos=popupList.indexOf(eWrapper),innerEls=eWrapper.querySelectorAll("div"),innerElsScrollMap=[];if(innerEls.forEach(el=>{0!==el.scrollTop&&innerElsScrollMap.push([el,el.scrollTop])}),onTopLength){eWrapper.classList.contains("ag-always-on-top")?pos!==popupLen-1&&last(alwaysOnTopList).insertAdjacentElement("afterend",eWrapper):pos!==popupLen-onTopLength-1&&alwaysOnTopList[0].insertAdjacentElement("beforebegin",eWrapper)}else pos!==popupLen-1&&last(popupList).insertAdjacentElement("afterend",eWrapper);for(;innerElsScrollMap.length;){const currentEl=innerElsScrollMap.pop();currentEl[0].scrollTop=currentEl[1]}}};PopupService.WAIT_FOR_POPUP_CONTENT_RESIZE=200,__decorateClass([Autowired("focusService")],PopupService.prototype,"focusService",2),__decorateClass([Autowired("ctrlsService")],PopupService.prototype,"ctrlsService",2),__decorateClass([Autowired("resizeObserverService")],PopupService.prototype,"resizeObserverService",2),__decorateClass([PostConstruct],PopupService.prototype,"postConstruct",1),PopupService=__decorateClass([Bean("popupService")],PopupService);var AgAutocompleteRow=class extends Component{constructor(){super('\n        <div class="ag-autocomplete-row" role="presentation">\n            <div class="ag-autocomplete-row-label"></div>\n        </div>'),this.hasHighlighting=!1}setState(value,selected){this.value=value,this.render(),this.updateSelected(selected)}updateSelected(selected){this.addOrRemoveCssClass("ag-autocomplete-row-selected",selected)}setSearchString(searchString){var _a;let keepHighlighting=!1;if(exists(searchString)){const index=null==(_a=this.value)?void 0:_a.toLocaleLowerCase().indexOf(searchString.toLocaleLowerCase());if(index>=0){keepHighlighting=!0,this.hasHighlighting=!0;const highlightEndIndex=index+searchString.length,startPart=escapeString(this.value.slice(0,index)),highlightedPart=escapeString(this.value.slice(index,highlightEndIndex)),endPart=escapeString(this.value.slice(highlightEndIndex));this.getGui().lastElementChild.innerHTML=`${startPart}<b>${highlightedPart}</b>${endPart}`}}!keepHighlighting&&this.hasHighlighting&&(this.hasHighlighting=!1,this.render())}render(){var _a;this.getGui().lastElementChild.innerHTML=null!=(_a=escapeString(this.value))?_a:"&nbsp;"}},_AgAutocompleteList=class _AgAutocompleteList extends PopupComponent{constructor(params){super(_AgAutocompleteList.TEMPLATE),this.params=params,this.searchString=""}destroy(){super.destroy()}init(){this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList=this.createManagedBean(new VirtualList({cssIdentifier:"autocomplete"})),this.virtualList.setComponentCreator(this.createRowComponent.bind(this)),this.eList.appendChild(this.virtualList.getGui()),this.virtualList.setModel({getRowCount:()=>this.autocompleteEntries.length,getRow:index=>this.autocompleteEntries[index]});const virtualListGui=this.virtualList.getGui();this.addManagedListener(virtualListGui,"click",()=>this.params.onConfirmed()),this.addManagedListener(virtualListGui,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(virtualListGui,"mousedown",e=>e.preventDefault()),this.setSelectedValue(0)}onNavigationKeyDown(event,key){event.preventDefault();const oldIndex=this.autocompleteEntries.indexOf(this.selectedValue),newIndex=key===KeyCode.UP?oldIndex-1:oldIndex+1;this.checkSetSelectedValue(newIndex)}setSearch(searchString){this.searchString=searchString,exists(searchString)?this.runSearch():(this.autocompleteEntries=this.params.autocompleteEntries,this.virtualList.refresh(),this.checkSetSelectedValue(0)),this.updateSearchInList()}runContainsSearch(searchString,searchStrings){let topMatch,topMatchStartsWithSearchString=!1;const lowerCaseSearchString=searchString.toLocaleLowerCase(),allMatches=searchStrings.filter(string=>{const index=string.toLocaleLowerCase().indexOf(lowerCaseSearchString),startsWithSearchString=0===index,isMatch=index>=0;return isMatch&&(!topMatch||!topMatchStartsWithSearchString&&startsWithSearchString||topMatchStartsWithSearchString===startsWithSearchString&&string.length<topMatch.length)&&(topMatch=string,topMatchStartsWithSearchString=startsWithSearchString),isMatch});return!topMatch&&allMatches.length&&(topMatch=allMatches[0]),{topMatch,allMatches}}runSearch(){var _a,_b;const{autocompleteEntries}=this.params,searchStrings=autocompleteEntries.map(v=>{var _a2;return null!=(_a2=v.displayValue)?_a2:v.key});let matchingStrings,topSuggestion;if(this.params.useFuzzySearch)matchingStrings=fuzzySuggestions(this.searchString,searchStrings,!0).values,topSuggestion=matchingStrings.length?matchingStrings[0]:void 0;else{const containsMatches=this.runContainsSearch(this.searchString,searchStrings);matchingStrings=containsMatches.allMatches,topSuggestion=containsMatches.topMatch}let filteredEntries=autocompleteEntries.filter(({key,displayValue})=>matchingStrings.includes(null!=displayValue?displayValue:key));if(!filteredEntries.length&&this.selectedValue&&(null==(_b=null==(_a=this.params)?void 0:_a.forceLastSelection)?void 0:_b.call(_a,this.selectedValue,this.searchString))&&(filteredEntries=[this.selectedValue]),this.autocompleteEntries=filteredEntries,this.virtualList.refresh(),!topSuggestion)return;const topSuggestionIndex=matchingStrings.indexOf(topSuggestion);this.checkSetSelectedValue(topSuggestionIndex)}updateSearchInList(){this.virtualList.forEachRenderedRow(row=>row.setSearchString(this.searchString))}checkSetSelectedValue(index){index>=0&&index<this.autocompleteEntries.length&&this.setSelectedValue(index)}setSelectedValue(index){const value=this.autocompleteEntries[index];this.selectedValue!==value&&(this.selectedValue=value,this.virtualList.ensureIndexVisible(index),this.virtualList.forEachRenderedRow((cmp,idx)=>{cmp.updateSelected(index===idx)}))}createRowComponent(value){var _a;const row=new AgAutocompleteRow;return this.getContext().createBean(row),row.setState(null!=(_a=value.displayValue)?_a:value.key,value===this.selectedValue),row}onMouseMove(mouseEvent){const rect=this.virtualList.getGui().getBoundingClientRect(),scrollTop=this.virtualList.getScrollTop(),mouseY=mouseEvent.clientY-rect.top+scrollTop,row=Math.floor(mouseY/this.virtualList.getRowHeight());this.checkSetSelectedValue(row)}afterGuiAttached(){this.virtualList.refresh()}getSelectedValue(){var _a;return this.autocompleteEntries.length&&null!=(_a=this.selectedValue)?_a:null}};_AgAutocompleteList.TEMPLATE='<div class="ag-autocomplete-list-popup">\n            <div ref="eList" class="ag-autocomplete-list"></div>\n        <div>',__decorateClass([RefSelector("eList")],_AgAutocompleteList.prototype,"eList",2),__decorateClass([PostConstruct],_AgAutocompleteList.prototype,"init",1);var AgAutocompleteList=_AgAutocompleteList,_AgAutocomplete=class _AgAutocomplete extends Component{constructor(){super('\n            <div class="ag-autocomplete" role="presentation">\n                <ag-input-text-field ref="eAutocompleteInput"></ag-input-text-field>\n            </div>'),this.isListOpen=!1,this.lastPosition=0,this.valid=!0}postConstruct(){this.eAutocompleteInput.onValueChange(value=>this.onValueChanged(value)),this.eAutocompleteInput.getInputElement().setAttribute("autocomplete","off"),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.addGuiEventListener("click",this.updatePositionAndList.bind(this)),this.addDestroyFunc(()=>{this.destroyBean(this.autocompleteList)}),this.addGuiEventListener("focusout",()=>this.onFocusOut())}onValueChanged(value){const parsedValue=makeNull(value);this.updateValue(parsedValue),this.updateAutocompleteList(parsedValue)}updateValue(value){this.updateLastPosition(),this.dispatchEvent({type:_AgAutocomplete.EVENT_VALUE_CHANGED,value}),this.validate(value)}updateAutocompleteList(value){var _a,_b,_c,_d;const autocompleteListParams=null!=(_b=null==(_a=this.listGenerator)?void 0:_a.call(this,value,this.lastPosition))?_b:{enabled:!1};if(autocompleteListParams.type&&autocompleteListParams.type===(null==(_c=this.autocompleteListParams)?void 0:_c.type)||this.isListOpen&&this.closeList(),this.autocompleteListParams=autocompleteListParams,null==(_d=this.autocompleteListParams)?void 0:_d.enabled){this.isListOpen||this.openList();const{searchString}=this.autocompleteListParams;this.autocompleteList.setSearch(null!=searchString?searchString:"")}else this.isListOpen&&this.closeList()}onKeyDown(event){const key=event.key;switch(this.updateLastPosition(),key){case KeyCode.ENTER:this.onEnterKeyDown(event);break;case KeyCode.TAB:this.onTabKeyDown(event);break;case KeyCode.DOWN:case KeyCode.UP:this.onUpDownKeyDown(event,key);break;case KeyCode.LEFT:case KeyCode.RIGHT:case KeyCode.PAGE_HOME:case KeyCode.PAGE_END:setTimeout(()=>{this.updatePositionAndList()});break;case KeyCode.ESCAPE:this.onEscapeKeyDown(event);break;case KeyCode.SPACE:event.ctrlKey&&!this.isListOpen&&(event.preventDefault(),this.forceOpenList())}}confirmSelection(){var _a;const selectedValue=null==(_a=this.autocompleteList)?void 0:_a.getSelectedValue();selectedValue&&(this.closeList(),this.dispatchEvent({type:_AgAutocomplete.EVENT_OPTION_SELECTED,value:this.getValue(),position:this.lastPosition,updateEntry:selectedValue,autocompleteType:this.autocompleteListParams.type}))}onTabKeyDown(event){this.isListOpen&&(event.preventDefault(),event.stopPropagation(),this.confirmSelection())}onEnterKeyDown(event){event.preventDefault(),this.isListOpen?this.confirmSelection():this.onCompleted()}onUpDownKeyDown(event,key){var _a;event.preventDefault(),this.isListOpen?null==(_a=this.autocompleteList)||_a.onNavigationKeyDown(event,key):this.forceOpenList()}onEscapeKeyDown(event){this.isListOpen&&(event.preventDefault(),event.stopPropagation(),this.closeList(),this.setCaret(this.lastPosition,!0))}onFocusOut(){this.isListOpen&&this.closeList()}updatePositionAndList(){var _a;this.updateLastPosition(),this.updateAutocompleteList(null!=(_a=this.eAutocompleteInput.getValue())?_a:null)}setCaret(position,setFocus){const eDocument=this.gos.getDocument(),activeEl=this.gos.getActiveDomElement();!setFocus||activeEl&&activeEl!==eDocument.body||this.eAutocompleteInput.getFocusableElement().focus();const eInput=this.eAutocompleteInput.getInputElement();eInput.setSelectionRange(position,position),position===eInput.value.length&&(eInput.scrollLeft=eInput.scrollWidth)}forceOpenList(){this.onValueChanged(this.eAutocompleteInput.getValue())}updateLastPosition(){var _a;this.lastPosition=null!=(_a=this.eAutocompleteInput.getInputElement().selectionStart)?_a:0}validate(value){var _a;this.validator&&(this.validationMessage=this.validator(value),this.eAutocompleteInput.getInputElement().setCustomValidity(null!=(_a=this.validationMessage)?_a:""),this.valid=!this.validationMessage,this.dispatchEvent({type:_AgAutocomplete.EVENT_VALID_CHANGED,isValid:this.valid,validationMessage:this.validationMessage}))}openList(){this.isListOpen=!0,this.autocompleteList=this.createBean(new AgAutocompleteList({autocompleteEntries:this.autocompleteListParams.entries,onConfirmed:()=>this.confirmSelection(),forceLastSelection:this.forceLastSelection}));const ePopupGui=this.autocompleteList.getGui(),positionParams={ePopup:ePopupGui,type:"autocomplete",eventSource:this.getGui(),position:"under",alignSide:this.gos.get("enableRtl")?"right":"left",keepWithinBounds:!0},addPopupRes=this.popupService.addPopup({eChild:ePopupGui,anchorToElement:this.getGui(),positionCallback:()=>this.popupService.positionPopupByComponent(positionParams),ariaLabel:this.listAriaLabel});this.hidePopup=addPopupRes.hideFunc,this.autocompleteList.afterGuiAttached()}closeList(){this.isListOpen=!1,this.hidePopup(),this.destroyBean(this.autocompleteList),this.autocompleteList=null}onCompleted(){this.isListOpen&&this.closeList(),this.dispatchEvent({type:_AgAutocomplete.EVENT_VALUE_CONFIRMED,value:this.getValue(),isValid:this.isValid()})}getValue(){return makeNull(this.eAutocompleteInput.getValue())}setInputPlaceholder(placeholder){return this.eAutocompleteInput.setInputPlaceholder(placeholder),this}setInputAriaLabel(label){return this.eAutocompleteInput.setInputAriaLabel(label),this}setListAriaLabel(label){return this.listAriaLabel=label,this}setListGenerator(listGenerator){return this.listGenerator=listGenerator,this}setValidator(validator){return this.validator=validator,this}isValid(){return this.valid}setValue(params){const{value,position,silent,updateListOnlyIfOpen,restoreFocus}=params;this.eAutocompleteInput.setValue(value,!0),this.setCaret(null!=position?position:this.lastPosition,restoreFocus),silent||this.updateValue(value),updateListOnlyIfOpen&&!this.isListOpen||this.updateAutocompleteList(value)}setForceLastSelection(forceLastSelection){return this.forceLastSelection=forceLastSelection,this}setInputDisabled(disabled){return this.eAutocompleteInput.setDisabled(disabled),this}};_AgAutocomplete.EVENT_VALUE_CHANGED="eventValueChanged",_AgAutocomplete.EVENT_VALUE_CONFIRMED="eventValueConfirmed",_AgAutocomplete.EVENT_OPTION_SELECTED="eventOptionSelected",_AgAutocomplete.EVENT_VALID_CHANGED="eventValidChanged",__decorateClass([Autowired("popupService")],_AgAutocomplete.prototype,"popupService",2),__decorateClass([RefSelector("eAutocompleteInput")],_AgAutocomplete.prototype,"eAutocompleteInput",2),__decorateClass([PostConstruct],_AgAutocomplete.prototype,"postConstruct",1);var AgAutocomplete=_AgAutocomplete,_PillDragComp=class _PillDragComp extends Component{constructor(dragSourceDropTarget,ghost,horizontal,template){super(),this.dragSourceDropTarget=dragSourceDropTarget,this.ghost=ghost,this.horizontal=horizontal,this.template=template}init(){var _a;this.setTemplate(null!=(_a=this.template)?_a:_PillDragComp.TEMPLATE);const eGui=this.getGui();this.addElementClasses(eGui),this.addElementClasses(this.eDragHandle,"drag-handle"),this.addElementClasses(this.eText,"text"),this.addElementClasses(this.eButton,"button"),this.eDragHandle.appendChild(createIconNoSpan("columnDrag",this.gos)),this.eButton.appendChild(createIconNoSpan("cancel",this.gos)),this.setupComponents(),!this.ghost&&this.isDraggable()&&this.addDragSource(),this.setupAria(),this.setupTooltip(),this.activateTabIndex(),this.refreshDraggable()}isDraggable(){return!0}refreshDraggable(){this.eDragHandle.classList.toggle("ag-column-select-column-readonly",!this.isDraggable())}setupAria(){const translate=this.localeService.getLocaleTextFunc(),ariaInstructions=[this.getAriaDisplayName()];this.addAdditionalAriaInstructions(ariaInstructions,translate),setAriaLabel(this.getGui(),ariaInstructions.join(". "))}addAdditionalAriaInstructions(ariaInstructions,translate){if(this.isRemovable()){const deleteAria=translate("ariaDropZoneColumnComponentDescription","Press DELETE to remove");ariaInstructions.push(deleteAria)}}setupTooltip(){const refresh=()=>{const newTooltipText=this.getTooltip();this.setTooltip({newTooltipText})};refresh(),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,refresh)}getDragSourceId(){}getDefaultIconName(){return DragAndDropService.ICON_NOT_ALLOWED}addDragSource(){const{dragAndDropService,eDragHandle}=this,getDragItem=this.createGetDragItem(),defaultIconName=this.getDefaultIconName(),dragSource={type:this.getDragSourceType(),sourceId:this.getDragSourceId(),eElement:eDragHandle,getDefaultIconName:()=>defaultIconName,getDragItem,dragItemName:this.getDisplayName()};dragAndDropService.addDragSource(dragSource,!0),this.addDestroyFunc(()=>dragAndDropService.removeDragSource(dragSource))}setupComponents(){this.setTextValue(),this.setupRemove(),this.ghost&&this.addCssClass("ag-column-drop-cell-ghost")}isRemovable(){return!0}refreshRemove(){setDisplayed(this.eButton,this.isRemovable())}setupRemove(){this.refreshRemove();const agEvent={type:_PillDragComp.EVENT_COLUMN_REMOVE};this.addGuiEventListener("keydown",e=>this.onKeyDown(e)),this.addManagedListener(this.eButton,"click",mouseEvent=>{this.dispatchEvent(agEvent),mouseEvent.stopPropagation()});const touchListener=new TouchListener(this.eButton);this.addManagedListener(touchListener,TouchListener.EVENT_TAP,()=>{this.dispatchEvent(agEvent)}),this.addDestroyFunc(touchListener.destroy.bind(touchListener))}onKeyDown(e){e.key===KeyCode.DELETE&&this.isRemovable()&&(e.preventDefault(),this.dispatchEvent({type:_PillDragComp.EVENT_COLUMN_REMOVE}))}getDisplayValue(){return this.getDisplayName()}setTextValue(){const displayValueSanitised=escapeString(this.getDisplayValue());this.eText.innerHTML=displayValueSanitised}addElementClasses(el,suffix){suffix=suffix?`-${suffix}`:"";const direction=this.horizontal?"horizontal":"vertical";el.classList.add(`ag-column-drop-cell${suffix}`,`ag-column-drop-${direction}-cell${suffix}`)}destroy(){super.destroy(),this.dragSourceDropTarget=null}};_PillDragComp.EVENT_COLUMN_REMOVE="columnRemove",_PillDragComp.TEMPLATE='<span role="option">\n          <span ref="eDragHandle" class="ag-drag-handle ag-column-drop-cell-drag-handle" role="presentation"></span>\n          <span ref="eText" class="ag-column-drop-cell-text" aria-hidden="true"></span>\n          <span ref="eButton" class="ag-column-drop-cell-button" role="presentation"></span>\n        </span>',__decorateClass([Autowired("dragAndDropService")],_PillDragComp.prototype,"dragAndDropService",2),__decorateClass([RefSelector("eText")],_PillDragComp.prototype,"eText",2),__decorateClass([RefSelector("eDragHandle")],_PillDragComp.prototype,"eDragHandle",2),__decorateClass([RefSelector("eButton")],_PillDragComp.prototype,"eButton",2),__decorateClass([PostConstruct],_PillDragComp.prototype,"init",1);var PillDragComp=_PillDragComp,_PillDropZonePanel=class _PillDropZonePanel extends Component{constructor(horizontal){super('<div class="ag-unselectable" role="presentation"></div>'),this.horizontal=horizontal,this.state=_PillDropZonePanel.STATE_NOT_DRAGGING,this.guiDestroyFunctions=[],this.childPillComponents=[],this.resizeEnabled=!1,this.addElementClasses(this.getGui()),this.ePillDropList=document.createElement("div"),this.addElementClasses(this.ePillDropList,"list"),setAriaRole(this.ePillDropList,"listbox")}isHorizontal(){return this.horizontal}toggleResizable(resizable){this.positionableFeature.setResizable(!!resizable&&{bottom:!0}),this.resizeEnabled=resizable}isSourceEventFromTarget(draggingEvent){const{dropZoneTarget,dragSource}=draggingEvent;return dropZoneTarget.contains(dragSource.eElement)}destroy(){this.destroyGui(),super.destroy()}destroyGui(){this.guiDestroyFunctions.forEach(func=>func()),this.guiDestroyFunctions.length=0,this.childPillComponents.length=0,clearElement(this.getGui()),clearElement(this.ePillDropList)}init(params){this.params=null!=params?params:{},this.createManagedBean(new ManagedFocusFeature(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.setupDropTarget(),this.positionableFeature=new PositionableFeature(this.getGui(),{minHeight:100}),this.createManagedBean(this.positionableFeature),this.refreshGui(),setAriaLabel(this.ePillDropList,this.getAriaLabel())}handleKeyDown(e){const isVertical=!this.horizontal;let isNext=e.key===KeyCode.DOWN,isPrevious=e.key===KeyCode.UP;if(!isVertical){const isRtl=this.gos.get("enableRtl");isNext=!isRtl&&e.key===KeyCode.RIGHT||isRtl&&e.key===KeyCode.LEFT,isPrevious=!isRtl&&e.key===KeyCode.LEFT||isRtl&&e.key===KeyCode.RIGHT}if(!isNext&&!isPrevious)return;const el=this.focusService.findNextFocusableElement(this.getFocusableElement(),!1,isPrevious);el&&(e.preventDefault(),el.focus())}addElementClasses(el,suffix){suffix=suffix?`-${suffix}`:"";const direction=this.horizontal?"horizontal":"vertical";el.classList.add(`ag-column-drop${suffix}`,`ag-column-drop-${direction}${suffix}`)}setupDropTarget(){this.dropTarget={getContainer:this.getGui.bind(this),getIconName:this.getIconName.bind(this),onDragging:this.onDragging.bind(this),onDragEnter:this.onDragEnter.bind(this),onDragLeave:this.onDragLeave.bind(this),onDragStop:this.onDragStop.bind(this),isInterestedIn:this.isInterestedIn.bind(this)},this.dragAndDropService.addDropTarget(this.dropTarget)}minimumAllowedNewInsertIndex(){return 0}checkInsertIndex(draggingEvent){const newIndex=this.getNewInsertIndex(draggingEvent);if(newIndex<0)return!1;const minimumAllowedIndex=this.minimumAllowedNewInsertIndex(),newAdjustedIndex=Math.max(minimumAllowedIndex,newIndex),changed=newAdjustedIndex!==this.insertIndex;return changed&&(this.insertIndex=newAdjustedIndex),changed}getNewInsertIndex(draggingEvent){const mouseEvent=draggingEvent.event,mouseLocation=this.horizontal?mouseEvent.clientX:mouseEvent.clientY,boundsList=this.childPillComponents.map(comp=>comp.getGui().getBoundingClientRect()),hoveredIndex=boundsList.findIndex(rect=>this.horizontal?rect.right>mouseLocation&&rect.left<mouseLocation:rect.top<mouseLocation&&rect.bottom>mouseLocation);if(-1===hoveredIndex){const enableRtl=this.gos.get("enableRtl");if(boundsList.every(rect=>mouseLocation>(this.horizontal?rect.right:rect.bottom)))return enableRtl&&this.horizontal?0:this.childPillComponents.length;return boundsList.every(rect=>mouseLocation<(this.horizontal?rect.left:rect.top))?enableRtl&&this.horizontal?this.childPillComponents.length:0:this.insertIndex}return this.insertIndex<=hoveredIndex?hoveredIndex+1:hoveredIndex}checkDragStartedBySelf(draggingEvent){this.state===_PillDropZonePanel.STATE_NOT_DRAGGING&&(this.state=_PillDropZonePanel.STATE_REARRANGE_ITEMS,this.potentialDndItems=this.getItems(draggingEvent.dragSource.getDragItem()),this.refreshGui(),this.checkInsertIndex(draggingEvent),this.refreshGui())}onDragging(draggingEvent){this.checkDragStartedBySelf(draggingEvent),this.checkInsertIndex(draggingEvent)&&this.refreshGui()}handleDragEnterEnd(draggingEvent){}onDragEnter(draggingEvent){const dragItems=this.getItems(draggingEvent.dragSource.getDragItem());this.state=_PillDropZonePanel.STATE_NEW_ITEMS_IN;const goodDragItems=dragItems.filter(item=>this.isItemDroppable(item,draggingEvent)),alreadyPresent=goodDragItems.every(item=>-1!==this.childPillComponents.map(cmp=>cmp.getItem()).indexOf(item));0!==goodDragItems.length&&(this.potentialDndItems=goodDragItems,alreadyPresent?this.state=_PillDropZonePanel.STATE_NOT_DRAGGING:(this.handleDragEnterEnd(draggingEvent),this.checkInsertIndex(draggingEvent),this.refreshGui()))}isPotentialDndItems(){return existsAndNotEmpty(this.potentialDndItems)}handleDragLeaveEnd(draggingEvent){}onDragLeave(draggingEvent){if(this.state===_PillDropZonePanel.STATE_REARRANGE_ITEMS){const items=this.getItems(draggingEvent.dragSource.getDragItem());this.removeItems(items)}this.isPotentialDndItems()&&(this.handleDragLeaveEnd(draggingEvent),this.potentialDndItems=[],this.refreshGui()),this.state=_PillDropZonePanel.STATE_NOT_DRAGGING}refreshOnDragStop(){return!0}onDragStop(){if(this.isPotentialDndItems()){let success=!1;this.state===_PillDropZonePanel.STATE_NEW_ITEMS_IN?(this.addItems(this.potentialDndItems),success=!0):success=this.rearrangeItems(this.potentialDndItems),this.potentialDndItems=[],!this.refreshOnDragStop()&&success||this.refreshGui()}this.state=_PillDropZonePanel.STATE_NOT_DRAGGING}removeItems(itemsToRemove){const newItemList=this.getExistingItems().filter(item=>!includes(itemsToRemove,item));this.updateItems(newItemList)}addItems(itemsToAdd){if(!itemsToAdd)return;const newItemList=this.getExistingItems().slice(),itemsToAddNoDuplicates=itemsToAdd.filter(item=>newItemList.indexOf(item)<0);insertArrayIntoArray(newItemList,itemsToAddNoDuplicates,this.insertIndex),this.updateItems(newItemList)}addItem(item){this.insertIndex=this.getExistingItems().length,this.addItems([item]),this.refreshGui()}rearrangeItems(itemsToAdd){const newItemList=this.getNonGhostItems().slice();return insertArrayIntoArray(newItemList,itemsToAdd,this.insertIndex),!areEqual(newItemList,this.getExistingItems())&&(this.updateItems(newItemList),!0)}refreshGui(){const scrollTop=this.ePillDropList.scrollTop,resizeEnabled=this.resizeEnabled,focusedIndex=this.getFocusedItem();let alternateElement=this.focusService.findNextFocusableElement();alternateElement||(alternateElement=this.focusService.findNextFocusableElement(void 0,!1,!0)),this.toggleResizable(!1),this.destroyGui(),this.addIconAndTitleToGui(),this.addEmptyMessageToGui(),this.addItemsToGui(),this.isHorizontal()||(this.ePillDropList.scrollTop=scrollTop),resizeEnabled&&this.toggleResizable(resizeEnabled),this.focusService.isKeyboardMode()&&this.restoreFocus(focusedIndex,alternateElement)}getFocusedItem(){const eGui=this.getGui(),activeElement=this.gos.getActiveDomElement();if(!eGui.contains(activeElement))return-1;return Array.from(eGui.querySelectorAll(".ag-column-drop-cell")).indexOf(activeElement)}restoreFocus(index,alternateElement){const eGui=this.getGui(),items=Array.from(eGui.querySelectorAll(".ag-column-drop-cell"));if(-1===index)return;0===items.length&&alternateElement.focus();const el=items[Math.min(items.length-1,index)];el&&el.focus()}focusList(fromBottom){const index=fromBottom?this.childPillComponents.length-1:0;this.restoreFocus(index,this.getFocusableElement())}getNonGhostItems(){const existingItems=this.getExistingItems();return this.isPotentialDndItems()?existingItems.filter(item=>!includes(this.potentialDndItems,item)):existingItems}addItemsToGui(){const itemsToAddToGui=this.getNonGhostItems().map(item=>this.createItemComponent(item,!1));if(this.isPotentialDndItems()){const dndItems=this.potentialDndItems.map(item=>this.createItemComponent(item,!0));this.insertIndex>=itemsToAddToGui.length?itemsToAddToGui.push(...dndItems):itemsToAddToGui.splice(this.insertIndex,0,...dndItems)}this.appendChild(this.ePillDropList),itemsToAddToGui.forEach((itemComponent,index)=>{index>0&&this.addArrow(this.ePillDropList),this.ePillDropList.appendChild(itemComponent.getGui())}),this.addAriaLabelsToComponents()}addAriaLabelsToComponents(){this.childPillComponents.forEach((comp,idx)=>{const eGui=comp.getGui();setAriaPosInSet(eGui,idx+1),setAriaSetSize(eGui,this.childPillComponents.length)})}createItemComponent(item,ghost){const itemComponent=this.createPillComponent(item,this.dropTarget,ghost,this.horizontal);return itemComponent.addEventListener(PillDragComp.EVENT_COLUMN_REMOVE,this.removeItems.bind(this,[item])),this.context.createBean(itemComponent),this.guiDestroyFunctions.push(()=>this.destroyBean(itemComponent)),ghost||this.childPillComponents.push(itemComponent),itemComponent}addIconAndTitleToGui(){const{title,icon:eGroupIcon}=this.params;if(!title||!eGroupIcon)return;const eTitleBar=document.createElement("div");if(setAriaHidden(eTitleBar,!0),this.addElementClasses(eTitleBar,"title-bar"),this.addElementClasses(eGroupIcon,"icon"),this.addOrRemoveCssClass("ag-column-drop-empty",this.isExistingItemsEmpty()),eTitleBar.appendChild(eGroupIcon),!this.horizontal){const eTitle=document.createElement("span");this.addElementClasses(eTitle,"title"),eTitle.innerHTML=title,eTitleBar.appendChild(eTitle)}this.appendChild(eTitleBar)}isExistingItemsEmpty(){return 0===this.getExistingItems().length}addEmptyMessageToGui(){const{emptyMessage}=this.params;if(!emptyMessage||!this.isExistingItemsEmpty()||this.isPotentialDndItems())return;const eMessage=document.createElement("span");eMessage.innerHTML=emptyMessage,this.addElementClasses(eMessage,"empty-message"),this.ePillDropList.appendChild(eMessage)}addArrow(eParent){if(this.horizontal){const icon=createIconNoSpan(this.gos.get("enableRtl")?"smallLeft":"smallRight",this.gos);this.addElementClasses(icon,"cell-separator"),eParent.appendChild(icon)}}};_PillDropZonePanel.STATE_NOT_DRAGGING="notDragging",_PillDropZonePanel.STATE_NEW_ITEMS_IN="newItemsIn",_PillDropZonePanel.STATE_REARRANGE_ITEMS="rearrangeItems",__decorateClass([Autowired("focusService")],_PillDropZonePanel.prototype,"focusService",2),__decorateClass([Autowired("dragAndDropService")],_PillDropZonePanel.prototype,"dragAndDropService",2);var PASSIVE_EVENTS2=["touchstart","touchend","touchmove","touchcancel"],VanillaFrameworkOverrides=class{constructor(frameworkName="javascript"){this.frameworkName=frameworkName,this.renderingEngine="vanilla",this.wrapIncoming=callback=>callback(),this.wrapOutgoing=callback=>callback()}setInterval(action,timeout){return new AgPromise(resolve=>{resolve(window.setInterval(action,timeout))})}addEventListener(element,type,listener,useCapture){const isPassive=includes(PASSIVE_EVENTS2,type);element.addEventListener(type,listener,{capture:!!useCapture,passive:isPassive})}get shouldWrapOutgoing(){return!1}frameworkComponent(name){return null}isFrameworkComponent(comp){return!1}getDocLink(path){return`https://www.ag-grid.com/${"solid"===this.frameworkName?"react":this.frameworkName}-data-grid${path?`/${path}`:""}`}},CellNavigationService=class extends BeanStub{getNextCellToFocus(key,focusedCell,ctrlPressed=!1){return ctrlPressed?this.getNextCellToFocusWithCtrlPressed(key,focusedCell):this.getNextCellToFocusWithoutCtrlPressed(key,focusedCell)}getNextCellToFocusWithCtrlPressed(key,focusedCell){const upKey=key===KeyCode.UP,downKey=key===KeyCode.DOWN,leftKey=key===KeyCode.LEFT;let column,rowIndex;if(upKey||downKey)rowIndex=upKey?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow(),column=focusedCell.column;else{const allColumns=this.columnModel.getAllDisplayedColumns(),isRtl=this.gos.get("enableRtl");rowIndex=focusedCell.rowIndex,column=leftKey!==isRtl?allColumns[0]:last(allColumns)}return{rowIndex,rowPinned:null,column}}getNextCellToFocusWithoutCtrlPressed(key,focusedCell){let pointer=focusedCell,finished=!1;for(;!finished;){switch(key){case KeyCode.UP:pointer=this.getCellAbove(pointer);break;case KeyCode.DOWN:pointer=this.getCellBelow(pointer);break;case KeyCode.RIGHT:pointer=this.gos.get("enableRtl")?this.getCellToLeft(pointer):this.getCellToRight(pointer);break;case KeyCode.LEFT:pointer=this.gos.get("enableRtl")?this.getCellToRight(pointer):this.getCellToLeft(pointer);break;default:pointer=null,console.warn("AG Grid: unknown key for navigation "+key)}finished=!pointer||this.isCellGoodToFocusOn(pointer)}return pointer}isCellGoodToFocusOn(gridCell){const column=gridCell.column;let rowNode;switch(gridCell.rowPinned){case"top":rowNode=this.pinnedRowModel.getPinnedTopRow(gridCell.rowIndex);break;case"bottom":rowNode=this.pinnedRowModel.getPinnedBottomRow(gridCell.rowIndex);break;default:rowNode=this.rowModel.getRow(gridCell.rowIndex)}if(!rowNode)return!1;return!column.isSuppressNavigable(rowNode)}getCellToLeft(lastCell){if(!lastCell)return null;const colToLeft=this.columnModel.getDisplayedColBefore(lastCell.column);return colToLeft?{rowIndex:lastCell.rowIndex,column:colToLeft,rowPinned:lastCell.rowPinned}:null}getCellToRight(lastCell){if(!lastCell)return null;const colToRight=this.columnModel.getDisplayedColAfter(lastCell.column);return colToRight?{rowIndex:lastCell.rowIndex,column:colToRight,rowPinned:lastCell.rowPinned}:null}getRowBelow(rowPosition){const index=rowPosition.rowIndex,pinned=rowPosition.rowPinned;if(this.isLastRowInContainer(rowPosition))switch(pinned){case"bottom":return null;case"top":return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;default:return this.pinnedRowModel.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null}const rowNode=this.rowModel.getRow(rowPosition.rowIndex),nextStickyPosition=this.getNextStickyPosition(rowNode);return nextStickyPosition||{rowIndex:index+1,rowPinned:pinned}}getNextStickyPosition(rowNode,up){if(!this.gos.isGroupRowsSticky()||!rowNode||!rowNode.sticky)return;let stickyRowCtrls=[];stickyRowCtrls=this.rowRenderer.getStickyTopRowCtrls().some(ctrl=>ctrl.getRowNode().rowIndex===rowNode.rowIndex)?[...this.rowRenderer.getStickyTopRowCtrls()].sort((a,b)=>a.getRowNode().rowIndex-b.getRowNode().rowIndex):[...this.rowRenderer.getStickyBottomRowCtrls()].sort((a,b)=>b.getRowNode().rowIndex-a.getRowNode().rowIndex);const diff=up?-1:1,idx=stickyRowCtrls.findIndex(ctrl=>ctrl.getRowNode().rowIndex===rowNode.rowIndex),nextCtrl=stickyRowCtrls[idx+diff];return nextCtrl?{rowIndex:nextCtrl.getRowNode().rowIndex,rowPinned:null}:void 0}getCellBelow(lastCell){if(!lastCell)return null;const rowBelow=this.getRowBelow(lastCell);return rowBelow?{rowIndex:rowBelow.rowIndex,column:lastCell.column,rowPinned:rowBelow.rowPinned}:null}isLastRowInContainer(rowPosition){const pinned=rowPosition.rowPinned,index=rowPosition.rowIndex;if("top"===pinned){return this.pinnedRowModel.getPinnedTopRowData().length-1<=index}if("bottom"===pinned){return this.pinnedRowModel.getPinnedBottomRowData().length-1<=index}return this.paginationProxy.getPageLastRow()<=index}getRowAbove(rowPosition){const index=rowPosition.rowIndex,pinned=rowPosition.rowPinned;if(pinned?0===index:index===this.paginationProxy.getPageFirstRow())return"top"===pinned?null:pinned&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender("top")?this.getLastFloatingTopRow():null;const rowNode=this.rowModel.getRow(rowPosition.rowIndex),nextStickyPosition=this.getNextStickyPosition(rowNode,!0);return nextStickyPosition||{rowIndex:index-1,rowPinned:pinned}}getCellAbove(lastCell){if(!lastCell)return null;const rowAbove=this.getRowAbove({rowIndex:lastCell.rowIndex,rowPinned:lastCell.rowPinned});return rowAbove?{rowIndex:rowAbove.rowIndex,column:lastCell.column,rowPinned:rowAbove.rowPinned}:null}getLastBodyCell(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}}getLastFloatingTopRow(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:"top"}}getNextTabbedCell(gridCell,backwards){return backwards?this.getNextTabbedCellBackwards(gridCell):this.getNextTabbedCellForwards(gridCell)}getNextTabbedCellForwards(gridCell){const displayedColumns=this.columnModel.getAllDisplayedColumns();let newRowIndex=gridCell.rowIndex,newFloating=gridCell.rowPinned,newColumn=this.columnModel.getDisplayedColAfter(gridCell.column);if(!newColumn){newColumn=displayedColumns[0];const rowBelow=this.getRowBelow(gridCell);if(missing(rowBelow))return null;if(!rowBelow.rowPinned&&!this.paginationProxy.isRowInPage(rowBelow))return null;newRowIndex=rowBelow?rowBelow.rowIndex:null,newFloating=rowBelow?rowBelow.rowPinned:null}return{rowIndex:newRowIndex,column:newColumn,rowPinned:newFloating}}getNextTabbedCellBackwards(gridCell){const displayedColumns=this.columnModel.getAllDisplayedColumns();let newRowIndex=gridCell.rowIndex,newFloating=gridCell.rowPinned,newColumn=this.columnModel.getDisplayedColBefore(gridCell.column);if(!newColumn){newColumn=last(displayedColumns);const rowAbove=this.getRowAbove({rowIndex:gridCell.rowIndex,rowPinned:gridCell.rowPinned});if(missing(rowAbove))return null;if(!rowAbove.rowPinned&&!this.paginationProxy.isRowInPage(rowAbove))return null;newRowIndex=rowAbove?rowAbove.rowIndex:null,newFloating=rowAbove?rowAbove.rowPinned:null}return{rowIndex:newRowIndex,column:newColumn,rowPinned:newFloating}}};__decorateClass([Autowired("columnModel")],CellNavigationService.prototype,"columnModel",2),__decorateClass([Autowired("rowModel")],CellNavigationService.prototype,"rowModel",2),__decorateClass([Autowired("rowRenderer")],CellNavigationService.prototype,"rowRenderer",2),__decorateClass([Autowired("pinnedRowModel")],CellNavigationService.prototype,"pinnedRowModel",2),__decorateClass([Autowired("paginationProxy")],CellNavigationService.prototype,"paginationProxy",2),CellNavigationService=__decorateClass([Bean("cellNavigationService")],CellNavigationService);var AlignedGridsService=class extends BeanStub{constructor(){super(...arguments),this.consuming=!1}setBeans(loggerFactory){this.logger=loggerFactory.create("AlignedGridsService")}getAlignedGridApis(){var _a;let alignedGrids=null!=(_a=this.gos.get("alignedGrids"))?_a:[];const isCallbackConfig="function"==typeof alignedGrids;"function"==typeof alignedGrids&&(alignedGrids=alignedGrids());const seeUrl=()=>`See ${this.getFrameworkOverrides().getDocLink("aligned-grids")}`;return alignedGrids.map(alignedGrid=>{var _a2;if(!alignedGrid)return errorOnce("alignedGrids contains an undefined option."),isCallbackConfig||errorOnce('You may want to configure via a callback to avoid setup race conditions:\n                     "alignedGrids: () => [linkedGrid]"'),void errorOnce(seeUrl());if(alignedGrid instanceof GridApi)return alignedGrid;const refOrComp=alignedGrid;return"current"in refOrComp?null==(_a2=refOrComp.current)?void 0:_a2.api:(refOrComp.api||errorOnce(`alignedGrids - No api found on the linked grid. If you are passing gridOptions to alignedGrids since v31 this is no longer valid. ${seeUrl()}`),refOrComp.api)}).filter(api=>!!api&&!api.isDestroyed())}init(){this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))}fireEvent(callback){this.consuming||this.getAlignedGridApis().forEach(api=>{if(api.isDestroyed())return;const alignedGridService=api.__getAlignedGridService();callback(alignedGridService)})}onEvent(callback){this.consuming=!0,callback(),this.consuming=!1}fireColumnEvent(event){this.fireEvent(alignedGridsService=>{alignedGridsService.onColumnEvent(event)})}fireScrollEvent(event){"horizontal"===event.direction&&this.fireEvent(alignedGridsService=>{alignedGridsService.onScrollEvent(event)})}onScrollEvent(event){this.onEvent(()=>{this.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(event.left,!0)})}getMasterColumns(event){const result=[];return event.columns?event.columns.forEach(column=>{result.push(column)}):event.column&&result.push(event.column),result}getColumnIds(event){const result=[];return event.columns?event.columns.forEach(column=>{result.push(column.getColId())}):event.column&&result.push(event.column.getColId()),result}onColumnEvent(event){this.onEvent(()=>{switch(event.type){case Events.EVENT_COLUMN_MOVED:case Events.EVENT_COLUMN_VISIBLE:case Events.EVENT_COLUMN_PINNED:case Events.EVENT_COLUMN_RESIZED:const colEvent=event;this.processColumnEvent(colEvent);break;case Events.EVENT_COLUMN_GROUP_OPENED:const groupOpenedEvent=event;this.processGroupOpenedEvent(groupOpenedEvent);break;case Events.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})}processGroupOpenedEvent(groupOpenedEvent){groupOpenedEvent.columnGroups.forEach(masterGroup=>{let otherColumnGroup=null;if(masterGroup){const groupId=masterGroup.getGroupId();otherColumnGroup=this.columnModel.getProvidedColumnGroup(groupId)}masterGroup&&!otherColumnGroup||(this.logger.log("onColumnEvent-> processing "+groupOpenedEvent+" expanded = "+masterGroup.isExpanded()),this.columnModel.setColumnGroupOpened(otherColumnGroup,masterGroup.isExpanded(),"alignedGridChanged"))})}processColumnEvent(colEvent){var _a;const masterColumn=colEvent.column;let otherColumn=null;if(masterColumn&&(otherColumn=this.columnModel.getPrimaryColumn(masterColumn.getColId())),masterColumn&&!otherColumn)return;const masterColumns=this.getMasterColumns(colEvent);switch(colEvent.type){case Events.EVENT_COLUMN_MOVED:{const movedEvent=colEvent,destColState=colEvent.api.getColumnState().map(s=>({colId:s.colId}));this.columnModel.applyColumnState({state:destColState,applyOrder:!0},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${colEvent.type} toIndex = ${movedEvent.toIndex}`)}break;case Events.EVENT_COLUMN_VISIBLE:{const visibleEvent=colEvent,destColState=colEvent.api.getColumnState().map(s=>({colId:s.colId,hide:s.hide}));this.columnModel.applyColumnState({state:destColState},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${colEvent.type} visible = ${visibleEvent.visible}`)}break;case Events.EVENT_COLUMN_PINNED:{const pinnedEvent=colEvent,destColState=colEvent.api.getColumnState().map(s=>({colId:s.colId,pinned:s.pinned}));this.columnModel.applyColumnState({state:destColState},"alignedGridChanged"),this.logger.log(`onColumnEvent-> processing ${colEvent.type} pinned = ${pinnedEvent.pinned}`)}break;case Events.EVENT_COLUMN_RESIZED:const resizedEvent=colEvent,columnWidths={};masterColumns.forEach(column=>{this.logger.log(`onColumnEvent-> processing ${colEvent.type} actualWidth = ${column.getActualWidth()}`),columnWidths[column.getId()]={key:column.getColId(),newWidth:column.getActualWidth()}}),null==(_a=resizedEvent.flexColumns)||_a.forEach(col=>{columnWidths[col.getId()]&&delete columnWidths[col.getId()]}),this.columnModel.setColumnWidths(Object.values(columnWidths),!1,resizedEvent.finished,"alignedGridChanged")}const isVerticalScrollShowing2=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing();this.getAlignedGridApis().forEach(api=>{api.setGridOption("alwaysShowVerticalScroll",isVerticalScrollShowing2)})}};__decorateClass([Autowired("columnModel")],AlignedGridsService.prototype,"columnModel",2),__decorateClass([Autowired("ctrlsService")],AlignedGridsService.prototype,"ctrlsService",2),__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],AlignedGridsService.prototype,"setBeans",1),__decorateClass([PostConstruct],AlignedGridsService.prototype,"init",1),AlignedGridsService=__decorateClass([Bean("alignedGridsService")],AlignedGridsService);var SelectionService=class extends BeanStub{constructor(){super(...arguments),this.selectedNodes=new Map,this.lastRowNode=null}init(){this.rowSelection=this.gos.get("rowSelection"),this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.addManagedPropertyListeners(["groupSelectsChildren","rowSelection"],()=>{this.groupSelectsChildren=this.gos.get("groupSelectsChildren"),this.rowSelection=this.gos.get("rowSelection"),this.deselectAllRowNodes({source:"api"})}),this.addManagedListener(this.eventService,Events.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))}destroy(){super.destroy(),this.resetNodes(),this.lastRowNode=null}isMultiselect(){return"multiple"===this.rowSelection}setNodesSelected(params){var _a;const{newValue,clearSelection,suppressFinishActions,rangeSelect,nodes,event,source="api"}=params;if(0===nodes.length)return 0;if(nodes.length>1&&!this.isMultiselect())return console.warn("AG Grid: cannot multi select while rowSelection='single'"),0;const groupSelectsFiltered=this.groupSelectsChildren&&!0===params.groupSelectsFiltered,filteredNodes=nodes.map(node=>node.footer?node.sibling:node);if(rangeSelect){if(nodes.length>1)return console.warn("AG Grid: cannot range select while selecting multiple rows"),0;let toNode=null;if("checkboxSelected"===source&&!1===newValue&&this.lastRowNode&&(this.lastRowNode.id?toNode=this.lastRowNode:this.lastRowNode=null),null==toNode&&(toNode=this.getLastSelectedNode()),toNode){const fromNode=filteredNodes[0];if(fromNode!==toNode&&this.isMultiselect())return this.selectRange(fromNode,toNode,newValue,source)}}this.lastRowNode=newValue?null:filteredNodes[0];let updatedCount=0;for(let i=0;i<filteredNodes.length;i++){const node=filteredNodes[i];if(!(groupSelectsFiltered&&node.group)){node.selectThisNode(newValue,event,source)&&updatedCount++}this.groupSelectsChildren&&(null==(_a=node.childrenAfterGroup)?void 0:_a.length)&&(updatedCount+=this.selectChildren(node,newValue,groupSelectsFiltered,source))}if(!suppressFinishActions){if(newValue&&(clearSelection||!this.isMultiselect())&&(updatedCount+=this.clearOtherNodes(filteredNodes[0],source)),updatedCount>0){this.updateGroupsFromChildrenSelections(source);const event2={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event2)}}return updatedCount}selectRange(fromNode,toNode,value=!0,source){const nodesToSelect=this.rowModel.getNodesInRangeForSelection(fromNode,toNode);let updatedCount=0;nodesToSelect.forEach(rowNode=>{if(rowNode.group&&this.groupSelectsChildren)return;rowNode.selectThisNode(value,void 0,source)&&updatedCount++}),this.updateGroupsFromChildrenSelections(source);const event={type:Events.EVENT_SELECTION_CHANGED,source};return this.eventService.dispatchEvent(event),updatedCount}selectChildren(node,newValue,groupSelectsFiltered,source){const children=groupSelectsFiltered?node.childrenAfterAggFilter:node.childrenAfterGroup;return missing(children)?0:this.setNodesSelected({newValue,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered,source,nodes:children})}getLastSelectedNode(){const selectedKeys=Array.from(this.selectedNodes.keys());if(0==selectedKeys.length)return null;const node=this.selectedNodes.get(last(selectedKeys));return node||null}getSelectedNodes(){const selectedNodes=[];return this.selectedNodes.forEach(rowNode=>{rowNode&&selectedNodes.push(rowNode)}),selectedNodes}getSelectedRows(){const selectedRows=[];return this.selectedNodes.forEach(rowNode=>{rowNode&&rowNode.data&&selectedRows.push(rowNode.data)}),selectedRows}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(predicate){const newSelectedNodes=new Map;this.selectedNodes.forEach((rowNode,key)=>{rowNode&&predicate(rowNode)&&newSelectedNodes.set(key,rowNode)}),this.selectedNodes=newSelectedNodes}updateGroupsFromChildrenSelections(source,changedPath){if(!this.groupSelectsChildren)return!1;if("clientSide"!==this.rowModel.getType())return!1;const rootNode=this.rowModel.getRootNode();changedPath||(changedPath=new ChangedPath(!0,rootNode)).setInactive();let selectionChanged=!1;return changedPath.forEachChangedNodeDepthFirst(rowNode=>{if(rowNode!==rootNode){const selected=rowNode.calculateSelectedFromChildren();selectionChanged=rowNode.selectThisNode(null!==selected&&selected,void 0,source)||selectionChanged}}),selectionChanged}clearOtherNodes(rowNodeToKeepSelected,source){const groupsToRefresh=new Map;let updatedCount=0;return this.selectedNodes.forEach(otherRowNode=>{if(otherRowNode&&otherRowNode.id!==rowNodeToKeepSelected.id){const rowNode=this.selectedNodes.get(otherRowNode.id);updatedCount+=rowNode.setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0,source}),this.groupSelectsChildren&&otherRowNode.parent&&groupsToRefresh.set(otherRowNode.parent.id,otherRowNode.parent)}}),groupsToRefresh.forEach(group=>{const selected=group.calculateSelectedFromChildren();group.selectThisNode(null!==selected&&selected,void 0,source)}),updatedCount}onRowSelected(event){const rowNode=event.node;this.groupSelectsChildren&&rowNode.group||(rowNode.isSelected()?this.selectedNodes.set(rowNode.id,rowNode):this.selectedNodes.delete(rowNode.id))}syncInRowNode(rowNode,oldNode){this.syncInOldRowNode(rowNode,oldNode),this.syncInNewRowNode(rowNode)}syncInOldRowNode(rowNode,oldNode){if(exists(oldNode)&&rowNode.id!==oldNode.id&&oldNode){const id=oldNode.id;this.selectedNodes.get(id)==rowNode&&this.selectedNodes.set(oldNode.id,oldNode)}}syncInNewRowNode(rowNode){this.selectedNodes.has(rowNode.id)?(rowNode.setSelectedInitialValue(!0),this.selectedNodes.set(rowNode.id,rowNode)):rowNode.setSelectedInitialValue(!1)}reset(source){const selectionCount=this.getSelectionCount();if(this.resetNodes(),selectionCount){const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}}resetNodes(){var _a;null==(_a=this.selectedNodes)||_a.clear()}getBestCostNodeSelection(){if("clientSide"!==this.rowModel.getType())return;const topLevelNodes=this.rowModel.getTopLevelNodes();if(null===topLevelNodes)return;const result=[];return function traverse(nodes){for(let i=0,l=nodes.length;i<l;i++){const node=nodes[i];if(node.isSelected())result.push(node);else{const maybeGroup=node;maybeGroup.group&&maybeGroup.children&&traverse(maybeGroup.children)}}}(topLevelNodes),result}isEmpty(){let count=0;return this.selectedNodes.forEach(rowNode=>{rowNode&&count++}),0===count}deselectAllRowNodes(params){const callback=rowNode=>rowNode.selectThisNode(!1,void 0,source),rowModelClientSide="clientSide"===this.rowModel.getType(),{source,justFiltered,justCurrentPage}=params;if(justCurrentPage||justFiltered){if(!rowModelClientSide)return void console.error("AG Grid: selecting just filtered only works when gridOptions.rowModelType='clientSide'");this.getNodesToSelect(justFiltered,justCurrentPage).forEach(callback)}else this.selectedNodes.forEach(rowNode=>{rowNode&&callback(rowNode)}),this.reset(source);rowModelClientSide&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(source);const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}getSelectedCounts(justFiltered,justCurrentPage){let selectedCount=0,notSelectedCount=0;return this.getNodesToSelect(justFiltered,justCurrentPage).forEach(node=>{this.groupSelectsChildren&&node.group||(node.isSelected()?selectedCount++:node.selectable&&notSelectedCount++)}),{selectedCount,notSelectedCount}}getSelectAllState(justFiltered,justCurrentPage){const{selectedCount,notSelectedCount}=this.getSelectedCounts(justFiltered,justCurrentPage);return(0!==selectedCount||0!==notSelectedCount)&&(selectedCount>0&&notSelectedCount>0?null:selectedCount>0)}hasNodesToSelect(justFiltered=!1,justCurrentPage=!1){return this.getNodesToSelect(justFiltered,justCurrentPage).filter(node=>node.selectable).length>0}getNodesToSelect(justFiltered=!1,justCurrentPage=!1){if("clientSide"!==this.rowModel.getType())throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const nodes=[];if(justCurrentPage)return this.paginationProxy.forEachNodeOnPage(node=>{if(node.group){if(!node.expanded){const recursivelyAddChildren=child=>{var _a;nodes.push(child),(null==(_a=child.childrenAfterFilter)?void 0:_a.length)&&child.childrenAfterFilter.forEach(recursivelyAddChildren)};return void recursivelyAddChildren(node)}this.groupSelectsChildren||nodes.push(node)}else nodes.push(node)}),nodes;const clientSideRowModel=this.rowModel;return justFiltered?(clientSideRowModel.forEachNodeAfterFilter(node=>{nodes.push(node)}),nodes):(clientSideRowModel.forEachNode(node=>{nodes.push(node)}),nodes)}selectAllRowNodes(params){if("clientSide"!==this.rowModel.getType())throw new Error(`selectAll only available when rowModelType='clientSide', ie not ${this.rowModel.getType()}`);const{source,justFiltered,justCurrentPage}=params;this.getNodesToSelect(justFiltered,justCurrentPage).forEach(rowNode=>rowNode.selectThisNode(!0,void 0,source)),"clientSide"===this.rowModel.getType()&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(source);const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}getSelectionState(){const selectedIds=[];return this.selectedNodes.forEach(node=>{(null==node?void 0:node.id)&&selectedIds.push(node.id)}),selectedIds.length?selectedIds:null}setSelectionState(state,source){if(!Array.isArray(state))return;const rowIds=new Set(state),nodes=[];this.rowModel.forEachNode(node=>{rowIds.has(node.id)&&nodes.push(node)}),this.setNodesSelected({newValue:!0,nodes,source})}};__decorateClass([Autowired("rowModel")],SelectionService.prototype,"rowModel",2),__decorateClass([Autowired("paginationProxy")],SelectionService.prototype,"paginationProxy",2),__decorateClass([PostConstruct],SelectionService.prototype,"init",1),SelectionService=__decorateClass([Bean("selectionService")],SelectionService);var ColumnApi=class{constructor(gridAp){this.viaApi=(funcName,...args)=>(warnOnce(`Since v31, 'columnApi.${funcName}' is deprecated and moved to 'api.${funcName}'.`),this.api[funcName](...args)),this.api=gridAp}sizeColumnsToFit(gridWidth){this.viaApi("sizeColumnsToFit",gridWidth)}setColumnGroupOpened(group,newValue){this.viaApi("setColumnGroupOpened",group,newValue)}getColumnGroup(name,instanceId){return this.viaApi("getColumnGroup",name,instanceId)}getProvidedColumnGroup(name){return this.viaApi("getProvidedColumnGroup",name)}getDisplayNameForColumn(column,location){return this.viaApi("getDisplayNameForColumn",column,location)}getDisplayNameForColumnGroup(columnGroup,location){return this.viaApi("getDisplayNameForColumnGroup",columnGroup,location)}getColumn(key){return this.viaApi("getColumn",key)}getColumns(){return this.viaApi("getColumns")}applyColumnState(params){return this.viaApi("applyColumnState",params)}getColumnState(){return this.viaApi("getColumnState")}resetColumnState(){this.viaApi("resetColumnState")}getColumnGroupState(){return this.viaApi("getColumnGroupState")}setColumnGroupState(stateItems){this.viaApi("setColumnGroupState",stateItems)}resetColumnGroupState(){this.viaApi("resetColumnGroupState")}isPinning(){return this.viaApi("isPinning")}isPinningLeft(){return this.viaApi("isPinningLeft")}isPinningRight(){return this.viaApi("isPinningRight")}getDisplayedColAfter(col){return this.viaApi("getDisplayedColAfter",col)}getDisplayedColBefore(col){return this.viaApi("getDisplayedColBefore",col)}setColumnVisible(key,visible){this.viaApi("setColumnVisible",key,visible)}setColumnsVisible(keys2,visible){this.viaApi("setColumnsVisible",keys2,visible)}setColumnPinned(key,pinned){this.viaApi("setColumnPinned",key,pinned)}setColumnsPinned(keys2,pinned){this.viaApi("setColumnsPinned",keys2,pinned)}getAllGridColumns(){return this.viaApi("getAllGridColumns")}getDisplayedLeftColumns(){return this.viaApi("getDisplayedLeftColumns")}getDisplayedCenterColumns(){return this.viaApi("getDisplayedCenterColumns")}getDisplayedRightColumns(){return this.viaApi("getDisplayedRightColumns")}getAllDisplayedColumns(){return this.viaApi("getAllDisplayedColumns")}getAllDisplayedVirtualColumns(){return this.viaApi("getAllDisplayedVirtualColumns")}moveColumn(key,toIndex){this.viaApi("moveColumn",key,toIndex)}moveColumnByIndex(fromIndex,toIndex){this.viaApi("moveColumnByIndex",fromIndex,toIndex)}moveColumns(columnsToMoveKeys,toIndex){this.viaApi("moveColumns",columnsToMoveKeys,toIndex)}moveRowGroupColumn(fromIndex,toIndex){this.viaApi("moveRowGroupColumn",fromIndex,toIndex)}setColumnAggFunc(key,aggFunc){this.viaApi("setColumnAggFunc",key,aggFunc)}setColumnWidth(key,newWidth,finished=!0,source){this.viaApi("setColumnWidth",key,newWidth,finished,source)}setColumnWidths(columnWidths,finished=!0,source){this.viaApi("setColumnWidths",columnWidths,finished,source)}setPivotMode(pivotMode){this.viaApi("setPivotMode",pivotMode)}isPivotMode(){return this.viaApi("isPivotMode")}getPivotResultColumn(pivotKeys,valueColKey){return this.viaApi("getPivotResultColumn",pivotKeys,valueColKey)}setValueColumns(colKeys){this.viaApi("setValueColumns",colKeys)}getValueColumns(){return this.viaApi("getValueColumns")}removeValueColumn(colKey){this.viaApi("removeValueColumn",colKey)}removeValueColumns(colKeys){this.viaApi("removeValueColumns",colKeys)}addValueColumn(colKey){this.viaApi("addValueColumn",colKey)}addValueColumns(colKeys){this.viaApi("addValueColumns",colKeys)}setRowGroupColumns(colKeys){this.viaApi("setRowGroupColumns",colKeys)}removeRowGroupColumn(colKey){this.viaApi("removeRowGroupColumn",colKey)}removeRowGroupColumns(colKeys){this.viaApi("removeRowGroupColumns",colKeys)}addRowGroupColumn(colKey){this.viaApi("addRowGroupColumn",colKey)}addRowGroupColumns(colKeys){this.viaApi("addRowGroupColumns",colKeys)}getRowGroupColumns(){return this.viaApi("getRowGroupColumns")}setPivotColumns(colKeys){this.viaApi("setPivotColumns",colKeys)}removePivotColumn(colKey){this.viaApi("removePivotColumn",colKey)}removePivotColumns(colKeys){this.viaApi("removePivotColumns",colKeys)}addPivotColumn(colKey){this.viaApi("addPivotColumn",colKey)}addPivotColumns(colKeys){this.viaApi("addPivotColumns",colKeys)}getPivotColumns(){return this.viaApi("getPivotColumns")}getLeftDisplayedColumnGroups(){return this.viaApi("getLeftDisplayedColumnGroups")}getCenterDisplayedColumnGroups(){return this.viaApi("getCenterDisplayedColumnGroups")}getRightDisplayedColumnGroups(){return this.viaApi("getRightDisplayedColumnGroups")}getAllDisplayedColumnGroups(){return this.viaApi("getAllDisplayedColumnGroups")}autoSizeColumn(key,skipHeader){return this.viaApi("autoSizeColumn",key,skipHeader)}autoSizeColumns(keys2,skipHeader){this.viaApi("autoSizeColumns",keys2,skipHeader)}autoSizeAllColumns(skipHeader){this.viaApi("autoSizeAllColumns",skipHeader)}setPivotResultColumns(colDefs){this.viaApi("setPivotResultColumns",colDefs)}getPivotResultColumns(){return this.viaApi("getPivotResultColumns")}};__decorateClass([Autowired("gridApi")],ColumnApi.prototype,"api",2),ColumnApi=__decorateClass([Bean("columnApi")],ColumnApi);var ValueService=class extends BeanStub{constructor(){super(...arguments),this.initialised=!1,this.isSsrm=!1}init(){this.isSsrm=this.gos.isRowModelType("serverSide"),this.cellExpressions=this.gos.get("enableCellExpressions"),this.isTreeData=this.gos.get("treeData"),this.initialised=!0;const listener=event=>this.callColumnCellValueChangedHandler(event),async=this.gos.useAsyncEvents();this.eventService.addEventListener(Events.EVENT_CELL_VALUE_CHANGED,listener,async),this.addDestroyFunc(()=>this.eventService.removeEventListener(Events.EVENT_CELL_VALUE_CHANGED,listener,async)),this.addManagedPropertyListener("treeData",propChange=>this.isTreeData=propChange.currentValue)}getValue(column,rowNode,forFilter=!1,ignoreAggData=!1){if(this.initialised||this.init(),!rowNode)return;const colDef=column.getColDef(),field=colDef.field,colId=column.getColId(),data=rowNode.data;let result;const groupDataExists=rowNode.groupData&&void 0!==rowNode.groupData[colId],aggDataExists=!ignoreAggData&&rowNode.aggData&&void 0!==rowNode.aggData[colId],ignoreSsrmAggData=this.isSsrm&&ignoreAggData&&!!column.getColDef().aggFunc,ssrmFooterGroupCol=this.isSsrm&&rowNode.footer&&rowNode.field&&(!0===column.getColDef().showRowGroup||column.getColDef().showRowGroup===rowNode.field);if(forFilter&&colDef.filterValueGetter?result=this.executeFilterValueGetter(colDef.filterValueGetter,data,column,rowNode):this.isTreeData&&aggDataExists?result=rowNode.aggData[colId]:this.isTreeData&&colDef.valueGetter?result=this.executeValueGetter(colDef.valueGetter,data,column,rowNode):this.isTreeData&&field&&data?result=getValueUsingField(data,field,column.isFieldContainsDots()):groupDataExists?result=rowNode.groupData[colId]:aggDataExists?result=rowNode.aggData[colId]:colDef.valueGetter?result=this.executeValueGetter(colDef.valueGetter,data,column,rowNode):ssrmFooterGroupCol?result=getValueUsingField(data,rowNode.field,column.isFieldContainsDots()):field&&data&&!ignoreSsrmAggData&&(result=getValueUsingField(data,field,column.isFieldContainsDots())),this.cellExpressions&&"string"==typeof result&&0===result.indexOf("=")){const cellValueGetter=result.substring(1);result=this.executeValueGetter(cellValueGetter,data,column,rowNode)}if(null==result){const openedGroup=this.getOpenedGroup(rowNode,column);if(null!=openedGroup)return openedGroup}return result}parseValue(column,rowNode,newValue,oldValue){const colDef=column.getColDef(),params=this.gos.addGridCommonParams({node:rowNode,data:null==rowNode?void 0:rowNode.data,oldValue,newValue,colDef,column}),valueParser=colDef.valueParser;return exists(valueParser)?"function"==typeof valueParser?valueParser(params):this.expressionService.evaluate(valueParser,params):newValue}formatValue(column,node,value,suppliedFormatter,useFormatterFromColumn=!0){let formatter,result=null;const colDef=column.getColDef();if(suppliedFormatter?formatter=suppliedFormatter:useFormatterFromColumn&&(formatter=colDef.valueFormatter),formatter){const params=this.gos.addGridCommonParams({value,node,data:node?node.data:null,colDef,column});result="function"==typeof formatter?formatter(params):this.expressionService.evaluate(formatter,params)}else if(colDef.refData)return colDef.refData[value]||"";return null==result&&Array.isArray(value)&&(result=value.join(", ")),result}getOpenedGroup(rowNode,column){if(!this.gos.get("showOpenedGroup"))return;if(!column.getColDef().showRowGroup)return;const showRowGroup=column.getColDef().showRowGroup;let pointer=rowNode.parent;for(;null!=pointer;){if(pointer.rowGroupColumn&&(!0===showRowGroup||showRowGroup===pointer.rowGroupColumn.getColId()))return pointer.key;pointer=pointer.parent}}setValue(rowNode,colKey,newValue,eventSource){const column=this.columnModel.getPrimaryColumn(colKey);if(!rowNode||!column)return!1;missing(rowNode.data)&&(rowNode.data={});const{field,valueSetter}=column.getColDef();if(missing(field)&&missing(valueSetter))return console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work"),!1;if(!this.dataTypeService.checkType(column,newValue))return console.warn("AG Grid: Data type of the new value does not match the cell data type of the column"),!1;const params=this.gos.addGridCommonParams({node:rowNode,data:rowNode.data,oldValue:this.getValue(column,rowNode),newValue,colDef:column.getColDef(),column});let valueWasDifferent;if(params.newValue=newValue,valueWasDifferent=exists(valueSetter)?"function"==typeof valueSetter?valueSetter(params):this.expressionService.evaluate(valueSetter,params):this.setValueUsingField(rowNode.data,field,newValue,column.isFieldContainsDots()),void 0===valueWasDifferent&&(valueWasDifferent=!0),!valueWasDifferent)return!1;rowNode.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),params.newValue=this.getValue(column,rowNode);const event={type:Events.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:rowNode.rowIndex,rowPinned:rowNode.rowPinned,column:params.column,api:params.api,columnApi:params.columnApi,colDef:params.colDef,context:params.context,data:rowNode.data,node:rowNode,oldValue:params.oldValue,newValue:params.newValue,value:params.newValue,source:eventSource};return this.eventService.dispatchEvent(event),!0}callColumnCellValueChangedHandler(event){const onCellValueChanged=event.colDef.onCellValueChanged;"function"==typeof onCellValueChanged&&this.getFrameworkOverrides().wrapOutgoing(()=>{onCellValueChanged({node:event.node,data:event.data,oldValue:event.oldValue,newValue:event.newValue,colDef:event.colDef,column:event.column,api:event.api,columnApi:event.columnApi,context:event.context})})}setValueUsingField(data,field,newValue,isFieldContainsDots){if(!field)return!1;let valuesAreSame=!1;if(isFieldContainsDots){const fieldPieces=field.split(".");let currentObject=data;for(;fieldPieces.length>0&&currentObject;){const fieldPiece=fieldPieces.shift();0===fieldPieces.length?(valuesAreSame=currentObject[fieldPiece]===newValue,valuesAreSame||(currentObject[fieldPiece]=newValue)):currentObject=currentObject[fieldPiece]}}else valuesAreSame=data[field]===newValue,valuesAreSame||(data[field]=newValue);return!valuesAreSame}executeFilterValueGetter(valueGetter,data,column,rowNode){const params=this.gos.addGridCommonParams({data,node:rowNode,column,colDef:column.getColDef(),getValue:this.getValueCallback.bind(this,rowNode)});return"function"==typeof valueGetter?valueGetter(params):this.expressionService.evaluate(valueGetter,params)}executeValueGetter(valueGetter,data,column,rowNode){const colId=column.getColId(),valueFromCache=this.valueCache.getValue(rowNode,colId);if(void 0!==valueFromCache)return valueFromCache;const params=this.gos.addGridCommonParams({data,node:rowNode,column,colDef:column.getColDef(),getValue:this.getValueCallback.bind(this,rowNode)});let result;return result="function"==typeof valueGetter?valueGetter(params):this.expressionService.evaluate(valueGetter,params),this.valueCache.setValue(rowNode,colId,result),result}getValueCallback(node,field){const otherColumn=this.columnModel.getPrimaryColumn(field);return otherColumn?this.getValue(otherColumn,node):null}getKeyForNode(col,rowNode){const value=this.getValue(col,rowNode),keyCreator=col.getColDef().keyCreator;let result=value;if(keyCreator){result=keyCreator(this.gos.addGridCommonParams({value,colDef:col.getColDef(),column:col,node:rowNode,data:rowNode.data}))}return"string"==typeof result||null==result||(result=String(result),"[object Object]"===result&&warnOnce("a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")),result}};__decorateClass([Autowired("expressionService")],ValueService.prototype,"expressionService",2),__decorateClass([Autowired("columnModel")],ValueService.prototype,"columnModel",2),__decorateClass([Autowired("valueCache")],ValueService.prototype,"valueCache",2),__decorateClass([Autowired("dataTypeService")],ValueService.prototype,"dataTypeService",2),__decorateClass([PostConstruct],ValueService.prototype,"init",1),ValueService=__decorateClass([Bean("valueService")],ValueService);var ExpressionService=class extends BeanStub{constructor(){super(...arguments),this.expressionToFunctionCache={}}setBeans(loggerFactory){this.logger=loggerFactory.create("ExpressionService")}evaluate(expression,params){if("string"==typeof expression)return this.evaluateExpression(expression,params);console.error("AG Grid: value should be either a string or a function",expression)}evaluateExpression(expression,params){try{const javaScriptFunction=this.createExpressionFunction(expression);return javaScriptFunction(params.value,params.context,params.oldValue,params.newValue,params.value,params.node,params.data,params.colDef,params.rowIndex,params.api,params.columnApi,params.getValue,params.column,params.columnGroup)}catch(e){return console.log("Processing of the expression failed"),console.log("Expression = "+expression),console.log("Params =",params),console.log("Exception = "+e),null}}createExpressionFunction(expression){if(this.expressionToFunctionCache[expression])return this.expressionToFunctionCache[expression];const functionBody=this.createFunctionBody(expression),theFunction=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",functionBody);return this.expressionToFunctionCache[expression]=theFunction,theFunction}createFunctionBody(expression){return expression.indexOf("return")>=0?expression:"return "+expression+";"}};__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],ExpressionService.prototype,"setBeans",1),ExpressionService=__decorateClass([Bean("expressionService")],ExpressionService);var LoggerFactory=class extends BeanStub{setBeans(gos){this.logging=gos.get("debug")}create(name){return new Logger(name,this.isLogging.bind(this))}isLogging(){return this.logging}};__decorateClass([__decorateParam(0,Qualifier("gridOptionsService"))],LoggerFactory.prototype,"setBeans",1),LoggerFactory=__decorateClass([Bean("loggerFactory")],LoggerFactory);var Logger=class{constructor(name,isLoggingFunc){this.name=name,this.isLoggingFunc=isLoggingFunc}isLogging(){return this.isLoggingFunc()}log(message){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+message)}},GridCtrl=class extends BeanStub{setComp(view,eGridDiv,eGui){this.view=view,this.eGridHostDiv=eGridDiv,this.eGui=eGui,this.eGui.setAttribute("grid-id",this.context.getGridId()),this.dragAndDropService.addDropTarget({getContainer:()=>this.eGui,isInterestedIn:type=>1===type||0===type,getIconName:()=>DragAndDropService.ICON_NOT_ALLOWED}),this.mouseEventService.stampTopLevelGridCompWithGridInstance(eGridDiv),this.createManagedBean(new LayoutFeature(this.view)),this.addRtlSupport();const unsubscribeFromResize=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>unsubscribeFromResize()),this.ctrlsService.register("gridCtrl",this)}isDetailGrid(){var _a;const el=this.focusService.findTabbableParent(this.getGui());return(null==(_a=null==el?void 0:el.getAttribute("row-id"))?void 0:_a.startsWith("detail"))||!1}showDropZones(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/row-grouping",this.context.getGridId())}showSideBar(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/side-bar",this.context.getGridId())}showStatusBar(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/status-bar",this.context.getGridId())}showWatermark(){return ModuleRegistry.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId())}onGridSizeChanged(){const event={type:Events.EVENT_GRID_SIZE_CHANGED,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight};this.eventService.dispatchEvent(event)}addRtlSupport(){const cssClass=this.gos.get("enableRtl")?"ag-rtl":"ag-ltr";this.view.setRtlClass(cssClass)}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(on){this.view.setCursor(on?"ew-resize":null)}disableUserSelect(on){this.view.setUserSelect(on?"none":null)}focusNextInnerContainer(backwards){const focusableContainers=this.view.getFocusableContainers(),activeEl=this.gos.getActiveDomElement(),nextIdx=focusableContainers.findIndex(container=>container.contains(activeEl))+(backwards?-1:1);return!(nextIdx<=0||nextIdx>=focusableContainers.length)&&this.focusService.focusInto(focusableContainers[nextIdx])}focusInnerElement(fromBottom){const focusableContainers=this.view.getFocusableContainers(),allColumns=this.columnModel.getAllDisplayedColumns();if(fromBottom){if(focusableContainers.length>1)return this.focusService.focusInto(last(focusableContainers),!0);const lastColumn=last(allColumns);if(this.focusService.focusGridView(lastColumn,!0))return!0}if(0===this.gos.get("headerHeight")||this.gos.get("suppressHeaderFocus")){if(this.focusService.focusGridView(allColumns[0]))return!0;for(let i=1;i<focusableContainers.length;i++)if(this.focusService.focusInto(focusableContainers[i]))return!0;return!1}return this.focusService.focusFirstHeader()}forceFocusOutOfContainer(up=!1){this.view.forceFocusOutOfContainer(up)}};__decorateClass([Autowired("focusService")],GridCtrl.prototype,"focusService",2),__decorateClass([Autowired("resizeObserverService")],GridCtrl.prototype,"resizeObserverService",2),__decorateClass([Autowired("columnModel")],GridCtrl.prototype,"columnModel",2),__decorateClass([Autowired("ctrlsService")],GridCtrl.prototype,"ctrlsService",2),__decorateClass([Autowired("mouseEventService")],GridCtrl.prototype,"mouseEventService",2),__decorateClass([Autowired("dragAndDropService")],GridCtrl.prototype,"dragAndDropService",2);var GridComp=class extends TabGuardComp{constructor(eGridDiv){super(),this.eGridDiv=eGridDiv}postConstruct(){this.logger=this.loggerFactory.create("GridComp");const compProxy={destroyGridUi:()=>this.destroyBean(this),setRtlClass:cssClass=>this.addCssClass(cssClass),forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:value=>{this.getGui().style.userSelect=null!=value?value:"",this.getGui().style.webkitUserSelect=null!=value?value:""},setCursor:value=>{this.getGui().style.cursor=null!=value?value:""}};this.ctrl=this.createManagedBean(new GridCtrl);const template=this.createTemplate();this.setTemplate(template),this.ctrl.setComp(compProxy,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:fromBottom=>this.ctrl.focusInnerElement(fromBottom),forceFocusOutWhenTabGuardsAreEmpty:!0})}insertGridIntoDom(){const eGui=this.getGui();this.eGridDiv.appendChild(eGui),this.addDestroyFunc(()=>{this.eGridDiv.removeChild(eGui),this.logger.log("Grid removed from DOM")})}updateLayoutClasses(cssClass,params){const eRootWrapperBodyClassList=this.eRootWrapperBody.classList;eRootWrapperBodyClassList.toggle("ag-layout-auto-height",params.autoHeight),eRootWrapperBodyClassList.toggle("ag-layout-normal",params.normal),eRootWrapperBodyClassList.toggle("ag-layout-print",params.print),this.addOrRemoveCssClass("ag-layout-auto-height",params.autoHeight),this.addOrRemoveCssClass("ag-layout-normal",params.normal),this.addOrRemoveCssClass("ag-layout-print",params.print)}createTemplate(){return`<div class="ag-root-wrapper" role="presentation">\n                ${this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":""}\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody" role="presentation">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    ${this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':""}\n                </div>\n                ${this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':""}\n                <ag-pagination></ag-pagination>\n                ${this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":""}\n            </div>`}getFocusableElement(){return this.eRootWrapperBody}getFocusableContainers(){const focusableContainers=[this.gridBodyComp.getGui()];return this.sideBarComp&&focusableContainers.push(this.sideBarComp.getGui()),focusableContainers.filter(el=>isVisible(el))}};__decorateClass([Autowired("loggerFactory")],GridComp.prototype,"loggerFactory",2),__decorateClass([RefSelector("gridBody")],GridComp.prototype,"gridBodyComp",2),__decorateClass([RefSelector("sideBar")],GridComp.prototype,"sideBarComp",2),__decorateClass([RefSelector("rootWrapperBody")],GridComp.prototype,"eRootWrapperBody",2),__decorateClass([PostConstruct],GridComp.prototype,"postConstruct",1);var SortController=class extends BeanStub{progressSort(column,multiSort,source){const nextDirection=this.getNextSortDirection(column);this.setSortForColumn(column,nextDirection,multiSort,source)}setSortForColumn(column,sort,multiSort,source){"asc"!==sort&&"desc"!==sort&&(sort=null);let columnsToUpdate=[column];if(this.gos.isColumnsSortingCoupledToGroup()&&column.getColDef().showRowGroup){const rowGroupColumns=this.columnModel.getSourceColumnsForGroupColumn(column),sortableRowGroupColumns=null==rowGroupColumns?void 0:rowGroupColumns.filter(col=>col.isSortable());sortableRowGroupColumns&&(columnsToUpdate=[column,...sortableRowGroupColumns])}columnsToUpdate.forEach(col=>col.setSort(sort,source));const updatedColumns=[];if(!((multiSort||this.gos.get("alwaysMultiSort"))&&!this.gos.get("suppressMultiSort"))){const clearedColumns=this.clearSortBarTheseColumns(columnsToUpdate,source);updatedColumns.push(...clearedColumns)}this.updateSortIndex(column),updatedColumns.push(...columnsToUpdate),this.dispatchSortChangedEvents(source,updatedColumns)}updateSortIndex(lastColToChange){const isCoupled=this.gos.isColumnsSortingCoupledToGroup(),groupParent=this.columnModel.getGroupDisplayColumnForGroup(lastColToChange.getId()),lastSortIndexCol=isCoupled&&groupParent||lastColToChange,allSortedCols=this.getColumnsWithSortingOrdered();this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(col=>col.setSortIndex(null));const allSortedColsWithoutChangesOrGroups=allSortedCols.filter(col=>(!isCoupled||!col.getColDef().showRowGroup)&&col!==lastSortIndexCol);(lastSortIndexCol.getSort()?[...allSortedColsWithoutChangesOrGroups,lastSortIndexCol]:allSortedColsWithoutChangesOrGroups).forEach((col,idx)=>{col.setSortIndex(idx)})}onSortChanged(source,columns){this.dispatchSortChangedEvents(source,columns)}isSortActive(){const sortedCols=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(column=>!!column.getSort());return sortedCols&&sortedCols.length>0}dispatchSortChangedEvents(source,columns){const event={type:Events.EVENT_SORT_CHANGED,source};columns&&(event.columns=columns),this.eventService.dispatchEvent(event)}clearSortBarTheseColumns(columnsToSkip,source){const clearedColumns=[];return this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(columnToClear=>{columnsToSkip.includes(columnToClear)||(columnToClear.getSort()&&clearedColumns.push(columnToClear),columnToClear.setSort(void 0,source))}),clearedColumns}getNextSortDirection(column){let sortingOrder;if(sortingOrder=column.getColDef().sortingOrder?column.getColDef().sortingOrder:this.gos.get("sortingOrder")?this.gos.get("sortingOrder"):SortController.DEFAULT_SORTING_ORDER,!Array.isArray(sortingOrder)||sortingOrder.length<=0)return console.warn(`AG Grid: sortingOrder must be an array with at least one element, currently it's ${sortingOrder}`),null;const currentIndex=sortingOrder.indexOf(column.getSort()),notInArray=currentIndex<0,lastItemInArray=currentIndex==sortingOrder.length-1;let result;return result=notInArray||lastItemInArray?sortingOrder[0]:sortingOrder[currentIndex+1],SortController.DEFAULT_SORTING_ORDER.indexOf(result)<0?(console.warn("AG Grid: invalid sort type "+result),null):result}getIndexedSortMap(){let allSortedCols=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(col=>!!col.getSort());if(this.columnModel.isPivotMode()){const isSortingLinked=this.gos.isColumnsSortingCoupledToGroup();allSortedCols=allSortedCols.filter(col=>{const isAggregated=!!col.getAggFunc(),isSecondary=!col.isPrimary(),isGroup=isSortingLinked?this.columnModel.getGroupDisplayColumnForGroup(col.getId()):col.getColDef().showRowGroup;return isAggregated||isSecondary||isGroup})}const sortedRowGroupCols=this.columnModel.getRowGroupColumns().filter(col=>!!col.getSort()),allColsIndexes={};allSortedCols.forEach((col,index)=>allColsIndexes[col.getId()]=index),allSortedCols.sort((a,b)=>{const iA=a.getSortIndex(),iB=b.getSortIndex();if(null!=iA&&null!=iB)return iA-iB;if(null==iA&&null==iB){return allColsIndexes[a.getId()]>allColsIndexes[b.getId()]?1:-1}return null==iB?-1:1});const isSortLinked=this.gos.isColumnsSortingCoupledToGroup()&&!!sortedRowGroupCols.length;isSortLinked&&(allSortedCols=[...new Set(allSortedCols.map(col=>{var _a;return null!=(_a=this.columnModel.getGroupDisplayColumnForGroup(col.getId()))?_a:col}))]);const indexMap=new Map;return allSortedCols.forEach((col,idx)=>indexMap.set(col,idx)),isSortLinked&&sortedRowGroupCols.forEach(col=>{const groupDisplayCol=this.columnModel.getGroupDisplayColumnForGroup(col.getId());indexMap.set(col,indexMap.get(groupDisplayCol))}),indexMap}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([col1,idx1],[col2,idx2])=>idx1-idx2).map(([col])=>col)}getSortModel(){return this.getColumnsWithSortingOrdered().filter(column=>column.getSort()).map(column=>({sort:column.getSort(),colId:column.getId()}))}getSortOptions(){return this.getColumnsWithSortingOrdered().filter(column=>column.getSort()).map(column=>({sort:column.getSort(),column}))}canColumnDisplayMixedSort(column){const isColumnSortCouplingActive=this.gos.isColumnsSortingCoupledToGroup(),isGroupDisplayColumn=!!column.getColDef().showRowGroup;return isColumnSortCouplingActive&&isGroupDisplayColumn}getDisplaySortForColumn(column){const linkedColumns=this.columnModel.getSourceColumnsForGroupColumn(column);if(!this.canColumnDisplayMixedSort(column)||!(null==linkedColumns?void 0:linkedColumns.length))return column.getSort();const sortableColumns=null!=column.getColDef().field||!!column.getColDef().valueGetter?[column,...linkedColumns]:linkedColumns,firstSort=sortableColumns[0].getSort();return sortableColumns.every(col=>col.getSort()==firstSort)?firstSort:"mixed"}getDisplaySortIndexForColumn(column){return this.getIndexedSortMap().get(column)}};SortController.DEFAULT_SORTING_ORDER=["asc","desc",null],__decorateClass([Autowired("columnModel")],SortController.prototype,"columnModel",2),SortController=__decorateClass([Bean("sortController")],SortController);var FocusService=class extends BeanStub{static addKeyboardModeEvents(doc){this.instanceCount>0||(doc.addEventListener("keydown",FocusService.toggleKeyboardMode),doc.addEventListener("mousedown",FocusService.toggleKeyboardMode))}static removeKeyboardModeEvents(doc){this.instanceCount>0||(doc.addEventListener("keydown",FocusService.toggleKeyboardMode),doc.addEventListener("mousedown",FocusService.toggleKeyboardMode))}static toggleKeyboardMode(event){const isKeyboardActive=FocusService.keyboardModeActive,isKeyboardEvent="keydown"===event.type;isKeyboardEvent&&(event.ctrlKey||event.metaKey||event.altKey)||isKeyboardActive!==isKeyboardEvent&&(FocusService.keyboardModeActive=isKeyboardEvent)}static unregisterGridCompController(doc){FocusService.removeKeyboardModeEvents(doc)}init(){const clearFocusedCellListener=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,clearFocusedCellListener),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,clearFocusedCellListener),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,clearFocusedCellListener),this.registerKeyboardFocusEvents(),this.ctrlsService.whenReady(p=>{this.gridCtrl=p.gridCtrl})}registerKeyboardFocusEvents(){const eDocument=this.gos.getDocument();FocusService.addKeyboardModeEvents(eDocument),FocusService.instanceCount++,this.addDestroyFunc(()=>{FocusService.instanceCount--,FocusService.unregisterGridCompController(eDocument)})}onColumnEverythingChanged(){if(!this.focusedCellPosition)return;const col=this.focusedCellPosition.column,colFromColumnModel=this.columnModel.getGridColumn(col.getId());col!==colFromColumnModel&&this.clearFocusedCell()}isKeyboardMode(){return FocusService.keyboardModeActive}getFocusCellToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),RowCtrl.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(this.gos.getActiveDomElement(),AbstractHeaderCellCtrl.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition}isDomDataMissingInHierarchy(eBrowserCell,key){let ePointer=eBrowserCell;for(;ePointer;){if(this.gos.getDomData(ePointer,key))return!1;ePointer=ePointer.parentNode}return!0}getFocusedCell(){return this.focusedCellPosition}shouldRestoreFocus(cell){return!!this.isCellRestoreFocused(cell)&&(setTimeout(()=>{this.restoredFocusedCellPosition=null},0),!0)}isCellRestoreFocused(cellPosition){return null!=this.restoredFocusedCellPosition&&this.cellPositionUtils.equals(cellPosition,this.restoredFocusedCellPosition)}setRestoreFocusedCell(cellPosition){"react"===this.getFrameworkOverrides().renderingEngine&&(this.restoredFocusedCellPosition=cellPosition)}getFocusEventParams(){const{rowIndex,rowPinned,column}=this.focusedCellPosition,params={rowIndex,rowPinned,column,isFullWidthCell:!1},rowCtrl=this.rowRenderer.getRowByPosition({rowIndex,rowPinned});return rowCtrl&&(params.isFullWidthCell=rowCtrl.isFullWidth()),params}clearFocusedCell(){if(this.restoredFocusedCellPosition=null,null==this.focusedCellPosition)return;const event=__spreadValues({type:Events.EVENT_CELL_FOCUS_CLEARED},this.getFocusEventParams());this.focusedCellPosition=null,this.eventService.dispatchEvent(event)}setFocusedCell(params){const{column,rowIndex,rowPinned,forceBrowserFocus=!1,preventScrollOnBrowserFocus=!1}=params,gridColumn=this.columnModel.getGridColumn(column);if(!gridColumn)return void(this.focusedCellPosition=null);this.focusedCellPosition=gridColumn?{rowIndex,rowPinned:makeNull(rowPinned),column:gridColumn}:null;const event=__spreadProps(__spreadValues({type:Events.EVENT_CELL_FOCUSED},this.getFocusEventParams()),{forceBrowserFocus,preventScrollOnBrowserFocus,floating:null});this.eventService.dispatchEvent(event)}isCellFocused(cellPosition){return null!=this.focusedCellPosition&&this.cellPositionUtils.equals(cellPosition,this.focusedCellPosition)}isRowNodeFocused(rowNode){return this.isRowFocused(rowNode.rowIndex,rowNode.rowPinned)}isHeaderWrapperFocused(headerCtrl){if(null==this.focusedHeaderPosition)return!1;const column=headerCtrl.getColumnGroupChild(),headerRowIndex=headerCtrl.getRowIndex(),pinned=headerCtrl.getPinned(),{column:focusedColumn,headerRowIndex:focusedHeaderRowIndex}=this.focusedHeaderPosition;return column===focusedColumn&&headerRowIndex===focusedHeaderRowIndex&&pinned==focusedColumn.getPinned()}clearFocusedHeader(){this.focusedHeaderPosition=null}getFocusedHeader(){return this.focusedHeaderPosition}setFocusedHeader(headerRowIndex,column){this.focusedHeaderPosition={headerRowIndex,column}}focusHeaderPosition(params){if(this.gos.get("suppressHeaderFocus"))return!1;const{direction,fromTab,allowUserOverride,event,fromCell,rowWithoutSpanValue}=params;let{headerPosition}=params;if(fromCell&&this.filterManager.isAdvancedFilterHeaderActive())return this.focusAdvancedFilter(headerPosition);if(allowUserOverride){const currentPosition=this.getFocusedHeader(),headerRowCount=this.headerNavigationService.getHeaderRowCount();if(fromTab){const userFunc=this.gos.getCallback("tabToNextHeader");userFunc&&(headerPosition=this.getHeaderPositionFromUserFunc({userFunc,direction,currentPosition,headerPosition,headerRowCount}))}else{const userFunc=this.gos.getCallback("navigateToNextHeader");if(userFunc&&event){headerPosition=userFunc({key:event.key,previousHeaderPosition:currentPosition,nextHeaderPosition:headerPosition,headerRowCount,event})}}}return!!headerPosition&&this.focusProvidedHeaderPosition({headerPosition,direction,event,fromCell,rowWithoutSpanValue})}focusHeaderPositionFromUserFunc(params){if(this.gos.get("suppressHeaderFocus"))return!1;const{userFunc,headerPosition,direction,event}=params,currentPosition=this.getFocusedHeader(),headerRowCount=this.headerNavigationService.getHeaderRowCount(),newHeaderPosition=this.getHeaderPositionFromUserFunc({userFunc,direction,currentPosition,headerPosition,headerRowCount});return!!newHeaderPosition&&this.focusProvidedHeaderPosition({headerPosition:newHeaderPosition,direction,event})}getHeaderPositionFromUserFunc(params){const{userFunc,direction,currentPosition,headerPosition,headerRowCount}=params,userResult=userFunc({backwards:"Before"===direction,previousHeaderPosition:currentPosition,nextHeaderPosition:headerPosition,headerRowCount});return!0===userResult||null===userResult?(null===userResult&&warnOnce("Returning `null` from tabToNextHeader is deprecated. Return `true` to stay on the current header, or `false` to let the browser handle the tab behaviour."),currentPosition):!1===userResult?null:userResult}focusProvidedHeaderPosition(params){const{headerPosition,direction,fromCell,rowWithoutSpanValue,event}=params;if(-1===headerPosition.headerRowIndex)return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(headerPosition):this.focusGridView(headerPosition.column);this.headerNavigationService.scrollToColumn(headerPosition.column,direction);const focusSuccess=this.ctrlsService.getHeaderRowContainerCtrl(headerPosition.column.getPinned()).focusHeader(headerPosition.headerRowIndex,headerPosition.column,event);return focusSuccess&&(null!=rowWithoutSpanValue||fromCell)&&this.headerNavigationService.setCurrentHeaderRowWithoutSpan(null!=rowWithoutSpanValue?rowWithoutSpanValue:-1),focusSuccess}focusFirstHeader(){let firstColumn=this.columnModel.getAllDisplayedColumns()[0];if(!firstColumn)return!1;firstColumn.getParent()&&(firstColumn=this.columnModel.getColumnGroupAtLevel(firstColumn,0));const headerPosition=this.headerPositionUtils.getHeaderIndexToFocus(firstColumn,0);return this.focusHeaderPosition({headerPosition,rowWithoutSpanValue:0})}focusLastHeader(event){const headerRowIndex=this.headerNavigationService.getHeaderRowCount()-1,column=last(this.columnModel.getAllDisplayedColumns());return this.focusHeaderPosition({headerPosition:{headerRowIndex,column},rowWithoutSpanValue:-1,event})}focusPreviousFromFirstCell(event){return this.filterManager.isAdvancedFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(event)}isAnyCellFocused(){return!!this.focusedCellPosition}isRowFocused(rowIndex,floating){return null!=this.focusedCellPosition&&(this.focusedCellPosition.rowIndex===rowIndex&&this.focusedCellPosition.rowPinned===makeNull(floating))}findFocusableElements(rootNode,exclude,onlyUnmanaged=!1){const focusableString=FOCUSABLE_SELECTOR;let excludeString=FOCUSABLE_EXCLUDE;exclude&&(excludeString+=", "+exclude),onlyUnmanaged&&(excludeString+=', [tabindex="-1"]');const nodes=Array.prototype.slice.apply(rootNode.querySelectorAll(focusableString)).filter(node=>isVisible(node)),excludeNodes=Array.prototype.slice.apply(rootNode.querySelectorAll(excludeString));if(!excludeNodes.length)return nodes;return b=excludeNodes,nodes.filter(element=>-1===b.indexOf(element));var b}focusInto(rootNode,up=!1,onlyUnmanaged=!1){const focusableElements=this.findFocusableElements(rootNode,null,onlyUnmanaged),toFocus=up?last(focusableElements):focusableElements[0];return!!toFocus&&(toFocus.focus({preventScroll:!0}),!0)}findFocusableElementBeforeTabGuard(rootNode,referenceElement){if(!referenceElement)return null;const focusableElements=this.findFocusableElements(rootNode),referenceIndex=focusableElements.indexOf(referenceElement);if(-1===referenceIndex)return null;let lastTabGuardIndex=-1;for(let i=referenceIndex-1;i>=0;i--)if(focusableElements[i].classList.contains("ag-tab-guard-top")){lastTabGuardIndex=i;break}return lastTabGuardIndex<=0?null:focusableElements[lastTabGuardIndex-1]}findNextFocusableElement(rootNode=this.eGridDiv,onlyManaged,backwards){const focusable=this.findFocusableElements(rootNode,onlyManaged?':not([tabindex="-1"])':null),activeEl=this.gos.getActiveDomElement();let currentIndex;currentIndex=onlyManaged?focusable.findIndex(el=>el.contains(activeEl)):focusable.indexOf(activeEl);const nextIndex=currentIndex+(backwards?-1:1);return nextIndex<0||nextIndex>=focusable.length?null:focusable[nextIndex]}isTargetUnderManagedComponent(rootNode,target){if(!target)return!1;const managedContainers=rootNode.querySelectorAll(`.${ManagedFocusFeature.FOCUS_MANAGED_CLASS}`);if(!managedContainers.length)return!1;for(let i=0;i<managedContainers.length;i++)if(managedContainers[i].contains(target))return!0;return!1}findTabbableParent(node,limit=5){let counter=0;for(;node&&null===getTabIndex(node)&&++counter<=limit;)node=node.parentElement;return null===getTabIndex(node)?null:node}focusGridView(column,backwards){var _a;if(this.gos.get("suppressCellFocus"))return backwards?this.gos.get("suppressHeaderFocus")?this.focusNextGridCoreContainer(!0,!0):this.focusLastHeader():this.focusNextGridCoreContainer(!1);const nextRow=backwards?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!nextRow)return!1;const{rowIndex,rowPinned}=nextRow,focusedHeader=this.getFocusedHeader();return!column&&focusedHeader&&(column=focusedHeader.column),!(null==rowIndex||!column)&&(this.navigationService.ensureCellVisible({rowIndex,column,rowPinned}),this.setFocusedCell({rowIndex,column,rowPinned:makeNull(rowPinned),forceBrowserFocus:!0}),null==(_a=this.rangeService)||_a.setRangeToCell({rowIndex,rowPinned,column}),!0)}focusNextGridCoreContainer(backwards,forceOut=!1){return!(forceOut||!this.gridCtrl.focusNextInnerContainer(backwards))||((forceOut||!backwards&&!this.gridCtrl.isDetailGrid())&&this.gridCtrl.forceFocusOutOfContainer(backwards),!1)}focusAdvancedFilter(position){var _a,_b;return this.advancedFilterFocusColumn=null==position?void 0:position.column,null!=(_b=null==(_a=this.advancedFilterService)?void 0:_a.getCtrl().focusHeaderComp())&&_b}focusNextFromAdvancedFilter(backwards,forceFirstColumn){var _a,_b;const column=null!=(_b=forceFirstColumn?void 0:this.advancedFilterFocusColumn)?_b:null==(_a=this.columnModel.getAllDisplayedColumns())?void 0:_a[0];return backwards?this.focusHeaderPosition({headerPosition:{column,headerRowIndex:this.headerNavigationService.getHeaderRowCount()-1}}):this.focusGridView(column)}clearAdvancedFilterColumn(){this.advancedFilterFocusColumn=void 0}};FocusService.keyboardModeActive=!1,FocusService.instanceCount=0,__decorateClass([Autowired("eGridDiv")],FocusService.prototype,"eGridDiv",2),__decorateClass([Autowired("columnModel")],FocusService.prototype,"columnModel",2),__decorateClass([Autowired("headerNavigationService")],FocusService.prototype,"headerNavigationService",2),__decorateClass([Autowired("headerPositionUtils")],FocusService.prototype,"headerPositionUtils",2),__decorateClass([Autowired("rowRenderer")],FocusService.prototype,"rowRenderer",2),__decorateClass([Autowired("rowPositionUtils")],FocusService.prototype,"rowPositionUtils",2),__decorateClass([Autowired("cellPositionUtils")],FocusService.prototype,"cellPositionUtils",2),__decorateClass([Autowired("navigationService")],FocusService.prototype,"navigationService",2),__decorateClass([Autowired("ctrlsService")],FocusService.prototype,"ctrlsService",2),__decorateClass([Autowired("filterManager")],FocusService.prototype,"filterManager",2),__decorateClass([Optional("rangeService")],FocusService.prototype,"rangeService",2),__decorateClass([Optional("advancedFilterService")],FocusService.prototype,"advancedFilterService",2),__decorateClass([PostConstruct],FocusService.prototype,"init",1),FocusService=__decorateClass([Bean("focusService")],FocusService);var ColumnHoverService=class extends BeanStub{setMouseOver(columns){this.selectedColumns=columns;const event={type:Events.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(event)}clearMouseOver(){this.selectedColumns=null;const event={type:Events.EVENT_COLUMN_HOVER_CHANGED};this.eventService.dispatchEvent(event)}isHovered(column){return!!this.selectedColumns&&this.selectedColumns.indexOf(column)>=0}};ColumnHoverService=__decorateClass([Bean("columnHoverService")],ColumnHoverService);var ColumnAnimationService=class extends BeanStub{constructor(){super(...arguments),this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.ctrlsService.whenReady(p=>this.gridBodyCtrl=p.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(suppress){this.suppressAnimation=suppress}start(){this.active||this.gos.get("suppressColumnMoveAnimation")||this.gos.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0)}finish(){this.active&&this.flush(()=>{this.active=!1})}executeNextVMTurn(func){this.active?this.executeNextFuncs.push(func):func()}executeLaterVMTurn(func){this.active?this.executeLaterFuncs.push(func):func()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const animationThreadCountCopy=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===animationThreadCountCopy&&this.gridBodyCtrl.setColumnMovingCss(!1)})}flush(callback){if(0===this.executeNextFuncs.length&&0===this.executeLaterFuncs.length)return void callback();const runFuncs=queue=>{for(;queue.length;){const func=queue.pop();func&&func()}};this.getFrameworkOverrides().wrapIncoming(()=>{window.setTimeout(()=>runFuncs(this.executeNextFuncs),0),window.setTimeout(()=>{callback(),runFuncs(this.executeLaterFuncs)},200)})}};__decorateClass([Autowired("ctrlsService")],ColumnAnimationService.prototype,"ctrlsService",2),__decorateClass([PostConstruct],ColumnAnimationService.prototype,"postConstruct",1),ColumnAnimationService=__decorateClass([Bean("columnAnimationService")],ColumnAnimationService);var PaginationAutoPageSizeService=class extends BeanStub{postConstruct(){this.ctrlsService.whenReady(p=>{this.centerRowsCtrl=p.center,this.addManagedListener(this.eventService,Events.EVENT_BODY_HEIGHT_CHANGED,this.checkPageSize.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.checkPageSize.bind(this)),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||null==this.centerRowsCtrl}onPaginationAutoSizeChanged(){this.notActive()?this.paginationProxy.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const bodyHeight=this.centerRowsCtrl.getViewportSizeFeature().getBodyHeight();if(bodyHeight>0){const update=()=>{const rowHeight=this.gos.getRowHeightAsNumber(),newPageSize=Math.floor(bodyHeight/rowHeight);this.paginationProxy.setPageSize(newPageSize,"autoCalculated")};this.isBodyRendered?debounce(()=>update(),50)():(update(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}};__decorateClass([Autowired("ctrlsService")],PaginationAutoPageSizeService.prototype,"ctrlsService",2),__decorateClass([Autowired("paginationProxy")],PaginationAutoPageSizeService.prototype,"paginationProxy",2),__decorateClass([PostConstruct],PaginationAutoPageSizeService.prototype,"postConstruct",1),PaginationAutoPageSizeService=__decorateClass([Bean("paginationAutoPageSizeService")],PaginationAutoPageSizeService);var ValueCache=class extends BeanStub{constructor(){super(...arguments),this.cacheVersion=0}init(){this.active=this.gos.get("valueCache"),this.neverExpires=this.gos.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(rowNode,colId,value){this.active&&(rowNode.__cacheVersion!==this.cacheVersion&&(rowNode.__cacheVersion=this.cacheVersion,rowNode.__cacheData={}),rowNode.__cacheData[colId]=value)}getValue(rowNode,colId){if(this.active&&rowNode.__cacheVersion===this.cacheVersion)return rowNode.__cacheData[colId]}};__decorateClass([PostConstruct],ValueCache.prototype,"init",1),ValueCache=__decorateClass([Bean("valueCache")],ValueCache);var ChangeDetectionService=class extends BeanStub{init(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,Events.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))}onCellValueChanged(event){"paste"!==event.source&&this.doChangeDetection(event.node,event.column)}doChangeDetection(rowNode,column){if(this.gos.get("suppressChangeDetection"))return;const nodesToRefresh=[rowNode];if(this.clientSideRowModel&&!rowNode.isRowPinned()){const onlyChangedColumns=this.gos.get("aggregateOnlyChangedColumns"),changedPath=new ChangedPath(onlyChangedColumns,this.clientSideRowModel.getRootNode());changedPath.addParentNode(rowNode.parent,[column]),this.clientSideRowModel.doAggregate(changedPath),changedPath.forEachChangedNodeDepthFirst(rowNode2=>{nodesToRefresh.push(rowNode2)})}this.rowRenderer.refreshCells({rowNodes:nodesToRefresh})}};__decorateClass([Autowired("rowModel")],ChangeDetectionService.prototype,"rowModel",2),__decorateClass([Autowired("rowRenderer")],ChangeDetectionService.prototype,"rowRenderer",2),__decorateClass([PostConstruct],ChangeDetectionService.prototype,"init",1),ChangeDetectionService=__decorateClass([Bean("changeDetectionService")],ChangeDetectionService);var AgComponentUtils=class extends BeanStub{adaptFunction(propertyName,jsCompFunc){const metadata=this.componentMetadataProvider.retrieve(propertyName);return metadata&&metadata.functionAdapter?metadata.functionAdapter(jsCompFunc):null}adaptCellRendererFunction(callback){return class Adapter{refresh(params){return!1}getGui(){return this.eGui}init(params){const callbackResult=callback(params),type=typeof callbackResult;this.eGui="string"!==type&&"number"!==type&&"boolean"!==type?null!=callbackResult?callbackResult:loadTemplate("<span></span>"):loadTemplate("<span>"+callbackResult+"</span>")}}}doesImplementIComponent(candidate){return!!candidate&&(candidate.prototype&&"getGui"in candidate.prototype)}};__decorateClass([Autowired("componentMetadataProvider")],AgComponentUtils.prototype,"componentMetadataProvider",2),AgComponentUtils=__decorateClass([Bean("agComponentUtils")],AgComponentUtils);var ComponentMetadataProvider=class extends BeanStub{postConstruct(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","onParamsUpdated","refresh"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached","onParamsUpdated","refresh"]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["refresh"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","getState"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]},menuItem:{mandatoryMethodList:[],optionalMethodList:["setActive","select","setExpanded","configureDefaults"]}}}retrieve(name){return this.componentMetaData[name]}};__decorateClass([Autowired("agComponentUtils")],ComponentMetadataProvider.prototype,"agComponentUtils",2),__decorateClass([PostConstruct],ComponentMetadataProvider.prototype,"postConstruct",1),ComponentMetadataProvider=__decorateClass([Bean("componentMetadataProvider")],ComponentMetadataProvider);var HARD_CODED_SIZES={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240},"ag-theme-quartz":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:260}},SASS_PROPERTY_BUILDER={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},Environment=class extends BeanStub{constructor(){super(...arguments),this.calculatedSizes={},this.calculatedTheme=null}postConstruct(){var _a;const el=null!=(_a=this.getTheme().el)?_a:this.eGridDiv;this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.mutationObserver=new MutationObserver(()=>{this.calculatedSizes={},this.calculatedTheme=null,this.calculatedTheme=this.getTheme(),this.fireGridStylesChangedEvent()}),this.mutationObserver.observe(el||this.eGridDiv,{attributes:!0,attributeFilter:["class"]})}fireGridStylesChangedEvent(){const event={type:Events.EVENT_GRID_STYLES_CHANGED};this.eventService.dispatchEvent(event)}getSassVariable(key){const{themeFamily,el}=this.getTheme();if(!themeFamily||0!==themeFamily.indexOf("ag-theme"))return;this.calculatedSizes||(this.calculatedSizes={}),this.calculatedSizes[themeFamily]||(this.calculatedSizes[themeFamily]={});const size=this.calculatedSizes[themeFamily][key];return null!=size?size:(this.calculatedSizes[themeFamily][key]=this.calculateValueForSassProperty(key,themeFamily,el),this.calculatedSizes[themeFamily][key])}calculateValueForSassProperty(property,theme,themeElement){const useTheme="ag-theme-"+(theme.match("material")?"material":theme.match("balham")?"balham":theme.match("alpine")?"alpine":"custom"),defaultValue=HARD_CODED_SIZES[useTheme][property],eDocument=this.gos.getDocument();if(themeElement||(themeElement=this.eGridDiv),!SASS_PROPERTY_BUILDER[property])return defaultValue;const classList=SASS_PROPERTY_BUILDER[property],div=eDocument.createElement("div"),classesFromThemeElement=Array.from(themeElement.classList);div.classList.add(theme,...classesFromThemeElement),div.style.position="absolute";const el=classList.reduce((prevEl,currentClass)=>{const currentDiv=eDocument.createElement("div");return currentDiv.style.position="static",currentDiv.classList.add(currentClass),prevEl.appendChild(currentDiv),currentDiv},div);let calculatedValue=0;if(eDocument.body){eDocument.body.appendChild(div);const sizeName=-1!==property.toLowerCase().indexOf("height")?"height":"width";calculatedValue=parseInt(window.getComputedStyle(el)[sizeName],10),eDocument.body.removeChild(div)}return calculatedValue||defaultValue}isThemeDark(){const{theme}=this.getTheme();return!!theme&&theme.indexOf("dark")>=0}chartMenuPanelWidth(){return this.getSassVariable("chartMenuPanelWidth")}getTheme(){if(this.calculatedTheme)return this.calculatedTheme;const reg=/\bag-(material|(?:theme-([\w\-]*)))\b/g;let el=this.eGridDiv,themeMatch=null,allThemes=[];for(;el;){if(themeMatch=reg.exec(el.className),themeMatch){const matched=el.className.match(reg);matched&&(allThemes=matched);break}el=el.parentElement||void 0}if(!themeMatch)return{allThemes};const theme=themeMatch[0];return this.calculatedTheme={theme,el,themeFamily:theme.replace(/-dark$/,""),allThemes},this.calculatedTheme}getFromTheme(defaultValue,sassVariableName){var _a;return null!=(_a=this.getSassVariable(sassVariableName))?_a:defaultValue}getDefaultRowHeight(){return this.getFromTheme(25,"rowHeight")}getListItemHeight(){return this.getFromTheme(20,"listItemHeight")}refreshRowHeightVariable(){const oldRowHeight=this.eGridDiv.style.getPropertyValue("--ag-line-height").trim(),height=this.gos.get("rowHeight");if(null==height||isNaN(height)||!isFinite(height))return null!==oldRowHeight&&this.eGridDiv.style.setProperty("--ag-line-height",null),-1;const newRowHeight=`${height}px`;return oldRowHeight!=newRowHeight?(this.eGridDiv.style.setProperty("--ag-line-height",newRowHeight),height):""!=oldRowHeight?parseFloat(oldRowHeight):-1}getMinColWidth(){const measuredMin=this.getFromTheme(null,"headerCellMinWidth");return exists(measuredMin)?Math.max(measuredMin,10):10}destroy(){this.calculatedSizes=null,this.mutationObserver&&this.mutationObserver.disconnect(),super.destroy()}};__decorateClass([Autowired("eGridDiv")],Environment.prototype,"eGridDiv",2),__decorateClass([PostConstruct],Environment.prototype,"postConstruct",1),Environment=__decorateClass([Bean("environment")],Environment);var RowContainerHeightService=class extends BeanStub{constructor(){super(...arguments),this.scrollY=0,this.uiBodyHeight=0}agWire(loggerFactory){this.logger=loggerFactory.create("RowContainerHeightService")}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=getMaxDivHeight(),this.logger.log("maxDivHeight = "+this.maxDivHeight)}isStretching(){return this.stretching}getDivStretchOffset(){return this.divStretchOffset}updateOffset(){if(!this.stretching)return;const newScrollY=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,newBodyHeight=this.getUiBodyHeight();(newScrollY!==this.scrollY||newBodyHeight!==this.uiBodyHeight)&&(this.scrollY=newScrollY,this.uiBodyHeight=newBodyHeight,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const scrollPercent=this.scrollY/this.maxScrollY,divStretchOffset=scrollPercent*this.pixelsToShave;this.logger.log(`Div Stretch Offset = ${divStretchOffset} (${this.pixelsToShave} * ${scrollPercent})`),this.setDivStretchOffset(divStretchOffset)}setUiContainerHeight(height){height!==this.uiContainerHeight&&(this.uiContainerHeight=height,this.eventService.dispatchEvent({type:Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(newOffset){const newOffsetFloor="number"==typeof newOffset?Math.floor(newOffset):null;this.divStretchOffset!==newOffsetFloor&&(this.divStretchOffset=newOffsetFloor,this.eventService.dispatchEvent({type:Events.EVENT_HEIGHT_SCALE_CHANGED}))}setModelHeight(modelHeight){this.modelHeight=modelHeight,this.stretching=null!=modelHeight&&this.maxDivHeight>0&&modelHeight>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getUiContainerHeight(){return this.uiContainerHeight}getRealPixelPosition(modelPixel){return modelPixel-this.divStretchOffset}getUiBodyHeight(){const pos=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return pos.bottom-pos.top}getScrollPositionForPixel(rowTop){if(this.pixelsToShave<=0)return rowTop;const scrollPercent=rowTop/(this.modelHeight-this.getUiBodyHeight());return this.maxScrollY*scrollPercent}};__decorateClass([Autowired("ctrlsService")],RowContainerHeightService.prototype,"ctrlsService",2),__decorateClass([__decorateParam(0,Qualifier("loggerFactory"))],RowContainerHeightService.prototype,"agWire",1),__decorateClass([PostConstruct],RowContainerHeightService.prototype,"postConstruct",1),RowContainerHeightService=__decorateClass([Bean("rowContainerHeightService")],RowContainerHeightService);var SelectableService=class extends BeanStub{init(){this.addManagedPropertyListener("isRowSelectable",()=>this.updateSelectable())}updateSelectableAfterGrouping(){this.updateSelectable(!0)}updateSelectable(skipLeafNodes=!1){const isRowSelecting=!!this.gos.get("rowSelection"),isRowSelectable=this.gos.get("isRowSelectable");if(!isRowSelecting||!isRowSelectable)return;const isGroupSelectsChildren=this.gos.get("groupSelectsChildren"),isCsrmGroupSelectsChildren="clientSide"===this.rowModel.getType()&&isGroupSelectsChildren,nodesToDeselect=[],nodeCallback=node=>{if(skipLeafNodes&&!node.group)return;if(isCsrmGroupSelectsChildren&&node.group){const hasSelectableChild=node.childrenAfterGroup.some(rowNode=>!0===rowNode.selectable);return void node.setRowSelectable(hasSelectableChild,!0)}const rowSelectable=!isRowSelectable||isRowSelectable(node);node.setRowSelectable(rowSelectable,!0),!rowSelectable&&node.isSelected()&&nodesToDeselect.push(node)};if(isCsrmGroupSelectsChildren){const csrm=this.rowModel;new ChangedPath(!1,csrm.getRootNode()).forEachChangedNodeDepthFirst(nodeCallback,!0,!0)}else this.rowModel.forEachNode(nodeCallback);nodesToDeselect.length&&this.selectionService.setNodesSelected({nodes:nodesToDeselect,newValue:!1,source:"selectableChanged"}),isCsrmGroupSelectsChildren&&this.selectionService instanceof SelectionService&&this.selectionService.updateGroupsFromChildrenSelections("selectableChanged")}};__decorateClass([Autowired("rowModel")],SelectableService.prototype,"rowModel",2),__decorateClass([Autowired("selectionService")],SelectableService.prototype,"selectionService",2),__decorateClass([PostConstruct],SelectableService.prototype,"init",1),SelectableService=__decorateClass([Bean("selectableService")],SelectableService);var PaginationComp=class extends Component{constructor(){super(),this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1}postConstruct(){const isRtl=this.gos.get("enableRtl");this.setTemplate(this.getTemplate());const{btFirst,btPrevious,btNext,btLast,pageSizeComp}=this;this.activateTabIndex([btFirst,btPrevious,btNext,btLast]),btFirst.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"last":"first",this.gos)),btPrevious.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"next":"previous",this.gos)),btNext.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"previous":"next",this.gos)),btLast.insertAdjacentElement("afterbegin",createIconNoSpan(isRtl?"first":"last",this.gos)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.onPaginationChanged()}onPaginationChanged(){const paginationPanelEnabled=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(paginationPanelEnabled),paginationPanelEnabled&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){this.areListenersSetup||(this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(item=>{const{el,fn}=item;this.addManagedListener(el,"click",fn),this.addManagedListener(el,"keydown",e=>{e.key!==KeyCode.ENTER&&e.key!==KeyCode.SPACE||(e.preventDefault(),fn())})}),this.areListenersSetup=!0)}onBtFirst(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()}setCurrentPageLabel(){const pagesExist=this.paginationProxy.getTotalPages()>0,currentPage=this.paginationProxy.getCurrentPage(),toDisplay=pagesExist?currentPage+1:0;this.lbCurrent.textContent=this.formatNumber(toDisplay)}formatNumber(value){const userFunc=this.gos.getCallback("paginationNumberFormatter");if(userFunc){return userFunc({value})}const localeTextFunc=this.localeService.getLocaleTextFunc();return formatNumberCommas(value,localeTextFunc("thousandSeparator",","),localeTextFunc("decimalSeparator","."))}getTemplate(){const localeTextFunc=this.localeService.getLocaleTextFunc(),strPage=localeTextFunc("page","Page"),strTo=localeTextFunc("to","to"),strOf=localeTextFunc("of","of"),strFirst=localeTextFunc("firstPage","First Page"),strPrevious=localeTextFunc("previousPage","Previous Page"),strNext=localeTextFunc("nextPage","Next Page"),strLast=localeTextFunc("lastPage","Last Page"),compId=this.getCompId();return`<div class="ag-paging-panel ag-unselectable" id="ag-${compId}">\n                <ag-page-size-selector ref="pageSizeComp"></ag-page-size-selector>\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-${compId}-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${compId}-to">${strTo}</span>\n                    <span id="ag-${compId}-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-${compId}-of">${strOf}</span>\n                    <span id="ag-${compId}-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-button ag-paging-button" role="button" aria-label="${strFirst}"></div>\n                    <div ref="btPrevious" class="ag-button ag-paging-button" role="button" aria-label="${strPrevious}"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-${compId}-start-page">${strPage}</span>\n                        <span id="ag-${compId}-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-${compId}-of-page">${strOf}</span>\n                        <span id="ag-${compId}-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-button ag-paging-button" role="button" aria-label="${strNext}"></div>\n                    <div ref="btLast" class="ag-button ag-paging-button" role="button" aria-label="${strLast}"></div>\n                </span>\n            </div>`}onBtNext(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()}enableOrDisableButtons(){const currentPage=this.paginationProxy.getCurrentPage(),maxRowFound=this.paginationProxy.isLastPageFound(),totalPages=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===currentPage,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const zeroPagesToDisplay=this.isZeroPagesToDisplay(),onLastPage=currentPage===totalPages-1;this.nextButtonDisabled=onLastPage||zeroPagesToDisplay,this.lastButtonDisabled=!maxRowFound||zeroPagesToDisplay||currentPage===totalPages-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(button,disabled){setAriaDisabled(button,disabled),button.classList.toggle("ag-disabled",disabled)}updateRowLabels(){const currentPage=this.paginationProxy.getCurrentPage(),pageSize=this.paginationProxy.getPageSize(),maxRowFound=this.paginationProxy.isLastPageFound(),rowCount=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;let startRow,endRow;if(this.isZeroPagesToDisplay()?startRow=endRow=0:(startRow=pageSize*currentPage+1,endRow=startRow+pageSize-1,maxRowFound&&endRow>rowCount&&(endRow=rowCount)),this.lbFirstRowOnPage.textContent=this.formatNumber(startRow),this.rowNodeBlockLoader.isLoading()){const translate=this.localeService.getLocaleTextFunc();this.lbLastRowOnPage.innerHTML=translate("pageLastRowUnknown","?")}else this.lbLastRowOnPage.textContent=this.formatNumber(endRow)}isZeroPagesToDisplay(){const maxRowFound=this.paginationProxy.isLastPageFound(),totalPages=this.paginationProxy.getTotalPages();return maxRowFound&&0===totalPages}setTotalLabels(){const lastPageFound=this.paginationProxy.isLastPageFound(),totalPages=this.paginationProxy.getTotalPages(),rowCount=lastPageFound?this.paginationProxy.getMasterRowCount():null;if(1===rowCount){const firstRow=this.paginationProxy.getRow(0);if(firstRow&&firstRow.group&&!(firstRow.groupData||firstRow.aggData))return void this.setTotalLabelsToZero()}if(lastPageFound)this.lbTotal.textContent=this.formatNumber(totalPages),this.lbRecordCount.textContent=this.formatNumber(rowCount);else{const moreText=this.localeService.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=moreText,this.lbRecordCount.innerHTML=moreText}}setTotalLabelsToZero(){this.lbFirstRowOnPage.textContent=this.formatNumber(0),this.lbCurrent.textContent=this.formatNumber(0),this.lbLastRowOnPage.textContent=this.formatNumber(0),this.lbTotal.textContent=this.formatNumber(0),this.lbRecordCount.textContent=this.formatNumber(0)}};__decorateClass([Autowired("paginationProxy")],PaginationComp.prototype,"paginationProxy",2),__decorateClass([Autowired("rowNodeBlockLoader")],PaginationComp.prototype,"rowNodeBlockLoader",2),__decorateClass([RefSelector("btFirst")],PaginationComp.prototype,"btFirst",2),__decorateClass([RefSelector("btPrevious")],PaginationComp.prototype,"btPrevious",2),__decorateClass([RefSelector("btNext")],PaginationComp.prototype,"btNext",2),__decorateClass([RefSelector("btLast")],PaginationComp.prototype,"btLast",2),__decorateClass([RefSelector("lbRecordCount")],PaginationComp.prototype,"lbRecordCount",2),__decorateClass([RefSelector("lbFirstRowOnPage")],PaginationComp.prototype,"lbFirstRowOnPage",2),__decorateClass([RefSelector("lbLastRowOnPage")],PaginationComp.prototype,"lbLastRowOnPage",2),__decorateClass([RefSelector("lbCurrent")],PaginationComp.prototype,"lbCurrent",2),__decorateClass([RefSelector("lbTotal")],PaginationComp.prototype,"lbTotal",2),__decorateClass([RefSelector("pageSizeComp")],PaginationComp.prototype,"pageSizeComp",2),__decorateClass([PostConstruct],PaginationComp.prototype,"postConstruct",1);var _OverlayWrapperComponent=class _OverlayWrapperComponent extends Component{constructor(){super(_OverlayWrapperComponent.TEMPLATE),this.inProgress=!1,this.destroyRequested=!1}updateLayoutClasses(cssClass,params){const overlayWrapperClassList=this.eOverlayWrapper.classList;overlayWrapperClassList.toggle("ag-layout-auto-height",params.autoHeight),overlayWrapperClassList.toggle("ag-layout-normal",params.normal),overlayWrapperClassList.toggle("ag-layout-print",params.print)}postConstruct(){this.createManagedBean(new LayoutFeature(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.overlayService.registerOverlayWrapperComp(this)}setWrapperTypeClass(overlayWrapperCssClass){const overlayWrapperClassList=this.eOverlayWrapper.classList;this.activeOverlayWrapperCssClass&&overlayWrapperClassList.toggle(this.activeOverlayWrapperCssClass,!1),this.activeOverlayWrapperCssClass=overlayWrapperCssClass,overlayWrapperClassList.toggle(overlayWrapperCssClass,!0)}showOverlay(overlayComp,overlayWrapperCssClass,updateListenerDestroyFunc){this.inProgress||(this.setWrapperTypeClass(overlayWrapperCssClass),this.destroyActiveOverlay(),this.inProgress=!0,overlayComp&&overlayComp.then(comp=>{this.inProgress=!1,this.eOverlayWrapper.appendChild(comp.getGui()),this.activeOverlay=comp,this.updateListenerDestroyFunc=updateListenerDestroyFunc,this.destroyRequested&&(this.destroyRequested=!1,this.destroyActiveOverlay())}),this.setDisplayed(!0,{skipAriaHidden:!0}))}destroyActiveOverlay(){var _a;this.inProgress?this.destroyRequested=!0:this.activeOverlay&&(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),null==(_a=this.updateListenerDestroyFunc)||_a.call(this),clearElement(this.eOverlayWrapper))}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}destroy(){this.destroyActiveOverlay(),super.destroy()}};_OverlayWrapperComponent.TEMPLATE='\n        <div class="ag-overlay" role="presentation">\n            <div class="ag-overlay-panel" role="presentation">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper" role="presentation"></div>\n            </div>\n        </div>',__decorateClass([Autowired("overlayService")],_OverlayWrapperComponent.prototype,"overlayService",2),__decorateClass([RefSelector("eOverlayWrapper")],_OverlayWrapperComponent.prototype,"eOverlayWrapper",2),__decorateClass([PostConstruct],_OverlayWrapperComponent.prototype,"postConstruct",1);var OverlayWrapperComponent=_OverlayWrapperComponent,RowPositionUtils=class extends BeanStub{getFirstRow(){let rowPinned,rowIndex=0;return this.pinnedRowModel.getPinnedTopRowCount()?rowPinned="top":this.rowModel.getRowCount()?(rowPinned=null,rowIndex=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(rowPinned="bottom"),void 0===rowPinned?null:{rowIndex,rowPinned}}getLastRow(){let rowIndex,rowPinned=null;const pinnedBottomCount=this.pinnedRowModel.getPinnedBottomRowCount(),pinnedTopCount=this.pinnedRowModel.getPinnedTopRowCount();return pinnedBottomCount?(rowPinned="bottom",rowIndex=pinnedBottomCount-1):this.rowModel.getRowCount()?(rowPinned=null,rowIndex=this.paginationProxy.getPageLastRow()):pinnedTopCount&&(rowPinned="top",rowIndex=pinnedTopCount-1),void 0===rowIndex?null:{rowIndex,rowPinned}}getRowNode(gridRow){switch(gridRow.rowPinned){case"top":return this.pinnedRowModel.getPinnedTopRowData()[gridRow.rowIndex];case"bottom":return this.pinnedRowModel.getPinnedBottomRowData()[gridRow.rowIndex];default:return this.rowModel.getRow(gridRow.rowIndex)}}sameRow(rowA,rowB){return!rowA&&!rowB||!(rowA&&!rowB||!rowA&&rowB)&&(rowA.rowIndex===rowB.rowIndex&&rowA.rowPinned==rowB.rowPinned)}before(rowA,rowB){switch(rowA.rowPinned){case"top":if("top"!==rowB.rowPinned)return!0;break;case"bottom":if("bottom"!==rowB.rowPinned)return!1;break;default:if(exists(rowB.rowPinned))return"top"!==rowB.rowPinned}return rowA.rowIndex<rowB.rowIndex}};__decorateClass([Autowired("rowModel")],RowPositionUtils.prototype,"rowModel",2),__decorateClass([Autowired("pinnedRowModel")],RowPositionUtils.prototype,"pinnedRowModel",2),__decorateClass([Autowired("paginationProxy")],RowPositionUtils.prototype,"paginationProxy",2),RowPositionUtils=__decorateClass([Bean("rowPositionUtils")],RowPositionUtils);var CellPositionUtils=class extends BeanStub{createId(cellPosition){const{rowIndex,rowPinned,column}=cellPosition;return this.createIdFromValues({rowIndex,column,rowPinned})}createIdFromValues(cellPosition){const{rowIndex,rowPinned,column}=cellPosition;return`${rowIndex}.${null==rowPinned?"null":rowPinned}.${column.getId()}`}equals(cellA,cellB){const colsMatch=cellA.column===cellB.column,floatingMatch=cellA.rowPinned===cellB.rowPinned,indexMatch=cellA.rowIndex===cellB.rowIndex;return colsMatch&&floatingMatch&&indexMatch}};CellPositionUtils=__decorateClass([Bean("cellPositionUtils")],CellPositionUtils);var UndoRedoAction=class{constructor(cellValueChanges){this.cellValueChanges=cellValueChanges}},RangeUndoRedoAction=class extends UndoRedoAction{constructor(cellValueChanges,initialRange,finalRange,ranges){super(cellValueChanges),this.initialRange=initialRange,this.finalRange=finalRange,this.ranges=ranges}},_UndoRedoStack=class _UndoRedoStack{constructor(maxStackSize){this.actionStack=[],this.maxStackSize=maxStackSize||_UndoRedoStack.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(item){item.cellValueChanges&&item.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(item))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}};_UndoRedoStack.DEFAULT_STACK_SIZE=10;var UndoRedoStack=_UndoRedoStack,UndoRedoService=class extends BeanStub{constructor(){super(...arguments),this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.onCellValueChanged=event=>{const eventCell={column:event.column,rowIndex:event.rowIndex,rowPinned:event.rowPinned},isCellEditing=null!==this.activeCellEdit&&this.cellPositionUtils.equals(this.activeCellEdit,eventCell),isRowEditing=null!==this.activeRowEdit&&this.rowPositionUtils.sameRow(this.activeRowEdit,eventCell);if(!(isCellEditing||isRowEditing||this.isPasting||this.isRangeInAction))return;const{rowPinned,rowIndex,column,oldValue,value}=event,cellValueChange={rowPinned,rowIndex,columnId:column.getColId(),newValue:value,oldValue};this.cellValueChanges.push(cellValueChange)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}init(){if(!this.gos.get("undoRedoCellEditing"))return;const undoRedoLimit=this.gos.get("undoRedoCellEditingLimit");undoRedoLimit<=0||(this.undoStack=new UndoRedoStack(undoRedoLimit),this.redoStack=new UndoRedoStack(undoRedoLimit),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addCellKeyListeners(),this.addManagedListener(this.eventService,Events.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,Events.EVENT_MODEL_UPDATED,e=>{e.keepUndoRedoStack||this.clearStacks()}),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,Events.EVENT_ROW_DRAG_END,this.clearStacks),this.ctrlsService.whenReady(p=>{this.gridBodyCtrl=p.gridBodyCtrl}))}getCurrentUndoStackSize(){return this.undoStack?this.undoStack.getCurrentStackSize():0}getCurrentRedoStackSize(){return this.redoStack?this.redoStack.getCurrentStackSize():0}undo(source){const startEvent={type:Events.EVENT_UNDO_STARTED,source};this.eventService.dispatchEvent(startEvent);const operationPerformed=this.undoRedo(this.undoStack,this.redoStack,"initialRange","oldValue","undo"),endEvent={type:Events.EVENT_UNDO_ENDED,source,operationPerformed};this.eventService.dispatchEvent(endEvent)}redo(source){const startEvent={type:Events.EVENT_REDO_STARTED,source};this.eventService.dispatchEvent(startEvent);const operationPerformed=this.undoRedo(this.redoStack,this.undoStack,"finalRange","newValue","redo"),endEvent={type:Events.EVENT_REDO_ENDED,source,operationPerformed};this.eventService.dispatchEvent(endEvent)}undoRedo(undoRedoStack,opposingUndoRedoStack,rangeProperty,cellValueChangeProperty,source){if(!undoRedoStack)return!1;const undoRedoAction=undoRedoStack.pop();return!(!undoRedoAction||!undoRedoAction.cellValueChanges)&&(this.processAction(undoRedoAction,cellValueChange=>cellValueChange[cellValueChangeProperty],source),undoRedoAction instanceof RangeUndoRedoAction?this.processRange(this.rangeService,undoRedoAction.ranges||[undoRedoAction[rangeProperty]]):this.processCell(undoRedoAction.cellValueChanges),opposingUndoRedoStack.push(undoRedoAction),!0)}processAction(action,valueExtractor,source){action.cellValueChanges.forEach(cellValueChange=>{const{rowIndex,rowPinned,columnId}=cellValueChange,rowPosition={rowIndex,rowPinned},currentRow=this.rowPositionUtils.getRowNode(rowPosition);currentRow.displayed&&currentRow.setDataValue(columnId,valueExtractor(cellValueChange),source)})}processRange(rangeService,ranges){let lastFocusedCell;rangeService.removeAllCellRanges(!0),ranges.forEach((range,idx)=>{if(!range)return;const startRow=range.startRow,endRow=range.endRow;idx===ranges.length-1&&(lastFocusedCell={rowPinned:startRow.rowPinned,rowIndex:startRow.rowIndex,columnId:range.startColumn.getColId()},this.setLastFocusedCell(lastFocusedCell));const cellRangeParams={rowStartIndex:startRow.rowIndex,rowStartPinned:startRow.rowPinned,rowEndIndex:endRow.rowIndex,rowEndPinned:endRow.rowPinned,columnStart:range.startColumn,columns:range.columns};rangeService.addCellRange(cellRangeParams)})}processCell(cellValueChanges){const cellValueChange=cellValueChanges[0],{rowIndex,rowPinned}=cellValueChange,rowPosition={rowIndex,rowPinned},row=this.rowPositionUtils.getRowNode(rowPosition),lastFocusedCell={rowPinned:cellValueChange.rowPinned,rowIndex:row.rowIndex,columnId:cellValueChange.columnId};this.setLastFocusedCell(lastFocusedCell,this.rangeService)}setLastFocusedCell(lastFocusedCell,rangeService){const{rowIndex,columnId,rowPinned}=lastFocusedCell,scrollFeature=this.gridBodyCtrl.getScrollFeature(),column=this.columnModel.getGridColumn(columnId);if(!column)return;scrollFeature.ensureIndexVisible(rowIndex),scrollFeature.ensureColumnVisible(column);const cellPosition={rowIndex,column,rowPinned};this.focusService.setFocusedCell(__spreadProps(__spreadValues({},cellPosition),{forceBrowserFocus:!0})),null==rangeService||rangeService.setRangeToCell(cellPosition)}addRowEditingListeners(){this.addManagedListener(this.eventService,Events.EVENT_ROW_EDITING_STARTED,e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,Events.EVENT_ROW_EDITING_STOPPED,()=>{const action=new UndoRedoAction(this.cellValueChanges);this.pushActionsToUndoStack(action),this.activeRowEdit=null})}addCellEditingListeners(){this.addManagedListener(this.eventService,Events.EVENT_CELL_EDITING_STARTED,e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}}),this.addManagedListener(this.eventService,Events.EVENT_CELL_EDITING_STOPPED,e=>{this.activeCellEdit=null;if(e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const action=new UndoRedoAction(this.cellValueChanges);this.pushActionsToUndoStack(action)}})}addPasteListeners(){this.addManagedListener(this.eventService,Events.EVENT_PASTE_START,()=>{this.isPasting=!0}),this.addManagedListener(this.eventService,Events.EVENT_PASTE_END,()=>{const action=new UndoRedoAction(this.cellValueChanges);this.pushActionsToUndoStack(action),this.isPasting=!1})}addFillListeners(){this.addManagedListener(this.eventService,Events.EVENT_FILL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,Events.EVENT_FILL_END,event=>{const action=new RangeUndoRedoAction(this.cellValueChanges,event.initialRange,event.finalRange);this.pushActionsToUndoStack(action),this.isRangeInAction=!1})}addCellKeyListeners(){this.addManagedListener(this.eventService,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_START,()=>{this.isRangeInAction=!0}),this.addManagedListener(this.eventService,Events.EVENT_KEY_SHORTCUT_CHANGED_CELL_END,()=>{let action;action=this.rangeService&&this.gos.get("enableRangeSelection")?new RangeUndoRedoAction(this.cellValueChanges,void 0,void 0,[...this.rangeService.getCellRanges()]):new UndoRedoAction(this.cellValueChanges),this.pushActionsToUndoStack(action),this.isRangeInAction=!1})}pushActionsToUndoStack(action){this.undoStack.push(action),this.cellValueChanges=[],this.redoStack.clear()}};__decorateClass([Autowired("focusService")],UndoRedoService.prototype,"focusService",2),__decorateClass([Autowired("ctrlsService")],UndoRedoService.prototype,"ctrlsService",2),__decorateClass([Autowired("cellPositionUtils")],UndoRedoService.prototype,"cellPositionUtils",2),__decorateClass([Autowired("rowPositionUtils")],UndoRedoService.prototype,"rowPositionUtils",2),__decorateClass([Autowired("columnModel")],UndoRedoService.prototype,"columnModel",2),__decorateClass([Optional("rangeService")],UndoRedoService.prototype,"rangeService",2),__decorateClass([PostConstruct],UndoRedoService.prototype,"init",1),UndoRedoService=__decorateClass([Bean("undoRedoService")],UndoRedoService);var HeaderPositionUtils=class extends BeanStub{findHeader(focusedHeader,direction){let nextColumn,getColMethod;if(focusedHeader.column instanceof ColumnGroup?nextColumn=this.columnModel.getDisplayedGroupAtDirection(focusedHeader.column,direction):(getColMethod=`getDisplayedCol${direction}`,nextColumn=this.columnModel[getColMethod](focusedHeader.column)),!nextColumn)return;let{headerRowIndex}=focusedHeader;if("filter"!==this.getHeaderRowType(headerRowIndex)){const columnsInPath=[nextColumn];for(;nextColumn.getParent();)nextColumn=nextColumn.getParent(),columnsInPath.push(nextColumn);nextColumn=columnsInPath[columnsInPath.length-1-headerRowIndex]}const{column,headerRowIndex:indexToFocus}=this.getHeaderIndexToFocus(nextColumn,headerRowIndex);return{column,headerRowIndex:indexToFocus}}getHeaderIndexToFocus(column,currentIndex){let nextColumn;if(column instanceof ColumnGroup&&this.isAnyChildSpanningHeaderHeight(column)&&column.isPadding()){const targetColumn=column;nextColumn=targetColumn.getLeafColumns()[0];let col=nextColumn;for(;col!==targetColumn;)currentIndex++,col=col.getParent()}return{column:nextColumn||column,headerRowIndex:currentIndex}}isAnyChildSpanningHeaderHeight(columnGroup){return!!columnGroup&&columnGroup.getLeafColumns().some(col=>col.isSpanHeaderHeight())}getColumnVisibleParent(currentColumn,currentIndex){const currentRowType=this.getHeaderRowType(currentIndex),isColumn="column"===currentRowType;let nextFocusColumn="filter"===currentRowType?currentColumn:currentColumn.getParent(),nextRow=currentIndex-1,headerRowIndexWithoutSpan=nextRow;if(isColumn&&this.isAnyChildSpanningHeaderHeight(currentColumn.getParent())){for(;nextFocusColumn&&nextFocusColumn.isPadding();)nextFocusColumn=nextFocusColumn.getParent(),nextRow--;headerRowIndexWithoutSpan=nextRow,nextRow<0&&(nextFocusColumn=currentColumn,nextRow=currentIndex,headerRowIndexWithoutSpan=void 0)}return{column:nextFocusColumn,headerRowIndex:nextRow,headerRowIndexWithoutSpan}}getColumnVisibleChild(column,currentIndex,direction="After"){let nextFocusColumn=column,nextRow=currentIndex+1,headerRowIndexWithoutSpan=nextRow;if("group"===this.getHeaderRowType(currentIndex)){const leafColumns=column.getDisplayedLeafColumns(),leafColumn="After"===direction?leafColumns[0]:last(leafColumns),columnsInTheWay=[];let currentColumn=leafColumn;for(;currentColumn.getParent()!==column;)currentColumn=currentColumn.getParent(),columnsInTheWay.push(currentColumn);if(nextFocusColumn=leafColumn,leafColumn.isSpanHeaderHeight())for(let i=columnsInTheWay.length-1;i>=0;i--){const colToFocus=columnsInTheWay[i];if(!colToFocus.isPadding()){nextFocusColumn=colToFocus;break}nextRow++}else nextFocusColumn=last(columnsInTheWay),nextFocusColumn||(nextFocusColumn=leafColumn)}return{column:nextFocusColumn,headerRowIndex:nextRow,headerRowIndexWithoutSpan}}getHeaderRowType(rowIndex){const centerHeaderContainer=this.ctrlsService.getHeaderRowContainerCtrl();if(centerHeaderContainer)return centerHeaderContainer.getRowType(rowIndex)}findColAtEdgeForHeaderRow(level,position){const displayedColumns=this.columnModel.getAllDisplayedColumns(),column=displayedColumns["start"===position?0:displayedColumns.length-1];if(!column)return;const type=this.ctrlsService.getHeaderRowContainerCtrl(column.getPinned()).getRowType(level);if("group"==type){return{headerRowIndex:level,column:this.columnModel.getColumnGroupAtLevel(column,level)}}return{headerRowIndex:null==type?-1:level,column}}};__decorateClass([Autowired("columnModel")],HeaderPositionUtils.prototype,"columnModel",2),__decorateClass([Autowired("ctrlsService")],HeaderPositionUtils.prototype,"ctrlsService",2),HeaderPositionUtils=__decorateClass([Bean("headerPositionUtils")],HeaderPositionUtils);var ColumnDefFactory=class{buildColumnDefs(cols,rowGroupColumns,pivotColumns){const res=[],colGroupDefs={};return cols.forEach(col=>{let addToResult=!0,childDef=this.createDefFromColumn(col,rowGroupColumns,pivotColumns),pointer=col.getOriginalParent(),lastPointer=null;for(;pointer;){let parentDef=null;if(pointer.isPadding()){pointer=pointer.getOriginalParent();continue}const existingParentDef=colGroupDefs[pointer.getGroupId()];if(existingParentDef){existingParentDef.children.push(childDef),addToResult=!1;break}if(parentDef=this.createDefFromGroup(pointer),parentDef&&(parentDef.children=[childDef],colGroupDefs[parentDef.groupId]=parentDef,childDef=parentDef,pointer=pointer.getOriginalParent()),null!=pointer&&lastPointer===pointer){addToResult=!1;break}lastPointer=pointer}addToResult&&res.push(childDef)}),res}createDefFromGroup(group){const defCloned=deepCloneDefinition(group.getColGroupDef(),["children"]);return defCloned&&(defCloned.groupId=group.getGroupId()),defCloned}createDefFromColumn(col,rowGroupColumns,pivotColumns){const colDefCloned=deepCloneDefinition(col.getColDef());return colDefCloned.colId=col.getColId(),colDefCloned.width=col.getActualWidth(),colDefCloned.rowGroup=col.isRowGroupActive(),colDefCloned.rowGroupIndex=col.isRowGroupActive()?rowGroupColumns.indexOf(col):null,colDefCloned.pivot=col.isPivotActive(),colDefCloned.pivotIndex=col.isPivotActive()?pivotColumns.indexOf(col):null,colDefCloned.aggFunc=col.isValueActive()?col.getAggFunc():null,colDefCloned.hide=!col.isVisible()||void 0,colDefCloned.pinned=col.isPinned()?col.getPinned():null,colDefCloned.sort=col.getSort()?col.getSort():null,colDefCloned.sortIndex=null!=col.getSortIndex()?col.getSortIndex():null,colDefCloned}};ColumnDefFactory=__decorateClass([Bean("columnDefFactory")],ColumnDefFactory);var RowCssClassCalculator=class{getInitialRowClasses(params){const classes=[];return exists(params.extraCssClass)&&classes.push(params.extraCssClass),classes.push("ag-row"),classes.push(params.rowFocused?"ag-row-focus":"ag-row-no-focus"),params.fadeRowIn&&classes.push("ag-opacity-zero"),classes.push(params.rowIsEven?"ag-row-even":"ag-row-odd"),params.rowNode.isRowPinned()&&classes.push("ag-row-pinned"),params.rowNode.isSelected()&&classes.push("ag-row-selected"),params.rowNode.footer&&classes.push("ag-row-footer"),classes.push("ag-row-level-"+params.rowLevel),params.rowNode.stub&&classes.push("ag-row-loading"),params.fullWidthRow&&classes.push("ag-full-width-row"),params.expandable&&(classes.push("ag-row-group"),classes.push(params.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),params.rowNode.dragging&&classes.push("ag-row-dragging"),pushAll(classes,this.processClassesFromGridOptions(params.rowNode)),pushAll(classes,this.preProcessRowClassRules(params.rowNode)),classes.push(params.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),params.firstRowOnPage&&classes.push("ag-row-first"),params.lastRowOnPage&&classes.push("ag-row-last"),params.fullWidthRow&&("left"===params.pinned&&classes.push("ag-cell-last-left-pinned"),"right"===params.pinned&&classes.push("ag-cell-first-right-pinned")),classes}processClassesFromGridOptions(rowNode){const res=[],process=rowCls=>{"string"==typeof rowCls?res.push(rowCls):Array.isArray(rowCls)&&rowCls.forEach(e=>res.push(e))},rowClass=this.gos.get("rowClass");if(rowClass){if("function"==typeof rowClass)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];process(rowClass)}const rowClassFunc=this.gos.getCallback("getRowClass");if(rowClassFunc){process(rowClassFunc({data:rowNode.data,node:rowNode,rowIndex:rowNode.rowIndex}))}return res}preProcessRowClassRules(rowNode){const res=[];return this.processRowClassRules(rowNode,className=>{res.push(className)},className=>{}),res}processRowClassRules(rowNode,onApplicableClass,onNotApplicableClass){const rowClassParams=this.gos.addGridCommonParams({data:rowNode.data,node:rowNode,rowIndex:rowNode.rowIndex});this.stylingService.processClassRules(void 0,this.gos.get("rowClassRules"),rowClassParams,onApplicableClass,onNotApplicableClass)}calculateRowLevel(rowNode){return rowNode.group?rowNode.level:rowNode.parent?rowNode.parent.level+1:0}};__decorateClass([Autowired("stylingService")],RowCssClassCalculator.prototype,"stylingService",2),__decorateClass([Autowired("gridOptionsService")],RowCssClassCalculator.prototype,"gos",2),RowCssClassCalculator=__decorateClass([Bean("rowCssClassCalculator")],RowCssClassCalculator);var RowNodeSorter=class extends BeanStub{init(){this.isAccentedSort=this.gos.get("accentedSort"),this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup(),this.addManagedPropertyListener("accentedSort",propChange=>this.isAccentedSort=propChange.currentValue),this.addManagedPropertyListener("autoGroupColumnDef",()=>this.primaryColumnsSortGroups=this.gos.isColumnsSortingCoupledToGroup())}doFullSort(rowNodes,sortOptions){const sortedRowNodes=rowNodes.map((rowNode,pos)=>({currentPos:pos,rowNode}));return sortedRowNodes.sort(this.compareRowNodes.bind(this,sortOptions)),sortedRowNodes.map(item=>item.rowNode)}compareRowNodes(sortOptions,sortedNodeA,sortedNodeB){const nodeA=sortedNodeA.rowNode,nodeB=sortedNodeB.rowNode;for(let i=0,len=sortOptions.length;i<len;i++){const sortOption=sortOptions[i],isDescending="desc"===sortOption.sort,valueA=this.getValue(nodeA,sortOption.column),valueB=this.getValue(nodeB,sortOption.column);let comparatorResult;const providedComparator=this.getComparator(sortOption,nodeA);comparatorResult=providedComparator?providedComparator(valueA,valueB,nodeA,nodeB,isDescending):_.defaultComparator(valueA,valueB,this.isAccentedSort);if(!isNaN(comparatorResult)&&0!==comparatorResult)return"asc"===sortOption.sort?comparatorResult:-1*comparatorResult}return sortedNodeA.currentPos-sortedNodeB.currentPos}getComparator(sortOption,rowNode){const column=sortOption.column,comparatorOnCol=column.getColDef().comparator;if(null!=comparatorOnCol)return comparatorOnCol;if(!column.getColDef().showRowGroup)return;const groupLeafField=!rowNode.group&&column.getColDef().field;if(!groupLeafField)return;const primaryColumn=this.columnModel.getPrimaryColumn(groupLeafField);return primaryColumn?primaryColumn.getColDef().comparator:void 0}getValue(node,column){var _a,_b;if(!this.primaryColumnsSortGroups)return this.valueService.getValue(column,node,!1,!1);if(node.rowGroupColumn===column){if(this.gos.isGroupUseEntireRow(this.columnModel.isPivotActive())){const leafChild=null==(_a=node.allLeafChildren)?void 0:_a[0];return leafChild?this.valueService.getValue(column,leafChild,!1,!1):void 0}const displayCol=this.columnModel.getGroupDisplayColumnForGroup(column.getId());if(!displayCol)return;return null==(_b=node.groupData)?void 0:_b[displayCol.getId()]}return node.group&&column.getColDef().showRowGroup?void 0:this.valueService.getValue(column,node,!1,!1)}};__decorateClass([Autowired("valueService")],RowNodeSorter.prototype,"valueService",2),__decorateClass([Autowired("columnModel")],RowNodeSorter.prototype,"columnModel",2),__decorateClass([PostConstruct],RowNodeSorter.prototype,"init",1),RowNodeSorter=__decorateClass([Bean("rowNodeSorter")],RowNodeSorter);var CtrlsService=class extends BeanStub{constructor(){super(...arguments),this.params={},this.ready=!1,this.readyCallbacks=[]}checkReady(){const params=this.params;this.ready=null!=params.gridCtrl&&null!=params.gridBodyCtrl&&null!=params.center&&null!=params.left&&null!=params.right&&null!=params.bottomCenter&&null!=params.bottomLeft&&null!=params.bottomRight&&null!=params.topCenter&&null!=params.topLeft&&null!=params.topRight&&null!=params.stickyTopCenter&&null!=params.stickyTopLeft&&null!=params.stickyTopRight&&null!=params.stickyBottomCenter&&null!=params.stickyBottomLeft&&null!=params.stickyBottomRight&&null!=params.centerHeader&&null!=params.leftHeader&&null!=params.rightHeader&&null!=params.fakeHScrollComp&&null!=params.fakeVScrollComp&&null!=params.gridHeaderCtrl,this.ready&&(this.readyCallbacks.forEach(c=>c(params)),this.readyCallbacks.length=0)}whenReady(callback){this.ready?callback(this.params):this.readyCallbacks.push(callback)}register(ctrlType,ctrl){this.params[ctrlType]=ctrl,this.checkReady()}registerHeaderContainer(ctrl,pinned){switch(pinned){case"left":this.params.leftHeader=ctrl;break;case"right":this.params.rightHeader=ctrl;break;default:this.params.centerHeader=ctrl}this.checkReady()}get(ctrlType){return this.params[ctrlType]}getParams(){return this.params}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){return[this.params.leftHeader,this.params.rightHeader,this.params.centerHeader]}getHeaderRowContainerCtrl(pinned){switch(pinned){case"left":return this.params.leftHeader;case"right":return this.params.rightHeader;default:return this.params.centerHeader}}};CtrlsService.NAME="ctrlsService",CtrlsService=__decorateClass([Bean(CtrlsService.NAME)],CtrlsService);var CtrlsFactory=class extends BeanStub{constructor(){super(...arguments),this.registry={}}register(meta){this.registry[meta.controllerName]=meta.controllerClass}getInstance(name){const ControllerClass=this.registry[name];if(null!=ControllerClass)return new ControllerClass}};CtrlsFactory=__decorateClass([Bean("ctrlsFactory")],CtrlsFactory);var AbstractFakeScrollComp=class extends Component{constructor(template,direction){super(template),this.direction=direction,this.hideTimeout=null}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged(),this.addOrRemoveCssClass("ag-apple-scrollbar",isMacOsUserAgent()||isIOSUserAgent())}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.invisibleScrollbar=isInvisibleScrollbar(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const eGui=this.getGui();["mouseenter","mousedown","touchstart"].forEach(eventName=>this.addManagedListener(eGui,eventName,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!0))),["mouseleave","touchend"].forEach(eventName=>this.addManagedListener(eGui,eventName,()=>this.addOrRemoveCssClass("ag-scrollbar-active",!1)))}onScrollVisibilityChanged(){void 0===this.invisibleScrollbar&&this.initialiseInvisibleScrollbar(),this.animationFrameService.requestAnimationFrame(()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL,params=>{params.direction===this.direction&&(null!==this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=null),this.addOrRemoveCssClass("ag-scrollbar-scrolling",!0))}),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL_END,()=>{this.hideTimeout=window.setTimeout(()=>{this.addOrRemoveCssClass("ag-scrollbar-scrolling",!1),this.hideTimeout=null},400)})}attemptSettingScrollPosition(value){const viewport=this.getViewport();waitUntil(()=>isVisible(viewport),()=>this.setScrollPosition(value),100)}getViewport(){return this.eViewport}getContainer(){return this.eContainer}onScrollCallback(fn){this.addManagedListener(this.getViewport(),"scroll",fn)}};__decorateClass([RefSelector("eViewport")],AbstractFakeScrollComp.prototype,"eViewport",2),__decorateClass([RefSelector("eContainer")],AbstractFakeScrollComp.prototype,"eContainer",2),__decorateClass([Autowired("scrollVisibleService")],AbstractFakeScrollComp.prototype,"scrollVisibleService",2),__decorateClass([Autowired("ctrlsService")],AbstractFakeScrollComp.prototype,"ctrlsService",2),__decorateClass([Autowired("animationFrameService")],AbstractFakeScrollComp.prototype,"animationFrameService",2);var _FakeHScrollComp=class _FakeHScrollComp extends AbstractFakeScrollComp{constructor(){super(_FakeHScrollComp.TEMPLATE,"horizontal")}postConstruct(){super.postConstruct();const spacerWidthsListener=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,spacerWidthsListener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,spacerWidthsListener),this.addManagedListener(this.eventService,Events.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedPropertyListener("domLayout",spacerWidthsListener),this.ctrlsService.register("fakeHScrollComp",this),this.createManagedBean(new CenterWidthFeature(width=>this.eContainer.style.width=`${width}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}initialiseInvisibleScrollbar(){void 0===this.invisibleScrollbar&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}onPinnedRowDataChanged(){this.refreshCompBottom()}refreshCompBottom(){if(!this.invisibleScrollbar)return;const bottomPinnedHeight=this.pinnedRowModel.getPinnedBottomTotalHeight();this.getGui().style.bottom=`${bottomPinnedHeight}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const vScrollShowing=this.scrollVisibleService.isVerticalScrollShowing();let rightSpacing=this.columnModel.getDisplayedColumnsRightWidth();const scrollOnRight=!this.enableRtl&&vScrollShowing,scrollbarWidth=this.gos.getScrollbarWidth();scrollOnRight&&(rightSpacing+=scrollbarWidth),setFixedWidth(this.eRightSpacer,rightSpacing),this.eRightSpacer.classList.toggle("ag-scroller-corner",rightSpacing<=scrollbarWidth);let leftSpacing=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&vScrollShowing&&(leftSpacing+=scrollbarWidth),setFixedWidth(this.eLeftSpacer,leftSpacing),this.eLeftSpacer.classList.toggle("ag-scroller-corner",leftSpacing<=scrollbarWidth)}setScrollVisible(){const hScrollShowing=this.scrollVisibleService.isHorizontalScrollShowing(),invisibleScrollbar2=this.invisibleScrollbar,isSuppressHorizontalScroll=this.gos.get("suppressHorizontalScroll"),scrollbarWidth=hScrollShowing&&this.gos.getScrollbarWidth()||0,scrollContainerSize=isSuppressHorizontalScroll?0:0===scrollbarWidth&&invisibleScrollbar2?16:scrollbarWidth;this.addOrRemoveCssClass("ag-scrollbar-invisible",invisibleScrollbar2),setFixedHeight(this.getGui(),scrollContainerSize),setFixedHeight(this.eViewport,scrollContainerSize),setFixedHeight(this.eContainer,scrollContainerSize),this.setDisplayed(hScrollShowing,{skipAriaHidden:!0})}getScrollPosition(){return getScrollLeft(this.getViewport(),this.enableRtl)}setScrollPosition(value){isVisible(this.getViewport())||this.attemptSettingScrollPosition(value),setScrollLeft(this.getViewport(),value,this.enableRtl)}};_FakeHScrollComp.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',__decorateClass([RefSelector("eLeftSpacer")],_FakeHScrollComp.prototype,"eLeftSpacer",2),__decorateClass([RefSelector("eRightSpacer")],_FakeHScrollComp.prototype,"eRightSpacer",2),__decorateClass([Autowired("columnModel")],_FakeHScrollComp.prototype,"columnModel",2),__decorateClass([Autowired("pinnedRowModel")],_FakeHScrollComp.prototype,"pinnedRowModel",2),__decorateClass([PostConstruct],_FakeHScrollComp.prototype,"postConstruct",1);var FakeHScrollComp=_FakeHScrollComp,PinnedWidthService=class extends BeanStub{postConstruct(){const listener=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_CHANGED,listener),this.addManagedListener(this.eventService,Events.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,listener),this.addManagedPropertyListener("domLayout",listener)}checkContainerWidths(){const printLayout=this.gos.isDomLayout("print"),newLeftWidth=printLayout?0:this.columnModel.getDisplayedColumnsLeftWidth(),newRightWidth=printLayout?0:this.columnModel.getDisplayedColumnsRightWidth();newLeftWidth!=this.leftWidth&&(this.leftWidth=newLeftWidth,this.eventService.dispatchEvent({type:Events.EVENT_LEFT_PINNED_WIDTH_CHANGED})),newRightWidth!=this.rightWidth&&(this.rightWidth=newRightWidth,this.eventService.dispatchEvent({type:Events.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))}getPinnedRightWidth(){return this.rightWidth}getPinnedLeftWidth(){return this.leftWidth}};__decorateClass([Autowired("columnModel")],PinnedWidthService.prototype,"columnModel",2),__decorateClass([PostConstruct],PinnedWidthService.prototype,"postConstruct",1),PinnedWidthService=__decorateClass([Bean("pinnedWidthService")],PinnedWidthService);var RowNodeEventThrottle=class extends BeanStub{constructor(){super(...arguments),this.events=[]}postConstruct(){"clientSide"==this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel)}dispatchExpanded(event,forceSync){if(null==this.clientSideRowModel)return void this.eventService.dispatchEvent(event);this.events.push(event);const func=()=>{this.clientSideRowModel&&this.clientSideRowModel.onRowGroupOpened(),this.events.forEach(e=>this.eventService.dispatchEvent(e)),this.events=[]};forceSync?func():(null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(func)),this.dispatchExpandedDebounced())}};__decorateClass([Autowired("animationFrameService")],RowNodeEventThrottle.prototype,"animationFrameService",2),__decorateClass([Autowired("rowModel")],RowNodeEventThrottle.prototype,"rowModel",2),__decorateClass([PostConstruct],RowNodeEventThrottle.prototype,"postConstruct",1),RowNodeEventThrottle=__decorateClass([Bean("rowNodeEventThrottle")],RowNodeEventThrottle);var CSRM_REQUIRES_ROW_GROUP_MODULE=(_options,gridOptions)=>{var _a;return"clientSide"===(null!=(_a=gridOptions.rowModelType)?_a:"clientSide")?{module:"@ag-grid-enterprise/row-grouping"}:null},COLUMN_DEFINITION_VALIDATIONS={enableRowGroup:CSRM_REQUIRES_ROW_GROUP_MODULE,rowGroup:CSRM_REQUIRES_ROW_GROUP_MODULE,rowGroupIndex:CSRM_REQUIRES_ROW_GROUP_MODULE,enablePivot:CSRM_REQUIRES_ROW_GROUP_MODULE,enableValue:CSRM_REQUIRES_ROW_GROUP_MODULE,pivot:CSRM_REQUIRES_ROW_GROUP_MODULE,pivotIndex:CSRM_REQUIRES_ROW_GROUP_MODULE,aggFunc:CSRM_REQUIRES_ROW_GROUP_MODULE,cellEditor:options=>"agRichSelect"===options.cellEditor||"agRichSelectCellEditor"===options.cellEditor?{module:"@ag-grid-enterprise/rich-select"}:null,menuTabs:options=>{var _a;const enterpriseMenuTabs=["columnsMenuTab","generalMenuTab"];return(null==(_a=options.menuTabs)?void 0:_a.some(tab=>enterpriseMenuTabs.includes(tab)))?{module:"@ag-grid-enterprise/menu"}:null},columnsMenuParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},columnChooserParams:{module:["@ag-grid-enterprise/menu","@ag-grid-enterprise/column-tool-panel"]},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],dependencies:(_options,{rowSelection})=>"multiple"===rowSelection?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],dependencies:(_options,{rowSelection})=>"multiple"===rowSelection?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],dependencies:(_options,{rowSelection})=>"multiple"===rowSelection?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},children:()=>COL_DEF_VALIDATORS},COL_DEF_VALIDATORS={objectName:"colDef",allProperties:Object.keys({headerName:void 0,columnGroupShow:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnsMenuParams:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressCellFlash:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressMenu:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0}),docsUrl:"column-properties/",deprecations:{columnsMenuParams:{version:"31.1",message:"Use `columnChooserParams` instead."},suppressMenu:{version:"31.1",message:"Use `suppressHeaderMenuButton` instead."},suppressCellFlash:{version:"31.2",message:"Use `enableCellChangeFlash={false}` in the ColDef"},dndSource:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."},dndSourceOnRowDrag:{version:"31.2",message:"This feature has been replaced by `Row Dragging to an External DropZone`."}},validations:COLUMN_DEFINITION_VALIDATIONS},GRID_OPTION_DEFAULTS={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!1,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"\t",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,suppressChartToolPanelsButton:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressAsyncEvents:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,enableCellChangeFlash:!1,cellFlashDelay:500,cellFlashDuration:500,cellFadeDelay:1e3,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupIncludeTotalFooter:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,suppressServerSideInfiniteScroll:!1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSideSortOnServer:!1,serverSideFilterOnServer:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,suppressGroupMaintainValueType:!1,functionsPassive:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1},GRID_OPTION_VALIDATIONS={sideBar:{module:"@ag-grid-enterprise/side-bar"},statusBar:{module:"@ag-grid-enterprise/status-bar"},enableCharts:{module:"@ag-grid-enterprise/charts"},getMainMenuItems:{module:"@ag-grid-enterprise/menu"},getContextMenuItems:{module:"@ag-grid-enterprise/menu"},allowContextMenuWithControlKey:{module:"@ag-grid-enterprise/menu"},enableAdvancedFilter:{module:"@ag-grid-enterprise/advanced-filter"},treeData:{supportedRowModels:["clientSide","serverSide"],module:"@ag-grid-enterprise/row-grouping",dependencies:options=>{var _a;const rowModel=null!=(_a=options.rowModelType)?_a:"clientSide";switch(rowModel){case"clientSide":const csrmWarning=`treeData requires 'getDataPath' in the ${rowModel} row model.`;return options.getDataPath?null:csrmWarning;case"serverSide":const ssrmWarning=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${rowModel} row model.`;return options.isServerSideGroup&&options.getServerSideGroupKey?null:ssrmWarning}return null}},masterDetail:{module:"@ag-grid-enterprise/master-detail"},enableRangeSelection:{module:"@ag-grid-enterprise/range-selection"},enableRangeHandle:{dependencies:{enableRangeSelection:[!0]}},enableFillHandle:{dependencies:{enableRangeSelection:[!0]}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupIncludeFooter:{supportedRowModels:["clientSide","serverSide"],dependencies:options=>{var _a;switch(null!=(_a=options.rowModelType)?_a:"clientSide"){case"clientSide":return null;case"serverSide":const warning="groupIncludeFooter is not supported alongside suppressServerSideInfiniteScroll";return options.suppressServerSideInfiniteScroll?warning:null}return null}},groupIncludeTotalFooter:{supportedRowModels:["clientSide"]},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveLowestSingleChildren:[void 0,!1]}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:[void 0,!1],groupRemoveSingleChildren:[void 0,!1]}},groupSelectsChildren:{dependencies:{rowSelection:["multiple"]}},suppressParentsInRowNodes:{dependencies:{groupSelectsChildren:[void 0,!1]}},viewportDatasource:{supportedRowModels:["viewport"],module:"@ag-grid-enterprise/viewport-row-model"},serverSideDatasource:{supportedRowModels:["serverSide"],module:"@ag-grid-enterprise/server-side-row-model"},cacheBlockSize:{supportedRowModels:["serverSide","infinite"]},datasource:{supportedRowModels:["infinite"],module:"@ag-grid-community/infinite-row-model"},rowData:{supportedRowModels:["clientSide"],module:"@ag-grid-community/client-side-row-model"},columnDefs:()=>COL_DEF_VALIDATORS,defaultColDef:()=>COL_DEF_VALIDATORS,defaultColGroupDef:()=>COL_DEF_VALIDATORS,autoGroupColumnDef:()=>COL_DEF_VALIDATORS},GRID_OPTIONS_VALIDATORS={objectName:"gridOptions",allProperties:[...PropertyKeys.ALL_PROPERTIES,...ComponentUtil.EVENT_CALLBACKS],propertyExceptions:["api","columnApi"],docsUrl:"grid-options/",deprecations:{enableChartToolPanelsButton:{version:"29"},functionsPassive:{version:"29.2"},onColumnRowGroupChangeRequest:{version:"29.2"},onColumnPivotChangeRequest:{version:"29.2"},onColumnValueChangeRequest:{version:"29.2"},onColumnAggFuncChangeRequest:{version:"29.2"},serverSideFilterAllLevels:{version:"30",message:"All server-side group levels are now filtered by default. This can be toggled using `serverSideOnlyRefreshFilteredGroups`."},suppressAggAtRootLevel:{version:"30",message:"The root level aggregation is now suppressed by default. This can be toggled using  `alwaysAggregateAtRootLevel`."},excludeHiddenColumnsFromQuickFilter:{version:"30",message:"Hidden columns are now excluded from the Quick Filter by default. This can be toggled using `includeHiddenColumnsInQuickFilter`."},enterMovesDown:{version:"30",renamed:"enterNavigatesVertically"},enterMovesDownAfterEdit:{version:"30",renamed:"enterNavigatesVerticallyAfterEdit"},suppressParentsInRowNodes:{version:"30.2",message:"Using suppressParentsInRowNodes is no longer recommended. To serialize nodes it is now recommended to instead remove the parent node reference before serialization."},advancedFilterModel:{version:"31",message:"Use `initialState.filter.advancedFilterModel` instead."},suppressAsyncEvents:{version:"31",message:"Events should be handled asynchronously."},cellFadeDelay:{version:"31.1",renamed:"cellFadeDuration"},cellFlashDelay:{version:"31.1",renamed:"cellFlashDuration"},suppressServerSideInfiniteScroll:{version:"31.1"},serverSideSortOnServer:{version:"31.1"},serverSideFilterOnServer:{version:"31.1"},enableCellChangeFlash:{version:"31.2",message:"Use `enableCellChangeFlash` in the `ColDef` or `defaultColDef` for all columns."},groupIncludeFooter:{version:"31.3",message:"Use `groupTotalRow` instead."},groupIncludeTotalFooter:{version:"31.3",message:"Use `grandTotalRow` instead."}},validations:GRID_OPTION_VALIDATIONS},GridOptionsService=class{constructor(){this.destroyed=!1,this.domDataKey="__AG_"+Math.random().toString(),this.propertyEventService=new EventService,this.globalEventHandlerFactory=restrictToSyncOnly=>(eventName,event)=>{if(this.destroyed)return;const alwaysSync=ALWAYS_SYNC_GLOBAL_EVENTS.has(eventName);if(alwaysSync&&!restrictToSyncOnly||!alwaysSync&&restrictToSyncOnly)return;const eventHandlerName=ComponentUtil.getCallbackForEvent(eventName),eventHandler=this.gridOptions[eventHandlerName];"function"==typeof eventHandler&&this.frameworkOverrides.wrapOutgoing(()=>{eventHandler(event)})}}get context(){return this.gridOptions.context}init(){this.columnApi=new ColumnApi(this.api);const async=!this.get("suppressAsyncEvents");this.eventService.addGlobalListener(this.globalEventHandlerFactory().bind(this),async),this.eventService.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propertyEventService.setFrameworkOverrides(this.frameworkOverrides),this.getScrollbarWidth()}destroy(){this.destroyed=!0,this.columnApi=void 0}get(property){var _a;return null!=(_a=this.gridOptions[property])?_a:GRID_OPTION_DEFAULTS[property]}getCallback(property){return this.mergeGridCommonParams(this.gridOptions[property])}exists(property){return exists(this.gridOptions[property])}mergeGridCommonParams(callback){if(callback){return callbackParams=>{const mergedParams=callbackParams;return mergedParams.api=this.api,mergedParams.columnApi=this.columnApi,mergedParams.context=this.context,callback(mergedParams)}}return callback}static toBoolean(value){return"boolean"==typeof value?value:"string"==typeof value&&("TRUE"===value.toUpperCase()||""==value)}static toNumber(value){if("number"==typeof value)return value;if("string"==typeof value){const parsed=parseInt(value);if(isNaN(parsed))return;return parsed}}static toConstrainedNum(min,max){return value=>{const num=GridOptionsService.toNumber(value);if(!(null==num||num<min||num>max))return num}}static getCoercedValue(key,value){const coerceFunc=GridOptionsService.PROPERTY_COERCIONS.get(key);return coerceFunc?coerceFunc(value):value}static getCoercedGridOptions(gridOptions){const newGo={};return Object.entries(gridOptions).forEach(([key,value])=>{const coercedValue=GridOptionsService.getCoercedValue(key,value);newGo[key]=coercedValue}),newGo}updateGridOptions({options,force,source="api"}){const changeSet={id:GridOptionsService.changeSetId++,properties:[]},events=[];Object.entries(options).forEach(([key,value])=>{"api"===source&&INITIAL_GRID_OPTION_KEYS[key]&&warnOnce(`${key} is an initial property and cannot be updated.`);const coercedValue=GridOptionsService.getCoercedValue(key,value),shouldForce=force||"object"==typeof coercedValue&&"api"===source,previousValue=this.gridOptions[key];if(shouldForce||previousValue!==coercedValue){this.gridOptions[key]=coercedValue;const event={type:key,currentValue:coercedValue,previousValue,changeSet,source};events.push(event)}}),this.validationService.processGridOptions(this.gridOptions),changeSet.properties=events.map(event=>event.type),events.forEach(event=>{this.gridOptions.debug&&console.log(`AG Grid: Updated property ${event.type} from `,event.previousValue," to  ",event.currentValue),this.propertyEventService.dispatchEvent(event)})}addEventListener(key,listener){this.propertyEventService.addEventListener(key,listener)}removeEventListener(key,listener){this.propertyEventService.removeEventListener(key,listener)}getScrollbarWidth(){if(null==this.scrollbarWidth){const scrollbarWidth="number"==typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:getScrollbarWidth();null!=scrollbarWidth&&(this.scrollbarWidth=scrollbarWidth,this.eventService.dispatchEvent({type:Events.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth}isRowModelType(rowModelType){return this.gridOptions.rowModelType===rowModelType||"clientSide"===rowModelType&&missing(this.gridOptions.rowModelType)}isDomLayout(domLayout){var _a;return(null!=(_a=this.gridOptions.domLayout)?_a:"normal")===domLayout}isRowSelection(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection}useAsyncEvents(){return!this.get("suppressAsyncEvents")}isGetRowHeightFunction(){return"function"==typeof this.gridOptions.getRowHeight}getRowHeightForNode(rowNode,allowEstimate=!1,defaultRowHeight){if(null==defaultRowHeight&&(defaultRowHeight=this.environment.getDefaultRowHeight()),this.isGetRowHeightFunction()){if(allowEstimate)return{height:defaultRowHeight,estimated:!0};const params={node:rowNode,data:rowNode.data},height=this.getCallback("getRowHeight")(params);if(this.isNumeric(height))return 0===height&&warnOnce("The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead."),{height:Math.max(1,height),estimated:!1}}if(rowNode.detail&&this.get("masterDetail"))return this.getMasterDetailRowHeight();return{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:defaultRowHeight,estimated:!1}}getMasterDetailRowHeight(){return this.get("detailRowAutoHeight")?{height:1,estimated:!1}:this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}}getRowHeightAsNumber(){if(!this.gridOptions.rowHeight||missing(this.gridOptions.rowHeight))return this.environment.getDefaultRowHeight();const rowHeight=this.environment.refreshRowHeightVariable();return-1!==rowHeight?rowHeight:(console.warn("AG Grid row height must be a number if not using standard row model"),this.environment.getDefaultRowHeight())}isNumeric(value){return!isNaN(value)&&"number"==typeof value&&isFinite(value)}getDomDataKey(){return this.domDataKey}getDomData(element,key){const domData=element[this.getDomDataKey()];return domData?domData[key]:void 0}setDomData(element,key,value){const domDataKey=this.getDomDataKey();let domData=element[domDataKey];missing(domData)&&(domData={},element[domDataKey]=domData),domData[key]=value}getDocument(){let result=null;return this.gridOptions.getDocument&&exists(this.gridOptions.getDocument)?result=this.gridOptions.getDocument():this.eGridDiv&&(result=this.eGridDiv.ownerDocument),result&&exists(result)?result:document}getWindow(){return this.getDocument().defaultView||window}getRootNode(){return this.eGridDiv.getRootNode()}getActiveDomElement(){return this.getRootNode().activeElement}getAsyncTransactionWaitMillis(){return exists(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:50}isAnimateRows(){return!this.get("ensureDomOrder")&&this.get("animateRows")}isGroupRowsSticky(){return!(this.get("paginateChildRows")||this.get("groupHideOpenParents")||this.isDomLayout("print"))}isColumnsSortingCoupledToGroup(){const autoGroupColumnDef=this.gridOptions.autoGroupColumnDef;return!(null==autoGroupColumnDef?void 0:autoGroupColumnDef.comparator)&&!this.get("treeData")}getGroupAggFiltering(){const userValue=this.gridOptions.groupAggFiltering;return"function"==typeof userValue?this.getCallback("groupAggFiltering"):!0===userValue?()=>!0:void 0}getGrandTotalRow(){const userValue=this.gridOptions.grandTotalRow;if(userValue)return userValue;return this.gridOptions.groupIncludeTotalFooter?"bottom":void 0}getGroupTotalRowCallback(){const userValue=this.get("groupTotalRow");if("function"==typeof userValue)return this.getCallback("groupTotalRow");if(userValue)return()=>userValue;const legacyValue=this.get("groupIncludeFooter");if("function"==typeof legacyValue){const legacyCallback=this.getCallback("groupIncludeFooter");return p=>legacyCallback(p)?"bottom":void 0}return()=>legacyValue?"bottom":void 0}isGroupMultiAutoColumn(){return this.gridOptions.groupDisplayType?"multipleColumns"===this.gridOptions.groupDisplayType:this.get("groupHideOpenParents")}isGroupUseEntireRow(pivotMode){return!pivotMode&&"groupRows"===this.gridOptions.groupDisplayType}getGridCommonParams(){return{api:this.api,columnApi:this.columnApi,context:this.context}}addGridCommonParams(params){const updatedParams=params;return updatedParams.api=this.api,updatedParams.columnApi=this.columnApi,updatedParams.context=this.context,updatedParams}};GridOptionsService.PROPERTY_COERCIONS=new Map([...PropertyKeys.BOOLEAN_PROPERTIES.map(key=>[key,GridOptionsService.toBoolean]),...PropertyKeys.NUMBER_PROPERTIES.map(key=>[key,GridOptionsService.toNumber]),["groupAggFiltering",val=>"function"==typeof val?val:GridOptionsService.toBoolean(val)],["pageSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["autoSizePadding",GridOptionsService.toConstrainedNum(0,Number.MAX_VALUE)],["keepDetailRowsCount",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["rowBuffer",GridOptionsService.toConstrainedNum(0,Number.MAX_VALUE)],["infiniteInitialRowCount",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["cacheOverflowSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["cacheBlockSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["serverSideInitialRowCount",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelPageSize",GridOptionsService.toConstrainedNum(1,Number.MAX_VALUE)],["viewportRowModelBufferSize",GridOptionsService.toConstrainedNum(0,Number.MAX_VALUE)]]),GridOptionsService.changeSetId=0,__decorateClass([Autowired("gridOptions")],GridOptionsService.prototype,"gridOptions",2),__decorateClass([Autowired("eventService")],GridOptionsService.prototype,"eventService",2),__decorateClass([Autowired("environment")],GridOptionsService.prototype,"environment",2),__decorateClass([Autowired("frameworkOverrides")],GridOptionsService.prototype,"frameworkOverrides",2),__decorateClass([Autowired("eGridDiv")],GridOptionsService.prototype,"eGridDiv",2),__decorateClass([Autowired("validationService")],GridOptionsService.prototype,"validationService",2),__decorateClass([Autowired("gridApi")],GridOptionsService.prototype,"api",2),__decorateClass([PostConstruct],GridOptionsService.prototype,"init",1),__decorateClass([PreDestroy],GridOptionsService.prototype,"destroy",1),GridOptionsService=__decorateClass([Bean("gridOptionsService")],GridOptionsService);var LocaleService=class extends BeanStub{getLocaleTextFunc(){const getLocaleText=this.gos.getCallback("getLocaleText");if(getLocaleText)return(key,defaultValue,variableValues)=>getLocaleText({key,defaultValue,variableValues});const localeText=this.gos.get("localeText");return(key,defaultValue,variableValues)=>{let localisedText=localeText&&localeText[key];if(localisedText&&variableValues&&variableValues.length){let found=0;for(;!(found>=variableValues.length);){if(-1===localisedText.indexOf("${variable}"))break;localisedText=localisedText.replace("${variable}",variableValues[found++])}}return null!=localisedText?localisedText:defaultValue}}};LocaleService=__decorateClass([Bean("localeService")],LocaleService);var _FakeVScrollComp=class _FakeVScrollComp extends AbstractFakeScrollComp{constructor(){super(_FakeVScrollComp.TEMPLATE,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new SetHeightFeature(this.eContainer)),this.ctrlsService.register("fakeVScrollComp",this),this.addManagedListener(this.eventService,Events.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onRowContainerHeightChanged.bind(this))}setScrollVisible(){const vScrollShowing=this.scrollVisibleService.isVerticalScrollShowing(),invisibleScrollbar2=this.invisibleScrollbar,scrollbarWidth=vScrollShowing&&this.gos.getScrollbarWidth()||0,adjustedScrollbarWidth=0===scrollbarWidth&&invisibleScrollbar2?16:scrollbarWidth;this.addOrRemoveCssClass("ag-scrollbar-invisible",invisibleScrollbar2),setFixedWidth(this.getGui(),adjustedScrollbarWidth),setFixedWidth(this.eViewport,adjustedScrollbarWidth),setFixedWidth(this.eContainer,adjustedScrollbarWidth),this.setDisplayed(vScrollShowing,{skipAriaHidden:!0})}onRowContainerHeightChanged(){const{ctrlsService}=this,gridBodyViewportEl=ctrlsService.getGridBodyCtrl().getBodyViewportElement(),eViewportScrollTop=this.getScrollPosition(),gridBodyViewportScrollTop=gridBodyViewportEl.scrollTop;eViewportScrollTop!=gridBodyViewportScrollTop&&this.setScrollPosition(gridBodyViewportScrollTop,!0)}getScrollPosition(){return this.getViewport().scrollTop}setScrollPosition(value,force){force||isVisible(this.getViewport())||this.attemptSettingScrollPosition(value),this.getViewport().scrollTop=value}};_FakeVScrollComp.TEMPLATE='<div class="ag-body-vertical-scroll" aria-hidden="true">\n            <div class="ag-body-vertical-scroll-viewport" ref="eViewport">\n                <div class="ag-body-vertical-scroll-container" ref="eContainer"></div>\n            </div>\n        </div>',__decorateClass([PostConstruct],_FakeVScrollComp.prototype,"postConstruct",1);var FakeVScrollComp=_FakeVScrollComp,MONTH_LOCALE_TEXT={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},MONTH_KEYS=["january","february","march","april","may","june","july","august","september","october","november","december"],DataTypeService=class extends BeanStub{constructor(){super(...arguments),this.dataTypeDefinitions={},this.isWaitingForRowData=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[]}init(){this.groupHideOpenParents=this.gos.get("groupHideOpenParents"),this.addManagedPropertyListener("groupHideOpenParents",()=>{this.groupHideOpenParents=this.gos.get("groupHideOpenParents")}),this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",event=>{this.processDataTypeDefinitions(),this.columnModel.recreateColumnDefs(convertSourceType(event.source))})}processDataTypeDefinitions(){var _a;const defaultDataTypes=this.getDefaultDataTypes();this.dataTypeDefinitions={},Object.entries(defaultDataTypes).forEach(([cellDataType,dataTypeDefinition])=>{this.dataTypeDefinitions[cellDataType]=__spreadProps(__spreadValues({},dataTypeDefinition),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(dataTypeDefinition)})});const dataTypeDefinitions=null!=(_a=this.gos.get("dataTypeDefinitions"))?_a:{};this.dataTypeMatchers={},Object.entries(dataTypeDefinitions).forEach(([cellDataType,dataTypeDefinition])=>{const mergedDataTypeDefinition=this.processDataTypeDefinition(dataTypeDefinition,dataTypeDefinitions,[cellDataType],defaultDataTypes);mergedDataTypeDefinition&&(this.dataTypeDefinitions[cellDataType]=mergedDataTypeDefinition,dataTypeDefinition.dataTypeMatcher&&(this.dataTypeMatchers[cellDataType]=dataTypeDefinition.dataTypeMatcher))}),this.checkObjectValueHandlers(defaultDataTypes),["dateString","text","number","boolean","date"].forEach(cellDataType=>{const overriddenDataTypeMatcher=this.dataTypeMatchers[cellDataType];overriddenDataTypeMatcher&&delete this.dataTypeMatchers[cellDataType],this.dataTypeMatchers[cellDataType]=null!=overriddenDataTypeMatcher?overriddenDataTypeMatcher:defaultDataTypes[cellDataType].dataTypeMatcher})}mergeDataTypeDefinitions(parentDataTypeDefinition,childDataTypeDefinition){const mergedDataTypeDefinition=__spreadValues(__spreadValues({},parentDataTypeDefinition),childDataTypeDefinition);return parentDataTypeDefinition.columnTypes&&childDataTypeDefinition.columnTypes&&childDataTypeDefinition.appendColumnTypes&&(mergedDataTypeDefinition.columnTypes=[...this.convertColumnTypes(parentDataTypeDefinition.columnTypes),...this.convertColumnTypes(childDataTypeDefinition.columnTypes)]),mergedDataTypeDefinition}processDataTypeDefinition(dataTypeDefinition,dataTypeDefinitions,alreadyProcessedDataTypes,defaultDataTypes){let mergedDataTypeDefinition;const extendsCellDataType=dataTypeDefinition.extendsDataType;if(dataTypeDefinition.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),dataTypeDefinition.extendsDataType===dataTypeDefinition.baseDataType){let baseDataTypeDefinition=defaultDataTypes[extendsCellDataType];const overriddenBaseDataTypeDefinition=dataTypeDefinitions[extendsCellDataType];if(baseDataTypeDefinition&&overriddenBaseDataTypeDefinition&&(baseDataTypeDefinition=overriddenBaseDataTypeDefinition),!this.validateDataTypeDefinition(dataTypeDefinition,baseDataTypeDefinition,extendsCellDataType))return;mergedDataTypeDefinition=this.mergeDataTypeDefinitions(baseDataTypeDefinition,dataTypeDefinition)}else{if(alreadyProcessedDataTypes.includes(extendsCellDataType))return void warnOnce('Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.');const extendedDataTypeDefinition=dataTypeDefinitions[extendsCellDataType];if(!this.validateDataTypeDefinition(dataTypeDefinition,extendedDataTypeDefinition,extendsCellDataType))return;const mergedExtendedDataTypeDefinition=this.processDataTypeDefinition(extendedDataTypeDefinition,dataTypeDefinitions,[...alreadyProcessedDataTypes,extendsCellDataType],defaultDataTypes);if(!mergedExtendedDataTypeDefinition)return;mergedDataTypeDefinition=this.mergeDataTypeDefinitions(mergedExtendedDataTypeDefinition,dataTypeDefinition)}return __spreadProps(__spreadValues({},mergedDataTypeDefinition),{groupSafeValueFormatter:this.createGroupSafeValueFormatter(mergedDataTypeDefinition)})}validateDataTypeDefinition(dataTypeDefinition,parentDataTypeDefinition,parentCellDataType){return parentDataTypeDefinition?parentDataTypeDefinition.baseDataType===dataTypeDefinition.baseDataType||(warnOnce('The "baseDataType" property of a data type definition must match that of its parent.'),!1):(warnOnce(`The data type definition ${parentCellDataType} does not exist.`),!1)}createGroupSafeValueFormatter(dataTypeDefinition){if(dataTypeDefinition.valueFormatter)return params=>{var _a,_b;if(null==(_a=params.node)?void 0:_a.group){const aggFunc=params.column.getAggFunc();if(aggFunc){if("first"===aggFunc||"last"===aggFunc)return dataTypeDefinition.valueFormatter(params);if("number"===dataTypeDefinition.baseDataType&&"count"!==aggFunc){if("number"==typeof params.value)return dataTypeDefinition.valueFormatter(params);if("object"==typeof params.value){if(!params.value)return;if("toNumber"in params.value)return dataTypeDefinition.valueFormatter(__spreadProps(__spreadValues({},params),{value:params.value.toNumber()}));if("value"in params.value)return dataTypeDefinition.valueFormatter(__spreadProps(__spreadValues({},params),{value:params.value.value}))}}}if(!this.gos.get("suppressGroupMaintainValueType"))return}else if(this.groupHideOpenParents&&params.column.isRowGroupActive()){if("string"!=typeof params.value||(null==(_b=dataTypeDefinition.dataTypeMatcher)?void 0:_b.call(dataTypeDefinition,params.value)))return dataTypeDefinition.valueFormatter(params);if(!this.gos.get("suppressGroupMaintainValueType"))return}return dataTypeDefinition.valueFormatter(params)}}updateColDefAndGetDataTypeDefinitionColumnType(colDef,userColDef,colId){let{cellDataType}=userColDef;const{field}=userColDef;if(void 0===cellDataType&&(cellDataType=colDef.cellDataType),null!=cellDataType&&!0!==cellDataType||(cellDataType=!!this.canInferCellDataType(colDef,userColDef)&&this.inferCellDataType(field,colId)),!cellDataType)return void(colDef.cellDataType=!1);const dataTypeDefinition=this.dataTypeDefinitions[cellDataType];if(dataTypeDefinition)return colDef.cellDataType=cellDataType,dataTypeDefinition.groupSafeValueFormatter&&(colDef.valueFormatter=dataTypeDefinition.groupSafeValueFormatter),dataTypeDefinition.valueParser&&(colDef.valueParser=dataTypeDefinition.valueParser),dataTypeDefinition.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(colDef,dataTypeDefinition,colId),dataTypeDefinition.columnTypes;warnOnce(`Missing data type definition - "${cellDataType}"`)}updateColDefAndGetColumnType(colDef,userColDef,colId){var _a,_b;const dataTypeDefinitionColumnType=this.updateColDefAndGetDataTypeDefinitionColumnType(colDef,userColDef,colId),columnTypes=null!=(_b=null!=(_a=userColDef.type)?_a:dataTypeDefinitionColumnType)?_b:colDef.type;return colDef.type=columnTypes,columnTypes?this.convertColumnTypes(columnTypes):void 0}addColumnListeners(column){if(!this.isWaitingForRowData)return;const columnStateUpdates=this.columnStateUpdatesPendingInference[column.getColId()];if(!columnStateUpdates)return;const columnListener=event=>{columnStateUpdates.add(event.key)};column.addEventListener(Column.EVENT_STATE_UPDATED,columnListener),this.columnStateUpdateListenerDestroyFuncs.push(()=>column.removeEventListener(Column.EVENT_STATE_UPDATED,columnListener))}canInferCellDataType(colDef,userColDef){var _a;if("clientSide"!==this.rowModel.getType())return!1;const propsToCheckForInference={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(this.doColDefPropsPreventInference(userColDef,propsToCheckForInference))return!1;const columnTypes=null===userColDef.type?colDef.type:userColDef.type;if(columnTypes){const columnTypeDefs=null!=(_a=this.gos.get("columnTypes"))?_a:{};if(this.convertColumnTypes(columnTypes).some(columnType=>{const columnTypeDef=columnTypeDefs[columnType.trim()];return columnTypeDef&&this.doColDefPropsPreventInference(columnTypeDef,propsToCheckForInference)}))return!1}return!this.doColDefPropsPreventInference(colDef,propsToCheckForInference)}doColDefPropsPreventInference(colDef,propsToCheckForInference){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([prop,comparisonValue])=>this.doesColDefPropPreventInference(colDef,propsToCheckForInference,prop,comparisonValue))}doesColDefPropPreventInference(colDef,checkProps,prop,comparisonValue){if(!checkProps[prop])return!1;const value=colDef[prop];return null===value?(checkProps[prop]=!1,!1):void 0===comparisonValue?!!value:value===comparisonValue}inferCellDataType(field,colId){var _a;if(!field)return;let value;const initialData=this.getInitialData();if(initialData){const fieldContainsDots=field.indexOf(".")>=0&&!this.gos.get("suppressFieldDotNotation");value=getValueUsingField(initialData,field,fieldContainsDots)}else this.initWaitForRowData(colId);if(null==value)return;const[cellDataType]=null!=(_a=Object.entries(this.dataTypeMatchers).find(([_cellDataType,dataTypeMatcher])=>dataTypeMatcher(value)))?_a:["object"];return cellDataType}getInitialData(){const rowData=this.gos.get("rowData");if(null==rowData?void 0:rowData.length)return rowData[0];if(this.initialData)return this.initialData;{const rowNodes=this.rowModel.getRootNode().allLeafChildren;if(null==rowNodes?void 0:rowNodes.length)return rowNodes[0].data}return null}initWaitForRowData(colId){if(this.columnStateUpdatesPendingInference[colId]=new Set,this.isWaitingForRowData)return;this.isWaitingForRowData=!0;const columnTypeOverridesExist=this.isColumnTypeOverrideInDataTypeDefinitions;columnTypeOverridesExist&&this.columnModel.queueResizeOperations();const destroyFunc=this.addManagedListener(this.eventService,Events.EVENT_ROW_DATA_UPDATE_STARTED,event=>{const{firstRowData}=event;if(!firstRowData)return;null==destroyFunc||destroyFunc(),this.isWaitingForRowData=!1,this.processColumnsPendingInference(firstRowData,columnTypeOverridesExist),this.columnStateUpdatesPendingInference={},columnTypeOverridesExist&&this.columnModel.processResizeOperations();const dataTypesInferredEvent={type:Events.EVENT_DATA_TYPES_INFERRED};this.eventService.dispatchEvent(dataTypesInferredEvent)})}isPendingInference(){return this.isWaitingForRowData}processColumnsPendingInference(firstRowData,columnTypeOverridesExist){this.initialData=firstRowData;const state=[];this.columnStateUpdateListenerDestroyFuncs.forEach(destroyFunc=>destroyFunc()),this.columnStateUpdateListenerDestroyFuncs=[];const newRowGroupColumnStateWithoutIndex={},newPivotColumnStateWithoutIndex={};Object.entries(this.columnStateUpdatesPendingInference).forEach(([colId,columnStateUpdates])=>{const column=this.columnModel.getGridColumn(colId);if(!column)return;const oldColDef=column.getColDef();if(!this.columnModel.resetColumnDefIntoColumn(column,"cellDataTypeInferred"))return;const newColDef=column.getColDef();if(columnTypeOverridesExist&&newColDef.type&&newColDef.type!==oldColDef.type){const updatedColumnState=this.getUpdatedColumnState(column,columnStateUpdates);updatedColumnState.rowGroup&&null==updatedColumnState.rowGroupIndex&&(newRowGroupColumnStateWithoutIndex[colId]=updatedColumnState),updatedColumnState.pivot&&null==updatedColumnState.pivotIndex&&(newPivotColumnStateWithoutIndex[colId]=updatedColumnState),state.push(updatedColumnState)}}),columnTypeOverridesExist&&state.push(...this.columnModel.generateColumnStateForRowGroupAndPivotIndexes(newRowGroupColumnStateWithoutIndex,newPivotColumnStateWithoutIndex)),state.length&&this.columnModel.applyColumnState({state},"cellDataTypeInferred"),this.initialData=null}getUpdatedColumnState(column,columnStateUpdates){const columnState=this.columnModel.getColumnStateFromColDef(column);return columnStateUpdates.forEach(key=>{delete columnState[key],"rowGroup"===key?delete columnState.rowGroupIndex:"pivot"===key&&delete columnState.pivotIndex}),columnState}checkObjectValueHandlers(defaultDataTypes){const resolvedObjectDataTypeDefinition=this.dataTypeDefinitions.object,defaultObjectDataTypeDefinition=defaultDataTypes.object;this.hasObjectValueParser=resolvedObjectDataTypeDefinition.valueParser!==defaultObjectDataTypeDefinition.valueParser,this.hasObjectValueFormatter=resolvedObjectDataTypeDefinition.valueFormatter!==defaultObjectDataTypeDefinition.valueFormatter}convertColumnTypes(type){let typeKeys=[];if(type instanceof Array){type.some(a=>"string"!=typeof a)?console.warn("if colDef.type is supplied an array it should be of type 'string[]'"):typeKeys=type}else"string"==typeof type?typeKeys=type.split(","):console.warn("colDef.type should be of type 'string' | 'string[]'");return typeKeys}getDateStringTypeDefinition(column){var _a;return column&&null!=(_a=this.getDataTypeDefinition(column))?_a:this.dataTypeDefinitions.dateString}getDateParserFunction(column){return this.getDateStringTypeDefinition(column).dateParser}getDateFormatterFunction(column){return this.getDateStringTypeDefinition(column).dateFormatter}getDataTypeDefinition(column){const colDef=column.getColDef();if(colDef.cellDataType)return this.dataTypeDefinitions[colDef.cellDataType]}getBaseDataType(column){var _a;return null==(_a=this.getDataTypeDefinition(column))?void 0:_a.baseDataType}checkType(column,value){var _a;if(null==value)return!0;const dataTypeMatcher=null==(_a=this.getDataTypeDefinition(column))?void 0:_a.dataTypeMatcher;return!dataTypeMatcher||dataTypeMatcher(value)}validateColDef(colDef){"object"===colDef.cellDataType&&(colDef.valueFormatter!==this.dataTypeDefinitions.object.groupSafeValueFormatter||this.hasObjectValueFormatter||warnOnce('Cell data type is "object" but no value formatter has been provided. Please either provide an object data type definition with a value formatter, or set "colDef.valueFormatter"'),colDef.editable&&colDef.valueParser===this.dataTypeDefinitions.object.valueParser&&!this.hasObjectValueParser&&warnOnce('Cell data type is "object" but no value parser has been provided. Please either provide an object data type definition with a value parser, or set "colDef.valueParser"'))}setColDefPropertiesForBaseDataType(colDef,dataTypeDefinition,colId){const formatValue=(column,node,value)=>{let valueFormatter=column.getColDef().valueFormatter;return valueFormatter===dataTypeDefinition.groupSafeValueFormatter&&(valueFormatter=dataTypeDefinition.valueFormatter),this.valueService.formatValue(column,node,value,valueFormatter)},usingSetFilter=ModuleRegistry.__isRegistered("@ag-grid-enterprise/set-filter",this.context.getGridId()),translate=this.localeService.getLocaleTextFunc(),mergeFilterParams=params=>{const{filterParams}=colDef;colDef.filterParams="object"==typeof filterParams?__spreadValues(__spreadValues({},filterParams),params):params};switch(dataTypeDefinition.baseDataType){case"number":colDef.cellEditor="agNumberCellEditor",usingSetFilter&&mergeFilterParams({comparator:(a,b)=>{const valA=null==a?0:parseInt(a),valB=null==b?0:parseInt(b);return valA===valB?0:valA>valB?1:-1}});break;case"boolean":colDef.cellEditor="agCheckboxCellEditor",colDef.cellRenderer="agCheckboxCellRenderer",colDef.suppressKeyboardEvent=params=>!!params.colDef.editable&&params.event.key===KeyCode.SPACE,mergeFilterParams(usingSetFilter?{valueFormatter:params=>exists(params.value)?translate(String(params.value),params.value?"True":"False"):translate("blanks","(Blanks)")}:{maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(_filterValues,cellValue)=>cellValue,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(_filterValues,cellValue)=>!1===cellValue,numberOfInputs:0}]});break;case"date":colDef.cellEditor="agDateCellEditor",colDef.keyCreator=params=>formatValue(params.column,params.node,params.value),usingSetFilter&&mergeFilterParams({valueFormatter:params=>{const valueFormatted=formatValue(params.column,params.node,params.value);return exists(valueFormatted)?valueFormatted:translate("blanks","(Blanks)")},treeList:!0,treeListFormatter:(pathKey,level)=>{if(1===level&&null!=pathKey){const monthKey=MONTH_KEYS[Number(pathKey)-1];return translate(monthKey,MONTH_LOCALE_TEXT[monthKey])}return null!=pathKey?pathKey:translate("blanks","(Blanks)")}});break;case"dateString":{colDef.cellEditor="agDateStringCellEditor",colDef.keyCreator=params=>formatValue(params.column,params.node,params.value);const convertToDate=dataTypeDefinition.dateParser;mergeFilterParams(usingSetFilter?{valueFormatter:params=>{const valueFormatted=formatValue(params.column,params.node,params.value);return exists(valueFormatted)?valueFormatted:translate("blanks","(Blanks)")},treeList:!0,treeListPathGetter:value=>{const date=convertToDate(null!=value?value:void 0);return date?[String(date.getFullYear()),String(date.getMonth()+1),String(date.getDate())]:null},treeListFormatter:(pathKey,level)=>{if(1===level&&null!=pathKey){const monthKey=MONTH_KEYS[Number(pathKey)-1];return translate(monthKey,MONTH_LOCALE_TEXT[monthKey])}return null!=pathKey?pathKey:translate("blanks","(Blanks)")}}:{comparator:(filterDate,cellValue)=>{const cellAsDate=convertToDate(cellValue);return null==cellValue||cellAsDate<filterDate?-1:cellAsDate>filterDate?1:0}});break}case"object":colDef.cellEditorParams={useFormatter:!0},colDef.comparator=(a,b)=>{const column=this.columnModel.getPrimaryColumn(colId),colDef2=null==column?void 0:column.getColDef();if(!column||!colDef2)return 0;const valA=null==a?"":formatValue(column,null,a),valB=null==b?"":formatValue(column,null,b);return valA===valB?0:valA>valB?1:-1},colDef.keyCreator=params=>formatValue(params.column,params.node,params.value),usingSetFilter?mergeFilterParams({valueFormatter:params=>{const valueFormatted=formatValue(params.column,params.node,params.value);return exists(valueFormatted)?valueFormatted:translate("blanks","(Blanks)")}}):colDef.filterValueGetter=params=>formatValue(params.column,params.node,this.valueService.getValue(params.column,params.node))}}getDefaultDataTypes(){const defaultDateFormatMatcher=value=>!!value.match("^\\d{4}-\\d{2}-\\d{2}$"),translate=this.localeService.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:params=>{var _a,_b;return""===(null==(_b=null==(_a=params.newValue)?void 0:_a.trim)?void 0:_b.call(_a))?null:Number(params.newValue)},valueFormatter:params=>null==params.value?"":"number"!=typeof params.value||isNaN(params.value)?translate("invalidNumber","Invalid Number"):String(params.value),dataTypeMatcher:value=>"number"==typeof value},text:{baseDataType:"text",valueParser:params=>""===params.newValue?null:toStringOrNull(params.newValue),dataTypeMatcher:value=>"string"==typeof value},boolean:{baseDataType:"boolean",valueParser:params=>{var _a,_b;return null==params.newValue?params.newValue:""===(null==(_b=null==(_a=params.newValue)?void 0:_a.trim)?void 0:_b.call(_a))?null:"true"===String(params.newValue).toLowerCase()},valueFormatter:params=>null==params.value?"":String(params.value),dataTypeMatcher:value=>"boolean"==typeof value},date:{baseDataType:"date",valueParser:params=>parseDateTimeFromString(null==params.newValue?null:String(params.newValue)),valueFormatter:params=>{var _a;return null==params.value?"":params.value instanceof Date&&!isNaN(params.value.getTime())?null!=(_a=serialiseDate(params.value,!1))?_a:"":translate("invalidDate","Invalid Date")},dataTypeMatcher:value=>value instanceof Date},dateString:{baseDataType:"dateString",dateParser:value=>{var _a;return null!=(_a=parseDateTimeFromString(value))?_a:void 0},dateFormatter:value=>{var _a;return null!=(_a=serialiseDate(null!=value?value:null,!1))?_a:void 0},valueParser:params=>defaultDateFormatMatcher(String(params.newValue))?params.newValue:null,valueFormatter:params=>defaultDateFormatMatcher(String(params.value))?params.value:"",dataTypeMatcher:value=>"string"==typeof value&&defaultDateFormatMatcher(value)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:params=>{var _a;return null!=(_a=toStringOrNull(params.value))?_a:""}}}}};__decorateClass([Autowired("rowModel")],DataTypeService.prototype,"rowModel",2),__decorateClass([Autowired("columnModel")],DataTypeService.prototype,"columnModel",2),__decorateClass([Autowired("valueService")],DataTypeService.prototype,"valueService",2),__decorateClass([PostConstruct],DataTypeService.prototype,"init",1),DataTypeService=__decorateClass([Bean("dataTypeService")],DataTypeService);var SyncService=class extends BeanStub{constructor(){super(...arguments),this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",event=>this.setColumnDefs(event))}start(){this.ctrlsService.whenReady(()=>{const columnDefs=this.gos.get("columnDefs");columnDefs?this.setColumnsAndData(columnDefs):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(columnDefs){this.columnModel.setColumnDefs(null!=columnDefs?columnDefs:[],"gridInitializing"),this.rowModel.start()}gridReady(){this.dispatchGridReadyEvent();const isEnterprise=ModuleRegistry.__isRegistered("@ag-grid-enterprise/core",this.context.getGridId());new Logger("AG Grid",()=>this.gos.get("debug")).log(`initialised successfully, enterprise = ${isEnterprise}`)}dispatchGridReadyEvent(){const readyEvent={type:Events.EVENT_GRID_READY};this.eventService.dispatchEvent(readyEvent)}setColumnDefs(event){const columnDefs=this.gos.get("columnDefs");if(columnDefs)return this.waitingForColumns?(this.waitingForColumns=!1,void this.setColumnsAndData(columnDefs)):void this.columnModel.setColumnDefs(columnDefs,convertSourceType(event.source))}};__decorateClass([Autowired("ctrlsService")],SyncService.prototype,"ctrlsService",2),__decorateClass([Autowired("columnModel")],SyncService.prototype,"columnModel",2),__decorateClass([Autowired("rowModel")],SyncService.prototype,"rowModel",2),__decorateClass([PostConstruct],SyncService.prototype,"postConstruct",1),SyncService=__decorateClass([Bean("syncService")],SyncService);var OverlayService=class extends BeanStub{constructor(){super(...arguments),this.manuallyDisplayed=!1}postConstruct(){this.addManagedListener(this.eventService,Events.EVENT_ROW_DATA_UPDATED,()=>this.onRowDataUpdated()),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.onNewColumnsLoaded())}registerOverlayWrapperComp(overlayWrapperComp){this.overlayWrapperComp=overlayWrapperComp,(!this.gos.get("columnDefs")||this.gos.isRowModelType("clientSide")&&!this.gos.get("rowData"))&&this.showLoadingOverlay()}showLoadingOverlay(){if(this.gos.get("suppressLoadingOverlay"))return;const compDetails=this.userComponentFactory.getLoadingOverlayCompDetails({});this.showOverlay(compDetails,"ag-overlay-loading-wrapper","loadingOverlayComponentParams")}showNoRowsOverlay(){if(this.gos.get("suppressNoRowsOverlay"))return;const compDetails=this.userComponentFactory.getNoRowsOverlayCompDetails({});this.showOverlay(compDetails,"ag-overlay-no-rows-wrapper","noRowsOverlayComponentParams")}showOverlay(compDetails,wrapperCssClass,gridOption){const promise=compDetails.newAgStackInstance(),listenerDestroyFunc=this.addManagedPropertyListener(gridOption,({currentValue})=>{promise.then(comp=>{comp.refresh&&comp.refresh(this.gos.addGridCommonParams(__spreadValues({},null!=currentValue?currentValue:{})))})});this.manuallyDisplayed=this.columnModel.isReady()&&!this.paginationProxy.isEmpty(),this.overlayWrapperComp.showOverlay(promise,wrapperCssClass,listenerDestroyFunc)}hideOverlay(){this.manuallyDisplayed=!1,this.overlayWrapperComp.hideOverlay()}showOrHideOverlay(){const isEmpty=this.paginationProxy.isEmpty(),isSuppressNoRowsOverlay=this.gos.get("suppressNoRowsOverlay");isEmpty&&!isSuppressNoRowsOverlay?this.showNoRowsOverlay():this.hideOverlay()}onRowDataUpdated(){this.showOrHideOverlay()}onNewColumnsLoaded(){!this.columnModel.isReady()||this.paginationProxy.isEmpty()||this.manuallyDisplayed||this.hideOverlay()}};__decorateClass([Autowired("userComponentFactory")],OverlayService.prototype,"userComponentFactory",2),__decorateClass([Autowired("paginationProxy")],OverlayService.prototype,"paginationProxy",2),__decorateClass([Autowired("columnModel")],OverlayService.prototype,"columnModel",2),__decorateClass([PostConstruct],OverlayService.prototype,"postConstruct",1),OverlayService=__decorateClass([Bean("overlayService")],OverlayService);var StateService=class extends BeanStub{constructor(){super(...arguments),this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=debounce(()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=debounce(()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),0),this.onRowSelectedDebounced=debounce(()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){var _a;this.isClientSideRowModel="clientSide"===this.rowModel.getType(),this.cachedState=null!=(_a=this.gos.get("initialState"))?_a:{},this.ctrlsService.whenReady(()=>this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnGridReady()));const newColumnsLoadedDestroyFunc=this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,({source})=>{"gridInitializing"===source&&(null==newColumnsLoadedDestroyFunc||newColumnsLoadedDestroyFunc(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnColumnsInitialised()))}),rowCountReadyDestroyFunc=this.addManagedListener(this.eventService,Events.EVENT_ROW_COUNT_READY,()=>{null==rowCountReadyDestroyFunc||rowCountReadyDestroyFunc(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnRowCountReady())}),firstDataRenderedDestroyFunc=this.addManagedListener(this.eventService,Events.EVENT_FIRST_DATA_RENDERED,()=>{null==firstDataRenderedDestroyFunc||firstDataRenderedDestroyFunc(),this.suppressEventsAndDispatchInitEvent(()=>this.setupStateOnFirstDataRendered())})}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setupStateOnGridReady(){this.updateCachedState("sideBar",this.getSideBarState()),this.addManagedListener(this.eventService,Events.EVENT_TOOL_PANEL_VISIBLE_CHANGED,()=>this.updateCachedState("sideBar",this.getSideBarState())),this.addManagedListener(this.eventService,Events.EVENT_SIDE_BAR_UPDATED,()=>this.updateCachedState("sideBar",this.getSideBarState()))}setupStateOnColumnsInitialised(){var _a;const initialState=null!=(_a=this.gos.get("initialState"))?_a:{};this.setColumnState(initialState),this.setColumnGroupState(initialState),this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState()),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,()=>this.updateColumnState(["aggregation"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_MOVED,()=>this.updateColumnState(["columnOrder"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PINNED,()=>this.updateColumnState(["columnPinning"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_RESIZED,()=>this.updateColumnState(["columnSizing"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VISIBLE,()=>this.updateColumnState(["columnVisibility"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,()=>this.updateColumnState(["pivot"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,()=>this.updateColumnState(["rowGroup"])),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,()=>this.updateColumnState(["sort"])),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,()=>this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","pivot","rowGroup","sort"])),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_GROUP_OPENED,()=>this.updateCachedState("columnGroup",this.getColumnGroupState()))}setupStateOnRowCountReady(){var _a;const{filter:filterState,rowGroupExpansion:rowGroupExpansionState,rowSelection:rowSelectionState,pagination:paginationState}=null!=(_a=this.gos.get("initialState"))?_a:{},advancedFilterModel=this.gos.get("advancedFilterModel");(filterState||advancedFilterModel)&&this.setFilterState(filterState,advancedFilterModel),rowGroupExpansionState&&this.setRowGroupExpansionState(rowGroupExpansionState),rowSelectionState&&this.setRowSelectionState(rowSelectionState),paginationState&&this.setPaginationState(paginationState),this.updateCachedState("filter",this.getFilterState()),this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowSelection",this.getRowSelectionState()),this.updateCachedState("pagination",this.getPaginationState()),this.addManagedListener(this.eventService,Events.EVENT_FILTER_CHANGED,()=>this.updateCachedState("filter",this.getFilterState())),this.addManagedListener(this.eventService,Events.EVENT_ROW_GROUP_OPENED,()=>this.onRowGroupOpenedDebounced()),this.addManagedListener(this.eventService,Events.EVENT_EXPAND_COLLAPSE_ALL,()=>this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState())),this.addManagedListener(this.eventService,Events.EVENT_SELECTION_CHANGED,()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()}),this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,event=>{(event.newPage||event.newPageSize)&&this.updateCachedState("pagination",this.getPaginationState())})}setupStateOnFirstDataRendered(){var _a;const{scroll:scrollState,rangeSelection:rangeSelectionState,focusedCell:focusedCellState,columnOrder:columnOrderState}=null!=(_a=this.gos.get("initialState"))?_a:{};focusedCellState&&this.setFocusedCellState(focusedCellState),rangeSelectionState&&this.setRangeSelectionState(rangeSelectionState),scrollState&&this.setScrollState(scrollState),this.setColumnPivotState(!!(null==columnOrderState?void 0:columnOrderState.orderedColIds)),this.updateCachedState("sideBar",this.getSideBarState()),this.updateCachedState("focusedCell",this.getFocusedCellState()),this.updateCachedState("rangeSelection",this.getRangeSelectionState()),this.updateCachedState("scroll",this.getScrollState()),this.addManagedListener(this.eventService,Events.EVENT_CELL_FOCUSED,()=>this.updateCachedState("focusedCell",this.getFocusedCellState())),this.addManagedListener(this.eventService,Events.EVENT_RANGE_SELECTION_CHANGED,event=>{event.finished&&this.updateCachedState("rangeSelection",this.getRangeSelectionState())}),this.addManagedListener(this.eventService,Events.EVENT_BODY_SCROLL_END,()=>this.updateCachedState("scroll",this.getScrollState()))}getColumnState(){const pivotMode=this.columnModel.isPivotMode(),sortColumns=[],groupColIds=[],aggregationColumns=[],pivotColIds=[],leftColIds=[],rightColIds=[],hiddenColIds=[],columnSizes=[],columns=[],columnState=this.columnModel.getColumnState();for(let i=0;i<columnState.length;i++){const{colId,sort,sortIndex,rowGroup,rowGroupIndex,aggFunc,pivot,pivotIndex,pinned,hide,width,flex}=columnState[i];columns.push(colId),sort&&(sortColumns[null!=sortIndex?sortIndex:0]={colId,sort}),rowGroup&&(groupColIds[null!=rowGroupIndex?rowGroupIndex:0]=colId),"string"==typeof aggFunc&&aggregationColumns.push({colId,aggFunc}),pivot&&(pivotColIds[null!=pivotIndex?pivotIndex:0]=colId),pinned&&("right"===pinned?rightColIds:leftColIds).push(colId),hide&&hiddenColIds.push(colId),(flex||width)&&columnSizes.push({colId,flex:null!=flex?flex:void 0,width})}return{sort:sortColumns.length?{sortModel:sortColumns}:void 0,rowGroup:groupColIds.length?{groupColIds}:void 0,aggregation:aggregationColumns.length?{aggregationModel:aggregationColumns}:void 0,pivot:pivotColIds.length||pivotMode?{pivotMode,pivotColIds}:void 0,columnPinning:leftColIds.length||rightColIds.length?{leftColIds,rightColIds}:void 0,columnVisibility:hiddenColIds.length?{hiddenColIds}:void 0,columnSizing:columnSizes.length?{columnSizingModel:columnSizes}:void 0,columnOrder:columns.length?{orderedColIds:columns}:void 0}}setColumnState(initialState){const{sort:sortState,rowGroup:groupState,aggregation:aggregationState,pivot:pivotState,columnPinning:columnPinningState,columnVisibility:columnVisibilityState,columnSizing:columnSizingState,columnOrder:columnOrderState}=initialState,columnStateMap={},getColumnState=colId=>{let columnState=columnStateMap[colId];return columnState||(columnState={colId},columnStateMap[colId]=columnState,columnState)};sortState&&sortState.sortModel.forEach(({colId,sort},sortIndex)=>{const columnState=getColumnState(colId);columnState.sort=sort,columnState.sortIndex=sortIndex}),groupState&&groupState.groupColIds.forEach((colId,rowGroupIndex)=>{const columnState=getColumnState(colId);columnState.rowGroup=!0,columnState.rowGroupIndex=rowGroupIndex}),aggregationState&&aggregationState.aggregationModel.forEach(({colId,aggFunc})=>{getColumnState(colId).aggFunc=aggFunc}),pivotState&&(pivotState.pivotColIds.forEach((colId,pivotIndex)=>{const columnState=getColumnState(colId);columnState.pivot=!0,columnState.pivotIndex=pivotIndex}),this.gos.updateGridOptions({options:{pivotMode:pivotState.pivotMode},source:"gridInitializing"})),columnPinningState&&(columnPinningState.leftColIds.forEach(colId=>{getColumnState(colId).pinned="left"}),columnPinningState.rightColIds.forEach(colId=>{getColumnState(colId).pinned="right"})),columnVisibilityState&&columnVisibilityState.hiddenColIds.forEach(colId=>{getColumnState(colId).hide=!0}),columnSizingState&&columnSizingState.columnSizingModel.forEach(({colId,flex,width})=>{const columnState=getColumnState(colId);columnState.flex=null!=flex?flex:null,columnState.width=width});const columns=null==columnOrderState?void 0:columnOrderState.orderedColIds,applyOrder=!!(null==columns?void 0:columns.length),columnStates=applyOrder?columns.map(colId=>getColumnState(colId)):Object.values(columnStateMap);if(columnStates.length){this.columnStates=columnStates;const defaultState={sort:null,sortIndex:null,rowGroup:null,rowGroupIndex:null,aggFunc:null,pivot:null,pivotIndex:null,pinned:null,hide:null,flex:null};this.columnModel.applyColumnState({state:columnStates,applyOrder,defaultState},"gridInitializing")}}setColumnPivotState(applyOrder){const columnStates=this.columnStates;this.columnStates=void 0;const columnGroupStates=this.columnGroupStates;if(this.columnGroupStates=void 0,this.columnModel.isSecondaryColumnsPresent()){if(columnStates){let secondaryColumnStates=[];for(const columnState of columnStates)this.columnModel.getSecondaryColumn(columnState.colId)&&secondaryColumnStates.push(columnState);this.columnModel.applyColumnState({state:secondaryColumnStates,applyOrder},"gridInitializing")}columnGroupStates&&this.columnModel.setColumnGroupState(columnGroupStates,"gridInitializing")}}getColumnGroupState(){const columnGroupState=this.columnModel.getColumnGroupState(),openColumnGroups=[];return columnGroupState.forEach(({groupId,open})=>{open&&openColumnGroups.push(groupId)}),openColumnGroups.length?{openColumnGroupIds:openColumnGroups}:void 0}setColumnGroupState(initialState){var _a;if(!initialState.hasOwnProperty("columnGroup"))return;const openColumnGroups=new Set(null==(_a=initialState.columnGroup)?void 0:_a.openColumnGroupIds),stateItems=this.columnModel.getColumnGroupState().map(({groupId})=>{const open=openColumnGroups.has(groupId);return open&&openColumnGroups.delete(groupId),{groupId,open}});openColumnGroups.forEach(groupId=>{stateItems.push({groupId,open:!0})}),stateItems.length&&(this.columnGroupStates=stateItems),this.columnModel.setColumnGroupState(stateItems,"gridInitializing")}getFilterState(){var _a;let filterModel=this.filterManager.getFilterModel();filterModel&&0===Object.keys(filterModel).length&&(filterModel=void 0);const advancedFilterModel=null!=(_a=this.filterManager.getAdvancedFilterModel())?_a:void 0;return filterModel||advancedFilterModel?{filterModel,advancedFilterModel}:void 0}setFilterState(filterState,gridOptionAdvancedFilterModel){const{filterModel,advancedFilterModel}=null!=filterState?filterState:{advancedFilterModel:gridOptionAdvancedFilterModel};filterModel&&this.filterManager.setFilterModel(filterModel,"columnFilter"),advancedFilterModel&&this.filterManager.setAdvancedFilterModel(advancedFilterModel)}getRangeSelectionState(){var _a;const cellRanges=null==(_a=this.rangeService)?void 0:_a.getCellRanges().map(cellRange=>{const{id,type,startRow,endRow,columns,startColumn}=cellRange;return{id,type,startRow,endRow,colIds:columns.map(column=>column.getColId()),startColId:startColumn.getColId()}});return(null==cellRanges?void 0:cellRanges.length)?{cellRanges}:void 0}setRangeSelectionState(rangeSelectionState){if(!this.gos.get("enableRangeSelection")||!this.rangeService)return;const cellRanges=[];rangeSelectionState.cellRanges.forEach(cellRange=>{const columns=[];if(cellRange.colIds.forEach(colId=>{const column=this.columnModel.getGridColumn(colId);column&&columns.push(column)}),!columns.length)return;let startColumn=this.columnModel.getGridColumn(cellRange.startColId);if(!startColumn){const allColumns=this.columnModel.getAllDisplayedColumns(),columnSet=new Set(columns);startColumn=allColumns.find(column=>columnSet.has(column))}cellRanges.push(__spreadProps(__spreadValues({},cellRange),{columns,startColumn}))}),this.rangeService.setCellRanges(cellRanges)}getScrollState(){var _a,_b,_c;if(!this.isClientSideRowModel)return;const scrollFeature=null==(_a=this.ctrlsService.getGridBodyCtrl())?void 0:_a.getScrollFeature(),{left}=null!=(_b=null==scrollFeature?void 0:scrollFeature.getHScrollPosition())?_b:{left:0},{top}=null!=(_c=null==scrollFeature?void 0:scrollFeature.getVScrollPosition())?_c:{top:0};return top||left?{top,left}:void 0}setScrollState(scrollState){var _a;if(!this.isClientSideRowModel)return;const{top,left}=scrollState;null==(_a=this.ctrlsService.getGridBodyCtrl())||_a.getScrollFeature().setScrollPosition(top,left)}getSideBarState(){var _a,_b;return null==(_b=null==(_a=this.sideBarService)?void 0:_a.getSideBarComp())?void 0:_b.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const focusedCell=this.focusService.getFocusedCell();if(focusedCell){const{column,rowIndex,rowPinned}=focusedCell;return{colId:column.getColId(),rowIndex,rowPinned}}}setFocusedCellState(focusedCellState){if(!this.isClientSideRowModel)return;const{colId,rowIndex,rowPinned}=focusedCellState;this.focusService.setFocusedCell({column:this.columnModel.getGridColumn(colId),rowIndex,rowPinned,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const page=this.paginationProxy.getCurrentPage(),pageSize=this.gos.get("paginationAutoPageSize")?void 0:this.paginationProxy.getPageSize();if(page||pageSize)return{page,pageSize}}setPaginationState(paginationState){paginationState.pageSize&&!this.gos.get("paginationAutoPageSize")&&this.paginationProxy.setPageSize(paginationState.pageSize,"initialState"),"number"==typeof paginationState.page&&this.paginationProxy.setPage(paginationState.page)}getRowSelectionState(){var _a;const selectionState=this.selectionService.getSelectionState();return!selectionState||!Array.isArray(selectionState)&&(!1===selectionState.selectAll||!1===selectionState.selectAllChildren)&&!(null==(_a=null==selectionState?void 0:selectionState.toggledNodes)?void 0:_a.length)?void 0:selectionState}setRowSelectionState(rowSelectionState){this.selectionService.setSelectionState(rowSelectionState,"gridInitializing")}getRowGroupExpansionState(){const expandedRowGroups=this.expansionService.getExpandedRows();return expandedRowGroups.length?{expandedRowGroupIds:expandedRowGroups}:void 0}setRowGroupExpansionState(rowGroupExpansionState){this.expansionService.expandRows(rowGroupExpansionState.expandedRowGroupIds)}updateColumnState(features){const newColumnState=this.getColumnState();let hasChanged=!1;Object.entries(newColumnState).forEach(([key,value])=>{jsonEquals(value,this.cachedState[key])||(hasChanged=!0)}),this.cachedState=__spreadValues(__spreadValues({},this.cachedState),newColumnState),hasChanged&&this.dispatchStateUpdateEvent(features)}updateCachedState(key,value){const existingValue=this.cachedState[key];this.setCachedStateValue(key,value),jsonEquals(value,existingValue)||this.dispatchStateUpdateEvent([key])}setCachedStateValue(key,value){this.cachedState=__spreadProps(__spreadValues({},this.cachedState),{[key]:value})}refreshStaleState(){this.staleStateKeys.forEach(key=>{if("rowSelection"===key)this.setCachedStateValue(key,this.getRowSelectionState())}),this.staleStateKeys.clear()}dispatchStateUpdateEvent(sources){this.suppressEvents||(sources.forEach(source=>this.queuedUpdateSources.add(source)),this.dispatchStateUpdateEventDebounced())}dispatchQueuedStateUpdateEvents(){const sources=Array.from(this.queuedUpdateSources);this.queuedUpdateSources.clear();const event={type:Events.EVENT_STATE_UPDATED,sources,state:this.cachedState};this.eventService.dispatchEvent(event)}suppressEventsAndDispatchInitEvent(updateFunc){this.suppressEvents=!0,this.columnAnimationService.setSuppressAnimation(!0),updateFunc(),setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.columnAnimationService.setSuppressAnimation(!1),this.dispatchStateUpdateEvent(["gridInitializing"]))})}};__decorateClass([Autowired("filterManager")],StateService.prototype,"filterManager",2),__decorateClass([Autowired("ctrlsService")],StateService.prototype,"ctrlsService",2),__decorateClass([Autowired("focusService")],StateService.prototype,"focusService",2),__decorateClass([Autowired("columnModel")],StateService.prototype,"columnModel",2),__decorateClass([Autowired("paginationProxy")],StateService.prototype,"paginationProxy",2),__decorateClass([Autowired("rowModel")],StateService.prototype,"rowModel",2),__decorateClass([Autowired("selectionService")],StateService.prototype,"selectionService",2),__decorateClass([Autowired("expansionService")],StateService.prototype,"expansionService",2),__decorateClass([Autowired("columnAnimationService")],StateService.prototype,"columnAnimationService",2),__decorateClass([Optional("sideBarService")],StateService.prototype,"sideBarService",2),__decorateClass([Optional("rangeService")],StateService.prototype,"rangeService",2),__decorateClass([PostConstruct],StateService.prototype,"postConstruct",1),StateService=__decorateClass([Bean("stateService")],StateService);var ValidationService=class extends BeanStub{init(){this.processGridOptions(this.gridOptions)}processGridOptions(options){this.processOptions(options,GRID_OPTIONS_VALIDATORS)}processColumnDefs(options){this.processOptions(options,COL_DEF_VALIDATORS)}processOptions(options,validator){const{validations,deprecations,allProperties,propertyExceptions,objectName,docsUrl}=validator;allProperties&&!0!==this.gridOptions.suppressPropertyNamesCheck&&this.checkProperties(options,[...null!=propertyExceptions?propertyExceptions:[],...Object.keys(deprecations)],allProperties,objectName,docsUrl);const warnings=new Set;Object.keys(options).forEach(key=>{var _a;const deprecation=deprecations[key];if(deprecation)if("renamed"in deprecation){const{renamed,version}=deprecation;warnings.add(`As of v${version}, ${String(key)} is deprecated. Please use ${String(renamed)} instead.`),options[renamed]=options[key]}else{const{message,version}=deprecation;warnings.add(`As of v${version}, ${String(key)} is deprecated. ${null!=message?message:""}`)}const value=options[key];if(null==value||!1===value)return;const rulesOrGetter=validations[key];let rules;if(!rulesOrGetter)return;if("function"==typeof rulesOrGetter){const fromGetter=rulesOrGetter(options,this.gridOptions);if(!fromGetter)return;if("objectName"in fromGetter){const value2=options[key];return Array.isArray(value2)?void value2.forEach(item=>{this.processOptions(item,fromGetter)}):void this.processOptions(options[key],fromGetter)}rules=fromGetter}else rules=rulesOrGetter;const{module,dependencies,supportedRowModels}=rules;if(supportedRowModels){const rowModel=null!=(_a=this.gridOptions.rowModelType)?_a:"clientSide";if(!supportedRowModels.includes(rowModel))return void warnings.add(`${String(key)} is not supported with the '${rowModel}' row model.`)}if(module){const modules=Array.isArray(module)?module:[module];let allRegistered=!0;if(modules.forEach(m=>{ModuleRegistry.__assertRegistered(m,String(key),this.context.getGridId())||(allRegistered=!1,warnings.add(`${String(key)} is only available when ${m} is loaded.`))}),!allRegistered)return}if(dependencies){const warning=this.checkForWarning(key,dependencies,options);if(warning)return void warnings.add(warning)}}),warnings.size>0&&warnings.forEach(warning=>{warnOnce(warning)})}checkForWarning(key,validator,options){if("function"==typeof validator)return validator(options,this.gridOptions);const failed=Object.entries(validator).find(([key2,value])=>{const gridOptionValue=options[key2];return!value.includes(gridOptionValue)});if(!failed)return null;const[failedKey,possibleOptions]=failed;return possibleOptions.length>1?`'${String(key)}' requires '${failedKey}' to be one of [${possibleOptions.join(", ")}].`:`'${String(key)}' requires '${failedKey}' to be ${possibleOptions[0]}.`}checkProperties(object,exceptions,validProperties,containerName,docsUrl){const invalidProperties=fuzzyCheckStrings(Object.getOwnPropertyNames(object),["__ob__","__v_skip","__metadata__",...exceptions,...validProperties],validProperties);if(iterateObject(invalidProperties,(key,value)=>{warnOnce(`invalid ${containerName} property '${key}' did you mean any of these: ${value.slice(0,8).join(", ")}`)}),Object.keys(invalidProperties).length>0&&docsUrl){const url=this.getFrameworkOverrides().getDocLink(docsUrl);warnOnce(`to see all the valid ${containerName} properties please check: ${url}`)}}};__decorateClass([Autowired("gridOptions")],ValidationService.prototype,"gridOptions",2),__decorateClass([PostConstruct],ValidationService.prototype,"init",1),ValidationService=__decorateClass([Bean("validationService")],ValidationService);var ApiEventService=class extends BeanStub{constructor(){super(...arguments),this.syncEventListeners=new Map,this.asyncEventListeners=new Map,this.syncGlobalEventListeners=new Set,this.globalEventListenerPairs=new Map}postConstruct(){this.frameworkEventWrappingService=new FrameworkEventListenerService(this.getFrameworkOverrides())}addEventListener(eventType,userListener){const listener=this.frameworkEventWrappingService.wrap(userListener),async=this.gos.useAsyncEvents()&&!ALWAYS_SYNC_GLOBAL_EVENTS.has(eventType),listeners=async?this.asyncEventListeners:this.syncEventListeners;listeners.has(eventType)||listeners.set(eventType,new Set),listeners.get(eventType).add(listener),this.eventService.addEventListener(eventType,listener,async)}removeEventListener(eventType,userListener){var _a;const listener=this.frameworkEventWrappingService.unwrap(userListener),asyncListeners=this.asyncEventListeners.get(eventType),hasAsync=!!(null==asyncListeners?void 0:asyncListeners.delete(listener));hasAsync||null==(_a=this.syncEventListeners.get(eventType))||_a.delete(listener),this.eventService.removeEventListener(eventType,listener,hasAsync)}addGlobalListener(userListener){const listener=this.frameworkEventWrappingService.wrapGlobal(userListener);if(this.gos.useAsyncEvents()){const syncListener=(eventType,event)=>{ALWAYS_SYNC_GLOBAL_EVENTS.has(eventType)&&listener(eventType,event)},asyncListener=(eventType,event)=>{ALWAYS_SYNC_GLOBAL_EVENTS.has(eventType)||listener(eventType,event)};this.globalEventListenerPairs.set(userListener,{syncListener,asyncListener}),this.eventService.addGlobalListener(syncListener,!1),this.eventService.addGlobalListener(asyncListener,!0)}else this.syncGlobalEventListeners.add(listener),this.eventService.addGlobalListener(listener,!1)}removeGlobalListener(userListener){const listener=this.frameworkEventWrappingService.unwrapGlobal(userListener);if(this.globalEventListenerPairs.has(listener)){const{syncListener,asyncListener}=this.globalEventListenerPairs.get(listener);this.eventService.removeGlobalListener(syncListener,!1),this.eventService.removeGlobalListener(asyncListener,!0),this.globalEventListenerPairs.delete(userListener)}else this.syncGlobalEventListeners.delete(listener),this.eventService.removeGlobalListener(listener,!1)}destroyEventListeners(map,async){map.forEach((listeners,eventType)=>{listeners.forEach(listener=>this.eventService.removeEventListener(eventType,listener,async)),listeners.clear()}),map.clear()}destroyGlobalListeners(set,async){set.forEach(listener=>this.eventService.removeGlobalListener(listener,async)),set.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncEventListeners,!1),this.destroyEventListeners(this.asyncEventListeners,!0),this.destroyGlobalListeners(this.syncGlobalEventListeners,!1),this.globalEventListenerPairs.forEach(({syncListener,asyncListener})=>{this.eventService.removeGlobalListener(syncListener,!1),this.eventService.removeGlobalListener(asyncListener,!0)}),this.globalEventListenerPairs.clear()}};__decorateClass([PostConstruct],ApiEventService.prototype,"postConstruct",1),ApiEventService=__decorateClass([Bean("apiEventService")],ApiEventService);var PageSizeSelectorComp=class extends Component{constructor(){super('<span class="ag-paging-page-size"></span>'),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const newValue=this.selectPageSizeComp.getValue();if(!newValue)return;const paginationPageSize=Number(newValue);isNaN(paginationPageSize)||paginationPageSize<1||paginationPageSize===this.paginationProxy.getPageSize()||(this.paginationProxy.setPageSize(paginationPageSize,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}init(){this.addManagedPropertyListener("paginationPageSizeSelector",()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedListener(this.eventService,Events.EVENT_PAGINATION_CHANGED,event=>this.handlePaginationChanged(event))}handlePaginationChanged(paginationChangedEvent){if(!this.selectPageSizeComp||!(null==paginationChangedEvent?void 0:paginationChangedEvent.newPageSize))return;const paginationPageSize=this.paginationProxy.getPageSize();this.getPageSizeSelectorValues().includes(paginationPageSize)?this.selectPageSizeComp.setValue(paginationPageSize.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(show){this.selectPageSizeComp&&this.reset(),show&&(this.reloadPageSizesSelector(),this.selectPageSizeComp&&this.appendChild(this.selectPageSizeComp))}reset(){clearElement(this.getGui()),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0)}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&!1!==this.gos.get("paginationPageSizeSelector")}reloadPageSizesSelector(){const pageSizeOptions=this.getPageSizeSelectorValues(),paginationPageSizeOption=this.paginationProxy.getPageSize(),shouldAddAndSelectEmptyOption=!paginationPageSizeOption||!pageSizeOptions.includes(paginationPageSizeOption);shouldAddAndSelectEmptyOption&&(pageSizeOptions.unshift(""),warnOnce("The paginationPageSize grid option is set to a value that is not in the list of page size options.\n                Please make sure that the paginationPageSize grid option is set to one of the values in the \n                paginationPageSizeSelector array, or set the paginationPageSizeSelector to false to hide the page size selector.")),this.selectPageSizeComp&&(this.destroyBean(this.selectPageSizeComp),this.selectPageSizeComp=void 0);const localeTextFunc=this.localeService.getLocaleTextFunc(),localisedLabel=localeTextFunc("pageSizeSelectorLabel","Page Size:"),options=pageSizeOptions.map(value=>({value:String(value),text:String(value)})),localisedAriaLabel=localeTextFunc("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new AgSelect).addOptions(options).setValue(String(shouldAddAndSelectEmptyOption?"":paginationPageSizeOption)).setAriaLabel(localisedAriaLabel).setLabel(localisedLabel).onValueChange(()=>this.handlePageSizeItemSelected()),this.hasEmptyOption=shouldAddAndSelectEmptyOption}getPageSizeSelectorValues(){const defaultValues=[20,50,100],paginationPageSizeSelectorValues=this.gos.get("paginationPageSizeSelector");return Array.isArray(paginationPageSizeSelectorValues)&&this.validateValues(paginationPageSizeSelectorValues)?[...paginationPageSizeSelectorValues].sort((a,b)=>a-b):defaultValues}validateValues(values2){if(!values2.length)return warnOnce("The paginationPageSizeSelector grid option is an empty array. This is most likely a mistake.\n                If you want to hide the page size selector, please set the paginationPageSizeSelector to false."),!1;for(let i=0;i<values2.length;i++){const value=values2[i],isPositive=value>0;if(!("number"==typeof value))return warnOnce("The paginationPageSizeSelector grid option contains a non-numeric value.\n                    Please make sure that all values in the paginationPageSizeSelector array are numbers."),!1;if(!isPositive)return warnOnce("The paginationPageSizeSelector grid option contains a negative number or zero.\n                    Please make sure that all values in the paginationPageSizeSelector array are positive."),!1}return!0}destroy(){this.toggleSelectDisplay(!1),super.destroy()}};__decorateClass([Autowired("paginationProxy")],PageSizeSelectorComp.prototype,"paginationProxy",2),__decorateClass([PostConstruct],PageSizeSelectorComp.prototype,"init",1);var AriaAnnouncementService=class extends BeanStub{constructor(){super(),this.descriptionContainer=null,this.announceValue=debounce(this.announceValue.bind(this),200)}postConstruct(){const eDocument=this.gos.getDocument(),div=this.descriptionContainer=eDocument.createElement("div");div.classList.add("ag-aria-description-container"),setAriaLive(div,"polite"),setAriaRelevant(div,"additions text"),setAriaAtomic(div,!0),this.eGridDiv.appendChild(div)}announceValue(value){this.descriptionContainer&&(this.descriptionContainer.textContent="",setTimeout(()=>{this.isAlive()&&this.descriptionContainer&&(this.descriptionContainer.textContent=value)},50))}destroy(){super.destroy();const{descriptionContainer}=this;descriptionContainer&&(clearElement(descriptionContainer),descriptionContainer.parentElement&&descriptionContainer.parentElement.removeChild(descriptionContainer)),this.descriptionContainer=null,this.eGridDiv=null}};__decorateClass([Autowired("eGridDiv")],AriaAnnouncementService.prototype,"eGridDiv",2),__decorateClass([PostConstruct],AriaAnnouncementService.prototype,"postConstruct",1),AriaAnnouncementService=__decorateClass([Bean("ariaAnnouncementService")],AriaAnnouncementService);var GlobalGridOptions=class{};function createGrid(eGridDiv,gridOptions,params){if(!gridOptions)return errorOnce("No gridOptions provided to createGrid"),{};const api=(new GridCoreCreator).create(eGridDiv,gridOptions,context=>{const gridComp=new GridComp(eGridDiv);context.createBean(gridComp)},void 0,params);if(!Object.isFrozen(gridOptions)&&!(null==params?void 0:params.frameworkOverrides)){const apiUrl="https://ag-grid.com/javascript-data-grid/grid-interface/#grid-api";Object.defineProperty(gridOptions,"api",{get:()=>{errorOnce(`gridOptions.api is no longer supported. See ${apiUrl}.`)},configurable:!0}),Object.defineProperty(gridOptions,"columnApi",{get:()=>{errorOnce(`gridOptions.columnApi is no longer supported and all methods moved to the grid api. See ${apiUrl}.`)},configurable:!0})}return api}GlobalGridOptions.gridOptions=void 0;var nextGridId=1,GridCoreCreator=class{create(eGridDiv,providedOptions,createUi,acceptChanges,params){var _a;let mergedGridOps={};GlobalGridOptions.gridOptions?(mergeDeep(mergedGridOps,GlobalGridOptions.gridOptions,!0,!0),mergedGridOps=__spreadValues(__spreadValues({},mergedGridOps),providedOptions)):mergedGridOps=providedOptions;const gridOptions=GridOptionsService.getCoercedGridOptions(mergedGridOps),debug=!!gridOptions.debug,gridId=null!=(_a=gridOptions.gridId)?_a:String(nextGridId++),registeredModules=this.getRegisteredModules(params,gridId),beanClasses=this.createBeansList(gridOptions.rowModelType,registeredModules,gridId),providedBeanInstances=this.createProvidedBeans(eGridDiv,gridOptions,params);if(!beanClasses)return void errorOnce("Failed to create grid.");const contextParams={providedBeanInstances,beanClasses,debug,gridId},contextLogger=new Logger("Context",()=>contextParams.debug),context=new Context(contextParams,contextLogger),beans=context.getBean("beans");this.registerModuleUserComponents(beans,registeredModules),this.registerStackComponents(beans,registeredModules),this.registerControllers(beans,registeredModules),createUi(context),beans.syncService.start(),acceptChanges&&acceptChanges(context);return context.getBean("gridApi")}registerControllers(beans,registeredModules){registeredModules.forEach(module=>{module.controllers&&module.controllers.forEach(meta=>beans.ctrlsFactory.register(meta))})}registerStackComponents(beans,registeredModules){const agStackComponents=this.createAgStackComponentsList(registeredModules);beans.agStackComponentsRegistry.setupComponents(agStackComponents)}getRegisteredModules(params,gridId){const passedViaConstructor=params?params.modules:null,registered=ModuleRegistry.__getRegisteredModules(gridId),allModules=[],mapNames={},addModule=(moduleBased,mod,gridId2)=>{var currentModule;mapNames[(currentModule=mod).moduleName]||(mapNames[currentModule.moduleName]=!0,allModules.push(currentModule),ModuleRegistry.__register(currentModule,moduleBased,gridId2)),mod.dependantModules&&mod.dependantModules.forEach(m=>addModule(moduleBased,m,gridId2))};return passedViaConstructor&&passedViaConstructor.forEach(m=>addModule(!0,m,gridId)),registered&&registered.forEach(m=>addModule(!ModuleRegistry.__isPackageBased(),m,void 0)),allModules}registerModuleUserComponents(beans,registeredModules){this.extractModuleEntity(registeredModules,module=>module.userComponents?module.userComponents:[]).forEach(compMeta=>{beans.userComponentRegistry.registerDefaultComponent(compMeta.componentName,compMeta.componentClass)})}createProvidedBeans(eGridDiv,gridOptions,params){let frameworkOverrides=params?params.frameworkOverrides:null;missing(frameworkOverrides)&&(frameworkOverrides=new VanillaFrameworkOverrides);const seed={gridOptions,eGridDiv,globalEventListener:params?params.globalEventListener:null,globalSyncEventListener:params?params.globalSyncEventListener:null,frameworkOverrides};return params&&params.providedBeanInstances&&Object.assign(seed,params.providedBeanInstances),seed}createAgStackComponentsList(registeredModules){let components=[{componentName:"AgCheckbox",componentClass:AgCheckbox},{componentName:"AgRadioButton",componentClass:AgRadioButton},{componentName:"AgToggleButton",componentClass:AgToggleButton},{componentName:"AgInputTextField",componentClass:AgInputTextField},{componentName:"AgInputTextArea",componentClass:AgInputTextArea},{componentName:"AgInputNumberField",componentClass:AgInputNumberField},{componentName:"AgInputDateField",componentClass:AgInputDateField},{componentName:"AgInputRange",componentClass:AgInputRange},{componentName:"AgRichSelect",componentClass:AgRichSelect},{componentName:"AgSelect",componentClass:AgSelect},{componentName:"AgSlider",componentClass:AgSlider},{componentName:"AgGridBody",componentClass:GridBodyComp},{componentName:"AgHeaderRoot",componentClass:GridHeaderComp},{componentName:"AgSortIndicator",componentClass:SortIndicatorComp},{componentName:"AgPagination",componentClass:PaginationComp},{componentName:"AgPageSizeSelector",componentClass:PageSizeSelectorComp},{componentName:"AgOverlayWrapper",componentClass:OverlayWrapperComponent},{componentName:"AgGroupComponent",componentClass:AgGroupComponent},{componentName:"AgRowContainer",componentClass:RowContainerComp},{componentName:"AgFakeHorizontalScroll",componentClass:FakeHScrollComp},{componentName:"AgFakeVerticalScroll",componentClass:FakeVScrollComp},{componentName:"AgAutocomplete",componentClass:AgAutocomplete}];const moduleAgStackComps=this.extractModuleEntity(registeredModules,module=>module.agStackComponents?module.agStackComponents:[]);return components=components.concat(moduleAgStackComps),components}createBeansList(rowModelType="clientSide",registeredModules,gridId){const rowModelModules=registeredModules.filter(module=>!module.rowModel||module.rowModel===rowModelType),rowModelModuleNames={clientSide:"@ag-grid-community/client-side-row-model",infinite:"@ag-grid-community/infinite-row-model",serverSide:"@ag-grid-enterprise/server-side-row-model",viewport:"@ag-grid-enterprise/viewport-row-model"};if(!rowModelModuleNames[rowModelType])return void errorOnce("Could not find row model for rowModelType = "+rowModelType);if(!ModuleRegistry.__assertRegistered(rowModelModuleNames[rowModelType],`rowModelType = '${rowModelType}'`,gridId))return;const beans=[Beans,RowPositionUtils,CellPositionUtils,HeaderPositionUtils,PaginationAutoPageSizeService,GridApi,UserComponentRegistry,AgComponentUtils,ComponentMetadataProvider,ResizeObserverService,UserComponentFactory,RowContainerHeightService,HorizontalResizeService,LocaleService,ValidationService,PinnedRowModel,DragService,DisplayedGroupCreator,EventService,GridOptionsService,PopupService,SelectionService,FilterManager,ColumnModel,HeaderNavigationService,PaginationProxy,RowRenderer,ExpressionService,ColumnFactory,AlignedGridsService,NavigationService,ValueCache,ValueService,LoggerFactory,AutoWidthCalculator,StandardMenuFactory,DragAndDropService,ColumnApi,FocusService,MouseEventService,Environment,CellNavigationService,StylingService,ScrollVisibleService,SortController,ColumnHoverService,ColumnAnimationService,SelectableService,AutoGroupColService,ChangeDetectionService,AnimationFrameService,UndoRedoService,AgStackComponentsRegistry,ColumnDefFactory,RowCssClassCalculator,RowNodeBlockLoader,RowNodeSorter,CtrlsService,PinnedWidthService,RowNodeEventThrottle,CtrlsFactory,DataTypeService,QuickFilterService,SyncService,OverlayService,StateService,ExpansionService,ApiEventService,AriaAnnouncementService,MenuService],moduleBeans=this.extractModuleEntity(rowModelModules,module=>module.beans?module.beans:[]);beans.push(...moduleBeans);const beansNoDuplicates=[];return beans.forEach(bean=>{beansNoDuplicates.indexOf(bean)<0&&beansNoDuplicates.push(bean)}),beansNoDuplicates}extractModuleEntity(moduleEntities,extractor){return[].concat(...moduleEntities.map(extractor))}},globalObj=void 0===__webpack_require__.g?{}:__webpack_require__.g;globalObj.HTMLElement="undefined"==typeof HTMLElement?{}:HTMLElement,globalObj.HTMLButtonElement="undefined"==typeof HTMLButtonElement?{}:HTMLButtonElement,globalObj.HTMLSelectElement="undefined"==typeof HTMLSelectElement?{}:HTMLSelectElement,globalObj.HTMLInputElement="undefined"==typeof HTMLInputElement?{}:HTMLInputElement,globalObj.Node="undefined"==typeof Node?{}:Node,globalObj.MouseEvent="undefined"==typeof MouseEvent?{}:MouseEvent;var _ClientSideNodeManager=class _ClientSideNodeManager{constructor(rootNode,gos,eventService,columnModel,selectionService,beans){this.nextId=0,this.rowCountReady=!1,this.allNodesMap={},this.rootNode=rootNode,this.gos=gos,this.eventService=eventService,this.columnModel=columnModel,this.beans=beans,this.selectionService=selectionService,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=_ClientSideNodeManager.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterAggFilter=[],this.rootNode.childrenAfterFilter=[]}getCopyOfNodesMap(){return _.cloneObject(this.allNodesMap)}getRowNode(id){return this.allNodesMap[id]}setRowData(rowData){if("string"==typeof rowData)return void console.warn("AG Grid: rowData must be an array.");this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(rowData);const rootNode=this.rootNode,sibling=this.rootNode.sibling;rootNode.childrenAfterFilter=null,rootNode.childrenAfterGroup=null,rootNode.childrenAfterAggFilter=null,rootNode.childrenAfterSort=null,rootNode.childrenMapped=null,rootNode.updateHasChildren(),this.nextId=0,this.allNodesMap={},rowData?rootNode.allLeafChildren=rowData.map(dataItem=>this.createNode(dataItem,this.rootNode,_ClientSideNodeManager.TOP_LEVEL)):(rootNode.allLeafChildren=[],rootNode.childrenAfterGroup=[]),sibling&&(sibling.childrenAfterFilter=rootNode.childrenAfterFilter,sibling.childrenAfterGroup=rootNode.childrenAfterGroup,sibling.childrenAfterAggFilter=rootNode.childrenAfterAggFilter,sibling.childrenAfterSort=rootNode.childrenAfterSort,sibling.childrenMapped=rootNode.childrenMapped,sibling.allLeafChildren=rootNode.allLeafChildren)}updateRowData(rowDataTran,rowNodeOrder){this.rowCountReady=!0,this.dispatchRowDataUpdateStartedEvent(rowDataTran.add);const rowNodeTransaction={remove:[],update:[],add:[]},nodesToUnselect=[];return this.executeRemove(rowDataTran,rowNodeTransaction,nodesToUnselect),this.executeUpdate(rowDataTran,rowNodeTransaction,nodesToUnselect),this.executeAdd(rowDataTran,rowNodeTransaction),this.updateSelection(nodesToUnselect,"rowDataChanged"),rowNodeOrder&&_.sortRowNodesByOrder(this.rootNode.allLeafChildren,rowNodeOrder),rowNodeTransaction}isRowCountReady(){return this.rowCountReady}dispatchRowDataUpdateStartedEvent(rowData){const event={type:Events.EVENT_ROW_DATA_UPDATE_STARTED,firstRowData:(null==rowData?void 0:rowData.length)?rowData[0]:null};this.eventService.dispatchEvent(event)}updateSelection(nodesToUnselect,source){const selectionChanged=nodesToUnselect.length>0;if(selectionChanged&&this.selectionService.setNodesSelected({newValue:!1,nodes:nodesToUnselect,suppressFinishActions:!0,source}),this.selectionService.updateGroupsFromChildrenSelections(source),selectionChanged){const event={type:Events.EVENT_SELECTION_CHANGED,source};this.eventService.dispatchEvent(event)}}executeAdd(rowDataTran,rowNodeTransaction){var _a;const{add,addIndex}=rowDataTran;if(_.missingOrEmpty(add))return;const newNodes=add.map(item=>this.createNode(item,this.rootNode,_ClientSideNodeManager.TOP_LEVEL));if("number"==typeof addIndex&&addIndex>=0){const{allLeafChildren}=this.rootNode,len=allLeafChildren.length;let normalisedAddIndex=addIndex;if(this.gos.get("treeData")&&addIndex>0&&len>0)for(let i=0;i<len;i++)if((null==(_a=allLeafChildren[i])?void 0:_a.rowIndex)==addIndex-1){normalisedAddIndex=i+1;break}const nodesBeforeIndex=allLeafChildren.slice(0,normalisedAddIndex),nodesAfterIndex=allLeafChildren.slice(normalisedAddIndex,allLeafChildren.length);this.rootNode.allLeafChildren=[...nodesBeforeIndex,...newNodes,...nodesAfterIndex]}else this.rootNode.allLeafChildren=[...this.rootNode.allLeafChildren,...newNodes];this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),rowNodeTransaction.add=newNodes}executeRemove(rowDataTran,rowNodeTransaction,nodesToUnselect){const{remove}=rowDataTran;if(_.missingOrEmpty(remove))return;const rowIdsRemoved={};remove.forEach(item=>{const rowNode=this.lookupRowNode(item);rowNode&&(rowNode.isSelected()&&nodesToUnselect.push(rowNode),rowNode.clearRowTopAndRowIndex(),rowIdsRemoved[rowNode.id]=!0,delete this.allNodesMap[rowNode.id],rowNodeTransaction.remove.push(rowNode))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(rowNode=>!rowIdsRemoved[rowNode.id]),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}executeUpdate(rowDataTran,rowNodeTransaction,nodesToUnselect){const{update}=rowDataTran;_.missingOrEmpty(update)||update.forEach(item=>{const rowNode=this.lookupRowNode(item);rowNode&&(rowNode.updateData(item),!rowNode.selectable&&rowNode.isSelected()&&nodesToUnselect.push(rowNode),this.setMasterForRow(rowNode,item,_ClientSideNodeManager.TOP_LEVEL,!1),rowNodeTransaction.update.push(rowNode))})}lookupRowNode(data){const getRowIdFunc=this.gos.getCallback("getRowId");let rowNode;if(getRowIdFunc){const id=getRowIdFunc({data,level:0});if(rowNode=this.allNodesMap[id],!rowNode)return console.error(`AG Grid: could not find row id=${id}, data item was not found for this id`),null}else if(rowNode=this.rootNode.allLeafChildren.find(node=>node.data===data),!rowNode)return console.error("AG Grid: could not find data item as object was not found",data),console.error("Consider using getRowId to help the Grid find matching row data"),null;return rowNode||null}createNode(dataItem,parent,level){const node=new RowNode(this.beans);node.group=!1,this.setMasterForRow(node,dataItem,level,!0);const suppressParentsInRowNodes=this.gos.get("suppressParentsInRowNodes");return parent&&!suppressParentsInRowNodes&&(node.parent=parent),node.level=level,node.setDataAndId(dataItem,this.nextId.toString()),this.allNodesMap[node.id]&&console.warn(`AG Grid: duplicate node id '${node.id}' detected from getRowId callback, this could cause issues in your grid.`),this.allNodesMap[node.id]=node,this.nextId++,node}setMasterForRow(rowNode,data,level,setExpanded){if(this.gos.get("treeData"))rowNode.setMaster(!1),setExpanded&&(rowNode.expanded=!1);else{if(this.gos.get("masterDetail")){const isRowMasterFunc=this.gos.get("isRowMaster");isRowMasterFunc?rowNode.setMaster(isRowMasterFunc(data)):rowNode.setMaster(!0)}else rowNode.setMaster(!1);if(setExpanded){const rowGroupColumns=this.columnModel.getRowGroupColumns(),masterRowLevel=level+(rowGroupColumns?rowGroupColumns.length:0);rowNode.expanded=!!rowNode.master&&this.isExpanded(masterRowLevel)}}}isExpanded(level){const expandByDefault=this.gos.get("groupDefaultExpanded");return-1===expandByDefault||level<expandByDefault}};_ClientSideNodeManager.TOP_LEVEL=0,_ClientSideNodeManager.ROOT_NODE_ID="ROOT_NODE_ID";var ClientSideNodeManager=_ClientSideNodeManager,ClientSideRowModel=class extends BeanStub{constructor(){super(...arguments),this.onRowHeightChanged_debounced=_.debounce(this.onRowHeightChanged.bind(this),100),this.rowsToDisplay=[],this.hasStarted=!1,this.shouldSkipSettingDataOnStart=!1,this.isRefreshingModel=!1,this.rowCountReady=!1}init(){const refreshEverythingFunc=this.refreshModel.bind(this,{step:"group"}),animate=!this.gos.get("suppressAnimationFrame"),refreshEverythingAfterColsChangedFunc=this.refreshModel.bind(this,{step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate});this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,refreshEverythingAfterColsChangedFunc),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_ROW_GROUP_CHANGED,refreshEverythingFunc),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:"pivot"})),this.addManagedListener(this.eventService,Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_COLUMN_PIVOT_MODE_CHANGED,refreshEverythingFunc),this.addManagedListener(this.eventService,Events.EVENT_GRID_STYLES_CHANGED,this.onGridStylesChanges.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_GRID_READY,()=>this.onGridReady()),this.addPropertyListeners(),this.rootNode=new RowNode(this.beans),this.nodeManager=new ClientSideNodeManager(this.rootNode,this.gos,this.eventService,this.columnModel,this.selectionService,this.beans)}addPropertyListeners(){const resetProps=new Set(["treeData","masterDetail"]),groupStageRefreshProps=new Set(["suppressParentsInRowNodes","groupDefaultExpanded","groupAllowUnbalanced","initialGroupOrderComparator","groupHideOpenParents","groupDisplayType"]),filterStageRefreshProps=new Set(["excludeChildrenWhenTreeDataFiltering"]),pivotStageRefreshProps=new Set(["removePivotHeaderRowWhenSingleValueColumn","pivotRowTotals","pivotColumnGroupTotals","suppressExpandablePivotGroups"]),aggregateStageRefreshProps=new Set(["getGroupRowAgg","alwaysAggregateAtRootLevel","groupIncludeTotalFooter","suppressAggFilteredOnly","grandTotalRow"]),sortStageRefreshProps=new Set(["postSortRows","groupDisplayType","accentedSort"]),filterAggStageRefreshProps=new Set([]),flattenStageRefreshProps=new Set(["groupRemoveSingleChildren","groupRemoveLowestSingleChildren","groupIncludeFooter","groupTotalRow"]),allProps=[...resetProps,...groupStageRefreshProps,...filterStageRefreshProps,...pivotStageRefreshProps,...pivotStageRefreshProps,...aggregateStageRefreshProps,...sortStageRefreshProps,...filterAggStageRefreshProps,...flattenStageRefreshProps];this.addManagedPropertyListeners(allProps,params=>{var _a;const properties=null==(_a=params.changeSet)?void 0:_a.properties;if(!properties)return;const arePropertiesImpacted=propSet=>properties.some(prop=>propSet.has(prop));arePropertiesImpacted(resetProps)?this.setRowData(this.rootNode.allLeafChildren.map(child=>child.data)):arePropertiesImpacted(groupStageRefreshProps)?this.refreshModel({step:"group"}):arePropertiesImpacted(filterStageRefreshProps)?this.refreshModel({step:"filter"}):arePropertiesImpacted(pivotStageRefreshProps)?this.refreshModel({step:"pivot"}):arePropertiesImpacted(aggregateStageRefreshProps)?this.refreshModel({step:"aggregate"}):arePropertiesImpacted(sortStageRefreshProps)?this.refreshModel({step:"sort"}):arePropertiesImpacted(filterAggStageRefreshProps)?this.refreshModel({step:"filter_aggregates"}):arePropertiesImpacted(flattenStageRefreshProps)&&this.refreshModel({step:"map"})}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.hasStarted=!0,this.shouldSkipSettingDataOnStart?this.dispatchUpdateEventsAndRefresh():this.setInitialData()}setInitialData(){const rowData=this.gos.get("rowData");rowData&&(this.shouldSkipSettingDataOnStart=!0,this.setRowData(rowData))}ensureRowHeightsValid(startPixel,endPixel,startLimitIndex,endLimitIndex){let atLeastOneChange,res=!1;do{atLeastOneChange=!1;const rowAtStartPixel=this.getRowIndexAtPixel(startPixel),rowAtEndPixel=this.getRowIndexAtPixel(endPixel),firstRow=Math.max(rowAtStartPixel,startLimitIndex),lastRow=Math.min(rowAtEndPixel,endLimitIndex);for(let rowIndex=firstRow;rowIndex<=lastRow;rowIndex++){const rowNode=this.getRow(rowIndex);if(rowNode.rowHeightEstimated){const rowHeight=this.gos.getRowHeightForNode(rowNode);rowNode.setRowHeight(rowHeight.height),atLeastOneChange=!0,res=!0}}atLeastOneChange&&this.setRowTopAndRowIndex()}while(atLeastOneChange);return res}setRowTopAndRowIndex(){const defaultRowHeight=this.environment.getDefaultRowHeight();let nextRowTop=0;const displayedRowsMapped=new Set,allowEstimate=this.gos.isDomLayout("normal");for(let i=0;i<this.rowsToDisplay.length;i++){const rowNode=this.rowsToDisplay[i];if(null!=rowNode.id&&displayedRowsMapped.add(rowNode.id),null==rowNode.rowHeight){const rowHeight=this.gos.getRowHeightForNode(rowNode,allowEstimate,defaultRowHeight);rowNode.setRowHeight(rowHeight.height,rowHeight.estimated)}rowNode.setRowTop(nextRowTop),rowNode.setRowIndex(i),nextRowTop+=rowNode.rowHeight}return displayedRowsMapped}clearRowTopAndRowIndex(changedPath,displayedRowsMapped){const changedPathActive=changedPath.isActive(),clearIfNotDisplayed=rowNode=>{rowNode&&null!=rowNode.id&&!displayedRowsMapped.has(rowNode.id)&&rowNode.clearRowTopAndRowIndex()},recurse=rowNode=>{if(clearIfNotDisplayed(rowNode),clearIfNotDisplayed(rowNode.detailNode),clearIfNotDisplayed(rowNode.sibling),rowNode.hasChildren()&&rowNode.childrenAfterGroup){const isRootNode=-1==rowNode.level;changedPathActive&&!isRootNode&&!rowNode.expanded||rowNode.childrenAfterGroup.forEach(recurse)}};recurse(this.rootNode)}ensureRowsAtPixel(rowNodes,pixel,increment=0){const indexAtPixelNow=this.getRowIndexAtPixel(pixel),rowNodeAtPixelNow=this.getRow(indexAtPixelNow),animate=!this.gos.get("suppressAnimationFrame");return rowNodeAtPixelNow!==rowNodes[0]&&(rowNodes.forEach(rowNode=>{_.removeFromArray(this.rootNode.allLeafChildren,rowNode)}),rowNodes.forEach((rowNode,idx)=>{_.insertIntoArray(this.rootNode.allLeafChildren,rowNode,Math.max(indexAtPixelNow+increment,0)+idx)}),this.refreshModel({step:"group",keepRenderedRows:!0,keepEditingRows:!0,animate}),!0)}highlightRowAtPixel(rowNode,pixel){const indexAtPixelNow=null!=pixel?this.getRowIndexAtPixel(pixel):null,rowNodeAtPixelNow=null!=indexAtPixelNow?this.getRow(indexAtPixelNow):null;if(!rowNodeAtPixelNow||!rowNode||rowNodeAtPixelNow===rowNode||null==pixel)return void(this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null));const highlight=this.getHighlightPosition(pixel,rowNodeAtPixelNow);this.lastHighlightedRow&&this.lastHighlightedRow!==rowNodeAtPixelNow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),rowNodeAtPixelNow.setHighlighted(highlight),this.lastHighlightedRow=rowNodeAtPixelNow}getHighlightPosition(pixel,rowNode){if(!rowNode){const index=this.getRowIndexAtPixel(pixel);if(!(rowNode=this.getRow(index||0)))return 1}const{rowTop,rowHeight}=rowNode;return pixel-rowTop<rowHeight/2?0:1}getLastHighlightedRowNode(){return this.lastHighlightedRow}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay?this.rowsToDisplay.length:0}getTopLevelRowCount(){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return 1;const filteredChildren=this.rootNode.childrenAfterAggFilter;return filteredChildren?filteredChildren.length:0}getTopLevelRowDisplayedIndex(topLevelIndex){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return topLevelIndex;let rowNode=this.rootNode.childrenAfterSort[topLevelIndex];if(this.gos.get("groupHideOpenParents"))for(;rowNode.expanded&&rowNode.childrenAfterSort&&rowNode.childrenAfterSort.length>0;)rowNode=rowNode.childrenAfterSort[0];return rowNode.rowIndex}getRowBounds(index){if(_.missing(this.rowsToDisplay))return null;const rowNode=this.rowsToDisplay[index];return rowNode?{rowTop:rowNode.rowTop,rowHeight:rowNode.rowHeight}:null}onRowGroupOpened(){const animate=this.gos.isAnimateRows();this.refreshModel({step:"map",keepRenderedRows:!0,animate})}onFilterChanged(event){if(event.afterDataChange)return;const animate=this.gos.isAnimateRows(),step=0===event.columns.length||event.columns.some(col=>col.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step,keepRenderedRows:!0,animate})}onSortChanged(){const animate=this.gos.isAnimateRows();this.refreshModel({step:"sort",keepRenderedRows:!0,animate,keepEditingRows:!0})}getType(){return"clientSide"}onValueChanged(){this.columnModel.isPivotActive()?this.refreshModel({step:"pivot"}):this.refreshModel({step:"aggregate"})}createChangePath(rowNodeTransactions){const noTransactions=_.missingOrEmpty(rowNodeTransactions),changedPath=new ChangedPath(!1,this.rootNode);return(noTransactions||this.gos.get("treeData"))&&changedPath.setInactive(),changedPath}isSuppressModelUpdateAfterUpdateTransaction(params){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;if(null==params.rowNodeTransactions)return!1;const transWithAddsOrDeletes=params.rowNodeTransactions.filter(tx=>null!=tx.add&&tx.add.length>0||null!=tx.remove&&tx.remove.length>0);return null==transWithAddsOrDeletes||0==transWithAddsOrDeletes.length}buildRefreshModelParams(step){let paramsStep="group";const stepsMapped={everything:"group",group:"group",filter:"filter",map:"map",aggregate:"aggregate",sort:"sort",pivot:"pivot"};if(_.exists(step)&&(paramsStep=stepsMapped[step]),_.missing(paramsStep))return void console.error(`AG Grid: invalid step ${step}, available steps are ${Object.keys(stepsMapped).join(", ")}`);return{step:paramsStep,keepRenderedRows:!0,keepEditingRows:!0,animate:!this.gos.get("suppressAnimationFrame")}}refreshModel(paramsOrStep){if(!this.hasStarted||this.isRefreshingModel||this.columnModel.shouldRowModelIgnoreRefresh())return;let params="object"==typeof paramsOrStep&&"step"in paramsOrStep?paramsOrStep:this.buildRefreshModelParams(paramsOrStep);if(!params)return;if(this.isSuppressModelUpdateAfterUpdateTransaction(params))return;const changedPath=this.createChangePath(params.rowNodeTransactions);switch(this.isRefreshingModel=!0,params.step){case"group":this.doRowGrouping(params.rowNodeTransactions,params.rowNodeOrder,changedPath,!!params.afterColumnsChanged);case"filter":this.doFilter(changedPath);case"pivot":this.doPivot(changedPath);case"aggregate":this.doAggregate(changedPath);case"filter_aggregates":this.doFilterAggregates(changedPath);case"sort":this.doSort(params.rowNodeTransactions,changedPath);case"map":this.doRowsToDisplay()}const displayedNodesMapped=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(changedPath,displayedNodesMapped),this.isRefreshingModel=!1;const event={type:Events.EVENT_MODEL_UPDATED,animate:params.animate,keepRenderedRows:params.keepRenderedRows,newData:params.newData,newPage:!1,keepUndoRedoStack:params.keepUndoRedoStack};this.eventService.dispatchEvent(event)}isEmpty(){const rowsMissing=_.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return _.missing(this.rootNode)||rowsMissing||!this.columnModel.isReady()}isRowsToRender(){return _.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0}getNodesInRangeForSelection(firstInRange,lastInRange){let started=!lastInRange,finished=!1;const result=[],groupsSelectChildren=this.gos.get("groupSelectsChildren");return this.forEachNodeAfterFilterAndSort(rowNode=>{if(finished)return;if(started&&(rowNode===lastInRange||rowNode===firstInRange)&&(finished=!0,rowNode.group&&groupsSelectChildren))return void result.push(...rowNode.allLeafChildren);if(!started){if(rowNode!==lastInRange&&rowNode!==firstInRange)return;started=!0}(!rowNode.group||!groupsSelectChildren)&&result.push(rowNode)}),result}setDatasource(datasource){console.error("AG Grid: should never call setDatasource on clientSideRowController")}getTopLevelNodes(){return this.rootNode?this.rootNode.childrenAfterGroup:null}getRootNode(){return this.rootNode}getRow(index){return this.rowsToDisplay[index]}isRowPresent(rowNode){return this.rowsToDisplay.indexOf(rowNode)>=0}getRowIndexAtPixel(pixelToMatch){if(this.isEmpty()||0===this.rowsToDisplay.length)return-1;let bottomPointer=0,topPointer=this.rowsToDisplay.length-1;if(pixelToMatch<=0)return 0;if(_.last(this.rowsToDisplay).rowTop<=pixelToMatch)return this.rowsToDisplay.length-1;let oldBottomPointer=-1,oldTopPointer=-1;for(;;){const midPointer=Math.floor((bottomPointer+topPointer)/2),currentRowNode=this.rowsToDisplay[midPointer];if(this.isRowInPixel(currentRowNode,pixelToMatch))return midPointer;currentRowNode.rowTop<pixelToMatch?bottomPointer=midPointer+1:currentRowNode.rowTop>pixelToMatch&&(topPointer=midPointer-1);if(oldBottomPointer===bottomPointer&&oldTopPointer===topPointer)return midPointer;oldBottomPointer=bottomPointer,oldTopPointer=topPointer}}isRowInPixel(rowNode,pixelToMatch){const topPixel=rowNode.rowTop,bottomPixel=rowNode.rowTop+rowNode.rowHeight;return topPixel<=pixelToMatch&&bottomPixel>pixelToMatch}forEachLeafNode(callback){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach((rowNode,index)=>callback(rowNode,index))}forEachNode(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterGroup||[]],callback,recursionType:0,index:0,includeFooterNodes})}forEachNodeAfterFilter(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterAggFilter||[]],callback,recursionType:1,index:0,includeFooterNodes})}forEachNodeAfterFilterAndSort(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[...this.rootNode.childrenAfterSort||[]],callback,recursionType:2,index:0,includeFooterNodes})}forEachPivotNode(callback,includeFooterNodes=!1){this.recursivelyWalkNodesAndCallback({nodes:[this.rootNode],callback,recursionType:3,index:0,includeFooterNodes})}recursivelyWalkNodesAndCallback(params){const{nodes,callback,recursionType,includeFooterNodes}=params;let{index}=params;const addFooters=position=>{var _a;const parentNode=null==(_a=nodes[0])?void 0:_a.parent;if(!parentNode)return;const grandTotal=includeFooterNodes&&this.gos.getGrandTotalRow(),isGroupIncludeFooter=this.gos.getGroupTotalRowCallback(),groupTotal=includeFooterNodes&&isGroupIncludeFooter({node:parentNode});parentNode===this.rootNode?grandTotal===position&&(parentNode.createFooter(),callback(parentNode.sibling,index++)):groupTotal===position&&(parentNode.createFooter(),callback(parentNode.sibling,index++))};addFooters("top");for(let i=0;i<nodes.length;i++){const node=nodes[i];if(callback(node,index++),node.hasChildren()&&!node.footer){let nodeChildren=null;switch(recursionType){case 0:nodeChildren=node.childrenAfterGroup;break;case 1:nodeChildren=node.childrenAfterAggFilter;break;case 2:nodeChildren=node.childrenAfterSort;break;case 3:nodeChildren=node.leafGroup?null:node.childrenAfterSort}nodeChildren&&(index=this.recursivelyWalkNodesAndCallback({nodes:[...nodeChildren],callback,recursionType,index,includeFooterNodes}))}}return addFooters("bottom"),index}doAggregate(changedPath){var _a;null==(_a=this.aggregationStage)||_a.execute({rowNode:this.rootNode,changedPath})}doFilterAggregates(changedPath){this.filterAggregatesStage?this.filterAggregatesStage.execute({rowNode:this.rootNode,changedPath}):this.rootNode.childrenAfterAggFilter=this.rootNode.childrenAfterFilter}expandOrCollapseAll(expand){const usingTreeData=this.gos.get("treeData"),usingPivotMode=this.columnModel.isPivotActive(),recursiveExpandOrCollapse=rowNodes=>{rowNodes&&rowNodes.forEach(rowNode=>{const actionRow=()=>{rowNode.expanded=expand,recursiveExpandOrCollapse(rowNode.childrenAfterGroup)};if(usingTreeData){return void(_.exists(rowNode.childrenAfterGroup)&&actionRow())}if(usingPivotMode){return void(!rowNode.leafGroup&&actionRow())}rowNode.group&&actionRow()})};this.rootNode&&recursiveExpandOrCollapse(this.rootNode.childrenAfterGroup),this.refreshModel({step:"map"});const eventSource=expand?"expandAll":"collapseAll",event={type:Events.EVENT_EXPAND_COLLAPSE_ALL,source:eventSource};this.eventService.dispatchEvent(event)}doSort(rowNodeTransactions,changedPath){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions,changedPath})}doRowGrouping(rowNodeTransactions,rowNodeOrder,changedPath,afterColumnsChanged){if(this.groupStage){if(rowNodeTransactions?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions,rowNodeOrder,changedPath}):this.groupStage.execute({rowNode:this.rootNode,changedPath,afterColumnsChanged}),this.gos.get("groupSelectsChildren")){if(this.selectionService.updateGroupsFromChildrenSelections("rowGroupChanged",changedPath)){const event={type:Events.EVENT_SELECTION_CHANGED,source:"rowGroupChanged"};this.eventService.dispatchEvent(event)}}}else this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren();this.nodeManager.isRowCountReady()&&(this.rowCountReady=!0,this.eventService.dispatchEventOnce({type:Events.EVENT_ROW_COUNT_READY}))}doFilter(changedPath){this.filterStage.execute({rowNode:this.rootNode,changedPath})}doPivot(changedPath){var _a;null==(_a=this.pivotStage)||_a.execute({rowNode:this.rootNode,changedPath})}getCopyOfNodesMap(){return this.nodeManager.getCopyOfNodesMap()}getRowNode(id){if("string"==typeof id&&0==id.indexOf(RowNode.ID_PREFIX_ROW_GROUP)){let res;return this.forEachNode(node=>{node.id===id&&(res=node)}),res}return this.nodeManager.getRowNode(id)}setRowData(rowData){this.selectionService.reset("rowDataChanged"),this.nodeManager.setRowData(rowData),this.hasStarted&&this.dispatchUpdateEventsAndRefresh()}dispatchUpdateEventsAndRefresh(){const rowDataUpdatedEvent={type:Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(rowDataUpdatedEvent),this.refreshModel({step:"group",newData:!0})}batchUpdateRowData(rowDataTransaction,callback){if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];const waitMillis=this.gos.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(()=>{this.executeBatchUpdateRowData()},waitMillis)}this.rowDataTransactionBatch.push({rowDataTransaction,callback})}flushAsyncTransactions(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){this.valueCache.onDataChanged();const callbackFuncsBound=[],rowNodeTrans=[];let forceRowNodeOrder=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(tranItem=>{const rowNodeTran=this.nodeManager.updateRowData(tranItem.rowDataTransaction,void 0);rowNodeTrans.push(rowNodeTran),tranItem.callback&&callbackFuncsBound.push(tranItem.callback.bind(null,rowNodeTran)),"number"==typeof tranItem.rowDataTransaction.addIndex&&(forceRowNodeOrder=!0)}),this.commonUpdateRowData(rowNodeTrans,void 0,forceRowNodeOrder),callbackFuncsBound.length>0&&window.setTimeout(()=>{callbackFuncsBound.forEach(func=>func())},0),rowNodeTrans.length>0){const event={type:Events.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:rowNodeTrans};this.eventService.dispatchEvent(event)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0}updateRowData(rowDataTran,rowNodeOrder){this.valueCache.onDataChanged();const rowNodeTran=this.nodeManager.updateRowData(rowDataTran,rowNodeOrder),forceRowNodeOrder="number"==typeof rowDataTran.addIndex;return this.commonUpdateRowData([rowNodeTran],rowNodeOrder,forceRowNodeOrder),rowNodeTran}createRowNodeOrder(){if(this.gos.get("suppressMaintainUnsortedOrder"))return;const orderMap={};if(this.rootNode&&this.rootNode.allLeafChildren)for(let index=0;index<this.rootNode.allLeafChildren.length;index++){orderMap[this.rootNode.allLeafChildren[index].id]=index}return orderMap}commonUpdateRowData(rowNodeTrans,rowNodeOrder,forceRowNodeOrder){if(!this.hasStarted)return;const animate=!this.gos.get("suppressAnimationFrame");forceRowNodeOrder&&(rowNodeOrder=this.createRowNodeOrder());const event={type:Events.EVENT_ROW_DATA_UPDATED};this.eventService.dispatchEvent(event),this.refreshModel({step:"group",rowNodeTransactions:rowNodeTrans,rowNodeOrder,keepRenderedRows:!0,keepEditingRows:!0,animate})}doRowsToDisplay(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepEditingRows:!0,keepUndoRedoStack:!0})}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}resetRowHeights(){const atLeastOne=this.resetRowHeightsForAllRowNodes();this.rootNode.setRowHeight(this.rootNode.rowHeight,!0),this.rootNode.sibling&&this.rootNode.sibling.setRowHeight(this.rootNode.sibling.rowHeight,!0),atLeastOne&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let atLeastOne=!1;return this.forEachNode(rowNode=>{rowNode.setRowHeight(rowNode.rowHeight,!0);const detailNode=rowNode.detailNode;detailNode&&detailNode.setRowHeight(detailNode.rowHeight,!0),rowNode.sibling&&rowNode.sibling.setRowHeight(rowNode.sibling.rowHeight,!0),atLeastOne=!0}),atLeastOne}onGridStylesChanges(){this.columnModel.isAutoRowHeightActive()||this.resetRowHeights()}onGridReady(){this.hasStarted||this.setInitialData()}isRowDataLoaded(){return this.rowCountReady}};__decorateClass([Autowired("columnModel")],ClientSideRowModel.prototype,"columnModel",2),__decorateClass([Autowired("selectionService")],ClientSideRowModel.prototype,"selectionService",2),__decorateClass([Autowired("valueCache")],ClientSideRowModel.prototype,"valueCache",2),__decorateClass([Autowired("beans")],ClientSideRowModel.prototype,"beans",2),__decorateClass([Autowired("filterStage")],ClientSideRowModel.prototype,"filterStage",2),__decorateClass([Autowired("sortStage")],ClientSideRowModel.prototype,"sortStage",2),__decorateClass([Autowired("flattenStage")],ClientSideRowModel.prototype,"flattenStage",2),__decorateClass([Optional("groupStage")],ClientSideRowModel.prototype,"groupStage",2),__decorateClass([Optional("aggregationStage")],ClientSideRowModel.prototype,"aggregationStage",2),__decorateClass([Optional("pivotStage")],ClientSideRowModel.prototype,"pivotStage",2),__decorateClass([Optional("filterAggregatesStage")],ClientSideRowModel.prototype,"filterAggregatesStage",2),__decorateClass([PostConstruct],ClientSideRowModel.prototype,"init",1),ClientSideRowModel=__decorateClass([Bean("rowModel")],ClientSideRowModel);var FilterStage=class extends BeanStub{execute(params){const{changedPath}=params;this.filterService.filter(changedPath)}};__decorateClass([Autowired("filterService")],FilterStage.prototype,"filterService",2),FilterStage=__decorateClass([Bean("filterStage")],FilterStage);var SortStage=class extends BeanStub{execute(params){const sortOptions=this.sortController.getSortOptions(),sortActive=_.exists(sortOptions)&&sortOptions.length>0,deltaSort=sortActive&&_.exists(params.rowNodeTransactions)&&this.gos.get("deltaSort"),sortContainsGroupColumns=sortOptions.some(opt=>this.gos.isColumnsSortingCoupledToGroup()?opt.column.isPrimary()&&opt.column.isRowGroupActive():!!opt.column.getColDef().showRowGroup);this.sortService.sort(sortOptions,sortActive,deltaSort,params.rowNodeTransactions,params.changedPath,sortContainsGroupColumns)}};__decorateClass([Autowired("sortService")],SortStage.prototype,"sortService",2),__decorateClass([Autowired("sortController")],SortStage.prototype,"sortController",2),SortStage=__decorateClass([Bean("sortStage")],SortStage);var FlattenStage=class extends BeanStub{execute(params){const rootNode=params.rowNode,result=[],skipLeafNodes=this.beans.columnModel.isPivotMode(),showRootNode=skipLeafNodes&&rootNode.leafGroup,topList=showRootNode?[rootNode]:rootNode.childrenAfterSort,details=this.getFlattenDetails();this.recursivelyAddToRowsToDisplay(details,topList,result,skipLeafNodes,0);if(!showRootNode&&result.length>0&&details.grandTotalRow){rootNode.createFooter();const addToTop="top"===details.grandTotalRow;this.addRowNodeToRowsToDisplay(details,rootNode.sibling,result,0,addToTop)}return result}getFlattenDetails(){const groupRemoveSingleChildren=this.gos.get("groupRemoveSingleChildren");return{groupRemoveLowestSingleChildren:!groupRemoveSingleChildren&&this.gos.get("groupRemoveLowestSingleChildren"),groupRemoveSingleChildren,isGroupMultiAutoColumn:this.gos.isGroupMultiAutoColumn(),hideOpenParents:this.gos.get("groupHideOpenParents"),grandTotalRow:this.gos.getGrandTotalRow(),groupTotalRow:this.gos.getGroupTotalRowCallback()}}recursivelyAddToRowsToDisplay(details,rowsToFlatten,result,skipLeafNodes,uiLevel){if(!_.missingOrEmpty(rowsToFlatten))for(let i=0;i<rowsToFlatten.length;i++){const rowNode=rowsToFlatten[i],isParent=rowNode.hasChildren(),isSkippedLeafNode=skipLeafNodes&&!isParent,isRemovedSingleChildrenGroup=details.groupRemoveSingleChildren&&isParent&&1===rowNode.childrenAfterGroup.length,isRemovedLowestSingleChildrenGroup=details.groupRemoveLowestSingleChildren&&isParent&&rowNode.leafGroup&&1===rowNode.childrenAfterGroup.length,neverAllowToExpand=skipLeafNodes&&rowNode.leafGroup,isHiddenOpenParent=details.hideOpenParents&&rowNode.expanded&&!rowNode.master&&!neverAllowToExpand;if(!(isSkippedLeafNode||isHiddenOpenParent||isRemovedSingleChildrenGroup||isRemovedLowestSingleChildrenGroup)&&this.addRowNodeToRowsToDisplay(details,rowNode,result,uiLevel),!skipLeafNodes||!rowNode.leafGroup)if(isParent){const excludedParent=isRemovedSingleChildrenGroup||isRemovedLowestSingleChildrenGroup;if(rowNode.expanded||excludedParent){const doesRowShowFooter=details.groupTotalRow({node:rowNode});doesRowShowFooter||rowNode.destroyFooter();const uiLevelForChildren=excludedParent?uiLevel:uiLevel+1;"top"===doesRowShowFooter&&(rowNode.createFooter(),this.addRowNodeToRowsToDisplay(details,rowNode.sibling,result,uiLevelForChildren)),this.recursivelyAddToRowsToDisplay(details,rowNode.childrenAfterSort,result,skipLeafNodes,uiLevelForChildren),"bottom"===doesRowShowFooter&&(rowNode.createFooter(),this.addRowNodeToRowsToDisplay(details,rowNode.sibling,result,uiLevelForChildren))}}else if(rowNode.master&&rowNode.expanded){const detailNode=this.createDetailNode(rowNode);this.addRowNodeToRowsToDisplay(details,detailNode,result,uiLevel)}}}addRowNodeToRowsToDisplay(details,rowNode,result,uiLevel,addToTop){addToTop?result.unshift(rowNode):result.push(rowNode),rowNode.setUiLevel(details.isGroupMultiAutoColumn?0:uiLevel)}createDetailNode(masterNode){if(_.exists(masterNode.detailNode))return masterNode.detailNode;const detailNode=new RowNode(this.beans);return detailNode.detail=!0,detailNode.selectable=!1,detailNode.parent=masterNode,_.exists(masterNode.id)&&(detailNode.id="detail_"+masterNode.id),detailNode.data=masterNode.data,detailNode.level=masterNode.level+1,masterNode.detailNode=detailNode,detailNode}};__decorateClass([Autowired("beans")],FlattenStage.prototype,"beans",2),FlattenStage=__decorateClass([Bean("flattenStage")],FlattenStage);var SortService=class extends BeanStub{sort(sortOptions,sortActive,useDeltaSort,rowNodeTransactions,changedPath,sortContainsGroupColumns){const groupMaintainOrder=this.gos.get("groupMaintainOrder"),groupColumnsPresent=this.columnModel.getAllGridColumns().some(c=>c.isRowGroupActive());let allDirtyNodes={};useDeltaSort&&rowNodeTransactions&&(allDirtyNodes=this.calculateDirtyNodes(rowNodeTransactions));const isPivotMode=this.columnModel.isPivotMode(),postSortFunc=this.gos.getCallback("postSortRows"),callback=rowNode=>{var _a;this.pullDownGroupDataForHideOpenParents(rowNode.childrenAfterAggFilter,!0);const skipSortingPivotLeafs=isPivotMode&&rowNode.leafGroup;if(groupMaintainOrder&&groupColumnsPresent&&!rowNode.leafGroup&&!sortContainsGroupColumns){const nextGroup=null==(_a=this.columnModel.getRowGroupColumns())?void 0:_a[rowNode.level+1],wasSortExplicitlyRemoved=null===(null==nextGroup?void 0:nextGroup.getSort()),childrenToBeSorted=rowNode.childrenAfterAggFilter.slice(0);if(rowNode.childrenAfterSort&&!wasSortExplicitlyRemoved){const indexedOrders={};rowNode.childrenAfterSort.forEach((node,idx)=>{indexedOrders[node.id]=idx}),childrenToBeSorted.sort((row1,row2)=>{var _a2,_b;return(null!=(_a2=indexedOrders[row1.id])?_a2:0)-(null!=(_b=indexedOrders[row2.id])?_b:0)})}rowNode.childrenAfterSort=childrenToBeSorted}else rowNode.childrenAfterSort=!sortActive||skipSortingPivotLeafs?rowNode.childrenAfterAggFilter.slice(0):useDeltaSort?this.doDeltaSort(rowNode,allDirtyNodes,changedPath,sortOptions):this.rowNodeSorter.doFullSort(rowNode.childrenAfterAggFilter,sortOptions);if(rowNode.sibling&&(rowNode.sibling.childrenAfterSort=rowNode.childrenAfterSort),this.updateChildIndexes(rowNode),postSortFunc){const params={nodes:rowNode.childrenAfterSort};postSortFunc(params)}};changedPath&&changedPath.forEachChangedNodeDepthFirst(callback),this.updateGroupDataForHideOpenParents(changedPath)}calculateDirtyNodes(rowNodeTransactions){const dirtyNodes={},addNodesFunc=rowNodes=>{rowNodes&&rowNodes.forEach(rowNode=>dirtyNodes[rowNode.id]=!0)};return rowNodeTransactions&&rowNodeTransactions.forEach(tran=>{addNodesFunc(tran.add),addNodesFunc(tran.update),addNodesFunc(tran.remove)}),dirtyNodes}doDeltaSort(rowNode,allTouchedNodes,changedPath,sortOptions){const unsortedRows=rowNode.childrenAfterAggFilter,oldSortedRows=rowNode.childrenAfterSort;if(!oldSortedRows)return this.rowNodeSorter.doFullSort(unsortedRows,sortOptions);const untouchedRowsMap={},touchedRows=[];unsortedRows.forEach(row=>{allTouchedNodes[row.id]||!changedPath.canSkip(row)?touchedRows.push(row):untouchedRowsMap[row.id]=!0});const sortedUntouchedRows=oldSortedRows.filter(child=>untouchedRowsMap[child.id]),mapNodeToSortedNode=(rowNode2,pos)=>({currentPos:pos,rowNode:rowNode2}),sortedChangedRows=touchedRows.map(mapNodeToSortedNode).sort((a,b)=>this.rowNodeSorter.compareRowNodes(sortOptions,a,b));return this.mergeSortedArrays(sortOptions,sortedChangedRows,sortedUntouchedRows.map(mapNodeToSortedNode)).map(({rowNode:rowNode2})=>rowNode2)}mergeSortedArrays(sortOptions,arr1,arr2){const res=[];let i=0,j=0;for(;i<arr1.length&&j<arr2.length;){this.rowNodeSorter.compareRowNodes(sortOptions,arr1[i],arr2[j])<0?res.push(arr1[i++]):res.push(arr2[j++])}for(;i<arr1.length;)res.push(arr1[i++]);for(;j<arr2.length;)res.push(arr2[j++]);return res}updateChildIndexes(rowNode){if(_.missing(rowNode.childrenAfterSort))return;const listToSort=rowNode.childrenAfterSort;for(let i=0;i<listToSort.length;i++){const child=listToSort[i],firstChild=0===i,lastChild=i===rowNode.childrenAfterSort.length-1;child.setFirstChild(firstChild),child.setLastChild(lastChild),child.setChildIndex(i)}}updateGroupDataForHideOpenParents(changedPath){if(!this.gos.get("groupHideOpenParents"))return;if(this.gos.get("treeData"))return _.warnOnce("The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them."),!1;const callback=rowNode=>{this.pullDownGroupDataForHideOpenParents(rowNode.childrenAfterSort,!1),rowNode.childrenAfterSort.forEach(child=>{child.hasChildren()&&callback(child)})};changedPath&&changedPath.executeFromRootNode(rowNode=>callback(rowNode))}pullDownGroupDataForHideOpenParents(rowNodes,clearOperation){this.gos.get("groupHideOpenParents")&&!_.missing(rowNodes)&&rowNodes.forEach(childRowNode=>{this.columnModel.getGroupDisplayColumns().forEach(groupDisplayCol=>{const showRowGroup=groupDisplayCol.getColDef().showRowGroup;if("string"!=typeof showRowGroup)return void console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup");const displayingGroupKey=showRowGroup,rowGroupColumn=this.columnModel.getPrimaryColumn(displayingGroupKey);if(!(rowGroupColumn===childRowNode.rowGroupColumn))if(clearOperation)childRowNode.setGroupValue(groupDisplayCol.getId(),void 0);else{const parentToStealFrom=childRowNode.getFirstChildOfFirstChild(rowGroupColumn);parentToStealFrom&&childRowNode.setGroupValue(groupDisplayCol.getId(),parentToStealFrom.key)}})})}};__decorateClass([Autowired("columnModel")],SortService.prototype,"columnModel",2),__decorateClass([Autowired("rowNodeSorter")],SortService.prototype,"rowNodeSorter",2),SortService=__decorateClass([Bean("sortService")],SortService);var FilterService=class extends BeanStub{filter(changedPath){const filterActive=this.filterManager.isChildFilterPresent();this.filterNodes(filterActive,changedPath)}filterNodes(filterActive,changedPath){const filterCallback=(rowNode,includeChildNodes)=>{rowNode.hasChildren()?rowNode.childrenAfterFilter=filterActive&&!includeChildNodes?rowNode.childrenAfterGroup.filter(childNode=>{const passBecauseChildren=childNode.childrenAfterFilter&&childNode.childrenAfterFilter.length>0,passBecauseDataPasses=childNode.data&&this.filterManager.doesRowPassFilter({rowNode:childNode});return passBecauseChildren||passBecauseDataPasses}):rowNode.childrenAfterGroup:rowNode.childrenAfterFilter=rowNode.childrenAfterGroup,rowNode.sibling&&(rowNode.sibling.childrenAfterFilter=rowNode.childrenAfterFilter)};if(this.doingTreeDataFiltering()){const treeDataDepthFirstFilter=(rowNode,alreadyFoundInParent)=>{if(rowNode.childrenAfterGroup)for(let i=0;i<rowNode.childrenAfterGroup.length;i++){const childNode=rowNode.childrenAfterGroup[i],foundInParent=alreadyFoundInParent||this.filterManager.doesRowPassFilter({rowNode:childNode});childNode.childrenAfterGroup?treeDataDepthFirstFilter(rowNode.childrenAfterGroup[i],foundInParent):filterCallback(childNode,foundInParent)}filterCallback(rowNode,alreadyFoundInParent)},treeDataFilterCallback=rowNode=>treeDataDepthFirstFilter(rowNode,!1);changedPath.executeFromRootNode(treeDataFilterCallback)}else{const defaultFilterCallback=rowNode=>filterCallback(rowNode,!1);changedPath.forEachChangedNodeDepthFirst(defaultFilterCallback,!0)}}doingTreeDataFiltering(){return this.gos.get("treeData")&&!this.gos.get("excludeChildrenWhenTreeDataFiltering")}};__decorateClass([Autowired("filterManager")],FilterService.prototype,"filterManager",2),FilterService=__decorateClass([Bean("filterService")],FilterService);var ImmutableService=class extends BeanStub{postConstruct(){"clientSide"===this.rowModel.getType()&&(this.clientSideRowModel=this.rowModel,this.addManagedPropertyListener("rowData",()=>this.onRowDataUpdated()))}isActive(){const getRowIdProvided=this.gos.exists("getRowId");return!this.gos.get("resetRowDataOnUpdate")&&getRowIdProvided}setRowData(rowData){const transactionAndMap=this.createTransactionForRowData(rowData);if(!transactionAndMap)return;const[transaction,orderIdMap]=transactionAndMap;this.clientSideRowModel.updateRowData(transaction,orderIdMap)}createTransactionForRowData(rowData){if(_.missing(this.clientSideRowModel))return void console.error("AG Grid: ImmutableService only works with ClientSideRowModel");const getRowIdFunc=this.gos.getCallback("getRowId");if(null==getRowIdFunc)return void console.error("AG Grid: ImmutableService requires getRowId() callback to be implemented, your row data needs IDs!");const transaction={remove:[],update:[],add:[]},existingNodesMap=this.clientSideRowModel.getCopyOfNodesMap(),orderMap=this.gos.get("suppressMaintainUnsortedOrder")?void 0:{};return _.exists(rowData)&&rowData.forEach((data,index)=>{const id=getRowIdFunc({data,level:0}),existingNode=existingNodesMap[id];if(orderMap&&(orderMap[id]=index),existingNode){existingNode.data!==data&&transaction.update.push(data),existingNodesMap[id]=void 0}else transaction.add.push(data)}),_.iterateObject(existingNodesMap,(id,rowNode)=>{rowNode&&transaction.remove.push(rowNode.data)}),[transaction,orderMap]}onRowDataUpdated(){const rowData=this.gos.get("rowData");rowData&&(this.isActive()?this.setRowData(rowData):(this.selectionService.reset("rowDataChanged"),this.clientSideRowModel.setRowData(rowData)))}};__decorateClass([Autowired("rowModel")],ImmutableService.prototype,"rowModel",2),__decorateClass([Autowired("rowRenderer")],ImmutableService.prototype,"rowRenderer",2),__decorateClass([Autowired("selectionService")],ImmutableService.prototype,"selectionService",2),__decorateClass([PostConstruct],ImmutableService.prototype,"postConstruct",1);var ClientSideRowModelModule={version:"31.3.4",moduleName:"@ag-grid-community/client-side-row-model",rowModel:"clientSide",beans:[ClientSideRowModel,FilterStage,SortStage,FlattenStage,SortService,FilterService,ImmutableService=__decorateClass([Bean("immutableService")],ImmutableService)]},__defProp2=Object.defineProperty,__getOwnPropDesc2=Object.getOwnPropertyDescriptor,__decorateClass2=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc2(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp2(target,key,result),result},InfiniteBlock=class extends RowNodeBlock{constructor(id,parentCache,params){super(id),this.parentCache=parentCache,this.params=params,this.startRow=id*params.blockSize,this.endRow=this.startRow+params.blockSize}postConstruct(){this.createRowNodes()}getBlockStateJson(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}}setDataAndId(rowNode,data,index){_.exists(data)?rowNode.setDataAndId(data,index.toString()):rowNode.setDataAndId(void 0,void 0)}loadFromDatasource(){const params=this.createLoadParams();_.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout(()=>{this.params.datasource.getRows(params)},0)}processServerFail(){}createLoadParams(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gos.getGridCommonParams().context}}forEachNode(callback,sequence,rowCount){this.rowNodes.forEach((rowNode,index)=>{this.startRow+index<rowCount&&callback(rowNode,sequence.next())})}getLastAccessed(){return this.lastAccessed}getRow(rowIndex,dontTouchLastAccessed=!1){dontTouchLastAccessed||(this.lastAccessed=this.params.lastAccessedSequence.next());const localIndex=rowIndex-this.startRow;return this.rowNodes[localIndex]}getStartRow(){return this.startRow}getEndRow(){return this.endRow}createRowNodes(){this.rowNodes=[];for(let i=0;i<this.params.blockSize;i++){const rowIndex=this.startRow+i,rowNode=new RowNode(this.beans);rowNode.setRowHeight(this.params.rowHeight),rowNode.uiLevel=0,rowNode.setRowIndex(rowIndex),rowNode.setRowTop(this.params.rowHeight*rowIndex),this.rowNodes.push(rowNode)}}processServerResult(params){this.rowNodes.forEach((rowNode,index)=>{const data=params.rowData?params.rowData[index]:void 0;!rowNode.id&&rowNode.alreadyRendered&&data&&(this.rowNodes[index]=new RowNode(this.beans),this.rowNodes[index].setRowIndex(rowNode.rowIndex),this.rowNodes[index].setRowTop(rowNode.rowTop),this.rowNodes[index].setRowHeight(rowNode.rowHeight),rowNode.clearRowTopAndRowIndex()),this.setDataAndId(this.rowNodes[index],data,this.startRow+index)});const finalRowCount=null!=params.rowCount&&params.rowCount>=0?params.rowCount:void 0;this.parentCache.pageLoaded(this,finalRowCount)}destroyRowNodes(){this.rowNodes.forEach(rowNode=>{rowNode.clearRowTopAndRowIndex()})}};__decorateClass2([Autowired("beans")],InfiniteBlock.prototype,"beans",2),__decorateClass2([PostConstruct],InfiniteBlock.prototype,"postConstruct",1),__decorateClass2([PreDestroy],InfiniteBlock.prototype,"destroyRowNodes",1);var index,decorator,_InfiniteCache=class _InfiniteCache2 extends BeanStub{constructor(params){super(),this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=params.initialRowCount,this.params=params}setBeans(loggerFactory){this.logger=loggerFactory.create("InfiniteCache")}getRow(rowIndex,dontCreatePage=!1){const blockId=Math.floor(rowIndex/this.params.blockSize);let block=this.blocks[blockId];if(!block){if(dontCreatePage)return;block=this.createBlock(blockId)}return block.getRow(rowIndex)}createBlock(blockNumber){const newBlock=this.createBean(new InfiniteBlock(blockNumber,this,this.params));return this.blocks[newBlock.getId()]=newBlock,this.blockCount++,this.purgeBlocksIfNeeded(newBlock),this.params.rowNodeBlockLoader.addBlock(newBlock),newBlock}refreshCache(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach(block=>block.setStateWaitingToLoad()),this.params.rowNodeBlockLoader.checkBlockToLoad())}destroyAllBlocks(){this.getBlocksInOrder().forEach(block=>this.destroyBlock(block))}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(block,lastRow){this.isAlive()&&(this.logger.log(`onPageLoaded: page = ${block.getId()}, lastRow = ${lastRow}`),this.checkRowCount(block,lastRow),this.onCacheUpdated())}purgeBlocksIfNeeded(blockToExclude){const blocksForPurging=this.getBlocksInOrder().filter(b=>b!=blockToExclude);blocksForPurging.sort((a,b)=>b.getLastAccessed()-a.getLastAccessed());const maxBlocksProvided=this.params.maxBlocksInCache>0,blocksToKeep=maxBlocksProvided?this.params.maxBlocksInCache-1:null,emptyBlocksToKeep=_InfiniteCache2.MAX_EMPTY_BLOCKS_TO_KEEP-1;blocksForPurging.forEach((block,index)=>{if(block.getState()===InfiniteBlock.STATE_WAITING_TO_LOAD&&index>=emptyBlocksToKeep||!!maxBlocksProvided&&index>=blocksToKeep){if(this.isBlockCurrentlyDisplayed(block))return;if(this.isBlockFocused(block))return;this.removeBlockFromCache(block)}})}isBlockFocused(block){const focusedCell=this.focusService.getFocusCellToUseAfterRefresh();if(!focusedCell)return!1;if(null!=focusedCell.rowPinned)return!1;const blockIndexStart=block.getStartRow(),blockIndexEnd=block.getEndRow();return focusedCell.rowIndex>=blockIndexStart&&focusedCell.rowIndex<blockIndexEnd}isBlockCurrentlyDisplayed(block){const startIndex=block.getStartRow(),endIndex=block.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(startIndex,endIndex)}removeBlockFromCache(blockToRemove){blockToRemove&&this.destroyBlock(blockToRemove)}checkRowCount(block,lastRow){if("number"==typeof lastRow&&lastRow>=0)this.rowCount=lastRow,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const lastRowIndexPlusOverflow=(block.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<lastRowIndexPlusOverflow&&(this.rowCount=lastRowIndexPlusOverflow)}}setRowCount(rowCount,lastRowIndexKnown){this.rowCount=rowCount,_.exists(lastRowIndexKnown)&&(this.lastRowIndexKnown=lastRowIndexKnown),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(callback){const sequence=new NumberSequence;this.getBlocksInOrder().forEach(block=>block.forEachNode(callback,sequence,this.rowCount))}getBlocksInOrder(){return _.getAllValuesInObject(this.blocks).sort((a,b)=>a.getId()-b.getId())}destroyBlock(block){delete this.blocks[block.getId()],this.destroyBean(block),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(block)}onCacheUpdated(){if(this.isAlive()){this.destroyAllBlocksPastVirtualRowCount();const event={type:Events.EVENT_STORE_UPDATED};this.eventService.dispatchEvent(event)}}destroyAllBlocksPastVirtualRowCount(){const blocksToDestroy=[];this.getBlocksInOrder().forEach(block=>{block.getId()*this.params.blockSize>=this.rowCount&&blocksToDestroy.push(block)}),blocksToDestroy.length>0&&blocksToDestroy.forEach(block=>this.destroyBlock(block))}purgeCache(){this.getBlocksInOrder().forEach(block=>this.removeBlockFromCache(block)),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(firstInRange,lastInRange){const result=[];let lastBlockId=-1,inActiveRange=!1;const numberSequence=new NumberSequence;_.missing(firstInRange)&&(inActiveRange=!0);let foundGapInSelection=!1;this.getBlocksInOrder().forEach(block=>{foundGapInSelection||(inActiveRange&&lastBlockId+1!==block.getId()?foundGapInSelection=!0:(lastBlockId=block.getId(),block.forEachNode(rowNode=>{const hitFirstOrLast=rowNode===firstInRange||rowNode===lastInRange;(inActiveRange||hitFirstOrLast)&&result.push(rowNode),hitFirstOrLast&&(inActiveRange=!inActiveRange)},numberSequence,this.rowCount)))});return foundGapInSelection||inActiveRange?[]:result}};_InfiniteCache.MAX_EMPTY_BLOCKS_TO_KEEP=2,__decorateClass2([Autowired("rowRenderer")],_InfiniteCache.prototype,"rowRenderer",2),__decorateClass2([Autowired("focusService")],_InfiniteCache.prototype,"focusService",2),__decorateClass2([(index=0,decorator=Qualifier("loggerFactory"),(target,key)=>decorator(target,key,index))],_InfiniteCache.prototype,"setBeans",1),__decorateClass2([PreDestroy],_InfiniteCache.prototype,"destroyAllBlocks",1);var InfiniteCache=_InfiniteCache,InfiniteRowModel=class extends BeanStub{getRowBounds(index){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*index}}ensureRowHeightsValid(startPixel,endPixel,startLimitIndex,endLimitIndex){return!1}init(){this.gos.isRowModelType("infinite")&&(this.rowHeight=this.gos.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache()),this.verifyProps())}verifyProps(){this.gos.exists("initialGroupOrderComparator")&&_.warnOnce("initialGroupOrderComparator cannot be used with Infinite Row Model as sorting is done on the server side")}start(){this.setDatasource(this.gos.get("datasource"))}destroyDatasource(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedListener(this.eventService,Events.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,Events.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this)),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=this.gos.getRowHeightAsNumber(),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onFilterChanged(){this.reset()}onSortChanged(){this.reset()}onColumnEverything(){let resetRequired;resetRequired=!this.cacheParams||this.isSortModelDifferent(),resetRequired&&this.reset()}isSortModelDifferent(){return!_.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())}getType(){return"infinite"}setDatasource(datasource){this.destroyDatasource(),this.datasource=datasource,datasource&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getNodesInRangeForSelection(firstInRange,lastInRange){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(firstInRange,lastInRange):[]}reset(){if(!this.datasource)return;null!=this.gos.getCallback("getRowId")||this.selectionService.reset("rowDataChanged"),this.resetCache()}createModelUpdatedEvent(){return{type:Events.EVENT_MODEL_UPDATED,newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1}}resetCache(){this.destroyCache(),this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,initialRowCount:this.gos.get("infiniteInitialRowCount"),maxBlocksInCache:this.gos.get("maxBlocksInCache"),rowHeight:this.gos.getRowHeightAsNumber(),overflowSize:this.gos.get("cacheOverflowSize"),blockSize:this.gos.get("cacheBlockSize"),lastAccessedSequence:new NumberSequence},this.infiniteCache=this.createBean(new InfiniteCache(this.cacheParams)),this.eventService.dispatchEventOnce({type:Events.EVENT_ROW_COUNT_READY});const event=this.createModelUpdatedEvent();this.eventService.dispatchEvent(event)}updateRowHeights(){this.forEachNode(node=>{node.setRowHeight(this.rowHeight),node.setRowTop(this.rowHeight*node.rowIndex)});const event=this.createModelUpdatedEvent();this.eventService.dispatchEvent(event)}destroyCache(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))}onCacheUpdated(){const event=this.createModelUpdatedEvent();this.eventService.dispatchEvent(event)}getRow(rowIndex){if(this.infiniteCache&&!(rowIndex>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(rowIndex)}getRowNode(id){let result;return this.forEachNode(rowNode=>{rowNode.id===id&&(result=rowNode)}),result}forEachNode(callback){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(callback)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(topLevelIndex){return topLevelIndex}getRowIndexAtPixel(pixel){if(0!==this.rowHeight){const rowIndexForPixel=Math.floor(pixel/this.rowHeight),lastRowIndex=this.getRowCount()-1;return rowIndexForPixel>lastRowIndex?lastRowIndex:rowIndexForPixel}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(rowNode){return!!this.getRowNode(rowNode.id)}refreshCache(){this.infiniteCache&&this.infiniteCache.refreshCache()}purgeCache(){this.infiniteCache&&this.infiniteCache.purgeCache()}isLastRowIndexKnown(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()}setRowCount(rowCount,lastRowIndexKnown){this.infiniteCache&&this.infiniteCache.setRowCount(rowCount,lastRowIndexKnown)}};__decorateClass2([Autowired("filterManager")],InfiniteRowModel.prototype,"filterManager",2),__decorateClass2([Autowired("sortController")],InfiniteRowModel.prototype,"sortController",2),__decorateClass2([Autowired("selectionService")],InfiniteRowModel.prototype,"selectionService",2),__decorateClass2([Autowired("rowRenderer")],InfiniteRowModel.prototype,"rowRenderer",2),__decorateClass2([Autowired("rowNodeBlockLoader")],InfiniteRowModel.prototype,"rowNodeBlockLoader",2),__decorateClass2([PostConstruct],InfiniteRowModel.prototype,"init",1),__decorateClass2([PreDestroy],InfiniteRowModel.prototype,"destroyDatasource",1);var InfiniteRowModelModule={version:"31.3.4",moduleName:"@ag-grid-community/infinite-row-model",rowModel:"infinite",beans:[InfiniteRowModel=__decorateClass2([Bean("rowModel")],InfiniteRowModel)]},__defProp3=Object.defineProperty,__getOwnPropDesc3=Object.getOwnPropertyDescriptor,__decorateClass3=(decorators,target,key,kind)=>{for(var decorator,result=kind>1?void 0:kind?__getOwnPropDesc3(target,key):target,i=decorators.length-1;i>=0;i--)(decorator=decorators[i])&&(result=(kind?decorator(target,key,result):decorator(result))||result);return kind&&result&&__defProp3(target,key,result),result},BaseCreator=class{setBeans(beans){this.beans=beans}getFileName(fileName){const extension=this.getDefaultFileExtension();return null!=fileName&&fileName.length||(fileName=this.getDefaultFileName()),-1===fileName.indexOf(".")?`${fileName}.${extension}`:fileName}getData(params){const serializingSession=this.createSerializingSession(params);return this.beans.gridSerializer.serialize(serializingSession,params)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},BaseGridSerializingSession=class{constructor(config){this.groupColumns=[];const{columnModel,valueService,gos,processCellCallback,processHeaderCallback,processGroupHeaderCallback,processRowGroupCallback}=config;this.columnModel=columnModel,this.valueService=valueService,this.gos=gos,this.processCellCallback=processCellCallback,this.processHeaderCallback=processHeaderCallback,this.processGroupHeaderCallback=processGroupHeaderCallback,this.processRowGroupCallback=processRowGroupCallback}prepare(columnsToExport){this.groupColumns=columnsToExport.filter(col=>!!col.getColDef().showRowGroup)}extractHeaderValue(column){const value=this.getHeaderName(this.processHeaderCallback,column);return null!=value?value:""}extractRowCellValue(column,index,accumulatedRowIndex,type,node){const value=this.gos.get("groupHideOpenParents")&&!node.footer||!this.shouldRenderGroupSummaryCell(node,column,index)?this.valueService.getValue(column,node):this.createValueForGroupNode(column,node);return this.processCell({accumulatedRowIndex,rowNode:node,column,value,processCellCallback:this.processCellCallback,type})}shouldRenderGroupSummaryCell(node,column,currentColumnIndex){var _a;if(!(node&&node.group))return!1;if(-1!==this.groupColumns.indexOf(column)){if(null!=(null==(_a=node.groupData)?void 0:_a[column.getId()]))return!0;if(this.gos.isRowModelType("serverSide")&&node.group)return!0;if(node.footer&&-1===node.level){const colDef=column.getColDef();return null==colDef||!0===colDef.showRowGroup||colDef.showRowGroup===this.columnModel.getRowGroupColumns()[0].getId()}}const isGroupUseEntireRow=this.gos.isGroupUseEntireRow(this.columnModel.isPivotMode());return 0===currentColumnIndex&&isGroupUseEntireRow}getHeaderName(callback,column){return callback?callback(this.gos.addGridCommonParams({column})):this.columnModel.getDisplayNameForColumn(column,"csv",!0)}createValueForGroupNode(column,node){if(this.processRowGroupCallback)return this.processRowGroupCallback(this.gos.addGridCommonParams({column,node}));const isTreeData=this.gos.get("treeData"),isSuppressGroupMaintainValueType=this.gos.get("suppressGroupMaintainValueType"),getValueFromNode=node2=>{var _a,_b;if(isTreeData||isSuppressGroupMaintainValueType)return node2.key;const value=null==(_a=node2.groupData)?void 0:_a[column.getId()];return value&&node2.rowGroupColumn&&!1!==node2.rowGroupColumn.getColDef().useValueFormatterForExport&&null!=(_b=this.valueService.formatValue(node2.rowGroupColumn,node2,value))?_b:value},isFooter=node.footer,keys2=[getValueFromNode(node)];if(!this.gos.isGroupMultiAutoColumn())for(;node.parent;)node=node.parent,keys2.push(getValueFromNode(node));const groupValue=keys2.reverse().join(" -> ");return isFooter?`Total ${groupValue}`:groupValue}processCell(params){var _a;const{accumulatedRowIndex,rowNode,column,value,processCellCallback,type}=params;return processCellCallback?{value:null!=(_a=processCellCallback(this.gos.addGridCommonParams({accumulatedRowIndex,column,node:rowNode,value,type,parseValue:valueToParse=>this.valueService.parseValue(column,rowNode,valueToParse,this.valueService.getValue(column,rowNode)),formatValue:valueToFormat=>{var _a2;return null!=(_a2=this.valueService.formatValue(column,rowNode,valueToFormat))?_a2:valueToFormat}})))?_a:""}:!1!==column.getColDef().useValueFormatterForExport?{value:null!=value?value:"",valueFormatted:this.valueService.formatValue(column,rowNode,value)}:{value:null!=value?value:""}}},Downloader=class{static download(fileName,content){const win=document.defaultView||window;if(!win)return void console.warn("AG Grid: There is no `window` associated with the current `document`");const element=document.createElement("a"),url=win.URL.createObjectURL(content);element.setAttribute("href",url),element.setAttribute("download",fileName),element.style.display="none",document.body.appendChild(element),element.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:win})),document.body.removeChild(element),win.setTimeout(()=>{win.URL.revokeObjectURL(url)},0)}},CsvSerializingSession=class extends BaseGridSerializingSession{constructor(config){super(config),this.isFirstLine=!0,this.result="";const{suppressQuotes,columnSeparator}=config;this.suppressQuotes=suppressQuotes,this.columnSeparator=columnSeparator}addCustomContent(content){content&&("string"==typeof content?(/^\s*\n/.test(content)||this.beginNewLine(),content=content.replace(/\r?\n/g,"\r\n"),this.result+=content):content.forEach(row=>{this.beginNewLine(),row.forEach((cell,index)=>{0!==index&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(cell.data.value||""),cell.mergeAcross&&this.appendEmptyCells(cell.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(columnGroup,header,index,span){0!=index&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(header),this.appendEmptyCells(span)}appendEmptyCells(count){for(let i=1;i<=count;i++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(column,index){0!=index&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(column))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(column,index,node){var _a;0!=index&&(this.result+=this.columnSeparator);const rowCellValue=this.extractRowCellValue(column,index,index,"csv",node);this.result+=this.putInQuotes(null!=(_a=rowCellValue.valueFormatted)?_a:rowCellValue.value)}putInQuotes(value){if(this.suppressQuotes)return value;if(null==value)return'""';let stringValue;"string"==typeof value?stringValue=value:"function"==typeof value.toString?stringValue=value.toString():(console.warn("AG Grid: unknown value type during csv conversion"),stringValue="");return'"'+stringValue.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1}},CsvCreator=class extends BaseCreator{postConstruct(){this.setBeans({gridSerializer:this.gridSerializer,gos:this.gos})}getMergedParams(params){const baseParams=this.gos.get("defaultCsvExportParams");return Object.assign({},baseParams,params)}export(userParams){if(this.isExportSuppressed())return void console.warn("AG Grid: Export cancelled. Export is not allowed as per your configuration.");const mergedParams=this.getMergedParams(userParams),data=this.getData(mergedParams),packagedFile=new Blob(["\ufeff",data],{type:"text/plain"}),fileName="function"==typeof mergedParams.fileName?mergedParams.fileName(this.gos.getGridCommonParams()):mergedParams.fileName;Downloader.download(this.getFileName(fileName),packagedFile)}exportDataAsCsv(params){this.export(params)}getDataAsCsv(params,skipDefaultParams=!1){const mergedParams=skipDefaultParams?Object.assign({},params):this.getMergedParams(params);return this.getData(mergedParams)}getDefaultFileExtension(){return"csv"}createSerializingSession(params){const{columnModel,valueService,gos}=this,{processCellCallback,processHeaderCallback,processGroupHeaderCallback,processRowGroupCallback,suppressQuotes,columnSeparator}=params;return new CsvSerializingSession({columnModel,valueService,gos,processCellCallback:processCellCallback||void 0,processHeaderCallback:processHeaderCallback||void 0,processGroupHeaderCallback:processGroupHeaderCallback||void 0,processRowGroupCallback:processRowGroupCallback||void 0,suppressQuotes:suppressQuotes||!1,columnSeparator:columnSeparator||","})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};__decorateClass3([Autowired("columnModel")],CsvCreator.prototype,"columnModel",2),__decorateClass3([Autowired("valueService")],CsvCreator.prototype,"valueService",2),__decorateClass3([Autowired("gridSerializer")],CsvCreator.prototype,"gridSerializer",2),__decorateClass3([Autowired("gridOptionsService")],CsvCreator.prototype,"gos",2),__decorateClass3([PostConstruct],CsvCreator.prototype,"postConstruct",1),CsvCreator=__decorateClass3([Bean("csvCreator")],CsvCreator);var GridSerializer=class extends BeanStub{serialize(gridSerializingSession,params={}){const{allColumns,columnKeys,skipRowGroups}=params,columnsToExport=this.getColumnsToExport(allColumns,skipRowGroups,columnKeys);return _.compose(this.prepareSession(columnsToExport),this.prependContent(params),this.exportColumnGroups(params,columnsToExport),this.exportHeaders(params,columnsToExport),this.processPinnedTopRows(params,columnsToExport),this.processRows(params,columnsToExport),this.processPinnedBottomRows(params,columnsToExport),this.appendContent(params))(gridSerializingSession).parse()}processRow(gridSerializingSession,params,columnsToExport,node){const rowSkipper=params.shouldRowBeSkipped||(()=>!1),skipSingleChildrenGroup=this.gos.get("groupRemoveSingleChildren"),skipLowestSingleChildrenGroup=this.gos.get("groupRemoveLowestSingleChildren"),isExplicitExportSelection=null!=params.rowPositions||!!params.onlySelected,hideOpenParents=this.gos.get("groupHideOpenParents")&&!isExplicitExportSelection,isLeafNode=this.columnModel.isPivotMode()?node.leafGroup:!node.group,isFooter=!!node.footer,shouldSkipLowestGroup=skipLowestSingleChildrenGroup&&node.leafGroup,shouldSkipCurrentGroup=1===node.allChildrenCount&&(skipSingleChildrenGroup||shouldSkipLowestGroup);if(!isLeafNode&&!isFooter&&(params.skipRowGroups||shouldSkipCurrentGroup||hideOpenParents)||params.onlySelected&&!node.isSelected()||params.skipPinnedTop&&"top"===node.rowPinned||params.skipPinnedBottom&&"bottom"===node.rowPinned)return;if(-1===node.level&&!isLeafNode&&!isFooter)return;if(rowSkipper(this.gos.addGridCommonParams({node})))return;const rowAccumulator=gridSerializingSession.onNewBodyRow(node);if(columnsToExport.forEach((column,index)=>{rowAccumulator.onColumn(column,index,node)}),params.getCustomContentBelowRow){const content=params.getCustomContentBelowRow(this.gos.addGridCommonParams({node}));content&&gridSerializingSession.addCustomContent(content)}}appendContent(params){return gridSerializingSession=>{const appendContent=params.appendContent;return appendContent&&gridSerializingSession.addCustomContent(appendContent),gridSerializingSession}}prependContent(params){return gridSerializingSession=>{const prependContent=params.prependContent;return prependContent&&gridSerializingSession.addCustomContent(prependContent),gridSerializingSession}}prepareSession(columnsToExport){return gridSerializingSession=>(gridSerializingSession.prepare(columnsToExport),gridSerializingSession)}exportColumnGroups(params,columnsToExport){return gridSerializingSession=>{if(!params.skipColumnGroupHeaders){const groupInstanceIdCreator=new GroupInstanceIdCreator,displayedGroups=this.displayedGroupCreator.createDisplayedGroups(columnsToExport,groupInstanceIdCreator,null);this.recursivelyAddHeaderGroups(displayedGroups,gridSerializingSession,params.processGroupHeaderCallback)}return gridSerializingSession}}exportHeaders(params,columnsToExport){return gridSerializingSession=>{if(!params.skipColumnHeaders){const gridRowIterator=gridSerializingSession.onNewHeaderRow();columnsToExport.forEach((column,index)=>{gridRowIterator.onColumn(column,index,void 0)})}return gridSerializingSession}}processPinnedTopRows(params,columnsToExport){return gridSerializingSession=>{const processRow=this.processRow.bind(this,gridSerializingSession,params,columnsToExport);return params.rowPositions?params.rowPositions.filter(position=>"top"===position.rowPinned).sort((a,b)=>a.rowIndex-b.rowIndex).map(position=>this.pinnedRowModel.getPinnedTopRow(position.rowIndex)).forEach(processRow):this.pinnedRowModel.forEachPinnedTopRow(processRow),gridSerializingSession}}processRows(params,columnsToExport){return gridSerializingSession=>{const rowModel=this.rowModel,rowModelType=rowModel.getType(),usingCsrm="clientSide"===rowModelType,usingSsrm="serverSide"===rowModelType,onlySelectedNonStandardModel=!usingCsrm&&params.onlySelected,processRow=this.processRow.bind(this,gridSerializingSession,params,columnsToExport),{exportedRows="filteredAndSorted"}=params;if(params.rowPositions)params.rowPositions.filter(position=>null==position.rowPinned).sort((a,b)=>a.rowIndex-b.rowIndex).map(position=>rowModel.getRow(position.rowIndex)).forEach(processRow);else if(this.columnModel.isPivotMode())usingCsrm?rowModel.forEachPivotNode(processRow,!0):usingSsrm?rowModel.forEachNodeAfterFilterAndSort(processRow,!0):rowModel.forEachNode(processRow);else if(params.onlySelectedAllPages||onlySelectedNonStandardModel){const selectedNodes=this.selectionService.getSelectedNodes();this.replicateSortedOrder(selectedNodes),selectedNodes.forEach(processRow)}else"all"===exportedRows?rowModel.forEachNode(processRow):usingCsrm||usingSsrm?rowModel.forEachNodeAfterFilterAndSort(processRow,!0):rowModel.forEachNode(processRow);return gridSerializingSession}}replicateSortedOrder(rows){const sortOptions=this.sortController.getSortOptions(),compareNodes=(rowA,rowB)=>{var _a,_b,_c,_d;return null!=rowA.rowIndex&&null!=rowB.rowIndex?rowA.rowIndex-rowB.rowIndex:rowA.level===rowB.level?(null==(_a=rowA.parent)?void 0:_a.id)===(null==(_b=rowB.parent)?void 0:_b.id)?this.rowNodeSorter.compareRowNodes(sortOptions,{rowNode:rowA,currentPos:null!=(_c=rowA.rowIndex)?_c:-1},{rowNode:rowB,currentPos:null!=(_d=rowB.rowIndex)?_d:-1}):compareNodes(rowA.parent,rowB.parent):rowA.level>rowB.level?compareNodes(rowA.parent,rowB):compareNodes(rowA,rowB.parent)};rows.sort(compareNodes)}processPinnedBottomRows(params,columnsToExport){return gridSerializingSession=>{const processRow=this.processRow.bind(this,gridSerializingSession,params,columnsToExport);return params.rowPositions?params.rowPositions.filter(position=>"bottom"===position.rowPinned).sort((a,b)=>a.rowIndex-b.rowIndex).map(position=>this.pinnedRowModel.getPinnedBottomRow(position.rowIndex)).forEach(processRow):this.pinnedRowModel.forEachPinnedBottomRow(processRow),gridSerializingSession}}getColumnsToExport(allColumns=!1,skipRowGroups=!1,columnKeys){const isPivotMode=this.columnModel.isPivotMode();if(columnKeys&&columnKeys.length)return this.columnModel.getGridColumns(columnKeys);const isTreeData=this.gos.get("treeData");let columnsToExport=[];return columnsToExport=allColumns&&!isPivotMode?this.columnModel.getAllGridColumns():this.columnModel.getAllDisplayedColumns(),skipRowGroups&&!isTreeData&&(columnsToExport=columnsToExport.filter(column=>"ag-Grid-AutoColumn"!==column.getColId())),columnsToExport}recursivelyAddHeaderGroups(displayedGroups,gridSerializingSession,processGroupHeaderCallback){const directChildrenHeaderGroups=[];displayedGroups.forEach(columnGroupChild=>{const columnGroup=columnGroupChild;columnGroup.getChildren&&columnGroup.getChildren().forEach(it=>directChildrenHeaderGroups.push(it))}),displayedGroups.length>0&&displayedGroups[0]instanceof ColumnGroup&&this.doAddHeaderHeader(gridSerializingSession,displayedGroups,processGroupHeaderCallback),directChildrenHeaderGroups&&directChildrenHeaderGroups.length>0&&this.recursivelyAddHeaderGroups(directChildrenHeaderGroups,gridSerializingSession,processGroupHeaderCallback)}doAddHeaderHeader(gridSerializingSession,displayedGroups,processGroupHeaderCallback){const gridRowIterator=gridSerializingSession.onNewHeaderGroupingRow();let columnIndex=0;displayedGroups.forEach(columnGroupChild=>{const columnGroup=columnGroupChild;let name;name=processGroupHeaderCallback?processGroupHeaderCallback(this.gos.addGridCommonParams({columnGroup})):this.columnModel.getDisplayNameForColumnGroup(columnGroup,"header");const collapsibleGroupRanges=columnGroup.getLeafColumns().reduce((collapsibleGroups,currentColumn,currentIdx,arr)=>{let lastGroup=_.last(collapsibleGroups);return"open"===currentColumn.getColumnGroupShow()?lastGroup&&null==lastGroup[1]||(lastGroup=[currentIdx],collapsibleGroups.push(lastGroup)):lastGroup&&null==lastGroup[1]&&(lastGroup[1]=currentIdx-1),currentIdx===arr.length-1&&lastGroup&&null==lastGroup[1]&&(lastGroup[1]=currentIdx),collapsibleGroups},[]);gridRowIterator.onColumn(columnGroup,name||"",columnIndex++,columnGroup.getLeafColumns().length-1,collapsibleGroupRanges)})}};__decorateClass3([Autowired("displayedGroupCreator")],GridSerializer.prototype,"displayedGroupCreator",2),__decorateClass3([Autowired("columnModel")],GridSerializer.prototype,"columnModel",2),__decorateClass3([Autowired("rowModel")],GridSerializer.prototype,"rowModel",2),__decorateClass3([Autowired("pinnedRowModel")],GridSerializer.prototype,"pinnedRowModel",2),__decorateClass3([Autowired("selectionService")],GridSerializer.prototype,"selectionService",2),__decorateClass3([Autowired("rowNodeSorter")],GridSerializer.prototype,"rowNodeSorter",2),__decorateClass3([Autowired("sortController")],GridSerializer.prototype,"sortController",2);var CsvExportModule={version:"31.3.4",moduleName:"@ag-grid-community/csv-export",beans:[CsvCreator,GridSerializer=__decorateClass3([Bean("gridSerializer")],GridSerializer)]};ModuleRegistry.__registerModules([ClientSideRowModelModule,InfiniteRowModelModule,CsvExportModule],!1,void 0)}}]);
import{a as h}from"./chunk-KMTXDXBV.js";import{a as o}from"./chunk-6BJDCBJV.js";import{a,b as l}from"./chunk-2E5AD633.js";import{f as n,h as c,j as r,l as d,m as s}from"./chunk-6YACYC4R.js";var p=()=>":host{display:inline-block}",u=class{constructor(e){c(this,e),this.ifxOpen=s(this,"ifxOpen",7),this.ifxClose=s(this,"ifxClose",7),this.ifxDropdown=s(this,"ifxDropdown",7)}placement="bottom-start";defaultOpen=!1;internalIsOpen=!1;noAppendToBody=!1;ifxOpen;ifxClose;ifxDropdown;disabled;noCloseOnOutsideClick=!1;noCloseOnMenuClick=!1;get el(){return d(this)}trigger;menu;popperInstance;handleOutsideClick(e){let t=e.target;!this.noCloseOnOutsideClick&&!this.el.contains(t)&&!this.menu.contains(t)&&this.closeDropdown()}handleFocusOutside(e){let t=e.target;this.internalIsOpen&&!this.el.contains(t)&&!this.menu.contains(t)&&this.closeDropdown()}handleTriggerClick=()=>{this.internalIsOpen?this.closeDropdown():this.openDropdown()};handleTriggerKeyDown=e=>{e.key==="Tab"&&this.internalIsOpen&&!e.shiftKey&&(e.preventDefault(),this.focusFirstItem())};handleMenuClick=()=>{this.noCloseOnMenuClick||this.closeDropdown()};getItemFocusables(){return this.menu?Array.from(this.menu.querySelectorAll("ifx-dropdown-item")).filter(t=>!(t.getAttribute("hide")==="true"||t.classList.contains("hide"))).map(t=>t.shadowRoot?.querySelector("a")).filter(t=>!!t):[]}handleMenuKeyDown=e=>{let t=this.getItemFocusables();if(!t.length)return;let i=t.indexOf(document.activeElement);switch(e.key){case"ArrowDown":e.preventDefault(),t[(i+1)%t.length].focus();break;case"ArrowUp":e.preventDefault(),t[(i-1+t.length)%t.length].focus();break;case"Home":e.preventDefault(),t[0].focus();break;case"End":e.preventDefault(),t[t.length-1].focus();break;case"Enter":case" ":case"Spacebar":e.preventDefault(),document.activeElement?.click();break;case"Escape":e.preventDefault(),this.closeDropdown(),this.trigger?.focus();break;case"Tab":e.shiftKey&&i===0&&(e.preventDefault(),this.closeDropdown(),this.trigger?.focus());break}};componentWillLoad(){this.updateSlotContent(),this.watchHandlerIsOpen(this.defaultOpen,this.internalIsOpen)}componentDidLoad(){return n(this,null,function*(){if(!o(this.el)){let e=a();l("ifx-dropdown",yield e)}})}watchHandlerIsOpen(e,t){e!==t&&e!==this.internalIsOpen&&(e?this.openDropdown():this.closeDropdown())}watchHandlerDisabled(e){this.trigger&&(this.trigger.disabled=e)}watchHandlerSlot(){this.updateSlotContent()}focusFirstItem(){let[e]=this.getItemFocusables();e?.focus()}updateSlotContent(){let e=this.el.querySelector("ifx-dropdown-trigger-button, ifx-dropdown-trigger");e!==this.trigger&&(this.trigger&&(this.trigger.removeEventListener("click",this.handleTriggerClick),this.trigger.removeEventListener("keydown",this.handleTriggerKeyDown)),this.trigger=e,this.trigger&&(this.trigger.disabled=this.disabled,this.trigger.addEventListener("click",this.handleTriggerClick),this.trigger.addEventListener("keydown",this.handleTriggerKeyDown)));let t=this.el.querySelector("ifx-dropdown-menu");this.noAppendToBody?this.menu=t:(this.menu&&this.menu!==t&&(this.menu.removeEventListener("click",this.handleMenuClick),this.menu.removeEventListener("keydown",this.handleMenuKeyDown),this.menu.remove()),this.menu=t,this.menu&&!document.body.contains(this.menu)&&document.body.append(this.menu)),this.menu&&(this.menu.removeEventListener("click",this.handleMenuClick),this.menu.removeEventListener("keydown",this.handleMenuKeyDown),this.menu.addEventListener("click",this.handleMenuClick),this.menu.addEventListener("keydown",this.handleMenuKeyDown))}menuClickHandler(){this.noCloseOnMenuClick||this.closeDropdown()}disconnectedCallback(){this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=null),this.menu&&this.menu.remove()}isOpen(){return n(this,null,function*(){return this.internalIsOpen})}closeDropdown(){return n(this,null,function*(){this.internalIsOpen&&(this.internalIsOpen=!1,this.trigger.isOpen=!1,this.menu.isOpen=!1,this.ifxClose.emit()),this.popperInstance&&(this.popperInstance.destroy(),this.popperInstance=null)})}openDropdown(){return n(this,null,function*(){!this.internalIsOpen&&!this.disabled&&(this.internalIsOpen=!0,this.trigger.isOpen=!0,this.menu.isOpen=!0,this.popperInstance=h(this.el,this.menu,{placement:this.placement}),this.ifxOpen.emit())})}render(){return r("div",{key:"4e98de0e83c6d6ff4416c495270f198bcabcf958","aria-label":"dropdown menu",class:"dropdown"},r("slot",{key:"a89296bd4a261e051586dade43c3815803969aec"}))}static get watchers(){return{defaultOpen:[{watchHandlerIsOpen:0}],disabled:[{watchHandlerDisabled:0}]}}};u.style=p();export{u as ifx_dropdown};
